<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><link rel="alternate" type="application/rss+xml" href="/feed/rss.xml"/><link rel="alternate" type="application/atom+xml" href="/feed/atom.xml"/><link rel="alternate" type="application/json" href="/feed/feed.json"/><title>Eclipse Vert.x goes Native | 博客 | Eclipse Vert.x</title><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/styles.f20dca63.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.f20dca63.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-b6e20584df76f29b6f35.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.fcef98db13e2318579fb.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.7064a0f84b2a7c13404a.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" as="script"/><link rel="preload" href="/_next/static/chunks/5df0631eea625b022d3730b3f1bf573e1b8deb37.dd672925a2e24782fa8b.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-c36bc482402d8ffe42a5.js" as="script"/></head><body><div id="__next"><main class="page"><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><span class="navbar-menu-item with-drop-down"><div class="dropdown"><a class="dropdown-title">开始<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/introduction-to-vertx-and-reactive/"><li class="dropdown-item">简介</li></a><a href="/get-started/"><li class="dropdown-item">开始</li></a><a href="https://start.vertx.io/" target="_blank" rel="noreferrer"><li class="dropdown-item">应用生成器 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="navbar-menu-item" href="/docs/">文档</a><span class="navbar-menu-item with-drop-down"><div class="dropdown"><a class="dropdown-title">资源<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/faq/"><li class="dropdown-item">答疑</li></a><a href="/channels/"><li class="dropdown-item">联系渠道</li></a><a href="https://how-to.vertx.io/" target="_blank" rel="noreferrer"><li class="dropdown-item">操作指南 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/vertx-eventbus-bridge-clients" target="_blank" rel="noreferrer"><li class="dropdown-item">EventBus Bridge Clients <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="navbar-menu-item" href="/blog/">博客</a><a class="navbar-menu-item" href="/community/">社区</a><a class="navbar-menu-item" href="/translation/">翻译团队</a></div><div class="navbar-social"><a href="https://github.com/vert-x3/vertx-awesome" class="navbar-social-link" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" class="navbar-social-link" title="Stack Overflow" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>Stack Overflow</title><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" class="navbar-social-link" title="YouTube" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>YouTube</title><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a href="https://discord.gg/KzEMwP2" class="navbar-social-link" title="Discord" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title>Discord</title><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg></a><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" class="navbar-social-link" title="Vert.x 用户组" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title>Vert.x 用户组</title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a><a href="https://shang.qq.com/wpa/qunwpa?idkey=587f58cacb9557e3291b46098e0fe09427b98a1c0f866da23c04c2762bc7e2ad" class="navbar-social-link" title="Vert.x中国用户组QQ群" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Vert.x中国用户组QQ群"><title>Vert.x中国用户组QQ群</title><path d="M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673zM12.662 4.846c.039-1.052.659-1.878 1.385-1.846s1.281.912 1.242 1.964c-.039 1.051-.659 1.878-1.385 1.846s-1.282-.912-1.242-1.964zM9.954 3c.725-.033 1.345.794 1.384 1.846.04 1.052-.517 1.931-1.242 1.963-.726.033-1.346-.794-1.385-1.845C8.672 3.912 9.228 3.033 9.954 3zM7.421 8.294c.194-.43 2.147-.908 4.566-.908h.026c2.418 0 4.372.479 4.566.908a.14.14 0 0 1 .014.061c0 .031-.01.059-.026.083-.163.238-2.333 1.416-4.553 1.416h-.026c-2.221 0-4.39-1.178-4.553-1.416a.136.136 0 0 1-.014-.144zm10.422 8.622c-.22 3.676-2.403 5.987-5.774 6.021h-.137c-3.37-.033-5.554-2.345-5.773-6.021-.081-1.35.001-2.496.147-3.43.318.063.638.122.958.176v3.506s1.658.334 3.318.103v-3.225c.488.027.96.04 1.406.034h.025c1.678.021 3.714-.204 5.683-.594.146.934.227 2.08.147 3.43zM10.48 5.804c.313-.041.542-.409.508-.825-.033-.415-.314-.72-.629-.679-.313.04-.541.409-.508.824.034.417.315.72.629.68zM14.479 5.156c.078.037.221.042.289-.146.035-.095.025-.165-.009-.214-.023-.033-.133-.118-.371-.176-.904-.22-1.341.384-1.405.499-.04.072-.012.176.056.227.067.051.139.037.179-.006.58-.628 1.21-.208 1.261-.184z"></path></svg></a></div></div></div></div></header><div class="page-content"><div class="container"><div class="blog-post"><div class="blog-navbar"><h2>Blog</h2><ul><li><a href="/blog/">All posts</a></li><li><a href="/blog/category/releases/">releases</a></li><li><a href="/blog/category/guides/">guides</a></li><li><a href="/blog/category/news/">news</a></li></ul><div class="feed-icons"><a href="/feed/atom.xml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></div></div><div class="blog-post-main"><div class="blog-post-content"><h1>Eclipse Vert.x goes Native</h1><span><p>I this blog post, I would like to give you a pre­view on na­tive image gen­er­a­tion of Vert.x ap­pli­ca­tions using GraalVM.</p><p>With <a href="https://www.graalvm.org/">GraalVM</a> it is pos­si­ble to gen­er­ate na­tive ex­e­cuta­bles.
These ex­e­cuta­bles can be di­rectly run with­out the need of an in­stalled JVM.</p><h2 id="benefits"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#benefits"></a>Benefits</h2><ul><li><p>The start up time is way faster. It is no longer re­quired to wait for the start up of the JVM. The ap­pli­ca­tion is usu­ally up and run­ning in a mat­ter of mil­lisec­onds.</p></li><li><p>Re­duced mem­ory foot­print. I mea­sured 40 MB mem­ory usage (RSS) for the Vert.x Web ap­pli­ca­tion which I’m going to show­case.</p></li><li><p>Smaller Con­tain­ers. No JVM means no over­head. All the needed parts are al­ready con­tained within the ex­e­cutable. This can be very ben­e­fi­cial when build­ing de­ploy­able con­tainer im­ages.</p></li></ul><h2 id="demo-project"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#demo-project"></a>Demo Project</h2><p>For the demo ap­pli­ca­tion I choose a very basic hello world <a href="/docs/vertx-web/java/">Vert.x Web</a> server.</p><pre><code class="hljs language-java"><span class="hljs-keyword">package</span> de.jotschi.examples;

<span class="hljs-keyword">import</span> java.io.File;

<span class="hljs-keyword">import</span> io.vertx.core.Vertx;
<span class="hljs-keyword">import</span> io.vertx.core.logging.Logger;
<span class="hljs-keyword">import</span> io.vertx.core.logging.LoggerFactory;
<span class="hljs-keyword">import</span> io.vertx.core.logging.SLF4JLogDelegateFactory;
<span class="hljs-keyword">import</span> io.vertx.ext.web.Router;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Runner</span> </span>{

  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
    <span class="hljs-comment">// Use logback for logging</span>
    File logbackFile = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;config&quot;</span>, <span class="hljs-string">&quot;logback.xml&quot;</span>);
    System.setProperty(<span class="hljs-string">&quot;logback.configurationFile&quot;</span>, logbackFile.getAbsolutePath());
    System.setProperty(LoggerFactory.LOGGER_DELEGATE_FACTORY_CLASS_NAME, SLF4JLogDelegateFactory.class.getName());
    Logger log = LoggerFactory.getLogger(Runner.class);

    // Setup the http server
    log.info(&quot;Starting server <span class="hljs-keyword">for</span>: http://localhost:<span class="hljs-number">8080</span>/hello<span class="hljs-string">&quot;);
    Vertx vertx = Vertx.vertx();
    Router router = Router.router(vertx);

    router.route(&quot;</span>/hello<span class="hljs-string">&quot;).handler(rc -&gt; {
      log.info(&quot;</span>Got hello request<span class="hljs-string">&quot;);
      rc.response().end(&quot;</span>World<span class="hljs-string">&quot;);
    });

    vertx.createHttpServer()
      .requestHandler(router::accept)
      .listen(8080);

  }

}
</span></code></pre><h2 id="graalvm"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#graalvm"></a>GraalVM</h2><p><a href="https://www.graalvm.org/">GraalVM</a> runs a sta­tic analy­sis on the gen­er­ated ap­pli­ca­tion in order to find the reach­able code.
This process which is run within the <a href="https://github.com/oracle/graal/tree/master/substratevm">Sub­strate VM</a> will lead to the gen­er­a­tion of the na­tive image.</p><h3 id="limitations"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#limitations"></a>Limitations</h3><p>Due to the na­ture of the sta­tic analy­sis Sub­strate VM also has some <a href="https://github.com/oracle/graal/blob/master/substratevm/LIMITATIONS.md">lim­i­ta­tions</a>.</p><p>Dy­namic class load­ing and un­load­ing for ex­am­ple is not sup­ported be­cause this would in essence alter the avail­able code dur­ing run­time. </p><p>Re­flec­tion is only par­tially sup­ported and re­quires some man­ual steps which we will cover later on.</p><h3 id="patches--workarounds"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#patches--workarounds"></a>Patches / Workarounds</h3><div class="alert info"><div class="alert-title">Work in progress</div><p>Next we need to apply some patches / workarounds. Keep in mind that na­tive image gen­er­a­tion is a fairly new topic and the these workarounds will hope­fully no longer be re­quired once the Sub­strate VM and Netty have bet­ter sup­port for each other.</p></div><p>I did not man­age to get na­tive epoll, kqueue and SSL in­te­gra­tion to work with na­tive im­ages.
These parts are heav­ily op­ti­mized within Netty and use JNI to di­rectly ac­cess the OS fea­tures.
Sub­strate VM sup­ports JNI and could in the­ory in­te­grate these na­tive li­braries. </p><p>I cre­ated a <a href="https://github.com/Jotschi/vertx-graalvm-native-image-test/tree/netty-native-epoll">re­pro­ducer</a>
and an <a href="https://github.com/oracle/graal/issues/442">issue</a> so hope­fully these prob­lems can be ad­dressed soon.</p><h3 id="vertx-transport"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#vertx-transport"></a>Vert.x Transport</h3><p>First I needed to patch the <code>io.vertx.core.net.impl.transport.Transport</code> class in order to pre­vent the load­ing of EPoll and KQueue na­tive sup­port. Oth­er­wise Sub­strate VM will try to load these classes and fail.</p><pre><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Transport</span> </span>{
…
  <span class="hljs-comment">/**
   * The native transport, it may be {<span class="hljs-doctag">@code</span> null} or failed.
   */</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Transport <span class="hljs-title">nativeTransport</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-comment">// Patched: I remove the native transport discovery. </span>
    <span class="hljs-comment">// The imports would be picked up by substrate </span>
    <span class="hljs-comment">// and cause further issues. </span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
  }
…
}
</code></pre><h3 id="netty-ssl"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#netty-ssl"></a>Netty SSL</h3><p>Na­tive SSL sup­port is an­other prob­lem­atic area. I cre­ated a patched dummy <code>io.netty.handler.ssl.ReferenceCountedOpenSslEngine</code> class in order to pre­vent Sub­strate VM from dig­ging deeper into the SSL code of Netty.</p><p>Next we need to set up the re­flec­tion con­fig­u­ra­tion within <code>reflectconfigs/netty.json</code>.</p><p>Netty uses re­flec­tion to in­stan­ti­ate the socket chan­nels. This is done in the Re­flec­tiveChan­nelFac­tory. We need to tell Sub­strate VM how classes of type NioServer­Sock­etChan­nel  and NioSock­etChan­nel can be in­stan­ti­ated. </p><pre><code class="hljs language-json">[
  {
    <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;io.netty.channel.socket.nio.NioSocketChannel&quot;</span>,
    <span class="hljs-attr">&quot;methods&quot;</span> : [
      { <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;&lt;init&gt;&quot;</span>, <span class="hljs-attr">&quot;parameterTypes&quot;</span> : [] }
    ]
  },
  {
    <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;io.netty.channel.socket.nio.NioServerSocketChannel&quot;</span>,
    <span class="hljs-attr">&quot;methods&quot;</span> : [
      { <span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;&lt;init&gt;&quot;</span>, <span class="hljs-attr">&quot;parameterTypes&quot;</span> : [] }
    ]
  }
]
</code></pre><p>If you want to learn more about the state of Netty and GraalVM I can rec­om­mend this <a href="https://medium.com/graalvm/instant-netty-startup-using-graalvm-native-image-generation-ed6f14ff7692">GraalVM Blog­post</a> by Co­drut Stancu.</p><h2 id="building"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#building"></a>Building</h2><p>Fi­nally we can build our maven project to gen­er­ate a shaded jar.</p><pre><code class="hljs language-bash">mvn clean package
</code></pre><p>Next we need the GraalVM pack­age. You can down­load it from the <a href="https://www.graalvm.org/">GraalVM web­site</a>.</p><p>We use the shaded jar as the input source for the <code>native-image</code> com­mand which will gen­er­ate the ex­e­cutable.</p><pre><code class="hljs language-bash"><span class="hljs-variable">$GRAALVMDIR</span>/bin/native-image \
 --verbose \
 --no-server \
 -Dio.netty.noUnsafe=<span class="hljs-literal">true</span>  \
 -H:ReflectionConfigurationFiles=./reflectconfigs/netty.json \
 -H:+ReportUnsupportedElementsAtRuntime \
 -Dfile.encoding=UTF-8 \
 -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar
</code></pre><h2 id="result"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#result"></a>Result</h2><p>Fi­nally we end up with an 27 MB <code>vertx-graalvm-native-image-test-0.0.1-SNAPSHOT</code> ex­e­cutable which we can run.</p><pre><code class="hljs language-bash">$ ldd vertx-graalvm-native-image-test-0.0.1-SNAPSHOT 
  linux-vdso.so.1 (0x00007ffc65be8000)
  libdl.so.2 =&gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f8e892f0000)
  libpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f8e890d3000)
  libz.so.1 =&gt; /lib/x86_64-linux-gnu/libz.so.1 (0x00007f8e88eb9000)
  librt.so.1 =&gt; /lib/x86_64-linux-gnu/librt.so.1 (0x00007f8e88cb1000)
  libcrypt.so.1 =&gt; /lib/x86_64-linux-gnu/libcrypt.so.1 (0x00007f8e88a79000)
  libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f8e886da000)
  /lib64/ld-linux-x86-64.so.2 (0x00007f8e8afb7000)
</code></pre><h3 id="memory"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#memory"></a>Memory</h3><pre><code class="hljs language-bash">/usr/bin/time -f <span class="hljs-string">&quot;\nmaxRSS\t%MkB&quot;</span> java -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar 
/usr/bin/time -f <span class="hljs-string">&quot;\nmaxRSS\t%MkB&quot;</span> ./vertx-graalvm-native-image-test-0.0.1-SNAPSHOT 
</code></pre><ul><li>Na­tive Image: 40 MB</li><li>Java 10: 125 MB</li></ul><p>The full project can be found on <a href="https://github.com/Jotschi/vertx-graalvm-native-image-test">GitHub</a>.</p><p>If you want to read more on the topic I can also rec­om­mend <a href="https://sites.google.com/a/athaydes.com/renato-athaydes/posts/a7mbnative-imagejavaappthatrunsin30msandusesonly4mbofram">this ar­ti­cle</a> by Re­nato Athay­des in which he demon­strates how to cre­ate a very small light weight low mem­ory ap­pli­ca­tion using GraalVM.</p><p>Thanks for read­ing. If you have any fur­ther ques­tions or feed­back don’t hes­i­tate to send me a tweet to <a href="https://twitter.com/Jotschi/">@Jotschi</a>.</p></span></div><div class="blog-post-sidebar"><div class="blog-post-author"><img class="blog-post-author-avatar" src="https://github.com/jotschi.png?size=160"/><div class="blog-post-author-name">by <a href="https://github.com/jotschi" target="_blank" rel="noopener noreferrer">Johannes Schüth</a></div></div><div class="blog-post-sidebar-date">Posted on <!-- -->4 June 2018</div>in <a class="blog-post-sidebar-category" href="/blog/category/guides/">guides</a><div class="blog-post-sidebar-reading-time"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <!-- -->5 min read</div><div class="blog-post-sidebar-share-icons"><a href="https://twitter.com/intent/tweet?text=Eclipse%20Vert.x%20goes%20Native&amp;url=https%3A%2F%2Fvertx-china.github.io%2Fblog%2Feclipse-vert-x-goes-native&amp;via=vertx_project" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Twitter</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"></path></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fvertx-china.github.io%2Fblog%2Feclipse-vert-x-goes-native" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fvertx-china.github.io%2Fblog%2Feclipse-vert-x-goes-native" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Facebook</title><path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path></svg></a></div></div></div><div class="blog-post-next-prev"><div class="blog-post-next-prev-entry"><h5>Next post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">8 June 2018</span>​<a class="blog-entry-category" href="/blog/category/releases/">releases</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/eclipse-vert-x-3-5-2/">Eclipse Vert.x 3.5.2</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/vietj.png?size=50"/><a href="https://github.com/vietj" target="_blank" rel="noopener noreferrer">Julien Viet</a></li></ul></span><p class="blog-entry-summary">We have just released Vert.x 3.5.2, a bug fix release of Vert.x 3.5.x.</p><span class="read-more-link"><a href="/blog/eclipse-vert-x-3-5-2/"> 阅读更多</a></span></div></div><div class="blog-post-next-prev-entry"><h5>Previous post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">23 April 2018</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/eclipse-vert-x-rabbitmq-client-gets-a-new-consumer-api/">Eclipse Vert.x RabbitMQ client gets a new consumer API!</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/Sammers21.png?size=50"/><a href="https://github.com/Sammers21" target="_blank" rel="noopener noreferrer">Pavel Drankov</a></li></ul></span><p class="blog-entry-summary">In this blog post, we present the new consumer API of the RabbitMQ client that will be released with Eclipse Vert.x 3.6.0.</p><span class="read-more-link"><a href="/blog/eclipse-vert-x-rabbitmq-client-gets-a-new-consumer-api/"> 阅读更多</a></span></div></div></div><div class="blog-post-related"><h5>Related posts</h5><div class="blog-post-related-posts"><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">3 August 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/unit-and-integration-tests/">Unit and Integration Tests</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">Let’s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn’t test the API.</p><span class="read-more-link"><a href="/blog/unit-and-integration-tests/"> 阅读更多</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">28 September 2016</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/vert-x-featuring-continuous-delivery-with-jenkins-and-ansible/">Vert.x featuring Continuous Delivery with Jenkins and Ansible</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/ricardohmon.png?size=50"/><a href="https://github.com/ricardohmon" target="_blank" rel="noopener noreferrer">Ricardo Hernandez</a></li></ul></span><p class="blog-entry-summary">This blog entry describes an approach to adopt Continuous Delivery for Vert.x applications using Jenkins and Ansible by taking advantage of the Jenkins Job DSL and Ansible plugins.</p><span class="read-more-link"><a href="/blog/vert-x-featuring-continuous-delivery-with-jenkins-and-ansible/"> 阅读更多</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">6 July 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/checklist-for-migrating-from-vert-x-2-1-x-to-vert-x-3-part-one/">Checklist for Migrating from Vert.x 2.1.x to Vert.x 3 - Part One</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/bytor99999.png?size=50"/><a href="https://github.com/bytor99999" target="_blank" rel="noopener noreferrer">Mark Spritzler</a></li></ul></span><p class="blog-entry-summary">So while upgrading our application, I thought I should note down all the changes that we had to do in the process. Since Vert.x 3 is a major upgrade from the previous version, with so many changes.</p><span class="read-more-link"><a href="/blog/checklist-for-migrating-from-vert-x-2-1-x-to-vert-x-3-part-one/"> 阅读更多</a></span></div></div></div></div></div></div><footer><div class="container"><div class="footer-nav-section"><div class="footer-nav-list footer-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMTI1LjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3oiLz48L3N2Zz4=" alt="Vert.x Logo"/></a></div><div class="footer-nav-list"><h5>Eclipse Vert.x</h5><ul class=""><li><a class="navbar-menu-item" href="/docs/">文档</a></li><li><a href="/download/">下载</a></li><li><a href="/blog/">博客</a></li><li><a href="/community/">社区</a></li><li><a href="/translation/">翻译团队</a></li><li><a href="https://github.com/eclipse-vertx/vert.x">GitHub</a></li><li><a href="https://github.com/vertx-china/vertx-web-site">翻译GitHub</a></li></ul></div><div class="footer-nav-list"><h5>资源</h5><ul class=""><li><a href="/faq/">答疑</a></li><li><a href="/channels/">联系渠道</a></li><li><a href="https://how-to.vertx.io/">操作指南</a></li><li><a href="https://start.vertx.io/">应用生成器</a></li></ul></div><div class="footer-nav-list"><h5>Eclipse</h5><ul class=""><li><a href="https://www.eclipse.org/">Eclipse 基金会</a></li><li><a href="https://www.eclipse.org/legal/privacy.php">隐私政策</a></li><li><a href="https://www.eclipse.org/legal/termsofuse.php">使用条款</a></li><li><a href="https://www.eclipse.org/legal/copyright.php">版权代理</a></li><li><a href="https://www.eclipse.org/legal/">法律资源</a></li></ul></div></div><div class="footer-copyright"><div class="footer-copyright-remarks">© <!-- -->2021<!-- --> Eclipse Vert.x<br/>Eclipse Vert.x 是开源的，并在<a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer">Eclipse Public License 2.0</a>和<a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache License 2.0</a>协议下获得了双重许可。<br class="footer-copyright-break"/>网站由 <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer">Michel Krämer</a> 设计。</div><div class="footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAyODEuMyA5MS4xIiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGU+LnN0MHtmaWxsOiNmNzk0MjJ9LnN0MXtmaWxsOiMzZDNjM2J9PC9zdHlsZT48ZyBpZD0iTGF5ZXJfMV8xXyI+PHBhdGggY2xhc3M9InN0MCIgZD0iTTI2NS43IDg0TDI1NyA3M2gtMi43djE3LjdoMy4zdi0xMmw5LjMgMTJoMi4xVjczaC0zLjN2MTF6bS0zMi40LTguM2M0LjIgMCA1LjggMy4zIDUuOCA2LjNzLTEuNiA2LTUuOCA2LTUuNy0zLjEtNS44LTYgMS43LTYuMyA1LjgtNi4zem0wLTNjLTYuMSAwLTkuMSA0LjctOS4xIDkuMyAwIDQuNyAyLjkgOS4xIDkuMSA5LjFzOS00LjYgOS4xLTkuMi0zLTkuMi05LjEtOS4yem0tMjEuMiAxOFY3M2gtMy4zdjE3LjdoMy4zem0tMjMuNiAwaDMuM1Y3Nmg1LjZ2LTNoLTE0LjZ2M2g1LjZsLjEgMTQuN3ptLTE4LjktNi41SDE2M2wzLjMtNy42IDMuMyA3LjZ6bTIuOCA2LjVoMy42TDE2OC4yIDczaC0zLjZsLTggMTcuN2gzLjZsMS41LTMuM2g5LjNsMS40IDMuM3ptLTM4LTE0LjZoMy42YzMuOSAwIDUuNSAyLjggNS41IDUuNS4xIDIuOC0xLjUgNS44LTUuNSA1LjhoLTMuNlY3Ni4xem0zLjctMy4xaC02Ljl2MTcuN2g2LjljNi4yIDAgOC45LTQuNSA4LjktOXMtMi44LTguNy04LjktOC43em0tMjIuNCAxMUwxMDcgNzNoLTIuN3YxNy43aDMuM3YtMTJsOS4zIDEyaDIuMVY3M2gtMy4zdjExek04OC4yIDczdjEwLjJjMCAzLTEuNiA0LjktNC4zIDQuOXMtNC42LTEuNy00LjYtNC45VjczSDc2djEwLjFjMCA1LjMgMy42IDcuOSA3LjkgNy45IDQuNCAwIDcuNy0yLjcgNy43LTcuOVY3M2gtMy40em0tMzMgMi43YzQuMiAwIDUuOCAzLjMgNS44IDYuM3MtMS42IDYtNS44IDYtNS43LTMuMS01LjgtNiAxLjctNi4zIDUuOC02LjN6bTAtM2MtNi4xIDAtOS4xIDQuNy05LjEgOS4zczIuOSA5LjEgOS4xIDkuMSA5LTQuNiA5LjEtOS4yLTMtOS4yLTkuMS05LjJ6bS0yOS43IDE4di02LjVoOC45di0zLjFoLTguOXYtNC44aDkuNFY3M0gyMi4ydjE3LjZoMy4zeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNjkuNCA1NC40aC0yMi4ydi04LjloMjEuNHYtNi45aC0yMS40di05LjFoMjIuMnYtNy4yaC0yOS42djM5LjVoMjkuNnYtNy40em0tNDAtMjUuNmMtMy02LjEtOS40LTcuOC0xNS41LTcuOC03LjMgMC0xNS4zIDMuNC0xNS4zIDExLjUgMCA4LjkgNy40IDExIDE1LjUgMTIgNS4yLjYgOS4xIDIuMSA5LjEgNS44IDAgNC4zLTQuNCA1LjktOS4xIDUuOXMtOS40LTEuOS0xMS4xLTYuM2wtNi4yIDMuMmMyLjkgNy4yIDkuMSA5LjcgMTcuMiA5LjcgOC44IDAgMTYuNi0zLjggMTYuNi0xMi42IDAtOS40LTcuNy0xMS42LTE1LjktMTIuNi00LjctLjYtOC44LTEuNS04LjgtNSAwLTIuOSAyLjYtNS4yIDguMi01LjIgNC4zIDAgOCAyLjIgOS40IDQuNGw1LjktM3pNMTc2IDIyLjJjLTYuMi0uMS0xMi40IDAtMTguNiAwdjM5LjVoNy40VjUwLjFIMTc2YzE5LjQgMCAxOS40LTI3LjkgMC0yNy45em0tMTEuMSA3LjFIMTc2YzkuNSAwIDkuNSAxNCAwIDE0aC0xMS4ybC4xLTE0em0tMTggMzIuNVYyMi4yaC03LjR2MzkuNWw3LjQuMXptLTQ0LTM5LjZ2MzkuNWgyNy43di02LjloLTIwLjNWMjIuMmgtNy40ek05MC43IDUxLjdjLTIuNyAyLjUtNi4yIDQtOS45IDQtOS44IDAtMTMuNS02LjgtMTMuNi0xMy40czQuMS0xMy43IDEzLjYtMTMuN2MzLjUtLjEgNyAxLjMgOS41IDMuN2w1LTQuOGMtMy44LTMuOS05LjEtNi0xNC41LTYtMTQuMyAwLTIxIDEwLjUtMjAuOSAyMC44czYuMyAyMC4zIDIwLjkgMjAuM2M1LjYuMSAxMS0yIDE1LTUuOWwtNS4xLTV6bS0zOSAyLjdIMjkuNXYtOC45aDIxLjR2LTYuOUgyOS41di05LjFoMjIuMnYtNy4ySDIyLjJ2MzkuNWgyOS42bC0uMS03LjR6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTkuOCAxOC4yQzE4LjggNC4xIDM2LjktLjggNTIuMSA2bC0xLS43QzM1LjctNC42IDE1LjItLjEgNS4zIDE1LjNzLTUuNCAzNS45IDEwIDQ1LjhsMS4xLjZDMy44IDUwLjguOCAzMi4zIDkuOCAxOC4yeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNzIuMiAyNi4xYzAtMi41IDIuMS00LjYgNC42LTQuNiAyLjUgMCA0LjYgMi4xIDQuNiA0LjYgMCAyLjUtMi4xIDQuNi00LjYgNC42LTIuNiAwLTQuNi0yLjEtNC42LTQuNnptOC42IDBjMC0yLjItMS44LTQuMS00LTQuMXMtNC4xIDEuOC00LjEgNC4xYzAgMi4yIDEuNyA0IDMuOSA0LjFoLjFjMi4zIDAgNC4xLTEuOCA0LjEtNC4xem0tNi0yLjVoMi4zYzEuMSAwIDEuOS41IDEuOSAxLjYgMCAuNy0uNCAxLjMtMS4xIDEuNWwxLjIgMS43aC0xLjRsLTEtMS41aC0uN3YxLjVoLTEuMWwtLjEtNC44em0yLjIgMi4zYy41IDAgLjgtLjMuOC0uN3MtLjMtLjctLjgtLjdoLTF2MS4zbDEgLjF6Ii8+PC9nPjwvc3ZnPg==" alt="Eclipse foundation Logo"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"categories":["releases","guides","news"],"post":{"meta":{"title":"Eclipse Vert.x goes Native","category":"guides","authors":[{"name":"Johannes Schüth","github_id":"jotschi"}],"summary":"This blog post introduces native image generation of Vert.x applications with GraalVM. Generated executables can be run without a JVM."},"date":"2018-06-04","slug":"eclipse-vert-x-goes-native","readingTime":{"text":"5 min read","minutes":4.235,"time":254100.00000000003,"words":847},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I this blog post, I would like to give you a pre\\xADview on na\\xADtive image gen\\xADer\\xADa\\xADtion of Vert.x ap\\xADpli\\xADca\\xADtions using GraalVM.\"), mdx(\"p\", null, \"With \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.graalvm.org/\"\n  }), \"GraalVM\"), \" it is pos\\xADsi\\xADble to gen\\xADer\\xADate na\\xADtive ex\\xADe\\xADcuta\\xADbles.\\nThese ex\\xADe\\xADcuta\\xADbles can be di\\xADrectly run with\\xADout the need of an in\\xADstalled JVM.\"), mdx(\"h2\", {\n    \"id\": \"benefits\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#benefits\"\n  })), \"Benefits\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The start up time is way faster. It is no longer re\\xADquired to wait for the start up of the JVM. The ap\\xADpli\\xADca\\xADtion is usu\\xADally up and run\\xADning in a mat\\xADter of mil\\xADlisec\\xADonds.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Re\\xADduced mem\\xADory foot\\xADprint. I mea\\xADsured 40 MB mem\\xADory usage (RSS) for the Vert.x Web ap\\xADpli\\xADca\\xADtion which I\\u2019m going to show\\xADcase.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Smaller Con\\xADtain\\xADers. No JVM means no over\\xADhead. All the needed parts are al\\xADready con\\xADtained within the ex\\xADe\\xADcutable. This can be very ben\\xADe\\xADfi\\xADcial when build\\xADing de\\xADploy\\xADable con\\xADtainer im\\xADages.\"))), mdx(\"h2\", {\n    \"id\": \"demo-project\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#demo-project\"\n  })), \"Demo Project\"), mdx(\"p\", null, \"For the demo ap\\xADpli\\xADca\\xADtion I choose a very basic hello world \", mdx(Link, {\n    href: \"/docs/vertx-web/java/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"Vert.x Web\")), \" server.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"package\"), \" de.jotschi.examples;\\n\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"import\"), \" java.io.File;\\n\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"import\"), \" io.vertx.core.Vertx;\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"import\"), \" io.vertx.core.logging.Logger;\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"import\"), \" io.vertx.core.logging.LoggerFactory;\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"import\"), \" io.vertx.core.logging.SLF4JLogDelegateFactory;\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"import\"), \" io.vertx.ext.web.Router;\\n\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"public\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-class\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"class\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"Runner\"), \" \"), \"{\\n\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"public\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"static\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"void\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"main\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(String[] args)\"), \" \"), \"{\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Use logback for logging\"), \"\\n    File logbackFile = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" File(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"config\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"logback.xml\\\"\"), \");\\n    System.setProperty(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"logback.configurationFile\\\"\"), \", logbackFile.getAbsolutePath());\\n    System.setProperty(LoggerFactory.LOGGER_DELEGATE_FACTORY_CLASS_NAME, SLF4JLogDelegateFactory.class.getName());\\n    Logger log = LoggerFactory.getLogger(Runner.class);\\n\\n    // Setup the http server\\n    log.info(\\\"Starting server \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"for\"), \": http://localhost:\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8080\"), \"/hello\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\");\\n    Vertx vertx = Vertx.vertx();\\n    Router router = Router.router(vertx);\\n\\n    router.route(\\\"\"), \"/hello\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\").handler(rc -\u003e {\\n      log.info(\\\"\"), \"Got hello request\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\");\\n      rc.response().end(\\\"\"), \"World\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\");\\n    });\\n\\n    vertx.createHttpServer()\\n      .requestHandler(router::accept)\\n      .listen(8080);\\n\\n  }\\n\\n}\\n\"))), mdx(\"h2\", {\n    \"id\": \"graalvm\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#graalvm\"\n  })), \"GraalVM\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.graalvm.org/\"\n  }), \"GraalVM\"), \" runs a sta\\xADtic analy\\xADsis on the gen\\xADer\\xADated ap\\xADpli\\xADca\\xADtion in order to find the reach\\xADable code.\\nThis process which is run within the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/oracle/graal/tree/master/substratevm\"\n  }), \"Sub\\xADstrate VM\"), \" will lead to the gen\\xADer\\xADa\\xADtion of the na\\xADtive image.\"), mdx(\"h3\", {\n    \"id\": \"limitations\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#limitations\"\n  })), \"Limitations\"), mdx(\"p\", null, \"Due to the na\\xADture of the sta\\xADtic analy\\xADsis Sub\\xADstrate VM also has some \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/oracle/graal/blob/master/substratevm/LIMITATIONS.md\"\n  }), \"lim\\xADi\\xADta\\xADtions\"), \".\"), mdx(\"p\", null, \"Dy\\xADnamic class load\\xADing and un\\xADload\\xADing for ex\\xADam\\xADple is not sup\\xADported be\\xADcause this would in essence alter the avail\\xADable code dur\\xADing run\\xADtime. \"), mdx(\"p\", null, \"Re\\xADflec\\xADtion is only par\\xADtially sup\\xADported and re\\xADquires some man\\xADual steps which we will cover later on.\"), mdx(\"h3\", {\n    \"id\": \"patches--workarounds\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#patches--workarounds\"\n  })), \"Patches / Workarounds\"), mdx(Alert, {\n    info: true,\n    title: \"Work in progress\",\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"Next we need to apply some patches / workarounds. Keep in mind that na\\xADtive image gen\\xADer\\xADa\\xADtion is a fairly new topic and the these workarounds will hope\\xADfully no longer be re\\xADquired once the Sub\\xADstrate VM and Netty have bet\\xADter sup\\xADport for each other.\")), mdx(\"p\", null, \"I did not man\\xADage to get na\\xADtive epoll, kqueue and SSL in\\xADte\\xADgra\\xADtion to work with na\\xADtive im\\xADages.\\nThese parts are heav\\xADily op\\xADti\\xADmized within Netty and use JNI to di\\xADrectly ac\\xADcess the OS fea\\xADtures.\\nSub\\xADstrate VM sup\\xADports JNI and could in the\\xADory in\\xADte\\xADgrate these na\\xADtive li\\xADbraries. \"), mdx(\"p\", null, \"I cre\\xADated a \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Jotschi/vertx-graalvm-native-image-test/tree/netty-native-epoll\"\n  }), \"re\\xADpro\\xADducer\"), \"\\nand an \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/oracle/graal/issues/442\"\n  }), \"issue\"), \" so hope\\xADfully these prob\\xADlems can be ad\\xADdressed soon.\"), mdx(\"h3\", {\n    \"id\": \"vertx-transport\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#vertx-transport\"\n  })), \"Vert.x Transport\"), mdx(\"p\", null, \"First I needed to patch the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"io.vertx.core.net.impl.transport.Transport\"), \" class in order to pre\\xADvent the load\\xADing of EPoll and KQueue na\\xADtive sup\\xADport. Oth\\xADer\\xADwise Sub\\xADstrate VM will try to load these classes and fail.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"public\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-class\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"class\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"Transport\"), \" \"), \"{\\n\\u2026\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"/**\\n   * The native transport, it may be {\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-doctag\"\n  }), \"@code\"), \" null} or failed.\\n   */\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"public\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"static\"), \" Transport \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"nativeTransport\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"()\"), \" \"), \"{\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Patched: I remove the native transport discovery. \"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// The imports would be picked up by substrate \"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// and cause further issues. \"), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"return\"), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"null\"), \";\\n  }\\n\\u2026\\n}\\n\")), mdx(\"h3\", {\n    \"id\": \"netty-ssl\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#netty-ssl\"\n  })), \"Netty SSL\"), mdx(\"p\", null, \"Na\\xADtive SSL sup\\xADport is an\\xADother prob\\xADlem\\xADatic area. I cre\\xADated a patched dummy \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"io.netty.handler.ssl.ReferenceCountedOpenSslEngine\"), \" class in order to pre\\xADvent Sub\\xADstrate VM from dig\\xADging deeper into the SSL code of Netty.\"), mdx(\"p\", null, \"Next we need to set up the re\\xADflec\\xADtion con\\xADfig\\xADu\\xADra\\xADtion within \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"reflectconfigs/netty.json\"), \".\"), mdx(\"p\", null, \"Netty uses re\\xADflec\\xADtion to in\\xADstan\\xADti\\xADate the socket chan\\xADnels. This is done in the Re\\xADflec\\xADtiveChan\\xADnelFac\\xADtory. We need to tell Sub\\xADstrate VM how classes of type NioServer\\xADSock\\xADetChan\\xADnel  and NioSock\\xADetChan\\xADnel can be in\\xADstan\\xADti\\xADated. \"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-json\"\n  }), \"[\\n  {\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"name\\\"\"), \" : \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"io.netty.channel.socket.nio.NioSocketChannel\\\"\"), \",\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"methods\\\"\"), \" : [\\n      { \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"name\\\"\"), \" : \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"\u003cinit\u003e\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"parameterTypes\\\"\"), \" : [] }\\n    ]\\n  },\\n  {\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"name\\\"\"), \" : \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"io.netty.channel.socket.nio.NioServerSocketChannel\\\"\"), \",\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"methods\\\"\"), \" : [\\n      { \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"name\\\"\"), \" : \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"\u003cinit\u003e\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"parameterTypes\\\"\"), \" : [] }\\n    ]\\n  }\\n]\\n\")), mdx(\"p\", null, \"If you want to learn more about the state of Netty and GraalVM I can rec\\xADom\\xADmend this \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://medium.com/graalvm/instant-netty-startup-using-graalvm-native-image-generation-ed6f14ff7692\"\n  }), \"GraalVM Blog\\xADpost\"), \" by Co\\xADdrut Stancu.\"), mdx(\"h2\", {\n    \"id\": \"building\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#building\"\n  })), \"Building\"), mdx(\"p\", null, \"Fi\\xADnally we can build our maven project to gen\\xADer\\xADate a shaded jar.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"mvn clean package\\n\")), mdx(\"p\", null, \"Next we need the GraalVM pack\\xADage. You can down\\xADload it from the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.graalvm.org/\"\n  }), \"GraalVM web\\xADsite\"), \".\"), mdx(\"p\", null, \"We use the shaded jar as the input source for the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"native-image\"), \" com\\xADmand which will gen\\xADer\\xADate the ex\\xADe\\xADcutable.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-variable\"\n  }), \"$GRAALVMDIR\"), \"/bin/native-image \\\\\\n --verbose \\\\\\n --no-server \\\\\\n -Dio.netty.noUnsafe=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-literal\"\n  }), \"true\"), \"  \\\\\\n -H:ReflectionConfigurationFiles=./reflectconfigs/netty.json \\\\\\n -H:+ReportUnsupportedElementsAtRuntime \\\\\\n -Dfile.encoding=UTF-8 \\\\\\n -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar\\n\")), mdx(\"h2\", {\n    \"id\": \"result\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#result\"\n  })), \"Result\"), mdx(\"p\", null, \"Fi\\xADnally we end up with an 27 MB \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-graalvm-native-image-test-0.0.1-SNAPSHOT\"), \" ex\\xADe\\xADcutable which we can run.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"$ ldd vertx-graalvm-native-image-test-0.0.1-SNAPSHOT \\n  linux-vdso.so.1 (0x00007ffc65be8000)\\n  libdl.so.2 =\u003e /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f8e892f0000)\\n  libpthread.so.0 =\u003e /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f8e890d3000)\\n  libz.so.1 =\u003e /lib/x86_64-linux-gnu/libz.so.1 (0x00007f8e88eb9000)\\n  librt.so.1 =\u003e /lib/x86_64-linux-gnu/librt.so.1 (0x00007f8e88cb1000)\\n  libcrypt.so.1 =\u003e /lib/x86_64-linux-gnu/libcrypt.so.1 (0x00007f8e88a79000)\\n  libc.so.6 =\u003e /lib/x86_64-linux-gnu/libc.so.6 (0x00007f8e886da000)\\n  /lib64/ld-linux-x86-64.so.2 (0x00007f8e8afb7000)\\n\")), mdx(\"h3\", {\n    \"id\": \"memory\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#memory\"\n  })), \"Memory\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"/usr/bin/time -f \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"\\\\nmaxRSS\\\\t%MkB\\\"\"), \" java -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar \\n/usr/bin/time -f \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"\\\\nmaxRSS\\\\t%MkB\\\"\"), \" ./vertx-graalvm-native-image-test-0.0.1-SNAPSHOT \\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Na\\xADtive Image: 40 MB\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Java 10: 125 MB\")), mdx(\"p\", null, \"The full project can be found on \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/Jotschi/vertx-graalvm-native-image-test\"\n  }), \"GitHub\"), \".\"), mdx(\"p\", null, \"If you want to read more on the topic I can also rec\\xADom\\xADmend \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://sites.google.com/a/athaydes.com/renato-athaydes/posts/a7mbnative-imagejavaappthatrunsin30msandusesonly4mbofram\"\n  }), \"this ar\\xADti\\xADcle\"), \" by Re\\xADnato Athay\\xADdes in which he demon\\xADstrates how to cre\\xADate a very small light weight low mem\\xADory ap\\xADpli\\xADca\\xADtion using GraalVM.\"), mdx(\"p\", null, \"Thanks for read\\xADing. If you have any fur\\xADther ques\\xADtions or feed\\xADback don\\u2019t hes\\xADi\\xADtate to send me a tweet to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/Jotschi/\"\n  }), \"@Jotschi\"), \".\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003cp\u003eI this blog post, I would like to give you a pre­view on na­tive image gen­er­a­tion of Vert.x ap­pli­ca­tions using GraalVM.\u003c/p\u003e\u003cp\u003eWith \u003ca href=\"https://www.graalvm.org/\"\u003eGraalVM\u003c/a\u003e it is pos­si­ble to gen­er­ate na­tive ex­e­cuta­bles.\nThese ex­e­cuta­bles can be di­rectly run with­out the need of an in­stalled JVM.\u003c/p\u003e\u003ch2 id=\"benefits\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#benefits\"\u003e\u003c/a\u003eBenefits\u003c/h2\u003e\u003cul\u003e\u003cli\u003e\u003cp\u003eThe start up time is way faster. It is no longer re­quired to wait for the start up of the JVM. The ap­pli­ca­tion is usu­ally up and run­ning in a mat­ter of mil­lisec­onds.\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003eRe­duced mem­ory foot­print. I mea­sured 40 MB mem­ory usage (RSS) for the Vert.x Web ap­pli­ca­tion which I’m going to show­case.\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003eSmaller Con­tain­ers. No JVM means no over­head. All the needed parts are al­ready con­tained within the ex­e­cutable. This can be very ben­e­fi­cial when build­ing de­ploy­able con­tainer im­ages.\u003c/p\u003e\u003c/li\u003e\u003c/ul\u003e\u003ch2 id=\"demo-project\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#demo-project\"\u003e\u003c/a\u003eDemo Project\u003c/h2\u003e\u003cp\u003eFor the demo ap­pli­ca­tion I choose a very basic hello world \u003ca href=\"/docs/vertx-web/java/\"\u003eVert.x Web\u003c/a\u003e server.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-keyword\"\u003epackage\u003c/span\u003e de.jotschi.examples;\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e java.io.File;\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e io.vertx.core.Vertx;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e io.vertx.core.logging.Logger;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e io.vertx.core.logging.LoggerFactory;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e io.vertx.core.logging.SLF4JLogDelegateFactory;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e io.vertx.ext.web.Router;\n\n\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eRunner\u003c/span\u003e \u003c/span\u003e{\n\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emain\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(String[] args)\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e// Use logback for logging\u003c/span\u003e\n    File logbackFile = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e File(\u003cspan class=\"hljs-string\"\u003e\u0026quot;config\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;logback.xml\u0026quot;\u003c/span\u003e);\n    System.setProperty(\u003cspan class=\"hljs-string\"\u003e\u0026quot;logback.configurationFile\u0026quot;\u003c/span\u003e, logbackFile.getAbsolutePath());\n    System.setProperty(LoggerFactory.LOGGER_DELEGATE_FACTORY_CLASS_NAME, SLF4JLogDelegateFactory.class.getName());\n    Logger log = LoggerFactory.getLogger(Runner.class);\n\n    // Setup the http server\n    log.info(\u0026quot;Starting server \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e: http://localhost:\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e/hello\u003cspan class=\"hljs-string\"\u003e\u0026quot;);\n    Vertx vertx = Vertx.vertx();\n    Router router = Router.router(vertx);\n\n    router.route(\u0026quot;\u003c/span\u003e/hello\u003cspan class=\"hljs-string\"\u003e\u0026quot;).handler(rc -\u0026gt; {\n      log.info(\u0026quot;\u003c/span\u003eGot hello request\u003cspan class=\"hljs-string\"\u003e\u0026quot;);\n      rc.response().end(\u0026quot;\u003c/span\u003eWorld\u003cspan class=\"hljs-string\"\u003e\u0026quot;);\n    });\n\n    vertx.createHttpServer()\n      .requestHandler(router::accept)\n      .listen(8080);\n\n  }\n\n}\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"graalvm\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#graalvm\"\u003e\u003c/a\u003eGraalVM\u003c/h2\u003e\u003cp\u003e\u003ca href=\"https://www.graalvm.org/\"\u003eGraalVM\u003c/a\u003e runs a sta­tic analy­sis on the gen­er­ated ap­pli­ca­tion in order to find the reach­able code.\nThis process which is run within the \u003ca href=\"https://github.com/oracle/graal/tree/master/substratevm\"\u003eSub­strate VM\u003c/a\u003e will lead to the gen­er­a­tion of the na­tive image.\u003c/p\u003e\u003ch3 id=\"limitations\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#limitations\"\u003e\u003c/a\u003eLimitations\u003c/h3\u003e\u003cp\u003eDue to the na­ture of the sta­tic analy­sis Sub­strate VM also has some \u003ca href=\"https://github.com/oracle/graal/blob/master/substratevm/LIMITATIONS.md\"\u003elim­i­ta­tions\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eDy­namic class load­ing and un­load­ing for ex­am­ple is not sup­ported be­cause this would in essence alter the avail­able code dur­ing run­time. \u003c/p\u003e\u003cp\u003eRe­flec­tion is only par­tially sup­ported and re­quires some man­ual steps which we will cover later on.\u003c/p\u003e\u003ch3 id=\"patches--workarounds\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#patches--workarounds\"\u003e\u003c/a\u003ePatches / Workarounds\u003c/h3\u003e\u003cdiv class=\"alert info\"\u003e\u003cdiv class=\"alert-title\"\u003eWork in progress\u003c/div\u003e\u003cp\u003eNext we need to apply some patches / workarounds. Keep in mind that na­tive image gen­er­a­tion is a fairly new topic and the these workarounds will hope­fully no longer be re­quired once the Sub­strate VM and Netty have bet­ter sup­port for each other.\u003c/p\u003e\u003c/div\u003e\u003cp\u003eI did not man­age to get na­tive epoll, kqueue and SSL in­te­gra­tion to work with na­tive im­ages.\nThese parts are heav­ily op­ti­mized within Netty and use JNI to di­rectly ac­cess the OS fea­tures.\nSub­strate VM sup­ports JNI and could in the­ory in­te­grate these na­tive li­braries. \u003c/p\u003e\u003cp\u003eI cre­ated a \u003ca href=\"https://github.com/Jotschi/vertx-graalvm-native-image-test/tree/netty-native-epoll\"\u003ere­pro­ducer\u003c/a\u003e\nand an \u003ca href=\"https://github.com/oracle/graal/issues/442\"\u003eissue\u003c/a\u003e so hope­fully these prob­lems can be ad­dressed soon.\u003c/p\u003e\u003ch3 id=\"vertx-transport\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#vertx-transport\"\u003e\u003c/a\u003eVert.x Transport\u003c/h3\u003e\u003cp\u003eFirst I needed to patch the \u003ccode\u003eio.vertx.core.net.impl.transport.Transport\u003c/code\u003e class in order to pre­vent the load­ing of EPoll and KQueue na­tive sup­port. Oth­er­wise Sub­strate VM will try to load these classes and fail.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eTransport\u003c/span\u003e \u003c/span\u003e{\n…\n  \u003cspan class=\"hljs-comment\"\u003e/**\n   * The native transport, it may be {\u003cspan class=\"hljs-doctag\"\u003e@code\u003c/span\u003e null} or failed.\n   */\u003c/span\u003e\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003estatic\u003c/span\u003e Transport \u003cspan class=\"hljs-title\"\u003enativeTransport\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e()\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e// Patched: I remove the native transport discovery. \u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// The imports would be picked up by substrate \u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// and cause further issues. \u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enull\u003c/span\u003e;\n  }\n…\n}\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"netty-ssl\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#netty-ssl\"\u003e\u003c/a\u003eNetty SSL\u003c/h3\u003e\u003cp\u003eNa­tive SSL sup­port is an­other prob­lem­atic area. I cre­ated a patched dummy \u003ccode\u003eio.netty.handler.ssl.ReferenceCountedOpenSslEngine\u003c/code\u003e class in order to pre­vent Sub­strate VM from dig­ging deeper into the SSL code of Netty.\u003c/p\u003e\u003cp\u003eNext we need to set up the re­flec­tion con­fig­u­ra­tion within \u003ccode\u003ereflectconfigs/netty.json\u003c/code\u003e.\u003c/p\u003e\u003cp\u003eNetty uses re­flec­tion to in­stan­ti­ate the socket chan­nels. This is done in the Re­flec­tiveChan­nelFac­tory. We need to tell Sub­strate VM how classes of type NioServer­Sock­etChan­nel  and NioSock­etChan­nel can be in­stan­ti­ated. \u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-json\"\u003e[\n  {\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e\u0026quot;io.netty.channel.socket.nio.NioSocketChannel\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;methods\u0026quot;\u003c/span\u003e : [\n      { \u003cspan class=\"hljs-attr\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026lt;init\u0026gt;\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003e\u0026quot;parameterTypes\u0026quot;\u003c/span\u003e : [] }\n    ]\n  },\n  {\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e\u0026quot;io.netty.channel.socket.nio.NioServerSocketChannel\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;methods\u0026quot;\u003c/span\u003e : [\n      { \u003cspan class=\"hljs-attr\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026lt;init\u0026gt;\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003e\u0026quot;parameterTypes\u0026quot;\u003c/span\u003e : [] }\n    ]\n  }\n]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIf you want to learn more about the state of Netty and GraalVM I can rec­om­mend this \u003ca href=\"https://medium.com/graalvm/instant-netty-startup-using-graalvm-native-image-generation-ed6f14ff7692\"\u003eGraalVM Blog­post\u003c/a\u003e by Co­drut Stancu.\u003c/p\u003e\u003ch2 id=\"building\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#building\"\u003e\u003c/a\u003eBuilding\u003c/h2\u003e\u003cp\u003eFi­nally we can build our maven project to gen­er­ate a shaded jar.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emvn clean package\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNext we need the GraalVM pack­age. You can down­load it from the \u003ca href=\"https://www.graalvm.org/\"\u003eGraalVM web­site\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eWe use the shaded jar as the input source for the \u003ccode\u003enative-image\u003c/code\u003e com­mand which will gen­er­ate the ex­e­cutable.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e\u003cspan class=\"hljs-variable\"\u003e$GRAALVMDIR\u003c/span\u003e/bin/native-image \\\n --verbose \\\n --no-server \\\n -Dio.netty.noUnsafe=\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e  \\\n -H:ReflectionConfigurationFiles=./reflectconfigs/netty.json \\\n -H:+ReportUnsupportedElementsAtRuntime \\\n -Dfile.encoding=UTF-8 \\\n -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"result\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#result\"\u003e\u003c/a\u003eResult\u003c/h2\u003e\u003cp\u003eFi­nally we end up with an 27 MB \u003ccode\u003evertx-graalvm-native-image-test-0.0.1-SNAPSHOT\u003c/code\u003e ex­e­cutable which we can run.\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ ldd vertx-graalvm-native-image-test-0.0.1-SNAPSHOT \n  linux-vdso.so.1 (0x00007ffc65be8000)\n  libdl.so.2 =\u0026gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f8e892f0000)\n  libpthread.so.0 =\u0026gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f8e890d3000)\n  libz.so.1 =\u0026gt; /lib/x86_64-linux-gnu/libz.so.1 (0x00007f8e88eb9000)\n  librt.so.1 =\u0026gt; /lib/x86_64-linux-gnu/librt.so.1 (0x00007f8e88cb1000)\n  libcrypt.so.1 =\u0026gt; /lib/x86_64-linux-gnu/libcrypt.so.1 (0x00007f8e88a79000)\n  libc.so.6 =\u0026gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f8e886da000)\n  /lib64/ld-linux-x86-64.so.2 (0x00007f8e8afb7000)\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"memory\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#memory\"\u003e\u003c/a\u003eMemory\u003c/h3\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e/usr/bin/time -f \u003cspan class=\"hljs-string\"\u003e\u0026quot;\\nmaxRSS\\t%MkB\u0026quot;\u003c/span\u003e java -jar target/vertx-graalvm-native-image-test-0.0.1-SNAPSHOT.jar \n/usr/bin/time -f \u003cspan class=\"hljs-string\"\u003e\u0026quot;\\nmaxRSS\\t%MkB\u0026quot;\u003c/span\u003e ./vertx-graalvm-native-image-test-0.0.1-SNAPSHOT \n\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\u003cli\u003eNa­tive Image: 40 MB\u003c/li\u003e\u003cli\u003eJava 10: 125 MB\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe full project can be found on \u003ca href=\"https://github.com/Jotschi/vertx-graalvm-native-image-test\"\u003eGitHub\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eIf you want to read more on the topic I can also rec­om­mend \u003ca href=\"https://sites.google.com/a/athaydes.com/renato-athaydes/posts/a7mbnative-imagejavaappthatrunsin30msandusesonly4mbofram\"\u003ethis ar­ti­cle\u003c/a\u003e by Re­nato Athay­des in which he demon­strates how to cre­ate a very small light weight low mem­ory ap­pli­ca­tion using GraalVM.\u003c/p\u003e\u003cp\u003eThanks for read­ing. If you have any fur­ther ques­tions or feed­back don’t hes­i­tate to send me a tweet to \u003ca href=\"https://twitter.com/Jotschi/\"\u003e@Jotschi\u003c/a\u003e.\u003c/p\u003e","scope":{}}},"prevPost":{"meta":{"title":"Eclipse Vert.x 3.5.2","category":"releases","authors":[{"name":"Julien Viet","github_id":"vietj"}],"summary":"We have just released Vert.x 3.5.2, a bug fix release of Vert.x 3.5.x."},"date":"2018-06-08","slug":"eclipse-vert-x-3-5-2"},"nextPost":{"meta":{"title":"Eclipse Vert.x RabbitMQ client gets a new consumer API!","category":"guides","authors":[{"name":"Pavel Drankov","github_id":"Sammers21"}],"summary":"In this blog post, we present the new consumer API of the RabbitMQ client that will be released with Eclipse Vert.x 3.6.0."},"date":"2018-04-23","slug":"eclipse-vert-x-rabbitmq-client-gets-a-new-consumer-api"},"relatedPosts":[{"meta":{"title":"Unit and Integration Tests","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"Let’s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn’t test the API."},"date":"2015-08-03","slug":"unit-and-integration-tests"},{"meta":{"title":"Vert.x featuring Continuous Delivery with Jenkins and Ansible","category":"guides","authors":[{"name":"Ricardo Hernandez","github_id":"ricardohmon"}],"summary":"This blog entry describes an approach to adopt Continuous Delivery for Vert.x applications using Jenkins and Ansible by taking advantage of the Jenkins Job DSL and Ansible plugins."},"date":"2016-09-28","slug":"vert-x-featuring-continuous-delivery-with-jenkins-and-ansible"},{"meta":{"title":"Checklist for Migrating from Vert.x 2.1.x to Vert.x 3 - Part One","category":"guides","authors":[{"name":"Mark Spritzler","github_id":"bytor99999"}],"summary":"So while upgrading our application, I thought I should note down all the changes that we had to do in the process. Since Vert.x 3 is a major upgrade from the previous version, with so many changes."},"date":"2015-07-06","slug":"checklist-for-migrating-from-vert-x-2-1-x-to-vert-x-3-part-one"}]},"__N_SSG":true},"page":"/blog/[[...slug]]","query":{"slug":["eclipse-vert-x-goes-native"]},"buildId":"WDiQ0QtWcC16cJkCgdFnh","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-9a5c89434732593ca2fd.js"></script><script src="/_next/static/chunks/main-b6e20584df76f29b6f35.js" async=""></script><script src="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" async=""></script><script src="/_next/static/chunks/framework.fcef98db13e2318579fb.js" async=""></script><script src="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" async=""></script><script src="/_next/static/chunks/styles.7064a0f84b2a7c13404a.js" async=""></script><script src="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" async=""></script><script src="/_next/static/chunks/5df0631eea625b022d3730b3f1bf573e1b8deb37.dd672925a2e24782fa8b.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-c36bc482402d8ffe42a5.js" async=""></script><script src="/_next/static/WDiQ0QtWcC16cJkCgdFnh/_buildManifest.js" async=""></script><script src="/_next/static/WDiQ0QtWcC16cJkCgdFnh/_ssgManifest.js" async=""></script></body></html>