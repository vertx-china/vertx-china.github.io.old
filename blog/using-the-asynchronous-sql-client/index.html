<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><link rel="alternate" type="application/rss+xml" href="/feed/rss.xml"/><link rel="alternate" type="application/atom+xml" href="/feed/atom.xml"/><link rel="alternate" type="application/json" href="/feed/feed.json"/><title>Using the asynchronous SQL client | 博客 | Eclipse Vert.x</title><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/styles.bee17d6f.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.bee17d6f.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-b6e20584df76f29b6f35.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.fcef98db13e2318579fb.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.7064a0f84b2a7c13404a.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" as="script"/><link rel="preload" href="/_next/static/chunks/5df0631eea625b022d3730b3f1bf573e1b8deb37.2c5d42edba8dda0b0ba3.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-ff5b3ed8f1ab05c5e7a9.js" as="script"/></head><body data-build-time="2021-06-07T04:28:39.027Z" data-build-commit-id="4dca5be531a5b2c6e23d005d98b7fb4dd7eb1162" data-build-run-id="913366962"><div id="__next"><main class="page"><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMjMyLjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3ptNDE0LTI2Ni45aC0xNS4zdjQyLjJoLTguNVY2LjloLTE1LjJWMGgzOXY2Ljl6TTExOTMgMGwxNC4yIDM3LjdMMTIyMS4zIDBoMTF2NDkuMWgtOC41VjMyLjlsLjgtMjEuNy0xNC41IDM3LjloLTYuMWwtMTQuNS0zNy44LjggMjEuNnYxNi4yaC04LjVWMGgxMS4yeiIvPjwvc3ZnPg==" alt="Vert.x Logo"/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><span class="navbar-menu-item with-drop-down"><div class="dropdown"><a class="dropdown-title">开始<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/introduction-to-vertx-and-reactive/"><li class="dropdown-item">简介</li></a><a href="/get-started/"><li class="dropdown-item">开始</li></a><a href="https://start.vertx.io/" target="_blank" rel="noreferrer"><li class="dropdown-item">应用生成器 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="navbar-menu-item" href="/docs/">文档</a><span class="navbar-menu-item with-drop-down"><div class="dropdown"><a class="dropdown-title">资源<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/faq/"><li class="dropdown-item">答疑</li></a><a href="/channels/"><li class="dropdown-item">联系渠道</li></a><a href="https://how-to.vertx.io/" target="_blank" rel="noreferrer"><li class="dropdown-item">操作指南 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/vertx-eventbus-bridge-clients" target="_blank" rel="noreferrer"><li class="dropdown-item">EventBus Bridge Clients <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="navbar-menu-item" href="/blog/">博客</a><a class="navbar-menu-item" href="/community/">社区</a><a class="navbar-menu-item" href="/translation/">翻译团队</a></div><div class="navbar-social"><a href="https://github.com/vert-x3/vertx-awesome" class="navbar-social-link" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" class="navbar-social-link" title="Stack Overflow" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>Stack Overflow</title><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" class="navbar-social-link" title="YouTube" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>YouTube</title><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a href="https://discord.gg/KzEMwP2" class="navbar-social-link" title="Discord" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title>Discord</title><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg></a><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" class="navbar-social-link" title="Vert.x 用户组" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title>Vert.x 用户组</title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a><a href="https://shang.qq.com/wpa/qunwpa?idkey=587f58cacb9557e3291b46098e0fe09427b98a1c0f866da23c04c2762bc7e2ad" class="navbar-social-link" title="Vert.x中国用户组QQ群" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Vert.x中国用户组QQ群"><title>Vert.x中国用户组QQ群</title><path d="M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673zM12.662 4.846c.039-1.052.659-1.878 1.385-1.846s1.281.912 1.242 1.964c-.039 1.051-.659 1.878-1.385 1.846s-1.282-.912-1.242-1.964zM9.954 3c.725-.033 1.345.794 1.384 1.846.04 1.052-.517 1.931-1.242 1.963-.726.033-1.346-.794-1.385-1.845C8.672 3.912 9.228 3.033 9.954 3zM7.421 8.294c.194-.43 2.147-.908 4.566-.908h.026c2.418 0 4.372.479 4.566.908a.14.14 0 0 1 .014.061c0 .031-.01.059-.026.083-.163.238-2.333 1.416-4.553 1.416h-.026c-2.221 0-4.39-1.178-4.553-1.416a.136.136 0 0 1-.014-.144zm10.422 8.622c-.22 3.676-2.403 5.987-5.774 6.021h-.137c-3.37-.033-5.554-2.345-5.773-6.021-.081-1.35.001-2.496.147-3.43.318.063.638.122.958.176v3.506s1.658.334 3.318.103v-3.225c.488.027.96.04 1.406.034h.025c1.678.021 3.714-.204 5.683-.594.146.934.227 2.08.147 3.43zM10.48 5.804c.313-.041.542-.409.508-.825-.033-.415-.314-.72-.629-.679-.313.04-.541.409-.508.824.034.417.315.72.629.68zM14.479 5.156c.078.037.221.042.289-.146.035-.095.025-.165-.009-.214-.023-.033-.133-.118-.371-.176-.904-.22-1.341.384-1.405.499-.04.072-.012.176.056.227.067.051.139.037.179-.006.58-.628 1.21-.208 1.261-.184z"></path></svg></a></div></div></div></div></header><div class="page-content"><div class="container"><div class="blog-post"><div class="blog-navbar"><h2>Blog</h2><ul><li><a href="/blog/">All posts</a></li><li><a href="/blog/category/releases/">releases</a></li><li><a href="/blog/category/guides/">guides</a></li><li><a href="/blog/category/news/">news</a></li></ul><div class="feed-icons"><a href="/feed/atom.xml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></div></div><div class="blog-post-main"><div class="blog-post-content"><h1>Using the asynchronous SQL client</h1><span><p>Fi­nally, back… This post is the fifth post of the in­tro­duc­tion to vert.x blog se­ries, after a not-​that-small break. In this post we are going to see how we can use JDBC in a vert.x ap­pli­ca­tion, and this, using the asyn­chro­nous API pro­vided by the <a href="/docs/vertx-jdbc-client/java/">vertx-​jdbc-client</a>.</p><h2 id="previously-in-the-introduction-to-vertx-series"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#previously-in-the-introduction-to-vertx-series"></a>Previously in the introduction to vert.x series</h2><p>As it was quite some time since the last post, let’s start by re­fresh­ing our mind about the four pre­vi­ous posts:</p><ol><li>The <a href="/blog/my-first-vert-x-3-application/">first post</a> has de­scribed how to build a vert.x ap­pli­ca­tion with Maven and ex­e­cute unit tests.</li><li>The <a href="/blog/vert-x-application-configuration/">sec­ond post</a> has de­scribed how this ap­pli­ca­tion can be­come con­fig­urable.</li><li>The <a href="/blog/some-rest-with-vert-x/">third post</a> has in­tro­duced <a href="/docs/vertx-web/java/">vertx-​web</a>, and a small col­lec­tion man­age­ment ap­pli­ca­tion has been de­vel­oped. This ap­pli­ca­tion of­fers a REST API used by a HTML/JavaScript fron­tend.</li><li>The <a href="/blog/unit-and-integration-tests/">pre­vi­ous post</a> has pre­sented how you can run in­te­gra­tion tests to en­sure the be­hav­ior of your ap­pli­ca­tion.</li></ol><p>In this post, back to code. The cur­rent ap­pli­ca­tion uses an in-​memory map to store the prod­ucts. It’s time to use a data­base. In this post we are going to use <a href="http://hsqldb.org/">HSQL</a>, but you can use any data­base pro­vid­ing a JDBC dri­ver. In­ter­ac­tions with the data­base will be asyn­chro­nous and made using the <a href="/docs/vertx-jdbc-client/java/">vertx-​jdbc-client</a>.</p><p>The code of this post are avail­able on this Github <a href="https://github.com/cescoffier/my-vertx-first-app">project</a>, in the <a href="https://github.com/cescoffier/my-vertx-first-app/tree/post-5">post-5 branch</a> branch.</p><h2 id="asynchronous"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#asynchronous"></a>Asynchronous?</h2><p>One of the vert.x char­ac­ter­is­tics is being asyn­chro­nous. With an asyn­chro­nous API, you don’t wait for a re­sult, but you are no­ti­fied when this re­sult is ready. Just to il­lus­trate this, let’s take a very sim­ple ex­am­ple.</p><p>Let’s imag­ine an <code>add</code> method. Tra­di­tion­ally, you would use it like this: <code>int r = add(1, 1)</code>. This is a syn­chro­nous API as you are wait­ing for the re­sult. An asyn­chro­nous ver­sion of this API would be: <code>add(1, 1, r -&gt; { /* do something with the result */ })</code>. In this ver­sion, you pass a <code>Handler</code> called when the re­sult has been com­puted. The method does not re­turn any­thing, and could be im­ple­mented as:</p><pre><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a, <span class="hljs-keyword">int</span> b, Handler&lt;Integer&gt; resultHandler)</span> </span>{
    <span class="hljs-keyword">int</span> r = a + b;
    resultHandler.handle(r);
}
</code></pre><p>Just to avoid mis­con­cep­tions, asyn­chro­nous API are not about threads. As we can see in the <code>add</code> ex­am­ple, there are no threads in­volved.</p><h2 id="jdbc-yes-but-asynchronous"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#jdbc-yes-but-asynchronous"></a>JDBC yes, but asynchronous</h2><p>So, now that we have seen some ba­sics about asyn­chro­nous API, let’s have a look to the vertx-​jdbc-client. This com­po­nent lets us in­ter­act with a data­base through a JDBC dri­ver. These in­ter­ac­tions are asyn­chro­nous, so when you were doing:</p><pre><code class="hljs language-java">String sql = <span class="hljs-string">&quot;SELECT * FROM Products&quot;</span>;
ResultSet rs = stmt.executeQuery(sql);
</code></pre><p>it will be:</p><pre><code class="hljs language-java">connection.query(<span class="hljs-string">&quot;SELECT * FROM Products&quot;</span>, result -&gt; {
        <span class="hljs-comment">// do something with the result</span>
});
</code></pre><p>This model is more ef­fi­cient as it avoids wait­ing for the re­sult. You are no­ti­fied when the re­sult is avail­able.</p><p>Let’s now mod­ify our ap­pli­ca­tion to use a data­base to store our prod­ucts.</p><h2 id="some-maven-dependencies"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#some-maven-dependencies"></a>Some maven dependencies</h2><p>The first things we need to do it to de­clare two new Maven de­pen­den­cies in our <code>pom.xml</code> file:</p><pre><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-jdbc-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hsqldb<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hsqldb<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre><p>The first de­pen­dency pro­vides the vertx-​jdbc-client, while the sec­ond one pro­vide the HSQL JDBC dri­ver. If you want to use an­other data­base, change this de­pen­dency. You will also need to change the JDBC url and JDBC dri­ver class name later.</p><h2 id="initializing-the-jdbc-client"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#initializing-the-jdbc-client"></a>Initializing the JDBC client</h2><p>Now that we have added these de­pen­den­cies, it’s time to cre­ate our JDBC client:</p><p>In the <code>MyFirstVerticle</code> class, de­clare a new field <code>JDBCClient jdbc;</code>, and add the fol­low­ing line at the be­gin­ning of the <code>start</code> method:</p><pre><code class="hljs language-java">jdbc = JDBCClient.createShared(vertx, config(), <span class="hljs-string">&quot;My-Whisky-Collection&quot;</span>);
</code></pre><p>This cre­ates an in­stance of JDBC client, con­fig­ured with the con­fig­u­ra­tion pro­vided to the ver­ti­cle. To work cor­rectly this con­fig­u­ra­tion needs to pro­vide:</p><ul><li><em>url</em> - the JDBC url such as <code>jdbc:hsqldb:mem:db?shutdown=true</code></li><li><em>dri­ver_class</em> - the JDBC dri­ver class such as <code>org.hsqldb.jdbcDriver</code></li></ul><p>Ok, we have the client, we need a con­nec­tion to the data­base. This is achieved using the <code>jdbc.getConnection</code> that take a <code>Handler&lt;AsyncResult&lt;SQLConnection&gt;&gt;</code> as pa­ra­me­ter. Let’s have a deeper look to this type. It’s a <code>Handler</code>, so it is called when the re­sult is ready. This re­sult is an in­stance of <code>AsyncResult&lt;SQLConnection&gt;</code>. <code>AsyncResult</code> is a struc­ture pro­vided by vert.x that lets us know if the op­er­a­tion was com­pleted suc­cess­fully or failed. In case of suc­cess, it pro­vides the re­sult, here an in­stance of <code>SQLConnection</code>.</p><p>When you re­ceive an in­stance of <code>AsyncResult</code>, your code gen­er­ally looks like:</p><pre><code class="hljs language-java"><span class="hljs-keyword">if</span> (ar.failed()) {
  System.err.println(<span class="hljs-string">&quot;The operation has failed...: &quot;</span>
      + ar.cause().getMessage());
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// Use the result:</span>
  result = ar.result();
 }
</code></pre><p>So, let’s go back to our <code>SQLConnection</code>. We need to re­trieve it, and then start the rest of the ap­pli­ca­tion. This changes how we start the ap­pli­ca­tion, as it will be­come asyn­chro­nous. So, if we di­vide our startup se­quence into small chunks it would be some­thing like:</p><pre><code class="hljs language-java">startBackend(
 (connection) -&gt; createSomeData(connection,
     (nothing) -&gt; startWebApp(
         (http) -&gt; completeStartup(http, fut)
     ), fut
 ), fut);
</code></pre><p>with:</p><ol><li><code>startBackend</code> - re­trieves a <code>SQLConnection</code> and then calls the next step</li><li><code>createSomeData</code> - ini­tial­izes the data­base and in­serts some data. When done, it calls the next step</li><li><code>startWebApp</code> - starts our web ap­pli­ca­tion</li><li><code>completeStartup</code> - fi­nal­izes our start se­quence</li></ol><p><code>fut</code> is the com­ple­tion fu­ture passed by vert.x that let us re­port when we are started, or if an issue has been en­coun­tered while start­ing.</p><p>Let’s have a look to <code>startBackend</code>:</p><pre><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startBackend</span><span class="hljs-params">(Handler&lt;AsyncResult&lt;SQLConnection&gt;&gt; next, Future&lt;Void&gt; fut)</span> </span>{
  jdbc.getConnection(ar -&gt; {
    <span class="hljs-keyword">if</span> (ar.failed()) {
      fut.fail(ar.cause());
    } <span class="hljs-keyword">else</span> {
      next.handle(Future.succeededFuture(ar.result()));
    }
  });
}
</code></pre><p>This method re­trieves a <code>SQLConnection</code>, check whether this op­er­a­tion suc­ceeded. If so, it calls the next step. In case of fail­ure, it re­ports it.</p><p>The other meth­ods fol­low the same pat­tern: 1) check if the last op­er­a­tion has suc­ceeded, 2) do the task, 3) call the next step.</p><h3 id="a-bit-of-sql"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#a-bit-of-sql"></a>A bit of SQL…</h3><p>Our client is ready, let’s now write some SQL state­ments. Let’s start by the <code>createSomeData</code> method that is part of the startup se­quence:</p><pre><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">createSomeData</span><span class="hljs-params">(AsyncResult&lt;SQLConnection&gt; result,
    Handler&lt;AsyncResult&lt;Void&gt;&gt; next, Future&lt;Void&gt; fut)</span> </span>{
    <span class="hljs-keyword">if</span> (result.failed()) {
      fut.fail(result.cause());
    } <span class="hljs-keyword">else</span> {
      SQLConnection connection = result.result();
      connection.execute(
          <span class="hljs-string">&quot;CREATE TABLE IF NOT EXISTS Whisky (id INTEGER IDENTITY, name varchar(100), &quot;</span> +
          <span class="hljs-string">&quot;origin varchar(100))&quot;</span>,
          ar -&gt; {
            <span class="hljs-keyword">if</span> (ar.failed()) {
              fut.fail(ar.cause());
              connection.close();
              <span class="hljs-keyword">return</span>;
            }
            connection.query(<span class="hljs-string">&quot;SELECT * FROM Whisky&quot;</span>, select -&gt; {
              <span class="hljs-keyword">if</span> (select.failed()) {
                fut.fail(ar.cause());
                connection.close();
                <span class="hljs-keyword">return</span>;
              }
              <span class="hljs-keyword">if</span> (select.result().getNumRows() == <span class="hljs-number">0</span>) {
                insert(
                    <span class="hljs-keyword">new</span> Whisky(<span class="hljs-string">&quot;Bowmore 15 Years Laimrig&quot;</span>, <span class="hljs-string">&quot;Scotland, Islay&quot;</span>),
                    connection,
                    (v) -&gt; insert(<span class="hljs-keyword">new</span> Whisky(<span class="hljs-string">&quot;Talisker 57° North&quot;</span>, <span class="hljs-string">&quot;Scotland, Island&quot;</span>),
                        connection,
                        (r) -&gt; {
                          next.handle(Future.&lt;Void&gt;succeededFuture());
                          connection.close();
                        }));                                                    
              } <span class="hljs-keyword">else</span> {
                next.handle(Future.&lt;Void&gt;succeededFuture());
                connection.close();
              }
            });
          });
    }
  }
</code></pre><p>This method checks that the <code>SQLConnection</code> is avail­able and then start ex­e­cut­ing some SQL state­ments. First, it cre­ates the ta­bles if there are not there yet. As you can see, the method called is struc­tured as fol­lows:</p><pre><code class="hljs language-java">connection.execute(
    SQL statement,
    handler called when the statement has been executed
)
</code></pre><p>The han­dler re­ceives an <code>AsyncResult&lt;Void&gt;</code>, <em>i.e.</em> a no­ti­fi­ca­tion of the com­ple­tion with­out an ac­tual re­sult.</p><div class="alert info"><div class="alert-title">Closing connection</div><p>Don’t for­get to close the SQL con­nec­tion when you are done. The con­nec­tion will be given back to the con­nec­tion pool and be reused.</p></div><p>In the code of this han­dler, we check whether or not the state­ment has been ex­e­cuted cor­rectly, and if so we check to see if the table al­ready con­tains some data, if not, it in­serts data using the <code>insert</code> method:</p><pre><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(Whisky whisky, SQLConnection connection, Handler&lt;AsyncResult&lt;Whisky&gt;&gt; next)</span> </span>{
  String sql = <span class="hljs-string">&quot;INSERT INTO Whisky (name, origin) VALUES ?, ?&quot;</span>;
  connection.updateWithParams(sql,
      <span class="hljs-keyword">new</span> JsonArray().add(whisky.getName()).add(whisky.getOrigin()),
      (ar) -&gt; {
        <span class="hljs-keyword">if</span> (ar.failed()) {
          next.handle(Future.failedFuture(ar.cause()));
          <span class="hljs-keyword">return</span>;
        }
        UpdateResult result = ar.result();
        <span class="hljs-comment">// Build a new whisky instance with the generated id.</span>
        Whisky w = <span class="hljs-keyword">new</span> Whisky(result.getKeys().getInteger(<span class="hljs-number">0</span>), whisky.getName(), whisky.getOrigin());
        next.handle(Future.succeededFuture(w));
      });
}
</code></pre><p>This method uses the <code>updateWithParams</code> method with an <em>IN­SERT</em> state­ment, and pass val­ues. This ap­proach avoids SQL in­jec­tion. Once the the state­ment has been ex­e­cuted, we cre­ates a new <code>Whisky</code> ob­ject with the cre­ated (auto-​generated) id.</p><h2 id="some-rest-with-a-pinch-of-sql"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#some-rest-with-a-pinch-of-sql"></a>Some REST with a pinch of SQL</h2><p>The method de­scribed  above is part of our start se­quence. But what about the method in­voked by our REST API. Let’s have a look to the <code>getAll</code> method. This method is called by the web front-​end to re­trieve all stored prod­ucts:</p><pre><code class="hljs language-java"> <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getAll</span><span class="hljs-params">(RoutingContext routingContext)</span> </span>{
    jdbc.getConnection(ar -&gt; {
      SQLConnection connection = ar.result();
      connection.query(<span class="hljs-string">&quot;SELECT * FROM Whisky&quot;</span>, result -&gt; {
        List&lt;Whisky&gt; whiskies = result.result().getRows().stream().map(Whisky::<span class="hljs-keyword">new</span>).collect(Collectors.toList());
        routingContext.response()
            .putHeader(<span class="hljs-string">&quot;content-type&quot;</span>, <span class="hljs-string">&quot;application/json; charset=utf-8&quot;</span>)
            .end(Json.encodePrettily(whiskies));
        connection.close(); <span class="hljs-comment">// Close the connection     </span>
      });
    });
  }
</code></pre><p>This method gets a <code>SQLConnection</code>, and then issue a query. Once the re­sult has been re­trieved it writes the HTTP re­sponse as be­fore. The <code>getOne</code>, <code>deleteOne</code>, <code>updateOne</code> and <code>addOne</code> meth­ods fol­low the same pat­tern. No­tice that the con­nec­tion can be closed after the re­sponse has been writ­ten.</p><p>Let’s have a look to the re­sult pro­vided to the han­dler passed to the <code>query</code> method. It gets a <code>ResultSet</code>, which con­tains the query re­sult. Each row is a <code>JsonObject</code>, so if your data ob­ject has a con­struc­tor tak­ing a <code>JsonObject</code> as unique ar­gu­ment, cre­at­ing there ob­jects is straight­for­ward.</p><h2 id="test-test-and-test-again"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#test-test-and-test-again"></a>Test, test, and test again</h2><p>We need to slightly up­date our tests to con­fig­ure the <code>JDBCClient</code>. In the <code>MyFirstVertilceTest</code> class, change the <code>DeploymentOption</code> ob­ject cre­ated in the <code>setUp</code> method to be:</p><pre><code class="hljs language-java">DeploymentOptions options = <span class="hljs-keyword">new</span> DeploymentOptions()
    .setConfig(<span class="hljs-keyword">new</span> JsonObject()
        .put(<span class="hljs-string">&quot;http.port&quot;</span>, port)
        .put(<span class="hljs-string">&quot;url&quot;</span>, <span class="hljs-string">&quot;jdbc:hsqldb:mem:test?shutdown=true&quot;</span>)
        .put(<span class="hljs-string">&quot;driver_class&quot;</span>, <span class="hljs-string">&quot;org.hsqldb.jdbcDriver&quot;</span>)
    );
</code></pre><p>In ad­di­tion to the <code>http.port</code>, we also put the JDBC url and the class of the JDBC dri­ver. We use an in-​memory data­base for tests.</p><p>The same mod­i­fi­ca­tion needs to be done in the <code>src/test/resources/my-it-config.json</code> file:</p><pre><code class="hljs language-json">{
  <span class="hljs-attr">&quot;http.port&quot;</span>: ${http.port},
  <span class="hljs-attr">&quot;url&quot;</span>: <span class="hljs-string">&quot;jdbc:hsqldb:mem:it-test?shutdown=true&quot;</span>,
  <span class="hljs-attr">&quot;driver_class&quot;</span>: <span class="hljs-string">&quot;org.hsqldb.jdbcDriver&quot;</span>
}
</code></pre><p>The <code>src/main/conf/my-application-conf.json</code> file also needs to be up­dated, not for the tests, but to run the ap­pli­ca­tion:</p><pre><code class="hljs language-json">{
  <span class="hljs-attr">&quot;http.port&quot;</span> : <span class="hljs-number">8082</span>,
  <span class="hljs-attr">&quot;url&quot;</span>: <span class="hljs-string">&quot;jdbc:hsqldb:file:db/whiskies&quot;</span>,
  <span class="hljs-attr">&quot;driver_class&quot;</span>: <span class="hljs-string">&quot;org.hsqldb.jdbcDriver&quot;</span>
}
</code></pre><p>The JDBC url is a bit dif­fer­ent in this last file, as we store the data­base on the file sys­tem.</p><h2 id="show-time"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#show-time"></a>Show time!</h2><p>Let’s now build our ap­pli­ca­tion:</p><p><code>mvn clean package</code></p><p>As we didn’t change the API (nei­ther the pub­lic java one nor the REST), test should run smoothly.</p><p>Then launch the ap­pli­ca­tion with:</p><p><code>java -jar target/my-first-app-1.0-SNAPSHOT-fat.jar -conf src/main/conf/my-application-conf.json </code></p><p>Open your browser to <code>http://localhost:8082/assets/index.html</code>, and you should see the ap­pli­ca­tion using the data­base. This time the prod­ucts are stored in a data­base per­sisted on the file sys­tem. So, if we stop and restart the ap­pli­ca­tion, the data is re­stored.</p><h2 id="conclusion"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#conclusion"></a>Conclusion</h2><p>In this post, we saw how you can use JDBC data­base with vert.x, and thus with­out too much bur­den. You may have been sur­prised by the asyn­chro­nous de­vel­op­ment model, but once you start using it, it’s hard to come back.</p><p>In the <a href="/blog/combine-vert-x-and-mongo-to-build-a-giant/">next post</a>, we see how the same ap­pli­ca­tion can use Mon­goDB in­stead of HSQL.</p><p>Stay tuned, and happy cod­ing!</p></span></div><div class="blog-post-sidebar"><div class="blog-post-author"><img class="blog-post-author-avatar" src="https://github.com/cescoffier.png?size=160"/><div class="blog-post-author-name">by <a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></div></div><div class="blog-post-sidebar-date">Posted on <!-- -->19 October 2015</div>in <a class="blog-post-sidebar-category" href="/blog/category/guides/">guides</a><div class="blog-post-sidebar-reading-time"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <!-- -->10 min read</div><div class="blog-post-sidebar-share-icons"><a href="https://twitter.com/intent/tweet?text=Using%20the%20asynchronous%20SQL%20client&amp;url=https%3A%2F%2Fvertx.io%2Fblog%2Fusing-the-asynchronous-sql-client&amp;via=vertx_project" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Twitter</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"></path></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fvertx.io%2Fblog%2Fusing-the-asynchronous-sql-client" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fvertx.io%2Fblog%2Fusing-the-asynchronous-sql-client" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Facebook</title><path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path></svg></a></div></div></div><div class="blog-post-next-prev"><div class="blog-post-next-prev-entry"><h5>Next post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">25 November 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/vert-x-es6-back-to-the-future/">Vert.x ES6 back to the future</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/pmlopes.png?size=50"/><a href="https://github.com/pmlopes" target="_blank" rel="noopener noreferrer">Paulo Lopes</a></li></ul></span><p class="blog-entry-summary">On October 21th, 2015 we all rejoiced with the return from the past of Marty McFly with his flying car and so on, however in the Vert.x world we were quite sad about our rather old JavaScript support.</p><span class="read-more-link"><a href="/blog/vert-x-es6-back-to-the-future/"> 阅读更多</a></span></div></div><div class="blog-post-next-prev-entry"><h5>Previous post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">8 October 2015</span>​<a class="blog-entry-category" href="/blog/category/releases/">releases</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/vert-x-3-1-0-is-released/">Vert.x 3.1.0 is released!</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/purplefox.png?size=50"/><a href="https://github.com/purplefox" target="_blank" rel="noopener noreferrer">Tim Fox</a></li></ul></span><p class="blog-entry-summary">I&#x27;m pleased to announce the release of Vert.x 3.1!</p><span class="read-more-link"><a href="/blog/vert-x-3-1-0-is-released/"> 阅读更多</a></span></div></div></div><div class="blog-post-related"><h5>Related posts</h5><div class="blog-post-related-posts"><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">3 August 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/unit-and-integration-tests/">Unit and Integration Tests</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">Let’s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn’t test the API.</p><span class="read-more-link"><a href="/blog/unit-and-integration-tests/"> 阅读更多</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">30 November 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/combine-vert-x-and-mongo-to-build-a-giant/">Combine vert.x and mongo to build a giant</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">This blog post is part of the introduction to Vert.x series. We are now going to replace this JDBC client by the vertx-mongo-client, and thus connect to a Mongo database.</p><span class="read-more-link"><a href="/blog/combine-vert-x-and-mongo-to-build-a-giant/"> 阅读更多</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">14 July 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/my-first-vert-x-3-application/">My first Vert.x 3 Application</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">Let&#x27;s say, you heard someone saying that Vert.x is awesome. Ok great, but you may want to try it by yourself. Well, the next natural question is “where do I start ?”</p><span class="read-more-link"><a href="/blog/my-first-vert-x-3-application/"> 阅读更多</a></span></div></div></div></div></div></div><footer><div class="container"><div class="footer-nav-section"><div class="footer-nav-list footer-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMjMyLjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3ptNDE0LTI2Ni45aC0xNS4zdjQyLjJoLTguNVY2LjloLTE1LjJWMGgzOXY2Ljl6TTExOTMgMGwxNC4yIDM3LjdMMTIyMS4zIDBoMTF2NDkuMWgtOC41VjMyLjlsLjgtMjEuNy0xNC41IDM3LjloLTYuMWwtMTQuNS0zNy44LjggMjEuNnYxNi4yaC04LjVWMGgxMS4yeiIvPjwvc3ZnPg==" alt="Vert.x Logo"/></a></div><div class="footer-nav-list"><h5>Eclipse Vert.x</h5><ul class=""><li><a class="navbar-menu-item" href="/docs/">文档</a></li><li><a href="/download/">下载</a></li><li><a href="/blog/">博客</a></li><li><a href="/community/">社区</a></li><li><a href="/translation/">翻译团队</a></li><li><a href="https://github.com/eclipse-vertx/vert.x">GitHub</a></li><li><a href="https://github.com/vertx-china/vertx-web-site">翻译GitHub</a></li></ul></div><div class="footer-nav-list"><h5>资源</h5><ul class=""><li><a href="/faq/">答疑</a></li><li><a href="/channels/">联系渠道</a></li><li><a href="https://how-to.vertx.io/">操作指南</a></li><li><a href="https://start.vertx.io/">应用生成器</a></li></ul></div><div class="footer-nav-list"><h5>Eclipse</h5><ul class=""><li><a href="https://www.eclipse.org/">Eclipse 基金会</a></li><li><a href="https://www.eclipse.org/legal/privacy.php">隐私政策</a></li><li><a href="https://www.eclipse.org/legal/termsofuse.php">使用条款</a></li><li><a href="https://www.eclipse.org/legal/copyright.php">版权代理</a></li><li><a href="https://www.eclipse.org/legal/">法律资源</a></li></ul></div></div><div class="footer-copyright"><div class="footer-copyright-remarks">© <!-- -->2021<!-- --> Eclipse Vert.x™<br/>Eclipse Vert.x™ 是开源的，并在<a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer">Eclipse Public License 2.0</a>和<a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache License 2.0</a>协议下获得了双重许可。<br class="footer-copyright-break"/>网站由 <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer">Michel Krämer</a> 设计。</div><div class="footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAyODEuMyA5MS4xIiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGU+LnN0MHtmaWxsOiNmNzk0MjJ9LnN0MXtmaWxsOiMzZDNjM2J9PC9zdHlsZT48ZyBpZD0iTGF5ZXJfMV8xXyI+PHBhdGggY2xhc3M9InN0MCIgZD0iTTI2NS43IDg0TDI1NyA3M2gtMi43djE3LjdoMy4zdi0xMmw5LjMgMTJoMi4xVjczaC0zLjN2MTF6bS0zMi40LTguM2M0LjIgMCA1LjggMy4zIDUuOCA2LjNzLTEuNiA2LTUuOCA2LTUuNy0zLjEtNS44LTYgMS43LTYuMyA1LjgtNi4zem0wLTNjLTYuMSAwLTkuMSA0LjctOS4xIDkuMyAwIDQuNyAyLjkgOS4xIDkuMSA5LjFzOS00LjYgOS4xLTkuMi0zLTkuMi05LjEtOS4yem0tMjEuMiAxOFY3M2gtMy4zdjE3LjdoMy4zem0tMjMuNiAwaDMuM1Y3Nmg1LjZ2LTNoLTE0LjZ2M2g1LjZsLjEgMTQuN3ptLTE4LjktNi41SDE2M2wzLjMtNy42IDMuMyA3LjZ6bTIuOCA2LjVoMy42TDE2OC4yIDczaC0zLjZsLTggMTcuN2gzLjZsMS41LTMuM2g5LjNsMS40IDMuM3ptLTM4LTE0LjZoMy42YzMuOSAwIDUuNSAyLjggNS41IDUuNS4xIDIuOC0xLjUgNS44LTUuNSA1LjhoLTMuNlY3Ni4xem0zLjctMy4xaC02Ljl2MTcuN2g2LjljNi4yIDAgOC45LTQuNSA4LjktOXMtMi44LTguNy04LjktOC43em0tMjIuNCAxMUwxMDcgNzNoLTIuN3YxNy43aDMuM3YtMTJsOS4zIDEyaDIuMVY3M2gtMy4zdjExek04OC4yIDczdjEwLjJjMCAzLTEuNiA0LjktNC4zIDQuOXMtNC42LTEuNy00LjYtNC45VjczSDc2djEwLjFjMCA1LjMgMy42IDcuOSA3LjkgNy45IDQuNCAwIDcuNy0yLjcgNy43LTcuOVY3M2gtMy40em0tMzMgMi43YzQuMiAwIDUuOCAzLjMgNS44IDYuM3MtMS42IDYtNS44IDYtNS43LTMuMS01LjgtNiAxLjctNi4zIDUuOC02LjN6bTAtM2MtNi4xIDAtOS4xIDQuNy05LjEgOS4zczIuOSA5LjEgOS4xIDkuMSA5LTQuNiA5LjEtOS4yLTMtOS4yLTkuMS05LjJ6bS0yOS43IDE4di02LjVoOC45di0zLjFoLTguOXYtNC44aDkuNFY3M0gyMi4ydjE3LjZoMy4zeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNjkuNCA1NC40aC0yMi4ydi04LjloMjEuNHYtNi45aC0yMS40di05LjFoMjIuMnYtNy4yaC0yOS42djM5LjVoMjkuNnYtNy40em0tNDAtMjUuNmMtMy02LjEtOS40LTcuOC0xNS41LTcuOC03LjMgMC0xNS4zIDMuNC0xNS4zIDExLjUgMCA4LjkgNy40IDExIDE1LjUgMTIgNS4yLjYgOS4xIDIuMSA5LjEgNS44IDAgNC4zLTQuNCA1LjktOS4xIDUuOXMtOS40LTEuOS0xMS4xLTYuM2wtNi4yIDMuMmMyLjkgNy4yIDkuMSA5LjcgMTcuMiA5LjcgOC44IDAgMTYuNi0zLjggMTYuNi0xMi42IDAtOS40LTcuNy0xMS42LTE1LjktMTIuNi00LjctLjYtOC44LTEuNS04LjgtNSAwLTIuOSAyLjYtNS4yIDguMi01LjIgNC4zIDAgOCAyLjIgOS40IDQuNGw1LjktM3pNMTc2IDIyLjJjLTYuMi0uMS0xMi40IDAtMTguNiAwdjM5LjVoNy40VjUwLjFIMTc2YzE5LjQgMCAxOS40LTI3LjkgMC0yNy45em0tMTEuMSA3LjFIMTc2YzkuNSAwIDkuNSAxNCAwIDE0aC0xMS4ybC4xLTE0em0tMTggMzIuNVYyMi4yaC03LjR2MzkuNWw3LjQuMXptLTQ0LTM5LjZ2MzkuNWgyNy43di02LjloLTIwLjNWMjIuMmgtNy40ek05MC43IDUxLjdjLTIuNyAyLjUtNi4yIDQtOS45IDQtOS44IDAtMTMuNS02LjgtMTMuNi0xMy40czQuMS0xMy43IDEzLjYtMTMuN2MzLjUtLjEgNyAxLjMgOS41IDMuN2w1LTQuOGMtMy44LTMuOS05LjEtNi0xNC41LTYtMTQuMyAwLTIxIDEwLjUtMjAuOSAyMC44czYuMyAyMC4zIDIwLjkgMjAuM2M1LjYuMSAxMS0yIDE1LTUuOWwtNS4xLTV6bS0zOSAyLjdIMjkuNXYtOC45aDIxLjR2LTYuOUgyOS41di05LjFoMjIuMnYtNy4ySDIyLjJ2MzkuNWgyOS42bC0uMS03LjR6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTkuOCAxOC4yQzE4LjggNC4xIDM2LjktLjggNTIuMSA2bC0xLS43QzM1LjctNC42IDE1LjItLjEgNS4zIDE1LjNzLTUuNCAzNS45IDEwIDQ1LjhsMS4xLjZDMy44IDUwLjguOCAzMi4zIDkuOCAxOC4yeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNzIuMiAyNi4xYzAtMi41IDIuMS00LjYgNC42LTQuNiAyLjUgMCA0LjYgMi4xIDQuNiA0LjYgMCAyLjUtMi4xIDQuNi00LjYgNC42LTIuNiAwLTQuNi0yLjEtNC42LTQuNnptOC42IDBjMC0yLjItMS44LTQuMS00LTQuMXMtNC4xIDEuOC00LjEgNC4xYzAgMi4yIDEuNyA0IDMuOSA0LjFoLjFjMi4zIDAgNC4xLTEuOCA0LjEtNC4xem0tNi0yLjVoMi4zYzEuMSAwIDEuOS41IDEuOSAxLjYgMCAuNy0uNCAxLjMtMS4xIDEuNWwxLjIgMS43aC0xLjRsLTEtMS41aC0uN3YxLjVoLTEuMWwtLjEtNC44em0yLjIgMi4zYy41IDAgLjgtLjMuOC0uN3MtLjMtLjctLjgtLjdoLTF2MS4zbDEgLjF6Ii8+PC9nPjwvc3ZnPg==" alt="Eclipse foundation Logo"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"categories":["releases","guides","news"],"post":{"meta":{"title":"Using the asynchronous SQL client","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"Finally, back... This post is the fifth post of the introduction to vert.x blog series, after a not-that-small break. In this post we are going to see how we can use JDBC in a vert.x application."},"date":"2015-10-19","slug":"using-the-asynchronous-sql-client","readingTime":{"text":"10 min read","minutes":9.02,"time":541199.9999999999,"words":1804},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Fi\\xADnally, back\\u2026 This post is the fifth post of the in\\xADtro\\xADduc\\xADtion to vert.x blog se\\xADries, after a not-\\u200Bthat-small break. In this post we are going to see how we can use JDBC in a vert.x ap\\xADpli\\xADca\\xADtion, and this, using the asyn\\xADchro\\xADnous API pro\\xADvided by the \", mdx(Link, {\n    href: \"/docs/vertx-jdbc-client/java/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"vertx-\\u200Bjdbc-client\")), \".\"), mdx(\"h2\", {\n    \"id\": \"previously-in-the-introduction-to-vertx-series\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#previously-in-the-introduction-to-vertx-series\"\n  })), \"Previously in the introduction to vert.x series\"), mdx(\"p\", null, \"As it was quite some time since the last post, let\\u2019s start by re\\xADfresh\\xADing our mind about the four pre\\xADvi\\xADous posts:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"The \", mdx(Link, {\n    href: \"/blog/my-first-vert-x-3-application/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"\"\n  }), \"first post\")), \" has de\\xADscribed how to build a vert.x ap\\xADpli\\xADca\\xADtion with Maven and ex\\xADe\\xADcute unit tests.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"The \", mdx(Link, {\n    href: \"/blog/vert-x-application-configuration/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"\"\n  }), \"sec\\xADond post\")), \" has de\\xADscribed how this ap\\xADpli\\xADca\\xADtion can be\\xADcome con\\xADfig\\xADurable.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"The \", mdx(Link, {\n    href: \"/blog/some-rest-with-vert-x/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"\"\n  }), \"third post\")), \" has in\\xADtro\\xADduced \", mdx(Link, {\n    href: \"/docs/vertx-web/java/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"\"\n  }), \"vertx-\\u200Bweb\")), \", and a small col\\xADlec\\xADtion man\\xADage\\xADment ap\\xADpli\\xADca\\xADtion has been de\\xADvel\\xADoped. This ap\\xADpli\\xADca\\xADtion of\\xADfers a REST API used by a HTML/JavaScript fron\\xADtend.\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"The \", mdx(Link, {\n    href: \"/blog/unit-and-integration-tests/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"\"\n  }), \"pre\\xADvi\\xADous post\")), \" has pre\\xADsented how you can run in\\xADte\\xADgra\\xADtion tests to en\\xADsure the be\\xADhav\\xADior of your ap\\xADpli\\xADca\\xADtion.\")), mdx(\"p\", null, \"In this post, back to code. The cur\\xADrent ap\\xADpli\\xADca\\xADtion uses an in-\\u200Bmemory map to store the prod\\xADucts. It\\u2019s time to use a data\\xADbase. In this post we are going to use \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://hsqldb.org/\"\n  }), \"HSQL\"), \", but you can use any data\\xADbase pro\\xADvid\\xADing a JDBC dri\\xADver. In\\xADter\\xADac\\xADtions with the data\\xADbase will be asyn\\xADchro\\xADnous and made using the \", mdx(Link, {\n    href: \"/docs/vertx-jdbc-client/java/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"vertx-\\u200Bjdbc-client\")), \".\"), mdx(\"p\", null, \"The code of this post are avail\\xADable on this Github \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/cescoffier/my-vertx-first-app\"\n  }), \"project\"), \", in the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/cescoffier/my-vertx-first-app/tree/post-5\"\n  }), \"post-5 branch\"), \" branch.\"), mdx(\"h2\", {\n    \"id\": \"asynchronous\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#asynchronous\"\n  })), \"Asynchronous?\"), mdx(\"p\", null, \"One of the vert.x char\\xADac\\xADter\\xADis\\xADtics is being asyn\\xADchro\\xADnous. With an asyn\\xADchro\\xADnous API, you don\\u2019t wait for a re\\xADsult, but you are no\\xADti\\xADfied when this re\\xADsult is ready. Just to il\\xADlus\\xADtrate this, let\\u2019s take a very sim\\xADple ex\\xADam\\xADple.\"), mdx(\"p\", null, \"Let\\u2019s imag\\xADine an \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"add\"), \" method. Tra\\xADdi\\xADtion\\xADally, you would use it like this: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"int r = add(1, 1)\"), \". This is a syn\\xADchro\\xADnous API as you are wait\\xADing for the re\\xADsult. An asyn\\xADchro\\xADnous ver\\xADsion of this API would be: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"add(1, 1, r -\u003e { /* do something with the result */ })\"), \". In this ver\\xADsion, you pass a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Handler\"), \" called when the re\\xADsult has been com\\xADputed. The method does not re\\xADturn any\\xADthing, and could be im\\xADple\\xADmented as:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"public\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"void\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"add\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"int\"), \" a, \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"int\"), \" b, Handler\u003cInteger\u003e resultHandler)\"), \" \"), \"{\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"int\"), \" r = a + b;\\n    resultHandler.handle(r);\\n}\\n\")), mdx(\"p\", null, \"Just to avoid mis\\xADcon\\xADcep\\xADtions, asyn\\xADchro\\xADnous API are not about threads. As we can see in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"add\"), \" ex\\xADam\\xADple, there are no threads in\\xADvolved.\"), mdx(\"h2\", {\n    \"id\": \"jdbc-yes-but-asynchronous\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#jdbc-yes-but-asynchronous\"\n  })), \"JDBC yes, but asynchronous\"), mdx(\"p\", null, \"So, now that we have seen some ba\\xADsics about asyn\\xADchro\\xADnous API, let\\u2019s have a look to the vertx-\\u200Bjdbc-client. This com\\xADpo\\xADnent lets us in\\xADter\\xADact with a data\\xADbase through a JDBC dri\\xADver. These in\\xADter\\xADac\\xADtions are asyn\\xADchro\\xADnous, so when you were doing:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"String sql = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"SELECT * FROM Products\\\"\"), \";\\nResultSet rs = stmt.executeQuery(sql);\\n\")), mdx(\"p\", null, \"it will be:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"connection.query(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"SELECT * FROM Products\\\"\"), \", result -\u003e {\\n        \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// do something with the result\"), \"\\n});\\n\")), mdx(\"p\", null, \"This model is more ef\\xADfi\\xADcient as it avoids wait\\xADing for the re\\xADsult. You are no\\xADti\\xADfied when the re\\xADsult is avail\\xADable.\"), mdx(\"p\", null, \"Let\\u2019s now mod\\xADify our ap\\xADpli\\xADca\\xADtion to use a data\\xADbase to store our prod\\xADucts.\"), mdx(\"h2\", {\n    \"id\": \"some-maven-dependencies\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#some-maven-dependencies\"\n  })), \"Some maven dependencies\"), mdx(\"p\", null, \"The first things we need to do it to de\\xADclare two new Maven de\\xADpen\\xADden\\xADcies in our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"pom.xml\"), \" file:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xml\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"io.vertx\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"vertx-jdbc-client\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"3.1.0\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"org.hsqldb\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"groupId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"hsqldb\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"artifactId\"), \"\u003e\"), \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"2.3.3\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"version\"), \"\u003e\"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-tag\"\n  }), \"\u003c/\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-name\"\n  }), \"dependency\"), \"\u003e\"), \"\\n\")), mdx(\"p\", null, \"The first de\\xADpen\\xADdency pro\\xADvides the vertx-\\u200Bjdbc-client, while the sec\\xADond one pro\\xADvide the HSQL JDBC dri\\xADver. If you want to use an\\xADother data\\xADbase, change this de\\xADpen\\xADdency. You will also need to change the JDBC url and JDBC dri\\xADver class name later.\"), mdx(\"h2\", {\n    \"id\": \"initializing-the-jdbc-client\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#initializing-the-jdbc-client\"\n  })), \"Initializing the JDBC client\"), mdx(\"p\", null, \"Now that we have added these de\\xADpen\\xADden\\xADcies, it\\u2019s time to cre\\xADate our JDBC client:\"), mdx(\"p\", null, \"In the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MyFirstVerticle\"), \" class, de\\xADclare a new field \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JDBCClient jdbc;\"), \", and add the fol\\xADlow\\xADing line at the be\\xADgin\\xADning of the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"start\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"jdbc = JDBCClient.createShared(vertx, config(), \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"My-Whisky-Collection\\\"\"), \");\\n\")), mdx(\"p\", null, \"This cre\\xADates an in\\xADstance of JDBC client, con\\xADfig\\xADured with the con\\xADfig\\xADu\\xADra\\xADtion pro\\xADvided to the ver\\xADti\\xADcle. To work cor\\xADrectly this con\\xADfig\\xADu\\xADra\\xADtion needs to pro\\xADvide:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"em\", {\n    parentName: \"li\"\n  }, \"url\"), \" - the JDBC url such as \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"jdbc:hsqldb:mem:db?shutdown=true\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"em\", {\n    parentName: \"li\"\n  }, \"dri\\xADver_class\"), \" - the JDBC dri\\xADver class such as \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"org.hsqldb.jdbcDriver\"))), mdx(\"p\", null, \"Ok, we have the client, we need a con\\xADnec\\xADtion to the data\\xADbase. This is achieved using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"jdbc.getConnection\"), \" that take a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Handler\u003cAsyncResult\u003cSQLConnection\u003e\u003e\"), \" as pa\\xADra\\xADme\\xADter. Let\\u2019s have a deeper look to this type. It\\u2019s a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Handler\"), \", so it is called when the re\\xADsult is ready. This re\\xADsult is an in\\xADstance of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AsyncResult\u003cSQLConnection\u003e\"), \". \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AsyncResult\"), \" is a struc\\xADture pro\\xADvided by vert.x that lets us know if the op\\xADer\\xADa\\xADtion was com\\xADpleted suc\\xADcess\\xADfully or failed. In case of suc\\xADcess, it pro\\xADvides the re\\xADsult, here an in\\xADstance of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SQLConnection\"), \".\"), mdx(\"p\", null, \"When you re\\xADceive an in\\xADstance of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AsyncResult\"), \", your code gen\\xADer\\xADally looks like:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"if\"), \" (ar.failed()) {\\n  System.err.println(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"The operation has failed...: \\\"\"), \"\\n      + ar.cause().getMessage());\\n} \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"else\"), \" {\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Use the result:\"), \"\\n  result = ar.result();\\n }\\n\")), mdx(\"p\", null, \"So, let\\u2019s go back to our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SQLConnection\"), \". We need to re\\xADtrieve it, and then start the rest of the ap\\xADpli\\xADca\\xADtion. This changes how we start the ap\\xADpli\\xADca\\xADtion, as it will be\\xADcome asyn\\xADchro\\xADnous. So, if we di\\xADvide our startup se\\xADquence into small chunks it would be some\\xADthing like:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"startBackend(\\n (connection) -\u003e createSomeData(connection,\\n     (nothing) -\u003e startWebApp(\\n         (http) -\u003e completeStartup(http, fut)\\n     ), fut\\n ), fut);\\n\")), mdx(\"p\", null, \"with:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"startBackend\"), \" - re\\xADtrieves a \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"SQLConnection\"), \" and then calls the next step\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"createSomeData\"), \" - ini\\xADtial\\xADizes the data\\xADbase and in\\xADserts some data. When done, it calls the next step\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"startWebApp\"), \" - starts our web ap\\xADpli\\xADca\\xADtion\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"completeStartup\"), \" - fi\\xADnal\\xADizes our start se\\xADquence\")), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fut\"), \" is the com\\xADple\\xADtion fu\\xADture passed by vert.x that let us re\\xADport when we are started, or if an issue has been en\\xADcoun\\xADtered while start\\xADing.\"), mdx(\"p\", null, \"Let\\u2019s have a look to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"startBackend\"), \":\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"private\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"void\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"startBackend\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(Handler\u003cAsyncResult\u003cSQLConnection\u003e\u003e next, Future\u003cVoid\u003e fut)\"), \" \"), \"{\\n  jdbc.getConnection(ar -\u003e {\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"if\"), \" (ar.failed()) {\\n      fut.fail(ar.cause());\\n    } \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"else\"), \" {\\n      next.handle(Future.succeededFuture(ar.result()));\\n    }\\n  });\\n}\\n\")), mdx(\"p\", null, \"This method re\\xADtrieves a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SQLConnection\"), \", check whether this op\\xADer\\xADa\\xADtion suc\\xADceeded. If so, it calls the next step. In case of fail\\xADure, it re\\xADports it.\"), mdx(\"p\", null, \"The other meth\\xADods fol\\xADlow the same pat\\xADtern: 1) check if the last op\\xADer\\xADa\\xADtion has suc\\xADceeded, 2) do the task, 3) call the next step.\"), mdx(\"h3\", {\n    \"id\": \"a-bit-of-sql\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#a-bit-of-sql\"\n  })), \"A bit of SQL\\u2026\"), mdx(\"p\", null, \"Our client is ready, let\\u2019s now write some SQL state\\xADments. Let\\u2019s start by the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"createSomeData\"), \" method that is part of the startup se\\xADquence:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"private\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"void\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"createSomeData\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(AsyncResult\u003cSQLConnection\u003e result,\\n    Handler\u003cAsyncResult\u003cVoid\u003e\u003e next, Future\u003cVoid\u003e fut)\"), \" \"), \"{\\n    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"if\"), \" (result.failed()) {\\n      fut.fail(result.cause());\\n    } \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"else\"), \" {\\n      SQLConnection connection = result.result();\\n      connection.execute(\\n          \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"CREATE TABLE IF NOT EXISTS Whisky (id INTEGER IDENTITY, name varchar(100), \\\"\"), \" +\\n          \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"origin varchar(100))\\\"\"), \",\\n          ar -\u003e {\\n            \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"if\"), \" (ar.failed()) {\\n              fut.fail(ar.cause());\\n              connection.close();\\n              \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"return\"), \";\\n            }\\n            connection.query(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"SELECT * FROM Whisky\\\"\"), \", select -\u003e {\\n              \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"if\"), \" (select.failed()) {\\n                fut.fail(ar.cause());\\n                connection.close();\\n                \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"return\"), \";\\n              }\\n              \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"if\"), \" (select.result().getNumRows() == \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"0\"), \") {\\n                insert(\\n                    \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" Whisky(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Bowmore 15 Years Laimrig\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Scotland, Islay\\\"\"), \"),\\n                    connection,\\n                    (v) -\u003e insert(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" Whisky(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Talisker 57\\xB0 North\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Scotland, Island\\\"\"), \"),\\n                        connection,\\n                        (r) -\u003e {\\n                          next.handle(Future.\u003cVoid\u003esucceededFuture());\\n                          connection.close();\\n                        }));                                                    \\n              } \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"else\"), \" {\\n                next.handle(Future.\u003cVoid\u003esucceededFuture());\\n                connection.close();\\n              }\\n            });\\n          });\\n    }\\n  }\\n\")), mdx(\"p\", null, \"This method checks that the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SQLConnection\"), \" is avail\\xADable and then start ex\\xADe\\xADcut\\xADing some SQL state\\xADments. First, it cre\\xADates the ta\\xADbles if there are not there yet. As you can see, the method called is struc\\xADtured as fol\\xADlows:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"connection.execute(\\n    SQL statement,\\n    handler called when the statement has been executed\\n)\\n\")), mdx(\"p\", null, \"The han\\xADdler re\\xADceives an \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"AsyncResult\u003cVoid\u003e\"), \", \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"i.e.\"), \" a no\\xADti\\xADfi\\xADca\\xADtion of the com\\xADple\\xADtion with\\xADout an ac\\xADtual re\\xADsult.\"), mdx(Alert, {\n    info: true,\n    title: \"Closing connection\",\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"Don\\u2019t for\\xADget to close the SQL con\\xADnec\\xADtion when you are done. The con\\xADnec\\xADtion will be given back to the con\\xADnec\\xADtion pool and be reused.\")), mdx(\"p\", null, \"In the code of this han\\xADdler, we check whether or not the state\\xADment has been ex\\xADe\\xADcuted cor\\xADrectly, and if so we check to see if the table al\\xADready con\\xADtains some data, if not, it in\\xADserts data using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"insert\"), \" method:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"private\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"void\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"insert\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(Whisky whisky, SQLConnection connection, Handler\u003cAsyncResult\u003cWhisky\u003e\u003e next)\"), \" \"), \"{\\n  String sql = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"INSERT INTO Whisky (name, origin) VALUES ?, ?\\\"\"), \";\\n  connection.updateWithParams(sql,\\n      \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" JsonArray().add(whisky.getName()).add(whisky.getOrigin()),\\n      (ar) -\u003e {\\n        \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"if\"), \" (ar.failed()) {\\n          next.handle(Future.failedFuture(ar.cause()));\\n          \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"return\"), \";\\n        }\\n        UpdateResult result = ar.result();\\n        \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Build a new whisky instance with the generated id.\"), \"\\n        Whisky w = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" Whisky(result.getKeys().getInteger(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"0\"), \"), whisky.getName(), whisky.getOrigin());\\n        next.handle(Future.succeededFuture(w));\\n      });\\n}\\n\")), mdx(\"p\", null, \"This method uses the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"updateWithParams\"), \" method with an \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"IN\\xADSERT\"), \" state\\xADment, and pass val\\xADues. This ap\\xADproach avoids SQL in\\xADjec\\xADtion. Once the the state\\xADment has been ex\\xADe\\xADcuted, we cre\\xADates a new \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Whisky\"), \" ob\\xADject with the cre\\xADated (auto-\\u200Bgenerated) id.\"), mdx(\"h2\", {\n    \"id\": \"some-rest-with-a-pinch-of-sql\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#some-rest-with-a-pinch-of-sql\"\n  })), \"Some REST with a pinch of SQL\"), mdx(\"p\", null, \"The method de\\xADscribed  above is part of our start se\\xADquence. But what about the method in\\xADvoked by our REST API. Let\\u2019s have a look to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getAll\"), \" method. This method is called by the web front-\\u200Bend to re\\xADtrieve all stored prod\\xADucts:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \" \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"private\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"void\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"getAll\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(RoutingContext routingContext)\"), \" \"), \"{\\n    jdbc.getConnection(ar -\u003e {\\n      SQLConnection connection = ar.result();\\n      connection.query(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"SELECT * FROM Whisky\\\"\"), \", result -\u003e {\\n        List\u003cWhisky\u003e whiskies = result.result().getRows().stream().map(Whisky::\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \").collect(Collectors.toList());\\n        routingContext.response()\\n            .putHeader(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"content-type\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"application/json; charset=utf-8\\\"\"), \")\\n            .end(Json.encodePrettily(whiskies));\\n        connection.close(); \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Close the connection     \"), \"\\n      });\\n    });\\n  }\\n\")), mdx(\"p\", null, \"This method gets a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"SQLConnection\"), \", and then issue a query. Once the re\\xADsult has been re\\xADtrieved it writes the HTTP re\\xADsponse as be\\xADfore. The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getOne\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"deleteOne\"), \", \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"updateOne\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"addOne\"), \" meth\\xADods fol\\xADlow the same pat\\xADtern. No\\xADtice that the con\\xADnec\\xADtion can be closed after the re\\xADsponse has been writ\\xADten.\"), mdx(\"p\", null, \"Let\\u2019s have a look to the re\\xADsult pro\\xADvided to the han\\xADdler passed to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"query\"), \" method. It gets a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ResultSet\"), \", which con\\xADtains the query re\\xADsult. Each row is a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JsonObject\"), \", so if your data ob\\xADject has a con\\xADstruc\\xADtor tak\\xADing a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JsonObject\"), \" as unique ar\\xADgu\\xADment, cre\\xADat\\xADing there ob\\xADjects is straight\\xADfor\\xADward.\"), mdx(\"h2\", {\n    \"id\": \"test-test-and-test-again\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#test-test-and-test-again\"\n  })), \"Test, test, and test again\"), mdx(\"p\", null, \"We need to slightly up\\xADdate our tests to con\\xADfig\\xADure the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JDBCClient\"), \". In the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MyFirstVertilceTest\"), \" class, change the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DeploymentOption\"), \" ob\\xADject cre\\xADated in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"setUp\"), \" method to be:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"DeploymentOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" DeploymentOptions()\\n    .setConfig(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" JsonObject()\\n        .put(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"http.port\\\"\"), \", port)\\n        .put(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"url\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"jdbc:hsqldb:mem:test?shutdown=true\\\"\"), \")\\n        .put(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"driver_class\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"org.hsqldb.jdbcDriver\\\"\"), \")\\n    );\\n\")), mdx(\"p\", null, \"In ad\\xADdi\\xADtion to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http.port\"), \", we also put the JDBC url and the class of the JDBC dri\\xADver. We use an in-\\u200Bmemory data\\xADbase for tests.\"), mdx(\"p\", null, \"The same mod\\xADi\\xADfi\\xADca\\xADtion needs to be done in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/test/resources/my-it-config.json\"), \" file:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-json\"\n  }), \"{\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"http.port\\\"\"), \": ${http.port},\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"url\\\"\"), \": \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"jdbc:hsqldb:mem:it-test?shutdown=true\\\"\"), \",\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"driver_class\\\"\"), \": \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"org.hsqldb.jdbcDriver\\\"\"), \"\\n}\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/conf/my-application-conf.json\"), \" file also needs to be up\\xADdated, not for the tests, but to run the ap\\xADpli\\xADca\\xADtion:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-json\"\n  }), \"{\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"http.port\\\"\"), \" : \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8082\"), \",\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"url\\\"\"), \": \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"jdbc:hsqldb:file:db/whiskies\\\"\"), \",\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attr\"\n  }), \"\\\"driver_class\\\"\"), \": \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"org.hsqldb.jdbcDriver\\\"\"), \"\\n}\\n\")), mdx(\"p\", null, \"The JDBC url is a bit dif\\xADfer\\xADent in this last file, as we store the data\\xADbase on the file sys\\xADtem.\"), mdx(\"h2\", {\n    \"id\": \"show-time\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#show-time\"\n  })), \"Show time!\"), mdx(\"p\", null, \"Let\\u2019s now build our ap\\xADpli\\xADca\\xADtion:\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"mvn clean package\")), mdx(\"p\", null, \"As we didn\\u2019t change the API (nei\\xADther the pub\\xADlic java one nor the REST), test should run smoothly.\"), mdx(\"p\", null, \"Then launch the ap\\xADpli\\xADca\\xADtion with:\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"java -jar target/my-first-app-1.0-SNAPSHOT-fat.jar -conf src/main/conf/my-application-conf.json \")), mdx(\"p\", null, \"Open your browser to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:8082/assets/index.html\"), \", and you should see the ap\\xADpli\\xADca\\xADtion using the data\\xADbase. This time the prod\\xADucts are stored in a data\\xADbase per\\xADsisted on the file sys\\xADtem. So, if we stop and restart the ap\\xADpli\\xADca\\xADtion, the data is re\\xADstored.\"), mdx(\"h2\", {\n    \"id\": \"conclusion\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#conclusion\"\n  })), \"Conclusion\"), mdx(\"p\", null, \"In this post, we saw how you can use JDBC data\\xADbase with vert.x, and thus with\\xADout too much bur\\xADden. You may have been sur\\xADprised by the asyn\\xADchro\\xADnous de\\xADvel\\xADop\\xADment model, but once you start using it, it\\u2019s hard to come back.\"), mdx(\"p\", null, \"In the \", mdx(Link, {\n    href: \"/blog/combine-vert-x-and-mongo-to-build-a-giant/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"next post\")), \", we see how the same ap\\xADpli\\xADca\\xADtion can use Mon\\xADgoDB in\\xADstead of HSQL.\"), mdx(\"p\", null, \"Stay tuned, and happy cod\\xADing!\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003cp\u003eFi­nally, back… This post is the fifth post of the in­tro­duc­tion to vert.x blog se­ries, after a not-​that-small break. In this post we are going to see how we can use JDBC in a vert.x ap­pli­ca­tion, and this, using the asyn­chro­nous API pro­vided by the \u003ca href=\"/docs/vertx-jdbc-client/java/\"\u003evertx-​jdbc-client\u003c/a\u003e.\u003c/p\u003e\u003ch2 id=\"previously-in-the-introduction-to-vertx-series\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#previously-in-the-introduction-to-vertx-series\"\u003e\u003c/a\u003ePreviously in the introduction to vert.x series\u003c/h2\u003e\u003cp\u003eAs it was quite some time since the last post, let’s start by re­fresh­ing our mind about the four pre­vi­ous posts:\u003c/p\u003e\u003col\u003e\u003cli\u003eThe \u003ca href=\"/blog/my-first-vert-x-3-application/\"\u003efirst post\u003c/a\u003e has de­scribed how to build a vert.x ap­pli­ca­tion with Maven and ex­e­cute unit tests.\u003c/li\u003e\u003cli\u003eThe \u003ca href=\"/blog/vert-x-application-configuration/\"\u003esec­ond post\u003c/a\u003e has de­scribed how this ap­pli­ca­tion can be­come con­fig­urable.\u003c/li\u003e\u003cli\u003eThe \u003ca href=\"/blog/some-rest-with-vert-x/\"\u003ethird post\u003c/a\u003e has in­tro­duced \u003ca href=\"/docs/vertx-web/java/\"\u003evertx-​web\u003c/a\u003e, and a small col­lec­tion man­age­ment ap­pli­ca­tion has been de­vel­oped. This ap­pli­ca­tion of­fers a REST API used by a HTML/JavaScript fron­tend.\u003c/li\u003e\u003cli\u003eThe \u003ca href=\"/blog/unit-and-integration-tests/\"\u003epre­vi­ous post\u003c/a\u003e has pre­sented how you can run in­te­gra­tion tests to en­sure the be­hav­ior of your ap­pli­ca­tion.\u003c/li\u003e\u003c/ol\u003e\u003cp\u003eIn this post, back to code. The cur­rent ap­pli­ca­tion uses an in-​memory map to store the prod­ucts. It’s time to use a data­base. In this post we are going to use \u003ca href=\"http://hsqldb.org/\"\u003eHSQL\u003c/a\u003e, but you can use any data­base pro­vid­ing a JDBC dri­ver. In­ter­ac­tions with the data­base will be asyn­chro­nous and made using the \u003ca href=\"/docs/vertx-jdbc-client/java/\"\u003evertx-​jdbc-client\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eThe code of this post are avail­able on this Github \u003ca href=\"https://github.com/cescoffier/my-vertx-first-app\"\u003eproject\u003c/a\u003e, in the \u003ca href=\"https://github.com/cescoffier/my-vertx-first-app/tree/post-5\"\u003epost-5 branch\u003c/a\u003e branch.\u003c/p\u003e\u003ch2 id=\"asynchronous\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#asynchronous\"\u003e\u003c/a\u003eAsynchronous?\u003c/h2\u003e\u003cp\u003eOne of the vert.x char­ac­ter­is­tics is being asyn­chro­nous. With an asyn­chro­nous API, you don’t wait for a re­sult, but you are no­ti­fied when this re­sult is ready. Just to il­lus­trate this, let’s take a very sim­ple ex­am­ple.\u003c/p\u003e\u003cp\u003eLet’s imag­ine an \u003ccode\u003eadd\u003c/code\u003e method. Tra­di­tion­ally, you would use it like this: \u003ccode\u003eint r = add(1, 1)\u003c/code\u003e. This is a syn­chro­nous API as you are wait­ing for the re­sult. An asyn­chro­nous ver­sion of this API would be: \u003ccode\u003eadd(1, 1, r -\u0026gt; { /* do something with the result */ })\u003c/code\u003e. In this ver­sion, you pass a \u003ccode\u003eHandler\u003c/code\u003e called when the re­sult has been com­puted. The method does not re­turn any­thing, and could be im­ple­mented as:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eadd\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e a, \u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e b, Handler\u0026lt;Integer\u0026gt; resultHandler)\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e r = a + b;\n    resultHandler.handle(r);\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eJust to avoid mis­con­cep­tions, asyn­chro­nous API are not about threads. As we can see in the \u003ccode\u003eadd\u003c/code\u003e ex­am­ple, there are no threads in­volved.\u003c/p\u003e\u003ch2 id=\"jdbc-yes-but-asynchronous\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#jdbc-yes-but-asynchronous\"\u003e\u003c/a\u003eJDBC yes, but asynchronous\u003c/h2\u003e\u003cp\u003eSo, now that we have seen some ba­sics about asyn­chro­nous API, let’s have a look to the vertx-​jdbc-client. This com­po­nent lets us in­ter­act with a data­base through a JDBC dri­ver. These in­ter­ac­tions are asyn­chro­nous, so when you were doing:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003eString sql = \u003cspan class=\"hljs-string\"\u003e\u0026quot;SELECT * FROM Products\u0026quot;\u003c/span\u003e;\nResultSet rs = stmt.executeQuery(sql);\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eit will be:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003econnection.query(\u003cspan class=\"hljs-string\"\u003e\u0026quot;SELECT * FROM Products\u0026quot;\u003c/span\u003e, result -\u0026gt; {\n        \u003cspan class=\"hljs-comment\"\u003e// do something with the result\u003c/span\u003e\n});\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis model is more ef­fi­cient as it avoids wait­ing for the re­sult. You are no­ti­fied when the re­sult is avail­able.\u003c/p\u003e\u003cp\u003eLet’s now mod­ify our ap­pli­ca­tion to use a data­base to store our prod­ucts.\u003c/p\u003e\u003ch2 id=\"some-maven-dependencies\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#some-maven-dependencies\"\u003e\u003c/a\u003eSome maven dependencies\u003c/h2\u003e\u003cp\u003eThe first things we need to do it to de­clare two new Maven de­pen­den­cies in our \u003ccode\u003epom.xml\u003c/code\u003e file:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-jdbc-client\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e3.1.0\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eorg.hsqldb\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003ehsqldb\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e2.3.3\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe first de­pen­dency pro­vides the vertx-​jdbc-client, while the sec­ond one pro­vide the HSQL JDBC dri­ver. If you want to use an­other data­base, change this de­pen­dency. You will also need to change the JDBC url and JDBC dri­ver class name later.\u003c/p\u003e\u003ch2 id=\"initializing-the-jdbc-client\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#initializing-the-jdbc-client\"\u003e\u003c/a\u003eInitializing the JDBC client\u003c/h2\u003e\u003cp\u003eNow that we have added these de­pen­den­cies, it’s time to cre­ate our JDBC client:\u003c/p\u003e\u003cp\u003eIn the \u003ccode\u003eMyFirstVerticle\u003c/code\u003e class, de­clare a new field \u003ccode\u003eJDBCClient jdbc;\u003c/code\u003e, and add the fol­low­ing line at the be­gin­ning of the \u003ccode\u003estart\u003c/code\u003e method:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003ejdbc = JDBCClient.createShared(vertx, config(), \u003cspan class=\"hljs-string\"\u003e\u0026quot;My-Whisky-Collection\u0026quot;\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis cre­ates an in­stance of JDBC client, con­fig­ured with the con­fig­u­ra­tion pro­vided to the ver­ti­cle. To work cor­rectly this con­fig­u­ra­tion needs to pro­vide:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003cem\u003eurl\u003c/em\u003e - the JDBC url such as \u003ccode\u003ejdbc:hsqldb:mem:db?shutdown=true\u003c/code\u003e\u003c/li\u003e\u003cli\u003e\u003cem\u003edri­ver_class\u003c/em\u003e - the JDBC dri­ver class such as \u003ccode\u003eorg.hsqldb.jdbcDriver\u003c/code\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eOk, we have the client, we need a con­nec­tion to the data­base. This is achieved using the \u003ccode\u003ejdbc.getConnection\u003c/code\u003e that take a \u003ccode\u003eHandler\u0026lt;AsyncResult\u0026lt;SQLConnection\u0026gt;\u0026gt;\u003c/code\u003e as pa­ra­me­ter. Let’s have a deeper look to this type. It’s a \u003ccode\u003eHandler\u003c/code\u003e, so it is called when the re­sult is ready. This re­sult is an in­stance of \u003ccode\u003eAsyncResult\u0026lt;SQLConnection\u0026gt;\u003c/code\u003e. \u003ccode\u003eAsyncResult\u003c/code\u003e is a struc­ture pro­vided by vert.x that lets us know if the op­er­a­tion was com­pleted suc­cess­fully or failed. In case of suc­cess, it pro­vides the re­sult, here an in­stance of \u003ccode\u003eSQLConnection\u003c/code\u003e.\u003c/p\u003e\u003cp\u003eWhen you re­ceive an in­stance of \u003ccode\u003eAsyncResult\u003c/code\u003e, your code gen­er­ally looks like:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.failed()) {\n  System.err.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;The operation has failed...: \u0026quot;\u003c/span\u003e\n      + ar.cause().getMessage());\n} \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n  \u003cspan class=\"hljs-comment\"\u003e// Use the result:\u003c/span\u003e\n  result = ar.result();\n }\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eSo, let’s go back to our \u003ccode\u003eSQLConnection\u003c/code\u003e. We need to re­trieve it, and then start the rest of the ap­pli­ca­tion. This changes how we start the ap­pli­ca­tion, as it will be­come asyn­chro­nous. So, if we di­vide our startup se­quence into small chunks it would be some­thing like:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003estartBackend(\n (connection) -\u0026gt; createSomeData(connection,\n     (nothing) -\u0026gt; startWebApp(\n         (http) -\u0026gt; completeStartup(http, fut)\n     ), fut\n ), fut);\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ewith:\u003c/p\u003e\u003col\u003e\u003cli\u003e\u003ccode\u003estartBackend\u003c/code\u003e - re­trieves a \u003ccode\u003eSQLConnection\u003c/code\u003e and then calls the next step\u003c/li\u003e\u003cli\u003e\u003ccode\u003ecreateSomeData\u003c/code\u003e - ini­tial­izes the data­base and in­serts some data. When done, it calls the next step\u003c/li\u003e\u003cli\u003e\u003ccode\u003estartWebApp\u003c/code\u003e - starts our web ap­pli­ca­tion\u003c/li\u003e\u003cli\u003e\u003ccode\u003ecompleteStartup\u003c/code\u003e - fi­nal­izes our start se­quence\u003c/li\u003e\u003c/ol\u003e\u003cp\u003e\u003ccode\u003efut\u003c/code\u003e is the com­ple­tion fu­ture passed by vert.x that let us re­port when we are started, or if an issue has been en­coun­tered while start­ing.\u003c/p\u003e\u003cp\u003eLet’s have a look to \u003ccode\u003estartBackend\u003c/code\u003e:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003estartBackend\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(Handler\u0026lt;AsyncResult\u0026lt;SQLConnection\u0026gt;\u0026gt; next, Future\u0026lt;Void\u0026gt; fut)\u003c/span\u003e \u003c/span\u003e{\n  jdbc.getConnection(ar -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.failed()) {\n      fut.fail(ar.cause());\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      next.handle(Future.succeededFuture(ar.result()));\n    }\n  });\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis method re­trieves a \u003ccode\u003eSQLConnection\u003c/code\u003e, check whether this op­er­a­tion suc­ceeded. If so, it calls the next step. In case of fail­ure, it re­ports it.\u003c/p\u003e\u003cp\u003eThe other meth­ods fol­low the same pat­tern: 1) check if the last op­er­a­tion has suc­ceeded, 2) do the task, 3) call the next step.\u003c/p\u003e\u003ch3 id=\"a-bit-of-sql\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#a-bit-of-sql\"\u003e\u003c/a\u003eA bit of SQL…\u003c/h3\u003e\u003cp\u003eOur client is ready, let’s now write some SQL state­ments. Let’s start by the \u003ccode\u003ecreateSomeData\u003c/code\u003e method that is part of the startup se­quence:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003ecreateSomeData\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(AsyncResult\u0026lt;SQLConnection\u0026gt; result,\n    Handler\u0026lt;AsyncResult\u0026lt;Void\u0026gt;\u0026gt; next, Future\u0026lt;Void\u0026gt; fut)\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (result.failed()) {\n      fut.fail(result.cause());\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      SQLConnection connection = result.result();\n      connection.execute(\n          \u003cspan class=\"hljs-string\"\u003e\u0026quot;CREATE TABLE IF NOT EXISTS Whisky (id INTEGER IDENTITY, name varchar(100), \u0026quot;\u003c/span\u003e +\n          \u003cspan class=\"hljs-string\"\u003e\u0026quot;origin varchar(100))\u0026quot;\u003c/span\u003e,\n          ar -\u0026gt; {\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.failed()) {\n              fut.fail(ar.cause());\n              connection.close();\n              \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e;\n            }\n            connection.query(\u003cspan class=\"hljs-string\"\u003e\u0026quot;SELECT * FROM Whisky\u0026quot;\u003c/span\u003e, select -\u0026gt; {\n              \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (select.failed()) {\n                fut.fail(ar.cause());\n                connection.close();\n                \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e;\n              }\n              \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (select.result().getNumRows() == \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) {\n                insert(\n                    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e Whisky(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Bowmore 15 Years Laimrig\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Scotland, Islay\u0026quot;\u003c/span\u003e),\n                    connection,\n                    (v) -\u0026gt; insert(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e Whisky(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Talisker 57° North\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Scotland, Island\u0026quot;\u003c/span\u003e),\n                        connection,\n                        (r) -\u0026gt; {\n                          next.handle(Future.\u0026lt;Void\u0026gt;succeededFuture());\n                          connection.close();\n                        }));                                                    \n              } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n                next.handle(Future.\u0026lt;Void\u0026gt;succeededFuture());\n                connection.close();\n              }\n            });\n          });\n    }\n  }\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis method checks that the \u003ccode\u003eSQLConnection\u003c/code\u003e is avail­able and then start ex­e­cut­ing some SQL state­ments. First, it cre­ates the ta­bles if there are not there yet. As you can see, the method called is struc­tured as fol­lows:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003econnection.execute(\n    SQL statement,\n    handler called when the statement has been executed\n)\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe han­dler re­ceives an \u003ccode\u003eAsyncResult\u0026lt;Void\u0026gt;\u003c/code\u003e, \u003cem\u003ei.e.\u003c/em\u003e a no­ti­fi­ca­tion of the com­ple­tion with­out an ac­tual re­sult.\u003c/p\u003e\u003cdiv class=\"alert info\"\u003e\u003cdiv class=\"alert-title\"\u003eClosing connection\u003c/div\u003e\u003cp\u003eDon’t for­get to close the SQL con­nec­tion when you are done. The con­nec­tion will be given back to the con­nec­tion pool and be reused.\u003c/p\u003e\u003c/div\u003e\u003cp\u003eIn the code of this han­dler, we check whether or not the state­ment has been ex­e­cuted cor­rectly, and if so we check to see if the table al­ready con­tains some data, if not, it in­serts data using the \u003ccode\u003einsert\u003c/code\u003e method:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003einsert\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(Whisky whisky, SQLConnection connection, Handler\u0026lt;AsyncResult\u0026lt;Whisky\u0026gt;\u0026gt; next)\u003c/span\u003e \u003c/span\u003e{\n  String sql = \u003cspan class=\"hljs-string\"\u003e\u0026quot;INSERT INTO Whisky (name, origin) VALUES ?, ?\u0026quot;\u003c/span\u003e;\n  connection.updateWithParams(sql,\n      \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonArray().add(whisky.getName()).add(whisky.getOrigin()),\n      (ar) -\u0026gt; {\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.failed()) {\n          next.handle(Future.failedFuture(ar.cause()));\n          \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e;\n        }\n        UpdateResult result = ar.result();\n        \u003cspan class=\"hljs-comment\"\u003e// Build a new whisky instance with the generated id.\u003c/span\u003e\n        Whisky w = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e Whisky(result.getKeys().getInteger(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e), whisky.getName(), whisky.getOrigin());\n        next.handle(Future.succeededFuture(w));\n      });\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis method uses the \u003ccode\u003eupdateWithParams\u003c/code\u003e method with an \u003cem\u003eIN­SERT\u003c/em\u003e state­ment, and pass val­ues. This ap­proach avoids SQL in­jec­tion. Once the the state­ment has been ex­e­cuted, we cre­ates a new \u003ccode\u003eWhisky\u003c/code\u003e ob­ject with the cre­ated (auto-​generated) id.\u003c/p\u003e\u003ch2 id=\"some-rest-with-a-pinch-of-sql\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#some-rest-with-a-pinch-of-sql\"\u003e\u003c/a\u003eSome REST with a pinch of SQL\u003c/h2\u003e\u003cp\u003eThe method de­scribed  above is part of our start se­quence. But what about the method in­voked by our REST API. Let’s have a look to the \u003ccode\u003egetAll\u003c/code\u003e method. This method is called by the web front-​end to re­trieve all stored prod­ucts:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003egetAll\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(RoutingContext routingContext)\u003c/span\u003e \u003c/span\u003e{\n    jdbc.getConnection(ar -\u0026gt; {\n      SQLConnection connection = ar.result();\n      connection.query(\u003cspan class=\"hljs-string\"\u003e\u0026quot;SELECT * FROM Whisky\u0026quot;\u003c/span\u003e, result -\u0026gt; {\n        List\u0026lt;Whisky\u0026gt; whiskies = result.result().getRows().stream().map(Whisky::\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e).collect(Collectors.toList());\n        routingContext.response()\n            .putHeader(\u003cspan class=\"hljs-string\"\u003e\u0026quot;content-type\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json; charset=utf-8\u0026quot;\u003c/span\u003e)\n            .end(Json.encodePrettily(whiskies));\n        connection.close(); \u003cspan class=\"hljs-comment\"\u003e// Close the connection     \u003c/span\u003e\n      });\n    });\n  }\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis method gets a \u003ccode\u003eSQLConnection\u003c/code\u003e, and then issue a query. Once the re­sult has been re­trieved it writes the HTTP re­sponse as be­fore. The \u003ccode\u003egetOne\u003c/code\u003e, \u003ccode\u003edeleteOne\u003c/code\u003e, \u003ccode\u003eupdateOne\u003c/code\u003e and \u003ccode\u003eaddOne\u003c/code\u003e meth­ods fol­low the same pat­tern. No­tice that the con­nec­tion can be closed after the re­sponse has been writ­ten.\u003c/p\u003e\u003cp\u003eLet’s have a look to the re­sult pro­vided to the han­dler passed to the \u003ccode\u003equery\u003c/code\u003e method. It gets a \u003ccode\u003eResultSet\u003c/code\u003e, which con­tains the query re­sult. Each row is a \u003ccode\u003eJsonObject\u003c/code\u003e, so if your data ob­ject has a con­struc­tor tak­ing a \u003ccode\u003eJsonObject\u003c/code\u003e as unique ar­gu­ment, cre­at­ing there ob­jects is straight­for­ward.\u003c/p\u003e\u003ch2 id=\"test-test-and-test-again\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#test-test-and-test-again\"\u003e\u003c/a\u003eTest, test, and test again\u003c/h2\u003e\u003cp\u003eWe need to slightly up­date our tests to con­fig­ure the \u003ccode\u003eJDBCClient\u003c/code\u003e. In the \u003ccode\u003eMyFirstVertilceTest\u003c/code\u003e class, change the \u003ccode\u003eDeploymentOption\u003c/code\u003e ob­ject cre­ated in the \u003ccode\u003esetUp\u003c/code\u003e method to be:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003eDeploymentOptions options = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e DeploymentOptions()\n    .setConfig(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonObject()\n        .put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;http.port\u0026quot;\u003c/span\u003e, port)\n        .put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;url\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;jdbc:hsqldb:mem:test?shutdown=true\u0026quot;\u003c/span\u003e)\n        .put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;driver_class\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;org.hsqldb.jdbcDriver\u0026quot;\u003c/span\u003e)\n    );\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIn ad­di­tion to the \u003ccode\u003ehttp.port\u003c/code\u003e, we also put the JDBC url and the class of the JDBC dri­ver. We use an in-​memory data­base for tests.\u003c/p\u003e\u003cp\u003eThe same mod­i­fi­ca­tion needs to be done in the \u003ccode\u003esrc/test/resources/my-it-config.json\u003c/code\u003e file:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-json\"\u003e{\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;http.port\u0026quot;\u003c/span\u003e: ${http.port},\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;url\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;jdbc:hsqldb:mem:it-test?shutdown=true\u0026quot;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;driver_class\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;org.hsqldb.jdbcDriver\u0026quot;\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe \u003ccode\u003esrc/main/conf/my-application-conf.json\u003c/code\u003e file also needs to be up­dated, not for the tests, but to run the ap­pli­ca­tion:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-json\"\u003e{\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;http.port\u0026quot;\u003c/span\u003e : \u003cspan class=\"hljs-number\"\u003e8082\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;url\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;jdbc:hsqldb:file:db/whiskies\u0026quot;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;driver_class\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;org.hsqldb.jdbcDriver\u0026quot;\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe JDBC url is a bit dif­fer­ent in this last file, as we store the data­base on the file sys­tem.\u003c/p\u003e\u003ch2 id=\"show-time\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#show-time\"\u003e\u003c/a\u003eShow time!\u003c/h2\u003e\u003cp\u003eLet’s now build our ap­pli­ca­tion:\u003c/p\u003e\u003cp\u003e\u003ccode\u003emvn clean package\u003c/code\u003e\u003c/p\u003e\u003cp\u003eAs we didn’t change the API (nei­ther the pub­lic java one nor the REST), test should run smoothly.\u003c/p\u003e\u003cp\u003eThen launch the ap­pli­ca­tion with:\u003c/p\u003e\u003cp\u003e\u003ccode\u003ejava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar -conf src/main/conf/my-application-conf.json \u003c/code\u003e\u003c/p\u003e\u003cp\u003eOpen your browser to \u003ccode\u003ehttp://localhost:8082/assets/index.html\u003c/code\u003e, and you should see the ap­pli­ca­tion using the data­base. This time the prod­ucts are stored in a data­base per­sisted on the file sys­tem. So, if we stop and restart the ap­pli­ca­tion, the data is re­stored.\u003c/p\u003e\u003ch2 id=\"conclusion\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#conclusion\"\u003e\u003c/a\u003eConclusion\u003c/h2\u003e\u003cp\u003eIn this post, we saw how you can use JDBC data­base with vert.x, and thus with­out too much bur­den. You may have been sur­prised by the asyn­chro­nous de­vel­op­ment model, but once you start using it, it’s hard to come back.\u003c/p\u003e\u003cp\u003eIn the \u003ca href=\"/blog/combine-vert-x-and-mongo-to-build-a-giant/\"\u003enext post\u003c/a\u003e, we see how the same ap­pli­ca­tion can use Mon­goDB in­stead of HSQL.\u003c/p\u003e\u003cp\u003eStay tuned, and happy cod­ing!\u003c/p\u003e","scope":{}}},"prevPost":{"meta":{"title":"Vert.x ES6 back to the future","category":"guides","authors":[{"name":"Paulo Lopes","github_id":"pmlopes"}],"summary":"On October 21th, 2015 we all rejoiced with the return from the past of Marty McFly with his flying car and so on, however in the Vert.x world we were quite sad about our rather old JavaScript support."},"date":"2015-11-25","slug":"vert-x-es6-back-to-the-future"},"nextPost":{"meta":{"title":"Vert.x 3.1.0 is released!","category":"releases","authors":[{"name":"Tim Fox","github_id":"purplefox"}],"summary":"I'm pleased to announce the release of Vert.x 3.1!"},"date":"2015-10-08","slug":"vert-x-3-1-0-is-released"},"relatedPosts":[{"meta":{"title":"Unit and Integration Tests","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"Let’s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn’t test the API."},"date":"2015-08-03","slug":"unit-and-integration-tests"},{"meta":{"title":"Combine vert.x and mongo to build a giant","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"This blog post is part of the introduction to Vert.x series. We are now going to replace this JDBC client by the vertx-mongo-client, and thus connect to a Mongo database."},"date":"2015-11-30","slug":"combine-vert-x-and-mongo-to-build-a-giant"},{"meta":{"title":"My first Vert.x 3 Application","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"Let's say, you heard someone saying that Vert.x is awesome. Ok great, but you may want to try it by yourself. Well, the next natural question is “where do I start ?”"},"date":"2015-07-14","slug":"my-first-vert-x-3-application"}]},"__N_SSG":true},"page":"/blog/[[...slug]]","query":{"slug":["using-the-asynchronous-sql-client"]},"buildId":"YA6bhIGJpm-I-TcGw6x8Z","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-9a5c89434732593ca2fd.js"></script><script src="/_next/static/chunks/main-b6e20584df76f29b6f35.js" async=""></script><script src="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" async=""></script><script src="/_next/static/chunks/framework.fcef98db13e2318579fb.js" async=""></script><script src="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" async=""></script><script src="/_next/static/chunks/styles.7064a0f84b2a7c13404a.js" async=""></script><script src="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" async=""></script><script src="/_next/static/chunks/5df0631eea625b022d3730b3f1bf573e1b8deb37.2c5d42edba8dda0b0ba3.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-ff5b3ed8f1ab05c5e7a9.js" async=""></script><script src="/_next/static/YA6bhIGJpm-I-TcGw6x8Z/_buildManifest.js" async=""></script><script src="/_next/static/YA6bhIGJpm-I-TcGw6x8Z/_ssgManifest.js" async=""></script></body></html>