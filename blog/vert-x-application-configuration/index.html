<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><link rel="alternate" type="application/rss+xml" href="/feed/rss.xml"/><link rel="alternate" type="application/atom+xml" href="/feed/atom.xml"/><link rel="alternate" type="application/json" href="/feed/feed.json"/><title>Vert.x Application Configuration | 博客 | Eclipse Vert.x</title><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/styles.bee17d6f.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.bee17d6f.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-b6e20584df76f29b6f35.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.fcef98db13e2318579fb.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.7064a0f84b2a7c13404a.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" as="script"/><link rel="preload" href="/_next/static/chunks/5df0631eea625b022d3730b3f1bf573e1b8deb37.2c5d42edba8dda0b0ba3.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-ff5b3ed8f1ab05c5e7a9.js" as="script"/></head><body data-build-time="2021-06-04T00:59:14.583Z" data-build-commit-id="2f3f5b4a59c83f4d94a6fff033b920bbac528a2a" data-build-run-id="904703094"><div id="__next"><main class="page"><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMjMyLjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3ptNDE0LTI2Ni45aC0xNS4zdjQyLjJoLTguNVY2LjloLTE1LjJWMGgzOXY2Ljl6TTExOTMgMGwxNC4yIDM3LjdMMTIyMS4zIDBoMTF2NDkuMWgtOC41VjMyLjlsLjgtMjEuNy0xNC41IDM3LjloLTYuMWwtMTQuNS0zNy44LjggMjEuNnYxNi4yaC04LjVWMGgxMS4yeiIvPjwvc3ZnPg==" alt="Vert.x Logo"/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><span class="navbar-menu-item with-drop-down"><div class="dropdown"><a class="dropdown-title">开始<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/introduction-to-vertx-and-reactive/"><li class="dropdown-item">简介</li></a><a href="/get-started/"><li class="dropdown-item">开始</li></a><a href="https://start.vertx.io/" target="_blank" rel="noreferrer"><li class="dropdown-item">应用生成器 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="navbar-menu-item" href="/docs/">文档</a><span class="navbar-menu-item with-drop-down"><div class="dropdown"><a class="dropdown-title">资源<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/faq/"><li class="dropdown-item">答疑</li></a><a href="/channels/"><li class="dropdown-item">联系渠道</li></a><a href="https://how-to.vertx.io/" target="_blank" rel="noreferrer"><li class="dropdown-item">操作指南 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/vertx-eventbus-bridge-clients" target="_blank" rel="noreferrer"><li class="dropdown-item">EventBus Bridge Clients <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="navbar-menu-item" href="/blog/">博客</a><a class="navbar-menu-item" href="/community/">社区</a><a class="navbar-menu-item" href="/translation/">翻译团队</a></div><div class="navbar-social"><a href="https://github.com/vert-x3/vertx-awesome" class="navbar-social-link" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" class="navbar-social-link" title="Stack Overflow" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>Stack Overflow</title><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" class="navbar-social-link" title="YouTube" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>YouTube</title><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a href="https://discord.gg/KzEMwP2" class="navbar-social-link" title="Discord" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title>Discord</title><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg></a><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" class="navbar-social-link" title="Vert.x 用户组" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title>Vert.x 用户组</title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a><a href="https://shang.qq.com/wpa/qunwpa?idkey=587f58cacb9557e3291b46098e0fe09427b98a1c0f866da23c04c2762bc7e2ad" class="navbar-social-link" title="Vert.x中国用户组QQ群" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Vert.x中国用户组QQ群"><title>Vert.x中国用户组QQ群</title><path d="M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673zM12.662 4.846c.039-1.052.659-1.878 1.385-1.846s1.281.912 1.242 1.964c-.039 1.051-.659 1.878-1.385 1.846s-1.282-.912-1.242-1.964zM9.954 3c.725-.033 1.345.794 1.384 1.846.04 1.052-.517 1.931-1.242 1.963-.726.033-1.346-.794-1.385-1.845C8.672 3.912 9.228 3.033 9.954 3zM7.421 8.294c.194-.43 2.147-.908 4.566-.908h.026c2.418 0 4.372.479 4.566.908a.14.14 0 0 1 .014.061c0 .031-.01.059-.026.083-.163.238-2.333 1.416-4.553 1.416h-.026c-2.221 0-4.39-1.178-4.553-1.416a.136.136 0 0 1-.014-.144zm10.422 8.622c-.22 3.676-2.403 5.987-5.774 6.021h-.137c-3.37-.033-5.554-2.345-5.773-6.021-.081-1.35.001-2.496.147-3.43.318.063.638.122.958.176v3.506s1.658.334 3.318.103v-3.225c.488.027.96.04 1.406.034h.025c1.678.021 3.714-.204 5.683-.594.146.934.227 2.08.147 3.43zM10.48 5.804c.313-.041.542-.409.508-.825-.033-.415-.314-.72-.629-.679-.313.04-.541.409-.508.824.034.417.315.72.629.68zM14.479 5.156c.078.037.221.042.289-.146.035-.095.025-.165-.009-.214-.023-.033-.133-.118-.371-.176-.904-.22-1.341.384-1.405.499-.04.072-.012.176.056.227.067.051.139.037.179-.006.58-.628 1.21-.208 1.261-.184z"></path></svg></a></div></div></div></div></header><div class="page-content"><div class="container"><div class="blog-post"><div class="blog-navbar"><h2>Blog</h2><ul><li><a href="/blog/">All posts</a></li><li><a href="/blog/category/releases/">releases</a></li><li><a href="/blog/category/guides/">guides</a></li><li><a href="/blog/category/news/">news</a></li></ul><div class="feed-icons"><a href="/feed/atom.xml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></div></div><div class="blog-post-main"><div class="blog-post-content"><h1>Vert.x Application Configuration</h1><span><p>In <a href="/blog/my-first-vert-x-3-application/">our pre­vi­ous post</a>, we de­vel­oped a very sim­ple Vert.x 3 ap­pli­ca­tion, and saw how this ap­pli­ca­tion can be tested, pack­aged and ex­e­cuted. That was nice, wasn’t it? Well, ok, that was only the be­gin­ning. In this post, we are going to en­hance our ap­pli­ca­tion to sup­port <em>ex­ter­nal</em> con­fig­u­ra­tion.</p><p>So just to re­mind you, we have an ap­pli­ca­tion start­ing a HTTP server on the port 8080 and re­ply­ing a po­lite “Hello” mes­sage to all HTTP re­quests. The pre­vi­ous code is avail­able <a href="https://github.com/cescoffier/my-vertx-first-app/tree/post-1">here</a>. The code de­vel­oped in this post is in the <a href="https://github.com/cescoffier/my-vertx-first-app/tree/post-2">post-2 branch</a>.</p><h2 id="so-why-do-we-need-configuration"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#so-why-do-we-need-configuration"></a>So, why do we need configuration?</h2><p>That’s a good ques­tion. The ap­pli­ca­tion works right now, but well, let’s say you want to de­ploy it on a ma­chine where the port 8080 is al­ready taken. We would need to change the port in the ap­pli­ca­tion code and in the test, just for this ma­chine. That would be sad. For­tu­nately, Vert.x ap­pli­ca­tions are con­fig­urable.</p><p>Vert.x con­fig­u­ra­tions are using the JSON for­mat, so don’t ex­pect any­thing com­pli­cated. They can be passed to ver­ti­cle ei­ther from the com­mand line, or using an API. Let’s have a look.</p><h2 id="no-8080-anymore"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#no-8080-anymore"></a>No ‘8080’ anymore</h2><p>The first step is to mod­ify the <code>io.vertx.blog.first.MyFirstVerticle</code> class to not bind to the port 8080, but to read it from the con­fig­u­ra­tion:</p><pre><code class="hljs language-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">start</span><span class="hljs-params">(Future&lt;Void&gt; fut)</span> </span>{
  vertx
      .createHttpServer()
      .requestHandler(r -&gt; {
        r.response().end(<span class="hljs-string">&quot;&lt;h1&gt;Hello from my first &quot;</span> +
            <span class="hljs-string">&quot;Vert.x 3 application&lt;/h1&gt;&quot;</span>);
      })
      .listen(
          <span class="hljs-comment">// Retrieve the port from the configuration,</span>
          <span class="hljs-comment">// default to 8080.</span>
          config().getInteger(<span class="hljs-string">&quot;http.port&quot;</span>, <span class="hljs-number">8080</span>),
          result -&gt; {
            <span class="hljs-keyword">if</span> (result.succeeded()) {
              fut.complete();
            } <span class="hljs-keyword">else</span> {
              fut.fail(result.cause());
            }
          }
      );
}
</code></pre><p>So, the only dif­fer­ence with the pre­vi­ous ver­sion is <code>config().getInteger(&quot;http.port&quot;, 8080)</code>. Here, our code is now re­quest­ing the con­fig­u­ra­tion and check whether the <em>http.port</em> prop­erty is set. If not, the port 8080 is used as fall-​back. The re­trieved con­fig­u­ra­tion is a <code>JsonObject</code>.</p><p>As we are using the port 8080 by de­fault, you can still pack­age our ap­pli­ca­tion and run it as be­fore:</p><pre><code class="hljs language-bash">mvn clean package
java -jar target/my-first-app-1.0-SNAPSHOT-fat.jar
</code></pre><p>Sim­ple right ?</p><h2 id="api-based-configuration---random-port-for-the-tests"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#api-based-configuration---random-port-for-the-tests"></a>API-based configuration - Random port for the tests</h2><p>Now that the ap­pli­ca­tion is con­fig­urable, let’s try to pro­vide a con­fig­u­ra­tion. In our test, we are going to con­fig­ure our ap­pli­ca­tion to use the port 8081. So, pre­vi­ously we were de­ploy­ing our ver­ti­cle with:</p><pre><code class="hljs language-java">vertx.deployVerticle(MyFirstVerticle.class.getName(), context.asyncAssertSuccess());
</code></pre><p>Let’s now pass some <em>de­ploy­ment op­tions</em>:</p><pre><code class="hljs language-java">port = <span class="hljs-number">8081</span>;
DeploymentOptions options = <span class="hljs-keyword">new</span> DeploymentOptions()
    .setConfig(<span class="hljs-keyword">new</span> JsonObject().put(<span class="hljs-string">&quot;http.port&quot;</span>, port));
vertx.deployVerticle(MyFirstVerticle.class.getName(), options, context.asyncAssertSuccess());
</code></pre><p>The <code>DeploymentOptions</code> ob­ject lets us cus­tomize var­i­ous pa­ra­me­ters. In par­tic­u­lar, it lets us in­ject the <code>JsonObject</code> re­trieved by the ver­ti­cle when using the <code>config()</code> method.</p><p>Ob­vi­ously, the test con­nect­ing to the server needs to be slightly mod­i­fied to use the right port (<code>port</code> is a field):</p><pre><code class="hljs language-java">vertx.createHttpClient().getNow(port, <span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>, response -&gt; {
  response.handler(body -&gt; {
    context.assertTrue(body.toString().contains(<span class="hljs-string">&quot;Hello&quot;</span>));
    async.complete();
  });
});
</code></pre><p>Ok, well, this does not re­ally fix our issue. What hap­pens when the port 8081 is used too. Let’s now pick a ran­dom port:</p><pre><code class="hljs language-java">ServerSocket socket = <span class="hljs-keyword">new</span> ServerSocket(<span class="hljs-number">0</span>);
port = socket.getLocalPort();
socket.close();

DeploymentOptions options = <span class="hljs-keyword">new</span> DeploymentOptions()
    .setConfig(<span class="hljs-keyword">new</span> JsonObject().put(<span class="hljs-string">&quot;http.port&quot;</span>, port));

vertx.deployVerticle(MyFirstVerticle.class.getName(), options, context.asyncAssertSuccess());
</code></pre><p>So, the idea is very sim­ple. We open a <em>server socket</em> that would pick a ran­dom port (that’s why we put 0 as pa­ra­me­ter). We re­trieve the used port and close the socket. Be aware that this method is <strong>not</strong> per­fect and may fail if the picked port be­comes used be­tween the <code>close</code> method and the start of our HTTP server. How­ever, it would work fine in the very high ma­jor­ity of the case.</p><p>With this in place, our test is now using a ran­dom port. Ex­e­cute them with:</p><pre><code class="hljs language-bash">mvn clean <span class="hljs-built_in">test</span>
</code></pre><h2 id="external-configuration---lets-run-on-another-port"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#external-configuration---lets-run-on-another-port"></a>External configuration - Let’s run on another port</h2><p>Ok, well ran­dom port is not what we want in <em>pro­duc­tion</em>. Could you imag­ine the face of your pro­duc­tion team if you tell them that your ap­pli­ca­tion is pick­ing a ran­dom port. It can ac­tu­ally be funny, but we should never mess with the pro­duc­tion team.</p><p>So for the ac­tual ex­e­cu­tion of your ap­pli­ca­tion, let’s pass the con­fig­u­ra­tion in an ex­ter­nal file. The con­fig­u­ra­tion is stored in a <em>json</em> file.</p><p>Cre­ate the <code>src/main/conf/my-application-conf.json</code> with the fol­low­ing con­tent:</p><pre><code class="hljs language-javascript">{
  <span class="hljs-string">&quot;http.port&quot;</span> : <span class="hljs-number">8082</span>
}
</code></pre><p>And now, to use this con­fig­u­ra­tion just launch your ap­pli­ca­tion with:</p><pre><code class="hljs language-bash">java -jar target/my-first-app-1.0-SNAPSHOT-fat.jar -conf src/main/conf/my-application-conf.json
</code></pre><p>Open a browser on http://lo­cal­host:8082, here it is !</p><p>How does that work ? Re­mem­ber, our <em>fat jar</em> is using the <code>Starter</code> class (pro­vided by Vert.x) to launch our ap­pli­ca­tion. This class is read­ing the <code>-conf</code> pa­ra­me­ter and cre­ate the cor­re­spond­ing de­ploy­ment op­tions when de­ploy­ing our ver­ti­cle.</p><h2 id="conclusion"><a aria-hidden="true" tabindex="-1" class="heading-anchor" href="#conclusion"></a>Conclusion</h2><p>After hav­ing de­vel­oped your first Vert.x ap­pli­ca­tion, we have seen how this ap­pli­ca­tion is con­fig­urable, and this with­out adding any com­plex­ity to our ap­pli­ca­tion. <a href="/blog/some-rest-with-vert-x/">In the next post</a>, we are going to see how we can use vertx-​web to de­velop a small ap­pli­ca­tion serv­ing sta­tic pages and a REST API. A bit more fancy, but still very sim­ple.</p><p>Happy Cod­ing and <!-- -->&amp;<!-- --> Stay Tuned!</p></span></div><div class="blog-post-sidebar"><div class="blog-post-author"><img class="blog-post-author-avatar" src="https://github.com/cescoffier.png?size=160"/><div class="blog-post-author-name">by <a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></div></div><div class="blog-post-sidebar-date">Posted on <!-- -->20 July 2015</div>in <a class="blog-post-sidebar-category" href="/blog/category/guides/">guides</a><div class="blog-post-sidebar-reading-time"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <!-- -->5 min read</div><div class="blog-post-sidebar-share-icons"><a href="https://twitter.com/intent/tweet?text=Vert.x%20Application%20Configuration&amp;url=https%3A%2F%2Fvertx.io%2Fblog%2Fvert-x-application-configuration&amp;via=vertx_project" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Twitter</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"></path></svg></a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fvertx.io%2Fblog%2Fvert-x-application-configuration" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fvertx.io%2Fblog%2Fvert-x-application-configuration" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><title>Facebook</title><path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path></svg></a></div></div></div><div class="blog-post-next-prev"><div class="blog-post-next-prev-entry"><h5>Next post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">27 July 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/some-rest-with-vert-x/">Some Rest with Vert.x</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">This post is part of the Introduction to Vert.x series. Let’s go a bit further this time and develop a CRUD-ish application</p><span class="read-more-link"><a href="/blog/some-rest-with-vert-x/"> 阅读更多</a></span></div></div><div class="blog-post-next-prev-entry"><h5>Previous post</h5><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">14 July 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/my-first-vert-x-3-application/">My first Vert.x 3 Application</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">Let&#x27;s say, you heard someone saying that Vert.x is awesome. Ok great, but you may want to try it by yourself. Well, the next natural question is “where do I start ?”</p><span class="read-more-link"><a href="/blog/my-first-vert-x-3-application/"> 阅读更多</a></span></div></div></div><div class="blog-post-related"><h5>Related posts</h5><div class="blog-post-related-posts"><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">3 August 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/unit-and-integration-tests/">Unit and Integration Tests</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">Let’s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn’t test the API.</p><span class="read-more-link"><a href="/blog/unit-and-integration-tests/"> 阅读更多</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">23 January 2021</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/eclipse-vert-x-CSRF-concerns/">Things to keep in mind concerning CSRF attacks</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/xhlika.png?size=50"/><a href="https://github.com/xhlika" target="_blank" rel="noopener noreferrer">Xhelal Likaj</a></li></ul></span><p class="blog-entry-summary">Eclipse Vert.x like most frameworks provides an anti-CSRF defense. However, no framework can prevent all attack vectors that exist in the web. Therefore, developers need to be aware of some dangers and common attack vectors concerning CSRF defenses.</p><span class="read-more-link"><a href="/blog/eclipse-vert-x-CSRF-concerns/"> 阅读更多</a></span></div><div class="blog-entry"><div class="blog-entry-meta"><div class="blog-entry-meta-left"><span class="blog-entry-date">30 November 2015</span>​<a class="blog-entry-category" href="/blog/category/guides/">guides</a></div><div class="blog-entry-meta-right"></div></div><h3><a href="/blog/combine-vert-x-and-mongo-to-build-a-giant/">Combine vert.x and mongo to build a giant</a></h3><span class="blog-entry-authors"><ul><li class=""><img src="https://github.com/cescoffier.png?size=50"/><a href="https://github.com/cescoffier" target="_blank" rel="noopener noreferrer">Clement Escoffier</a></li></ul></span><p class="blog-entry-summary">This blog post is part of the introduction to Vert.x series. We are now going to replace this JDBC client by the vertx-mongo-client, and thus connect to a Mongo database.</p><span class="read-more-link"><a href="/blog/combine-vert-x-and-mongo-to-build-a-giant/"> 阅读更多</a></span></div></div></div></div></div></div><footer><div class="container"><div class="footer-nav-section"><div class="footer-nav-list footer-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMjMyLjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3ptNDE0LTI2Ni45aC0xNS4zdjQyLjJoLTguNVY2LjloLTE1LjJWMGgzOXY2Ljl6TTExOTMgMGwxNC4yIDM3LjdMMTIyMS4zIDBoMTF2NDkuMWgtOC41VjMyLjlsLjgtMjEuNy0xNC41IDM3LjloLTYuMWwtMTQuNS0zNy44LjggMjEuNnYxNi4yaC04LjVWMGgxMS4yeiIvPjwvc3ZnPg==" alt="Vert.x Logo"/></a></div><div class="footer-nav-list"><h5>Eclipse Vert.x</h5><ul class=""><li><a class="navbar-menu-item" href="/docs/">文档</a></li><li><a href="/download/">下载</a></li><li><a href="/blog/">博客</a></li><li><a href="/community/">社区</a></li><li><a href="/translation/">翻译团队</a></li><li><a href="https://github.com/eclipse-vertx/vert.x">GitHub</a></li><li><a href="https://github.com/vertx-china/vertx-web-site">翻译GitHub</a></li></ul></div><div class="footer-nav-list"><h5>资源</h5><ul class=""><li><a href="/faq/">答疑</a></li><li><a href="/channels/">联系渠道</a></li><li><a href="https://how-to.vertx.io/">操作指南</a></li><li><a href="https://start.vertx.io/">应用生成器</a></li></ul></div><div class="footer-nav-list"><h5>Eclipse</h5><ul class=""><li><a href="https://www.eclipse.org/">Eclipse 基金会</a></li><li><a href="https://www.eclipse.org/legal/privacy.php">隐私政策</a></li><li><a href="https://www.eclipse.org/legal/termsofuse.php">使用条款</a></li><li><a href="https://www.eclipse.org/legal/copyright.php">版权代理</a></li><li><a href="https://www.eclipse.org/legal/">法律资源</a></li></ul></div></div><div class="footer-copyright"><div class="footer-copyright-remarks">© <!-- -->2021<!-- --> Eclipse Vert.x™<br/>Eclipse Vert.x™ 是开源的，并在<a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer">Eclipse Public License 2.0</a>和<a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache License 2.0</a>协议下获得了双重许可。<br class="footer-copyright-break"/>网站由 <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer">Michel Krämer</a> 设计。</div><div class="footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAyODEuMyA5MS4xIiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGU+LnN0MHtmaWxsOiNmNzk0MjJ9LnN0MXtmaWxsOiMzZDNjM2J9PC9zdHlsZT48ZyBpZD0iTGF5ZXJfMV8xXyI+PHBhdGggY2xhc3M9InN0MCIgZD0iTTI2NS43IDg0TDI1NyA3M2gtMi43djE3LjdoMy4zdi0xMmw5LjMgMTJoMi4xVjczaC0zLjN2MTF6bS0zMi40LTguM2M0LjIgMCA1LjggMy4zIDUuOCA2LjNzLTEuNiA2LTUuOCA2LTUuNy0zLjEtNS44LTYgMS43LTYuMyA1LjgtNi4zem0wLTNjLTYuMSAwLTkuMSA0LjctOS4xIDkuMyAwIDQuNyAyLjkgOS4xIDkuMSA5LjFzOS00LjYgOS4xLTkuMi0zLTkuMi05LjEtOS4yem0tMjEuMiAxOFY3M2gtMy4zdjE3LjdoMy4zem0tMjMuNiAwaDMuM1Y3Nmg1LjZ2LTNoLTE0LjZ2M2g1LjZsLjEgMTQuN3ptLTE4LjktNi41SDE2M2wzLjMtNy42IDMuMyA3LjZ6bTIuOCA2LjVoMy42TDE2OC4yIDczaC0zLjZsLTggMTcuN2gzLjZsMS41LTMuM2g5LjNsMS40IDMuM3ptLTM4LTE0LjZoMy42YzMuOSAwIDUuNSAyLjggNS41IDUuNS4xIDIuOC0xLjUgNS44LTUuNSA1LjhoLTMuNlY3Ni4xem0zLjctMy4xaC02Ljl2MTcuN2g2LjljNi4yIDAgOC45LTQuNSA4LjktOXMtMi44LTguNy04LjktOC43em0tMjIuNCAxMUwxMDcgNzNoLTIuN3YxNy43aDMuM3YtMTJsOS4zIDEyaDIuMVY3M2gtMy4zdjExek04OC4yIDczdjEwLjJjMCAzLTEuNiA0LjktNC4zIDQuOXMtNC42LTEuNy00LjYtNC45VjczSDc2djEwLjFjMCA1LjMgMy42IDcuOSA3LjkgNy45IDQuNCAwIDcuNy0yLjcgNy43LTcuOVY3M2gtMy40em0tMzMgMi43YzQuMiAwIDUuOCAzLjMgNS44IDYuM3MtMS42IDYtNS44IDYtNS43LTMuMS01LjgtNiAxLjctNi4zIDUuOC02LjN6bTAtM2MtNi4xIDAtOS4xIDQuNy05LjEgOS4zczIuOSA5LjEgOS4xIDkuMSA5LTQuNiA5LjEtOS4yLTMtOS4yLTkuMS05LjJ6bS0yOS43IDE4di02LjVoOC45di0zLjFoLTguOXYtNC44aDkuNFY3M0gyMi4ydjE3LjZoMy4zeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNjkuNCA1NC40aC0yMi4ydi04LjloMjEuNHYtNi45aC0yMS40di05LjFoMjIuMnYtNy4yaC0yOS42djM5LjVoMjkuNnYtNy40em0tNDAtMjUuNmMtMy02LjEtOS40LTcuOC0xNS41LTcuOC03LjMgMC0xNS4zIDMuNC0xNS4zIDExLjUgMCA4LjkgNy40IDExIDE1LjUgMTIgNS4yLjYgOS4xIDIuMSA5LjEgNS44IDAgNC4zLTQuNCA1LjktOS4xIDUuOXMtOS40LTEuOS0xMS4xLTYuM2wtNi4yIDMuMmMyLjkgNy4yIDkuMSA5LjcgMTcuMiA5LjcgOC44IDAgMTYuNi0zLjggMTYuNi0xMi42IDAtOS40LTcuNy0xMS42LTE1LjktMTIuNi00LjctLjYtOC44LTEuNS04LjgtNSAwLTIuOSAyLjYtNS4yIDguMi01LjIgNC4zIDAgOCAyLjIgOS40IDQuNGw1LjktM3pNMTc2IDIyLjJjLTYuMi0uMS0xMi40IDAtMTguNiAwdjM5LjVoNy40VjUwLjFIMTc2YzE5LjQgMCAxOS40LTI3LjkgMC0yNy45em0tMTEuMSA3LjFIMTc2YzkuNSAwIDkuNSAxNCAwIDE0aC0xMS4ybC4xLTE0em0tMTggMzIuNVYyMi4yaC03LjR2MzkuNWw3LjQuMXptLTQ0LTM5LjZ2MzkuNWgyNy43di02LjloLTIwLjNWMjIuMmgtNy40ek05MC43IDUxLjdjLTIuNyAyLjUtNi4yIDQtOS45IDQtOS44IDAtMTMuNS02LjgtMTMuNi0xMy40czQuMS0xMy43IDEzLjYtMTMuN2MzLjUtLjEgNyAxLjMgOS41IDMuN2w1LTQuOGMtMy44LTMuOS05LjEtNi0xNC41LTYtMTQuMyAwLTIxIDEwLjUtMjAuOSAyMC44czYuMyAyMC4zIDIwLjkgMjAuM2M1LjYuMSAxMS0yIDE1LTUuOWwtNS4xLTV6bS0zOSAyLjdIMjkuNXYtOC45aDIxLjR2LTYuOUgyOS41di05LjFoMjIuMnYtNy4ySDIyLjJ2MzkuNWgyOS42bC0uMS03LjR6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTkuOCAxOC4yQzE4LjggNC4xIDM2LjktLjggNTIuMSA2bC0xLS43QzM1LjctNC42IDE1LjItLjEgNS4zIDE1LjNzLTUuNCAzNS45IDEwIDQ1LjhsMS4xLjZDMy44IDUwLjguOCAzMi4zIDkuOCAxOC4yeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNzIuMiAyNi4xYzAtMi41IDIuMS00LjYgNC42LTQuNiAyLjUgMCA0LjYgMi4xIDQuNiA0LjYgMCAyLjUtMi4xIDQuNi00LjYgNC42LTIuNiAwLTQuNi0yLjEtNC42LTQuNnptOC42IDBjMC0yLjItMS44LTQuMS00LTQuMXMtNC4xIDEuOC00LjEgNC4xYzAgMi4yIDEuNyA0IDMuOSA0LjFoLjFjMi4zIDAgNC4xLTEuOCA0LjEtNC4xem0tNi0yLjVoMi4zYzEuMSAwIDEuOS41IDEuOSAxLjYgMCAuNy0uNCAxLjMtMS4xIDEuNWwxLjIgMS43aC0xLjRsLTEtMS41aC0uN3YxLjVoLTEuMWwtLjEtNC44em0yLjIgMi4zYy41IDAgLjgtLjMuOC0uN3MtLjMtLjctLjgtLjdoLTF2MS4zbDEgLjF6Ii8+PC9nPjwvc3ZnPg==" alt="Eclipse foundation Logo"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"categories":["releases","guides","news"],"post":{"meta":{"title":"Vert.x Application Configuration","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"In our previous post, we developed a very simple Vert.x 3 application, and saw how this application can be tested, packaged and executed. That was nice, wasn’t it?"},"date":"2015-07-20","slug":"vert-x-application-configuration","readingTime":{"text":"5 min read","minutes":4.165,"time":249900,"words":833},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In \", mdx(Link, {\n    href: \"/blog/my-first-vert-x-3-application/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"our pre\\xADvi\\xADous post\")), \", we de\\xADvel\\xADoped a very sim\\xADple Vert.x 3 ap\\xADpli\\xADca\\xADtion, and saw how this ap\\xADpli\\xADca\\xADtion can be tested, pack\\xADaged and ex\\xADe\\xADcuted. That was nice, wasn\\u2019t it? Well, ok, that was only the be\\xADgin\\xADning. In this post, we are going to en\\xADhance our ap\\xADpli\\xADca\\xADtion to sup\\xADport \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"ex\\xADter\\xADnal\"), \" con\\xADfig\\xADu\\xADra\\xADtion.\"), mdx(\"p\", null, \"So just to re\\xADmind you, we have an ap\\xADpli\\xADca\\xADtion start\\xADing a HTTP server on the port 8080 and re\\xADply\\xADing a po\\xADlite \\u201CHello\\u201D mes\\xADsage to all HTTP re\\xADquests. The pre\\xADvi\\xADous code is avail\\xADable \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/cescoffier/my-vertx-first-app/tree/post-1\"\n  }), \"here\"), \". The code de\\xADvel\\xADoped in this post is in the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/cescoffier/my-vertx-first-app/tree/post-2\"\n  }), \"post-2 branch\"), \".\"), mdx(\"h2\", {\n    \"id\": \"so-why-do-we-need-configuration\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#so-why-do-we-need-configuration\"\n  })), \"So, why do we need configuration?\"), mdx(\"p\", null, \"That\\u2019s a good ques\\xADtion. The ap\\xADpli\\xADca\\xADtion works right now, but well, let\\u2019s say you want to de\\xADploy it on a ma\\xADchine where the port 8080 is al\\xADready taken. We would need to change the port in the ap\\xADpli\\xADca\\xADtion code and in the test, just for this ma\\xADchine. That would be sad. For\\xADtu\\xADnately, Vert.x ap\\xADpli\\xADca\\xADtions are con\\xADfig\\xADurable.\"), mdx(\"p\", null, \"Vert.x con\\xADfig\\xADu\\xADra\\xADtions are using the JSON for\\xADmat, so don\\u2019t ex\\xADpect any\\xADthing com\\xADpli\\xADcated. They can be passed to ver\\xADti\\xADcle ei\\xADther from the com\\xADmand line, or using an API. Let\\u2019s have a look.\"), mdx(\"h2\", {\n    \"id\": \"no-8080-anymore\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#no-8080-anymore\"\n  })), \"No \\u20188080\\u2019 anymore\"), mdx(\"p\", null, \"The first step is to mod\\xADify the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"io.vertx.blog.first.MyFirstVerticle\"), \" class to not bind to the port 8080, but to read it from the con\\xADfig\\xADu\\xADra\\xADtion:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"public\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"void\"), \" \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"start\"), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-params\"\n  }), \"(Future\u003cVoid\u003e fut)\"), \" \"), \"{\\n  vertx\\n      .createHttpServer()\\n      .requestHandler(r -\u003e {\\n        r.response().end(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"\u003ch1\u003eHello from my first \\\"\"), \" +\\n            \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Vert.x 3 application\u003c/h1\u003e\\\"\"), \");\\n      })\\n      .listen(\\n          \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// Retrieve the port from the configuration,\"), \"\\n          \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"// default to 8080.\"), \"\\n          config().getInteger(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"http.port\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8080\"), \"),\\n          result -\u003e {\\n            \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"if\"), \" (result.succeeded()) {\\n              fut.complete();\\n            } \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"else\"), \" {\\n              fut.fail(result.cause());\\n            }\\n          }\\n      );\\n}\\n\")), mdx(\"p\", null, \"So, the only dif\\xADfer\\xADence with the pre\\xADvi\\xADous ver\\xADsion is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"config().getInteger(\\\"http.port\\\", 8080)\"), \". Here, our code is now re\\xADquest\\xADing the con\\xADfig\\xADu\\xADra\\xADtion and check whether the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"http.port\"), \" prop\\xADerty is set. If not, the port 8080 is used as fall-\\u200Bback. The re\\xADtrieved con\\xADfig\\xADu\\xADra\\xADtion is a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JsonObject\"), \".\"), mdx(\"p\", null, \"As we are using the port 8080 by de\\xADfault, you can still pack\\xADage our ap\\xADpli\\xADca\\xADtion and run it as be\\xADfore:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"mvn clean package\\njava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar\\n\")), mdx(\"p\", null, \"Sim\\xADple right ?\"), mdx(\"h2\", {\n    \"id\": \"api-based-configuration---random-port-for-the-tests\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#api-based-configuration---random-port-for-the-tests\"\n  })), \"API-based configuration - Random port for the tests\"), mdx(\"p\", null, \"Now that the ap\\xADpli\\xADca\\xADtion is con\\xADfig\\xADurable, let\\u2019s try to pro\\xADvide a con\\xADfig\\xADu\\xADra\\xADtion. In our test, we are going to con\\xADfig\\xADure our ap\\xADpli\\xADca\\xADtion to use the port 8081. So, pre\\xADvi\\xADously we were de\\xADploy\\xADing our ver\\xADti\\xADcle with:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"vertx.deployVerticle(MyFirstVerticle.class.getName(), context.asyncAssertSuccess());\\n\")), mdx(\"p\", null, \"Let\\u2019s now pass some \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"de\\xADploy\\xADment op\\xADtions\"), \":\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"port = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8081\"), \";\\nDeploymentOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" DeploymentOptions()\\n    .setConfig(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" JsonObject().put(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"http.port\\\"\"), \", port));\\nvertx.deployVerticle(MyFirstVerticle.class.getName(), options, context.asyncAssertSuccess());\\n\")), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DeploymentOptions\"), \" ob\\xADject lets us cus\\xADtomize var\\xADi\\xADous pa\\xADra\\xADme\\xADters. In par\\xADtic\\xADu\\xADlar, it lets us in\\xADject the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JsonObject\"), \" re\\xADtrieved by the ver\\xADti\\xADcle when using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"config()\"), \" method.\"), mdx(\"p\", null, \"Ob\\xADvi\\xADously, the test con\\xADnect\\xADing to the server needs to be slightly mod\\xADi\\xADfied to use the right port (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"port\"), \" is a field):\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"vertx.createHttpClient().getNow(port, \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"localhost\\\"\"), \", \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"/\\\"\"), \", response -\u003e {\\n  response.handler(body -\u003e {\\n    context.assertTrue(body.toString().contains(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Hello\\\"\"), \"));\\n    async.complete();\\n  });\\n});\\n\")), mdx(\"p\", null, \"Ok, well, this does not re\\xADally fix our issue. What hap\\xADpens when the port 8081 is used too. Let\\u2019s now pick a ran\\xADdom port:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-java\"\n  }), \"ServerSocket socket = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" ServerSocket(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"0\"), \");\\nport = socket.getLocalPort();\\nsocket.close();\\n\\nDeploymentOptions options = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" DeploymentOptions()\\n    .setConfig(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"new\"), \" JsonObject().put(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"http.port\\\"\"), \", port));\\n\\nvertx.deployVerticle(MyFirstVerticle.class.getName(), options, context.asyncAssertSuccess());\\n\")), mdx(\"p\", null, \"So, the idea is very sim\\xADple. We open a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"server socket\"), \" that would pick a ran\\xADdom port (that\\u2019s why we put 0 as pa\\xADra\\xADme\\xADter). We re\\xADtrieve the used port and close the socket. Be aware that this method is \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"not\"), \" per\\xADfect and may fail if the picked port be\\xADcomes used be\\xADtween the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"close\"), \" method and the start of our HTTP server. How\\xADever, it would work fine in the very high ma\\xADjor\\xADity of the case.\"), mdx(\"p\", null, \"With this in place, our test is now using a ran\\xADdom port. Ex\\xADe\\xADcute them with:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"mvn clean \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-built_in\"\n  }), \"test\"), \"\\n\")), mdx(\"h2\", {\n    \"id\": \"external-configuration---lets-run-on-another-port\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#external-configuration---lets-run-on-another-port\"\n  })), \"External configuration - Let\\u2019s run on another port\"), mdx(\"p\", null, \"Ok, well ran\\xADdom port is not what we want in \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"pro\\xADduc\\xADtion\"), \". Could you imag\\xADine the face of your pro\\xADduc\\xADtion team if you tell them that your ap\\xADpli\\xADca\\xADtion is pick\\xADing a ran\\xADdom port. It can ac\\xADtu\\xADally be funny, but we should never mess with the pro\\xADduc\\xADtion team.\"), mdx(\"p\", null, \"So for the ac\\xADtual ex\\xADe\\xADcu\\xADtion of your ap\\xADpli\\xADca\\xADtion, let\\u2019s pass the con\\xADfig\\xADu\\xADra\\xADtion in an ex\\xADter\\xADnal file. The con\\xADfig\\xADu\\xADra\\xADtion is stored in a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"json\"), \" file.\"), mdx(\"p\", null, \"Cre\\xADate the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/conf/my-application-conf.json\"), \" with the fol\\xADlow\\xADing con\\xADtent:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-javascript\"\n  }), \"{\\n  \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"http.port\\\"\"), \" : \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-number\"\n  }), \"8082\"), \"\\n}\\n\")), mdx(\"p\", null, \"And now, to use this con\\xADfig\\xADu\\xADra\\xADtion just launch your ap\\xADpli\\xADca\\xADtion with:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"java -jar target/my-first-app-1.0-SNAPSHOT-fat.jar -conf src/main/conf/my-application-conf.json\\n\")), mdx(\"p\", null, \"Open a browser on http://lo\\xADcal\\xADhost:8082, here it is !\"), mdx(\"p\", null, \"How does that work ? Re\\xADmem\\xADber, our \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"fat jar\"), \" is using the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Starter\"), \" class (pro\\xADvided by Vert.x) to launch our ap\\xADpli\\xADca\\xADtion. This class is read\\xADing the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"-conf\"), \" pa\\xADra\\xADme\\xADter and cre\\xADate the cor\\xADre\\xADspond\\xADing de\\xADploy\\xADment op\\xADtions when de\\xADploy\\xADing our ver\\xADti\\xADcle.\"), mdx(\"h2\", {\n    \"id\": \"conclusion\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#conclusion\"\n  })), \"Conclusion\"), mdx(\"p\", null, \"After hav\\xADing de\\xADvel\\xADoped your first Vert.x ap\\xADpli\\xADca\\xADtion, we have seen how this ap\\xADpli\\xADca\\xADtion is con\\xADfig\\xADurable, and this with\\xADout adding any com\\xADplex\\xADity to our ap\\xADpli\\xADca\\xADtion. \", mdx(Link, {\n    href: \"/blog/some-rest-with-vert-x/\",\n    passHref: true,\n    mdxType: \"Link\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"\"\n  }), \"In the next post\")), \", we are going to see how we can use vertx-\\u200Bweb to de\\xADvelop a small ap\\xADpli\\xADca\\xADtion serv\\xADing sta\\xADtic pages and a REST API. A bit more fancy, but still very sim\\xADple.\"), mdx(\"p\", null, \"Happy Cod\\xADing and \", \"\u0026\", \" Stay Tuned!\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003cp\u003eIn \u003ca href=\"/blog/my-first-vert-x-3-application/\"\u003eour pre­vi­ous post\u003c/a\u003e, we de­vel­oped a very sim­ple Vert.x 3 ap­pli­ca­tion, and saw how this ap­pli­ca­tion can be tested, pack­aged and ex­e­cuted. That was nice, wasn’t it? Well, ok, that was only the be­gin­ning. In this post, we are going to en­hance our ap­pli­ca­tion to sup­port \u003cem\u003eex­ter­nal\u003c/em\u003e con­fig­u­ra­tion.\u003c/p\u003e\u003cp\u003eSo just to re­mind you, we have an ap­pli­ca­tion start­ing a HTTP server on the port 8080 and re­ply­ing a po­lite “Hello” mes­sage to all HTTP re­quests. The pre­vi­ous code is avail­able \u003ca href=\"https://github.com/cescoffier/my-vertx-first-app/tree/post-1\"\u003ehere\u003c/a\u003e. The code de­vel­oped in this post is in the \u003ca href=\"https://github.com/cescoffier/my-vertx-first-app/tree/post-2\"\u003epost-2 branch\u003c/a\u003e.\u003c/p\u003e\u003ch2 id=\"so-why-do-we-need-configuration\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#so-why-do-we-need-configuration\"\u003e\u003c/a\u003eSo, why do we need configuration?\u003c/h2\u003e\u003cp\u003eThat’s a good ques­tion. The ap­pli­ca­tion works right now, but well, let’s say you want to de­ploy it on a ma­chine where the port 8080 is al­ready taken. We would need to change the port in the ap­pli­ca­tion code and in the test, just for this ma­chine. That would be sad. For­tu­nately, Vert.x ap­pli­ca­tions are con­fig­urable.\u003c/p\u003e\u003cp\u003eVert.x con­fig­u­ra­tions are using the JSON for­mat, so don’t ex­pect any­thing com­pli­cated. They can be passed to ver­ti­cle ei­ther from the com­mand line, or using an API. Let’s have a look.\u003c/p\u003e\u003ch2 id=\"no-8080-anymore\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#no-8080-anymore\"\u003e\u003c/a\u003eNo ‘8080’ anymore\u003c/h2\u003e\u003cp\u003eThe first step is to mod­ify the \u003ccode\u003eio.vertx.blog.first.MyFirstVerticle\u003c/code\u003e class to not bind to the port 8080, but to read it from the con­fig­u­ra­tion:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003estart\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(Future\u0026lt;Void\u0026gt; fut)\u003c/span\u003e \u003c/span\u003e{\n  vertx\n      .createHttpServer()\n      .requestHandler(r -\u0026gt; {\n        r.response().end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026lt;h1\u0026gt;Hello from my first \u0026quot;\u003c/span\u003e +\n            \u003cspan class=\"hljs-string\"\u003e\u0026quot;Vert.x 3 application\u0026lt;/h1\u0026gt;\u0026quot;\u003c/span\u003e);\n      })\n      .listen(\n          \u003cspan class=\"hljs-comment\"\u003e// Retrieve the port from the configuration,\u003c/span\u003e\n          \u003cspan class=\"hljs-comment\"\u003e// default to 8080.\u003c/span\u003e\n          config().getInteger(\u003cspan class=\"hljs-string\"\u003e\u0026quot;http.port\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e),\n          result -\u0026gt; {\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (result.succeeded()) {\n              fut.complete();\n            } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n              fut.fail(result.cause());\n            }\n          }\n      );\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eSo, the only dif­fer­ence with the pre­vi­ous ver­sion is \u003ccode\u003econfig().getInteger(\u0026quot;http.port\u0026quot;, 8080)\u003c/code\u003e. Here, our code is now re­quest­ing the con­fig­u­ra­tion and check whether the \u003cem\u003ehttp.port\u003c/em\u003e prop­erty is set. If not, the port 8080 is used as fall-​back. The re­trieved con­fig­u­ra­tion is a \u003ccode\u003eJsonObject\u003c/code\u003e.\u003c/p\u003e\u003cp\u003eAs we are using the port 8080 by de­fault, you can still pack­age our ap­pli­ca­tion and run it as be­fore:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emvn clean package\njava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eSim­ple right ?\u003c/p\u003e\u003ch2 id=\"api-based-configuration---random-port-for-the-tests\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#api-based-configuration---random-port-for-the-tests\"\u003e\u003c/a\u003eAPI-based configuration - Random port for the tests\u003c/h2\u003e\u003cp\u003eNow that the ap­pli­ca­tion is con­fig­urable, let’s try to pro­vide a con­fig­u­ra­tion. In our test, we are going to con­fig­ure our ap­pli­ca­tion to use the port 8081. So, pre­vi­ously we were de­ploy­ing our ver­ti­cle with:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003evertx.deployVerticle(MyFirstVerticle.class.getName(), context.asyncAssertSuccess());\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eLet’s now pass some \u003cem\u003ede­ploy­ment op­tions\u003c/em\u003e:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003eport = \u003cspan class=\"hljs-number\"\u003e8081\u003c/span\u003e;\nDeploymentOptions options = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e DeploymentOptions()\n    .setConfig(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonObject().put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;http.port\u0026quot;\u003c/span\u003e, port));\nvertx.deployVerticle(MyFirstVerticle.class.getName(), options, context.asyncAssertSuccess());\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe \u003ccode\u003eDeploymentOptions\u003c/code\u003e ob­ject lets us cus­tomize var­i­ous pa­ra­me­ters. In par­tic­u­lar, it lets us in­ject the \u003ccode\u003eJsonObject\u003c/code\u003e re­trieved by the ver­ti­cle when using the \u003ccode\u003econfig()\u003c/code\u003e method.\u003c/p\u003e\u003cp\u003eOb­vi­ously, the test con­nect­ing to the server needs to be slightly mod­i­fied to use the right port (\u003ccode\u003eport\u003c/code\u003e is a field):\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003evertx.createHttpClient().getNow(port, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, response -\u0026gt; {\n  response.handler(body -\u0026gt; {\n    context.assertTrue(body.toString().contains(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello\u0026quot;\u003c/span\u003e));\n    async.complete();\n  });\n});\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOk, well, this does not re­ally fix our issue. What hap­pens when the port 8081 is used too. Let’s now pick a ran­dom port:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-java\"\u003eServerSocket socket = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ServerSocket(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e);\nport = socket.getLocalPort();\nsocket.close();\n\nDeploymentOptions options = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e DeploymentOptions()\n    .setConfig(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e JsonObject().put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;http.port\u0026quot;\u003c/span\u003e, port));\n\nvertx.deployVerticle(MyFirstVerticle.class.getName(), options, context.asyncAssertSuccess());\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eSo, the idea is very sim­ple. We open a \u003cem\u003eserver socket\u003c/em\u003e that would pick a ran­dom port (that’s why we put 0 as pa­ra­me­ter). We re­trieve the used port and close the socket. Be aware that this method is \u003cstrong\u003enot\u003c/strong\u003e per­fect and may fail if the picked port be­comes used be­tween the \u003ccode\u003eclose\u003c/code\u003e method and the start of our HTTP server. How­ever, it would work fine in the very high ma­jor­ity of the case.\u003c/p\u003e\u003cp\u003eWith this in place, our test is now using a ran­dom port. Ex­e­cute them with:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003emvn clean \u003cspan class=\"hljs-built_in\"\u003etest\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"external-configuration---lets-run-on-another-port\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#external-configuration---lets-run-on-another-port\"\u003e\u003c/a\u003eExternal configuration - Let’s run on another port\u003c/h2\u003e\u003cp\u003eOk, well ran­dom port is not what we want in \u003cem\u003epro­duc­tion\u003c/em\u003e. Could you imag­ine the face of your pro­duc­tion team if you tell them that your ap­pli­ca­tion is pick­ing a ran­dom port. It can ac­tu­ally be funny, but we should never mess with the pro­duc­tion team.\u003c/p\u003e\u003cp\u003eSo for the ac­tual ex­e­cu­tion of your ap­pli­ca­tion, let’s pass the con­fig­u­ra­tion in an ex­ter­nal file. The con­fig­u­ra­tion is stored in a \u003cem\u003ejson\u003c/em\u003e file.\u003c/p\u003e\u003cp\u003eCre­ate the \u003ccode\u003esrc/main/conf/my-application-conf.json\u003c/code\u003e with the fol­low­ing con­tent:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e{\n  \u003cspan class=\"hljs-string\"\u003e\u0026quot;http.port\u0026quot;\u003c/span\u003e : \u003cspan class=\"hljs-number\"\u003e8082\u003c/span\u003e\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eAnd now, to use this con­fig­u­ra­tion just launch your ap­pli­ca­tion with:\u003c/p\u003e\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003ejava -jar target/my-first-app-1.0-SNAPSHOT-fat.jar -conf src/main/conf/my-application-conf.json\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eOpen a browser on http://lo­cal­host:8082, here it is !\u003c/p\u003e\u003cp\u003eHow does that work ? Re­mem­ber, our \u003cem\u003efat jar\u003c/em\u003e is using the \u003ccode\u003eStarter\u003c/code\u003e class (pro­vided by Vert.x) to launch our ap­pli­ca­tion. This class is read­ing the \u003ccode\u003e-conf\u003c/code\u003e pa­ra­me­ter and cre­ate the cor­re­spond­ing de­ploy­ment op­tions when de­ploy­ing our ver­ti­cle.\u003c/p\u003e\u003ch2 id=\"conclusion\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#conclusion\"\u003e\u003c/a\u003eConclusion\u003c/h2\u003e\u003cp\u003eAfter hav­ing de­vel­oped your first Vert.x ap­pli­ca­tion, we have seen how this ap­pli­ca­tion is con­fig­urable, and this with­out adding any com­plex­ity to our ap­pli­ca­tion. \u003ca href=\"/blog/some-rest-with-vert-x/\"\u003eIn the next post\u003c/a\u003e, we are going to see how we can use vertx-​web to de­velop a small ap­pli­ca­tion serv­ing sta­tic pages and a REST API. A bit more fancy, but still very sim­ple.\u003c/p\u003e\u003cp\u003eHappy Cod­ing and \u003c!-- --\u003e\u0026amp;\u003c!-- --\u003e Stay Tuned!\u003c/p\u003e","scope":{}}},"prevPost":{"meta":{"title":"Some Rest with Vert.x","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"This post is part of the Introduction to Vert.x series. Let’s go a bit further this time and develop a CRUD-ish application"},"date":"2015-07-27","slug":"some-rest-with-vert-x"},"nextPost":{"meta":{"title":"My first Vert.x 3 Application","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"Let's say, you heard someone saying that Vert.x is awesome. Ok great, but you may want to try it by yourself. Well, the next natural question is “where do I start ?”"},"date":"2015-07-14","slug":"my-first-vert-x-3-application"},"relatedPosts":[{"meta":{"title":"Unit and Integration Tests","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"Let’s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn’t test the API."},"date":"2015-08-03","slug":"unit-and-integration-tests"},{"meta":{"title":"Things to keep in mind concerning CSRF attacks","category":"guides","authors":[{"name":"Xhelal Likaj","github_id":"xhlika"}],"summary":"Eclipse Vert.x like most frameworks provides an anti-CSRF defense. However, no framework can prevent all attack vectors that exist in the web. Therefore, developers need to be aware of some dangers and common attack vectors concerning CSRF defenses."},"date":"2021-01-23","slug":"eclipse-vert-x-CSRF-concerns"},{"meta":{"title":"Combine vert.x and mongo to build a giant","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"This blog post is part of the introduction to Vert.x series. We are now going to replace this JDBC client by the vertx-mongo-client, and thus connect to a Mongo database."},"date":"2015-11-30","slug":"combine-vert-x-and-mongo-to-build-a-giant"}]},"__N_SSG":true},"page":"/blog/[[...slug]]","query":{"slug":["vert-x-application-configuration"]},"buildId":"7Pm1RDWKr5Pqxp6rERRr2","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-9a5c89434732593ca2fd.js"></script><script src="/_next/static/chunks/main-b6e20584df76f29b6f35.js" async=""></script><script src="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" async=""></script><script src="/_next/static/chunks/framework.fcef98db13e2318579fb.js" async=""></script><script src="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" async=""></script><script src="/_next/static/chunks/styles.7064a0f84b2a7c13404a.js" async=""></script><script src="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" async=""></script><script src="/_next/static/chunks/5df0631eea625b022d3730b3f1bf573e1b8deb37.2c5d42edba8dda0b0ba3.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5B%5B...slug%5D%5D-ff5b3ed8f1ab05c5e7a9.js" async=""></script><script src="/_next/static/7Pm1RDWKr5Pqxp6rERRr2/_buildManifest.js" async=""></script><script src="/_next/static/7Pm1RDWKr5Pqxp6rERRr2/_ssgManifest.js" async=""></script></body></html>