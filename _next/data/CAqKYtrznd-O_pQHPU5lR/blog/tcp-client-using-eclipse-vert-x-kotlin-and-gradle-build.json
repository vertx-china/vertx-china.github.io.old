{"pageProps":{"categories":["releases","guides","news"],"post":{"meta":{"title":"TCP Client using Eclipse Vert.x, Kotlin and Gradle build","category":"guides","authors":[{"name":"Usman Saleem","github_id":"usmansaleem"}],"summary":"In this blog post, I demonstrate how to write a very simple TCP client that keeps a connection open to a custom-written server in cloud."},"date":"2017-12-20","slug":"tcp-client-using-eclipse-vert-x-kotlin-and-gradle-build","readingTime":{"text":"5 min read","minutes":4.185,"time":251099.99999999997,"words":837},"content":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"As part of my hobby project to con\\xADtrol Rasp\\xADber\\xADryPi using Google Home Mini and/or Alexa, I wanted to write a very sim\\xADple TCP client that keeps a con\\xADnec\\xADtion open to one of my cus\\xADtom writ\\xADten server in cloud (I will write an\\xADother blog post to cover the server side on a later date). The re\\xADquire\\xADment of the client is to send a shared se\\xADcret upon con\\xADnect\\xADing and then keep wait\\xADing for mes\\xADsage from server. Vert.x, Kotlin and Gra\\xADdle allow rapid de\\xADvel\\xADop\\xADment of such project. The gen\\xADer\\xADated jar can be ex\\xADe\\xADcuted on Rasp\\xADberry Pi. These steps out\\xADline the project setup and re\\xADlated source code to show\\xADcase a Vert.x and Kotlin project with Gra\\xADdle.\"), mdx(\"h2\", {\n    \"id\": \"project-directory-structure\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#project-directory-structure\"\n  })), \"Project Directory Structure\"), mdx(\"p\", null, \"From com\\xADmand line (or via Win\\xADdows Ex\\xADplorer, what\\xADever you pre\\xADfer to use) cre\\xADate a di\\xADrec\\xADtory for project,for in\\xADstance \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx-net-client\"), \". Since we are using Kotlin, we will place all Kotlin files in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/kotlin\"), \" folder. The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/resources\"), \" folder will con\\xADtain our log\\xADging con\\xADfig\\xADu\\xADra\\xADtion re\\xADlated files.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-awk\"\n  }), \"cd vertx-net-client\\nmkdir -p src\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-regexp\"\n  }), \"/main/\"), \"kotlin\\nmkdir -p src\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-regexp\"\n  }), \"/main/\"), \"resources\\n\")), mdx(\"h3\", {\n    \"id\": \"project-files\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#project-files\"\n  })), \"Project Files\"), mdx(\"p\", null, \"We need to add fol\\xADlow\\xADing files in the project\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".gitignore\"), \"\\nIf you want to check your project into git, you may con\\xADsider adding fol\\xADlow\\xADing \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".gitignore\"), \" file at root of your project\")), mdx(Gist, {\n    url: \"https://gist.github.com/usmansaleem/b5838484a20cb8b08f236f2265ad7a8e\",\n    mdxType: \"Gist\"\n  }), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"logback.xml\"), \"\\nThis ex\\xADam\\xADple is using slf4j and log\\xADback for log\\xADging. If you de\\xADcide to use it in your project, you may also add fol\\xADlow\\xADing log\\xADback.xml file in \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"src/main/resources\"), \". Mod\\xADify it as per your re\\xADquire\\xADments. This ex\\xADam\\xADple will\\nlog on con\\xADsole.\")), mdx(Gist, {\n    url: \"https://gist.github.com/usmansaleem/750c6d1cad0721b52be2ff00f758fb9f\",\n    mdxType: \"Gist\"\n  }), mdx(\"h2\", {\n    \"id\": \"gradle-setup\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#gradle-setup\"\n  })), \"Gradle Setup\"), mdx(\"p\", null, \"We will use Gra\\xADdle build sys\\xADtem for this project. If you don\\u2019t al\\xADready have Gra\\xADdle avail\\xADable on your sys\\xADtem, down\\xADload and unzip gra\\xADdle in a di\\xADrec\\xADtory of your choice (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"$GRADLE_HOME\"), \" is used here to rep\\xADre\\xADsent this di\\xADrec\\xADtory). This gra\\xADdle dis\\xADtri\\xADb\\xADu\\xADtion will be used as a start\\xADing point to cre\\xADate Gra\\xADdle wrap\\xADper scripts for our project. These scripts will allow our project to down\\xADload and use cor\\xADrect ver\\xADsion of gra\\xADdle dis\\xADtri\\xADb\\xADu\\xADtion au\\xADto\\xADmat\\xADi\\xADcally with\\xADout mess\\xADing up sys\\xADtem. Re\\xADally use\\xADful when build\\xADing your project on CI tool or on any other de\\xADvel\\xADoper\\u2019s ma\\xADchine.\"), mdx(\"p\", null, \"Run fol\\xADlow\\xADing com\\xADmand in project\\u2019s di\\xADrec\\xADtory\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-variable\"\n  }), \"$GRADLE_HOME\"), \"/bin/gradle wrapper\\n\")), mdx(\"p\", null, \"The above com\\xADmands will gen\\xADer\\xADate fol\\xADlow\\xADing files and di\\xADrec\\xADto\\xADries.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"gradle/  gradlew  gradlew.bat\\n\")), mdx(\"h3\", {\n    \"id\": \"gradle-build-file-buildgradle\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#gradle-build-file-buildgradle\"\n  })), \"Gradle build file \", mdx(\"inlineCode\", {\n    parentName: \"h3\"\n  }, \"build.gradle\")), mdx(\"p\", null, \"Cre\\xADate (and/or copy and mod\\xADify) fol\\xADlow\\xADing \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"build.gradle\"), \" in your project\\u2019s root di\\xADrec\\xADtory. Our ex\\xADam\\xADple gra\\xADdle build file is using \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/jponge/vertx-gradle-plugin/\"\n  }), \"vertx-\\u200Bgradle-plugin\"), \".\"), mdx(Gist, {\n    url: \"https://gist.github.com/usmansaleem/e723f25b827e0a925eaef2957a80132d\",\n    mdxType: \"Gist\"\n  }), mdx(\"p\", null, \"In the project di\\xADrec\\xADtory, run fol\\xADlow\\xADing com\\xADmand to down\\xADload local gra\\xADdle dis\\xADtri\\xADb\\xADu\\xADtion:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"./gradlew\\n\")), mdx(\"p\", null, \"(or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".\\\\gradlew.bat\"), \" if in Win\\xADdows)\"), mdx(\"p\", null, \"At this stage we should have fol\\xADlow\\xADing file struc\\xADture. This is also a good time to com\\xADmit changes if you are work\\xADing with git.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".gitignore\"), \"                              \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"build.gradle\"), \"                            \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gradle/wrapper/gradle-wrapper.jar\"), \"       \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gradle/wrapper/gradle-wrapper.properties\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gradlew\"), \"                                 \"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"gradlew.bat\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"src/main/resources/logback.xml\"))), mdx(\"p\", null, \"Now that our project struc\\xADture is ready, time to add the meat of the project. You may use any IDE of your choice. My pref\\xADer\\xADence is In\\xADtel\\xADliJ IDEA.\"), mdx(\"p\", null, \"Cre\\xADate a new pack\\xADage under \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/kotlin\"), \". The pack\\xADage name should be adapted from the fol\\xADlow\\xADing sec\\xADtion of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"build.gradle\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-ebnf\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attribute\"\n  }), \"vertx\"), \" {\\n\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-attribute\"\n  }), \"    mainVerticle\"), \" = \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"info.usmans.blog.vertx.NetClientVerticle\\\"\"), \"\\n}\\n\")), mdx(\"p\", null, \"From the above ex\\xADam\\xADple, the pack\\xADage name is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"info.usmans.blog.vertx\")), mdx(\"p\", null, \"Add a new Kotlin Class/file in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/main/kotlin/info/usmans/blog/vertx\"), \" as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"NetClientVerticle.kt\")), mdx(\"p\", null, \"The con\\xADtents of this class is as fol\\xADlows\"), mdx(Gist, {\n    url: \"https://gist.github.com/usmansaleem/2a176a7b752fcb72f7f31964809696fe\",\n    mdxType: \"Gist\"\n  }), mdx(\"h2\", {\n    \"id\": \"explaining-the-code\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#explaining-the-code\"\n  })), \"Explaining the Code\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fun main(args: Array<String>)\"), \" is not strictly re\\xADquired, it quickly al\\xADlows run\\xADning the Vert.x ver\\xADti\\xADcle from within IDE. You will also no\\xADtice a small hack in the method for set\\xADting sys\\xADtem prop\\xADerty \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.disableDnsResolver\"), \" which is to avoid a Netty bug that I ob\\xADserved when run\\xADning on Win\\xADdows ma\\xADchine and re\\xADmote server is down. Of course, since we are using vertx-\\u200Bgradle-plugin, we can also use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gradle vertxRun\"), \" to run our ver\\xADti\\xADcle. In this case the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"main\"), \" method will not get called.\"), mdx(\"p\", null, \"The \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"override fun start()\"), \" method calls \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fireReconnectTimer\"), \" which in turn calls \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"reconnect\"), \" method. \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"reconnect\"), \" method con\\xADtains the con\\xADnec\\xADtion logic to server as well as it calls \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fireReconnectTimer\"), \" if it is un\\xADable to con\\xADnect to server or dis\\xADcon\\xADnects from server. In \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"reconnect\"), \" method the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"socket.handler\"), \" gets called when server send mes\\xADsage to client.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-xl\"\n  }), mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-function\"\n  }), mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-title\"\n  }), \"socket\"), \".handler({ \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-keyword\"\n  }), \"data\"), \" ->\"), \"\\n                        logger.info(\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"Data received: ${data}\\\"\"), \")\\n                        \", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-comment\"\n  }), \"//\", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"hljs-doctag\"\n  }), \"TODO:\"), \" Do the work here ...\"), \"\\n               })\\n\")), mdx(\"h2\", {\n    \"id\": \"distributing-the-project\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#distributing-the-project\"\n  })), \"Distributing the project\"), mdx(\"p\", null, \"To cre\\xADate re\\xADdis\\xADtrib\\xADutable jar, use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"./gradlew shadowJar\"), \" com\\xADmand. Or if using In\\xADtel\\xADliJ: from Gra\\xADdle projects, Tasks, shadow, shad\\xADow\\xADJar (right click run). This com\\xADmand will gen\\xADer\\xADate \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"./build/libs/vertx-net-client-fat.jar\"), \".\"), mdx(\"h3\", {\n    \"id\": \"executing-the-client\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#executing-the-client\"\n  })), \"Executing the client\"), mdx(\"p\", null, \"The client jar can be ex\\xADe\\xADcuted using fol\\xADlow\\xADing com\\xADmand:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \" java -DserverHost=127.0.0.1 -DserverPort=8888 -DconnectMessage=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"hello\\\"\"), \" -jar vertx-net-client-full.jar\\n\")), mdx(\"p\", null, \"If you wish to use SLF4J for Vert.x in\\xADter\\xADnal log\\xADging, you need to pass sys\\xADtem prop\\xADerty \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"vertx.logger-delegate-factory-class-name\"), \" with value of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"io.vertx.core.logging.SLF4JLogDelegateFactory\"), \". The final com\\xADmand would look like:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"hljs language-bash\"\n  }), \"java -DserverHost=127.0.0.1 -DserverPort=8888 -DconnectMessage=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"hello\\\"\"), \" -Dvertx.logger-delegate-factory-class-name=\", mdx(\"span\", _extends({\n    parentName: \"code\"\n  }, {\n    \"className\": \"hljs-string\"\n  }), \"\\\"io.vertx.core.logging.SLF4JLogDelegateFactory\\\"\"), \" -jar vertx-net-client-full.jar\\n\")), mdx(\"p\", null, \"You can con\\xADfig\\xADure Vert.x log\\xADging lev\\xADels in log\\xADback.xml file if re\\xADquired.\"), mdx(\"h2\", {\n    \"id\": \"conclusion\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"aria-hidden\": true,\n    \"tabIndex\": -1,\n    \"className\": \"heading-anchor\",\n    \"href\": \"#conclusion\"\n  })), \"Conclusion\"), mdx(\"p\", null, \"This post de\\xADscribes how easy it is to cre\\xADate a sim\\xADple TCP client using Vert.x, Kotlin and Gra\\xADdle build sys\\xADtem. Hope\\xADfully the tech\\xADniques shown here will serve as a start\\xADing point for your next DIY project.\"), mdx(Alert, {\n    info: true,\n    mdxType: \"Alert\"\n  }, mdx(\"p\", null, \"This post is adapted and re\\xADpro\\xADduced from \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://usmans.info/view/blog/tcp_client_using_vertx_kotlin_gradle\"\n  }), \"au\\xADthor\\u2019s blog post\"))));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"<p>As part of my hobby project to con­trol Rasp­ber­ryPi using Google Home Mini and/or Alexa, I wanted to write a very sim­ple TCP client that keeps a con­nec­tion open to one of my cus­tom writ­ten server in cloud (I will write an­other blog post to cover the server side on a later date). The re­quire­ment of the client is to send a shared se­cret upon con­nect­ing and then keep wait­ing for mes­sage from server. Vert.x, Kotlin and Gra­dle allow rapid de­vel­op­ment of such project. The gen­er­ated jar can be ex­e­cuted on Rasp­berry Pi. These steps out­line the project setup and re­lated source code to show­case a Vert.x and Kotlin project with Gra­dle.</p><h2 id=\"project-directory-structure\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#project-directory-structure\"></a>Project Directory Structure</h2><p>From com­mand line (or via Win­dows Ex­plorer, what­ever you pre­fer to use) cre­ate a di­rec­tory for project,for in­stance <code>vertx-net-client</code>. Since we are using Kotlin, we will place all Kotlin files in <code>src/main/kotlin</code> folder. The <code>src/main/resources</code> folder will con­tain our log­ging con­fig­u­ra­tion re­lated files.</p><pre><code class=\"hljs language-awk\">cd vertx-net-client\nmkdir -p src<span class=\"hljs-regexp\">/main/</span>kotlin\nmkdir -p src<span class=\"hljs-regexp\">/main/</span>resources\n</code></pre><h3 id=\"project-files\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#project-files\"></a>Project Files</h3><p>We need to add fol­low­ing files in the project</p><ul><li><code>.gitignore</code>\nIf you want to check your project into git, you may con­sider adding fol­low­ing <code>.gitignore</code> file at root of your project</li></ul><div>...waiting for Gist...</div><ul><li><code>logback.xml</code>\nThis ex­am­ple is using slf4j and log­back for log­ging. If you de­cide to use it in your project, you may also add fol­low­ing log­back.xml file in <code>src/main/resources</code>. Mod­ify it as per your re­quire­ments. This ex­am­ple will\nlog on con­sole.</li></ul><div>...waiting for Gist...</div><h2 id=\"gradle-setup\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#gradle-setup\"></a>Gradle Setup</h2><p>We will use Gra­dle build sys­tem for this project. If you don’t al­ready have Gra­dle avail­able on your sys­tem, down­load and unzip gra­dle in a di­rec­tory of your choice (<code>$GRADLE_HOME</code> is used here to rep­re­sent this di­rec­tory). This gra­dle dis­tri­b­u­tion will be used as a start­ing point to cre­ate Gra­dle wrap­per scripts for our project. These scripts will allow our project to down­load and use cor­rect ver­sion of gra­dle dis­tri­b­u­tion au­to­mat­i­cally with­out mess­ing up sys­tem. Re­ally use­ful when build­ing your project on CI tool or on any other de­vel­oper’s ma­chine.</p><p>Run fol­low­ing com­mand in project’s di­rec­tory</p><pre><code class=\"hljs language-bash\"><span class=\"hljs-variable\">$GRADLE_HOME</span>/bin/gradle wrapper\n</code></pre><p>The above com­mands will gen­er­ate fol­low­ing files and di­rec­to­ries.</p><pre><code class=\"hljs language-bash\">gradle/  gradlew  gradlew.bat\n</code></pre><h3 id=\"gradle-build-file-buildgradle\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#gradle-build-file-buildgradle\"></a>Gradle build file <code>build.gradle</code></h3><p>Cre­ate (and/or copy and mod­ify) fol­low­ing <code>build.gradle</code> in your project’s root di­rec­tory. Our ex­am­ple gra­dle build file is using <a href=\"https://github.com/jponge/vertx-gradle-plugin/\">vertx-​gradle-plugin</a>.</p><div>...waiting for Gist...</div><p>In the project di­rec­tory, run fol­low­ing com­mand to down­load local gra­dle dis­tri­b­u­tion:</p><pre><code class=\"hljs language-bash\">./gradlew\n</code></pre><p>(or <code>.\\gradlew.bat</code> if in Win­dows)</p><p>At this stage we should have fol­low­ing file struc­ture. This is also a good time to com­mit changes if you are work­ing with git.</p><ul><li><code>.gitignore</code>                              </li><li><code>build.gradle</code>                            </li><li><code>gradle/wrapper/gradle-wrapper.jar</code>       </li><li><code>gradle/wrapper/gradle-wrapper.properties</code></li><li><code>gradlew</code>                                 </li><li><code>gradlew.bat</code></li><li><code>src/main/resources/logback.xml</code></li></ul><p>Now that our project struc­ture is ready, time to add the meat of the project. You may use any IDE of your choice. My pref­er­ence is In­tel­liJ IDEA.</p><p>Cre­ate a new pack­age under <code>src/main/kotlin</code>. The pack­age name should be adapted from the fol­low­ing sec­tion of <code>build.gradle</code></p><pre><code class=\"hljs language-ebnf\"><span class=\"hljs-attribute\">vertx</span> {\n<span class=\"hljs-attribute\">    mainVerticle</span> = <span class=\"hljs-string\">&quot;info.usmans.blog.vertx.NetClientVerticle&quot;</span>\n}\n</code></pre><p>From the above ex­am­ple, the pack­age name is <code>info.usmans.blog.vertx</code></p><p>Add a new Kotlin Class/file in <code>src/main/kotlin/info/usmans/blog/vertx</code> as <code>NetClientVerticle.kt</code></p><p>The con­tents of this class is as fol­lows</p><div>...waiting for Gist...</div><h2 id=\"explaining-the-code\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#explaining-the-code\"></a>Explaining the Code</h2><p>The <code>fun main(args: Array&lt;String&gt;)</code> is not strictly re­quired, it quickly al­lows run­ning the Vert.x ver­ti­cle from within IDE. You will also no­tice a small hack in the method for set­ting sys­tem prop­erty <code>vertx.disableDnsResolver</code> which is to avoid a Netty bug that I ob­served when run­ning on Win­dows ma­chine and re­mote server is down. Of course, since we are using vertx-​gradle-plugin, we can also use <code>gradle vertxRun</code> to run our ver­ti­cle. In this case the <code>main</code> method will not get called.</p><p>The <code>override fun start()</code> method calls <code>fireReconnectTimer</code> which in turn calls <code>reconnect</code> method. <code>reconnect</code> method con­tains the con­nec­tion logic to server as well as it calls <code>fireReconnectTimer</code> if it is un­able to con­nect to server or dis­con­nects from server. In <code>reconnect</code> method the <code>socket.handler</code> gets called when server send mes­sage to client.</p><pre><code class=\"hljs language-xl\"><span class=\"hljs-function\"><span class=\"hljs-title\">socket</span>.handler({ <span class=\"hljs-keyword\">data</span> -&gt;</span>\n                        logger.info(<span class=\"hljs-string\">&quot;Data received: ${data}&quot;</span>)\n                        <span class=\"hljs-comment\">//<span class=\"hljs-doctag\">TODO:</span> Do the work here ...</span>\n               })\n</code></pre><h2 id=\"distributing-the-project\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#distributing-the-project\"></a>Distributing the project</h2><p>To cre­ate re­dis­trib­utable jar, use <code>./gradlew shadowJar</code> com­mand. Or if using In­tel­liJ: from Gra­dle projects, Tasks, shadow, shad­ow­Jar (right click run). This com­mand will gen­er­ate <code>./build/libs/vertx-net-client-fat.jar</code>.</p><h3 id=\"executing-the-client\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#executing-the-client\"></a>Executing the client</h3><p>The client jar can be ex­e­cuted using fol­low­ing com­mand:</p><pre><code class=\"hljs language-bash\"> java -DserverHost=127.0.0.1 -DserverPort=8888 -DconnectMessage=<span class=\"hljs-string\">&quot;hello&quot;</span> -jar vertx-net-client-full.jar\n</code></pre><p>If you wish to use SLF4J for Vert.x in­ter­nal log­ging, you need to pass sys­tem prop­erty <code>vertx.logger-delegate-factory-class-name</code> with value of <code>io.vertx.core.logging.SLF4JLogDelegateFactory</code>. The final com­mand would look like:</p><pre><code class=\"hljs language-bash\">java -DserverHost=127.0.0.1 -DserverPort=8888 -DconnectMessage=<span class=\"hljs-string\">&quot;hello&quot;</span> -Dvertx.logger-delegate-factory-class-name=<span class=\"hljs-string\">&quot;io.vertx.core.logging.SLF4JLogDelegateFactory&quot;</span> -jar vertx-net-client-full.jar\n</code></pre><p>You can con­fig­ure Vert.x log­ging lev­els in log­back.xml file if re­quired.</p><h2 id=\"conclusion\"><a aria-hidden=\"true\" tabindex=\"-1\" class=\"heading-anchor\" href=\"#conclusion\"></a>Conclusion</h2><p>This post de­scribes how easy it is to cre­ate a sim­ple TCP client using Vert.x, Kotlin and Gra­dle build sys­tem. Hope­fully the tech­niques shown here will serve as a start­ing point for your next DIY project.</p><div class=\"alert info\"><p>This post is adapted and re­pro­duced from <a href=\"https://usmans.info/view/blog/tcp_client_using_vertx_kotlin_gradle\">au­thor’s blog post</a></p></div>","scope":{}}},"prevPost":{"meta":{"title":"Eclipse Vert.x based Framework URL Shortener Backend","category":"guides","authors":[{"name":"Lazar Bulić","github_id":"pendula95"}],"summary":"We combine Vert.x with the serverless framework to write a microservice that runs on AWS Lambda."},"date":"2017-12-21","slug":"eclipse-vert-x-based-framework-url-shortener-backend"},"nextPost":{"meta":{"title":"Eclipse Vert.x meets GraphQL","category":"guides","authors":[{"name":"Johannes Schüth","github_id":"jotschi"}],"summary":"In this blog post, we will look at an example application written in Vert.x that uses the new GraphQL API of Gentics Mesh."},"date":"2017-11-14","slug":"eclipse-vert-x-meets-graphql"},"relatedPosts":[{"meta":{"title":"Centralized logging for Vert.x applications using the ELK stack","category":"guides","authors":[{"name":"Ricardo Hernandez","github_id":"ricardohmon"}],"summary":"This post entry describes a solution to achieve centralized logging of Vert.x applications using the ELK stack (Logstash, Elasticsearch, and Kibana)."},"date":"2016-09-08","slug":"centralized-logging-for-vert-x-applications-using-the-elk-stack"},{"meta":{"title":"Using the asynchronous SQL client","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"Finally, back... This post is the fifth post of the introduction to vert.x blog series, after a not-that-small break. In this post we are going to see how we can use JDBC in a vert.x application."},"date":"2015-10-19","slug":"using-the-asynchronous-sql-client"},{"meta":{"title":"Some Rest with Vert.x","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"This post is part of the Introduction to Vert.x series. Let’s go a bit further this time and develop a CRUD-ish application"},"date":"2015-07-27","slug":"some-rest-with-vert-x"}]},"__N_SSG":true}