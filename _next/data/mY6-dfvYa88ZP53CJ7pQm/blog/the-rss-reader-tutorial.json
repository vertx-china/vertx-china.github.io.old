{"pageProps":{"categories":["releases","guides","security","news"],"post":{"meta":{"title":"The RSS reader tutorial","category":"guides","authors":[{"name":"Pavel Drankov","github_id":"Sammers21"}],"summary":"In this tutorial, you will learn how to use the Eclipse Vert.x Cassandra client in practice. We will develop an RSS reader with three HTTP endpoints."},"date":"2018-08-20","slug":"the-rss-reader-tutorial","readingTime":{"text":"7 min read","minutes":6.18,"time":370800,"words":1236},"content":{"compiledSource":"var d=Object.defineProperty,m=Object.defineProperties;var h=Object.getOwnPropertyDescriptors;var r=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;var o=(a,s,n)=>s in a?d(a,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[s]=n,e=(a,s)=>{for(var n in s||(s={}))p.call(s,n)&&o(a,n,s[n]);if(r)for(var n of r(s))i.call(s,n)&&o(a,n,s[n]);return a},l=(a,s)=>m(a,h(s));var c=(a,s)=>{var n={};for(var t in a)p.call(a,t)&&s.indexOf(t)<0&&(n[t]=a[t]);if(a!=null&&r)for(var t of r(a))s.indexOf(t)<0&&i.call(a,t)&&(n[t]=a[t]);return n};const makeShortcode=a=>function(n){return console.warn(\"Component \"+a+\" was not imported, exported, or provided by MDXProvider as global scope\"),mdx(\"div\",e({},n))},Link=makeShortcode(\"Link\"),layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var t=n,{components:a}=t,s=c(t,[\"components\"]);return mdx(MDXLayout,l(e(e({},layoutProps),s),{components:a,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"This tu\\xADto\\xADr\\xADial is ded\\xADi\\xADcated for users who\\u2019d like to know how to use the Eclipse Vert.x Cas\\xADsan\\xADdra client in prac\\xADtice.\"),mdx(\"h2\",e({},{id:\"before-you-start-this-tutorial\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#before-you-start-this-tutorial\"})),\"Before you start this tutorial\"),mdx(\"p\",null,\"Be\\xADfore start\\xADing, you should\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"be fa\\xADmil\\xADiar with \",mdx(Link,{href:\"/\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"Eclipse Vert.x\")),\". If you are not, here is the \",mdx(Link,{href:\"/docs/guide-for-java-devs/\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"guide for Java de\\xADvel\\xADop\\xADers\")),\".\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"have some basic un\\xADder\\xADstand\\xADing of data\\xADbases. Ex\\xADtended knowl\\xADedge of Cas\\xADsan\\xADdra is not re\\xADquired.\"))),mdx(\"p\",null,\"You also may find it use\\xADful to read \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://validator.w3.org/feed/docs/rss2.html\"}),\"the RSS 2.0\"),\" spec\\xADi\\xADfi\\xADca\\xADtion, be\\xADcause the re\\xADsulted app is, ba\\xADsi\\xADcally, a stor\\xADage of RSS 2.0 feeds.\"),mdx(\"p\",null,\"To give you an idea of what the App is about, here is how it looks like from the fronted side:\"),mdx(\"p\",null,mdx(\"img\",e({parentName:\"p\"},{src:\"https://i.imgur.com/2V954zx.png\",alt:\"see how it looks\"}))),mdx(\"p\",null,\"In the image, we see that browser space is split into 2 parts:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"Saved feed names\"),mdx(\"li\",{parentName:\"ol\"},\"List of ar\\xADti\\xADcles for the se\\xADlected feed\")),mdx(\"p\",null,`Here you also can enter a link to a new feed, so the App will fetch and parse the feed.\nAfter that, it will ap\\xADpear in the left col\\xADumn along with other saved feeds.`),mdx(\"h2\",e({},{id:\"requirements\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#requirements\"})),\"Requirements\"),mdx(\"p\",null,\"For com\\xADplet\\xADing this tu\\xADto\\xADr\\xADial you need:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Java 8 or higher\"),mdx(\"li\",{parentName:\"ul\"},\"Git\"),mdx(\"li\",{parentName:\"ul\"},\"1 hour of your time\"),mdx(\"li\",{parentName:\"ul\"},\"You fa\\xADvorite code ed\\xADi\\xADtor\")),mdx(\"p\",null,`For run\\xADning the ex\\xADam\\xADple you should en\\xADsure that Cas\\xADsan\\xADdra ser\\xADvice is run\\xADning lo\\xADcally on port 9042.\nAs an op\\xADtion, you can run Cas\\xADsan\\xADdra with `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/riptano/ccm#installation\"}),\"ccm\"),`(Cas\\xADsan\\xADdra Clus\\xADter Man\\xADager).\nFol\\xADlow `,mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/riptano/ccm#installation\"}),\"this\"),` in\\xADstruc\\xADtions for in\\xADstalling ccm.\nAfter in\\xADstalling you will be able to run a sin\\xADgle node clus\\xADter:`),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-better-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-meta\"}),\"$\"),mdx(\"span\",e({parentName:\"code\"},{className:\"bash\"}),\" ccm create rss_reader -v 3.11.2 -n 1 -s\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-meta\"}),\"$\"),mdx(\"span\",e({parentName:\"code\"},{className:\"bash\"}),\" ccm start\"),`\n`)),mdx(\"p\",null,\"Be\\xADfore com\\xADplet\\xADing this step make sure that you have suc\\xADcess\\xADfully cloned the RSS reader repos\\xADi\\xADtory and checked out the \",mdx(\"inlineCode\",{parentName:\"p\"},\"step_1\"),\" branch:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-better-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-meta\"}),\"$\"),mdx(\"span\",e({parentName:\"code\"},{className:\"bash\"}),\" git \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-built_in\"}),\"clone\"),\" https://github.com/Sammers21/rss-reader\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-meta\"}),\"$\"),mdx(\"span\",e({parentName:\"code\"},{className:\"bash\"}),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-built_in\"}),\"cd\"),\" rss-reader\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-meta\"}),\"$\"),mdx(\"span\",e({parentName:\"code\"},{className:\"bash\"}),\" git checkout step_1\"),`\n`)),mdx(\"p\",null,\"Now you can try to tun this ex\\xADam\\xADple and see if it works:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-better-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-meta\"}),\"$\"),mdx(\"span\",e({parentName:\"code\"},{className:\"bash\"}),\" ./gradlew vertxRun\"),`\n`)),mdx(\"h2\",e({},{id:\"schema\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#schema\"})),\"Schema\"),mdx(\"p\",null,\"If you are fa\\xADmil\\xADiar with \",mdx(\"a\",e({parentName:\"p\"},{href:\"http://cassandra.apache.org/\"}),\"Apache Cas\\xADsan\\xADdra\"),`, you\nshould know that the way your data is stored in Cas\\xADsan\\xADdra is de\\xADpen\\xADdent on queries\nyou are run\\xADning. It means that you need first to fig\\xADure out what kind of queries\nyou will be run\\xADning, and then you can pro\\xADduce a stor\\xADage scheme.`),mdx(\"p\",null,\"In our case, we\\u2019d like our ap\\xADpli\\xADca\\xADtion to have 3 end\\xADpoints:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},mdx(\"inlineCode\",{parentName:\"li\"},\"POST /user/{user_id}/rss_link\"),\" - for adding links to a user\\u2019s feed\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"inlineCode\",{parentName:\"li\"},\"GET /user/{user_id}/rss_channels\"),\" - for re\\xADtriev\\xADing in\\xADfor\\xADma\\xADtion about RSS chan\\xADnels a user sub\\xADscribed on\"),mdx(\"li\",{parentName:\"ol\"},mdx(\"inlineCode\",{parentName:\"li\"},\"GET /articles/by_rss_link?link={rss_link}\"),\" - for re\\xADtriev\\xADing in\\xADfor\\xADma\\xADtion about ar\\xADti\\xADcles on a spe\\xADcific RSS chan\\xADnel\")),mdx(\"p\",null,\"For im\\xADple\\xADment\\xADing this end\\xADpoints, the schema should look as fol\\xADlows:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-sql\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"CREATE\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"TABLE\"),\" rss_by_user (login text , rss_link text, \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"PRIMARY\"),` KEY (login, rss_link));\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"CREATE\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"TABLE\"),\" articles_by_rss_link(rss_link text, pubDate \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-type\"}),\"timestamp\"),\", title text, article_link text, description text, \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"PRIMARY\"),` KEY ( rss_link , pubDate , article_link));\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"CREATE\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"TABLE\"),\" channel_info_by_rss_link(rss_link text, last_fetch_time \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-type\"}),\"timestamp\"),\",title text, site_link text, description text, \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"PRIMARY\"),` KEY(rss_link));\n`)),mdx(\"h2\",e({},{id:\"what-to-do-in-this-step\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#what-to-do-in-this-step\"})),\"What to do in this step\"),mdx(\"p\",null,\"In this step, we will im\\xADple\\xADment only the first end\\xADpoint\"),mdx(\"h2\",e({},{id:\"project-overview\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#project-overview\"})),\"Project overview\"),mdx(\"p\",null,\"There are two no\\xADtable classes in the project: \",mdx(\"inlineCode\",{parentName:\"p\"},\"AppVerticle\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"FetchVerticle\"),\". The first one is a \",mdx(Link,{href:\"/docs/vertx-core/java/#_verticles\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"Ver\\xADti\\xADcle\")),\" re\\xADspon\\xADsi\\xADble for HTTP re\\xADquest han\\xADdling and stor\\xADage schema ini\\xADtial\\xADiza\\xADtion. The sec\\xADond one is a \",mdx(Link,{href:\"/docs/vertx-core/java/#_verticles\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"Ver\\xADti\\xADcle\")),\" as well, but re\\xADspon\\xADsi\\xADble for RSS feeds fetch\\xADing.\"),mdx(\"p\",null,\"The idea is sim\\xADple. When the ap\\xADpli\\xADca\\xADtion is start\\xADing the \",mdx(\"inlineCode\",{parentName:\"p\"},\"AppVerticle\"),\" is de\\xADployed, then it tries to ini\\xADtial\\xADize stor\\xADage schema, de\\xADscribed in \",mdx(\"inlineCode\",{parentName:\"p\"},\"src/main/resources/schema.cql\"),\" file by read\\xADing it and ex\\xADe\\xADcut\\xADing listed queries line by line. After the schema ini\\xADtial\\xADiza\\xADtion the \",mdx(\"inlineCode\",{parentName:\"p\"},\"AppVerticle\"),\" de\\xADploys \",mdx(\"inlineCode\",{parentName:\"p\"},\"FetchVerticle\"),\" and starts a HTTP server.\"),mdx(\"h2\",e({},{id:\"implementing-the-endpoint\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#implementing-the-endpoint\"})),\"Implementing the endpoint\"),mdx(\"p\",null,\"Now, it is time to im\\xADple\\xADment the first end\\xADpoint. Pay at\\xADten\\xADtion to \",mdx(\"inlineCode\",{parentName:\"p\"},\"TODO\"),\"s, they are for point\\xADing you out about where changes should be made.\"),mdx(\"p\",null,\"Now, let\\u2019s have a look at the \",mdx(\"inlineCode\",{parentName:\"p\"},\"AppVerticle#postRssLink\"),\" method. This method is called each time the first end\\xADpoint is called, so we can fig\\xADure out what is the posted body and id of the user, who per\\xADformed the re\\xADquest, di\\xADrectly there. There are 2 main things we want to do in this method:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"No\\xADti\\xADfy\\xADing via the \",mdx(Link,{href:\"/docs/vertx-core/java/#event_bus\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"li\"},{href:\"\"}),\"Event Bus\")),\" the \",mdx(\"inlineCode\",{parentName:\"li\"},\"FetchVerticle\"),\" to fetch given by user link link to an RSS feed.\"),mdx(\"li\",{parentName:\"ol\"},\"In\\xADsert\\xADing an entry to the \",mdx(\"inlineCode\",{parentName:\"li\"},\"rss_by_user\"),\" table.\")),mdx(\"p\",null,\"This is how the \",mdx(\"inlineCode\",{parentName:\"p\"},\"AppVerticle#postRssLink\"),\" method should be im\\xADple\\xADmented:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"private\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"postRssLink\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(RoutingContext ctx)\"),\" \"),`{\n    ctx.request().bodyHandler(body -> {\n        JsonObject bodyAsJson = body.toJsonObject();\n        String link = bodyAsJson.getString(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"link\"'),`);\n        String userId = ctx.request().getParam(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"user_id\"'),`);\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"if\"),\" (link == \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"null\"),\" || userId == \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"null\"),`) {\n            responseWithInvalidRequest(ctx);\n        } `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"else\"),` {\n            vertx.eventBus().send(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"fetch.rss.link\"'),`, link);\n            Future<ResultSet> future = Future.future();\n            BoundStatement query = insertNewLinkForUser.bind(userId, link);\n            client.execute(query, future);\n            future.setHandler(result -> {\n                `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"if\"),` (result.succeeded()) {\n                    ctx.response().end(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"new\"),\" JsonObject().put(\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"message\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"The feed just added\"'),`).toString());\n                } `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"else\"),` {\n                    ctx.response().setStatusCode(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-number\"}),\"400\"),`).end(result.cause().getMessage());\n                }\n            });\n        }\n    });\n}\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"private\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"responseWithInvalidRequest\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(RoutingContext ctx)\"),\" \"),`{\n    ctx.response()\n            .setStatusCode(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-number\"}),\"400\"),`)\n            .putHeader(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"content-type\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"application/json; charset=utf-8\"'),`)\n            .end(invalidRequest().toString());\n}\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"private\"),\" JsonObject \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"invalidRequest\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"()\"),\" \"),`{\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"return\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"new\"),\" JsonObject().put(\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"message\"'),\", \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"Invalid request\"'),`);\n}\n`)),mdx(\"p\",null,\"You may no\\xADtice that \",mdx(\"inlineCode\",{parentName:\"p\"},\"insertNewLinkForUser\"),\" is a \",mdx(\"inlineCode\",{parentName:\"p\"},\"PreparedStatement\"),\", and should be ini\\xADtial\\xADized be\\xADfore the \",mdx(\"inlineCode\",{parentName:\"p\"},\"AppVerticle\"),\" start. Let\\u2019s do it in the \",mdx(\"inlineCode\",{parentName:\"p\"},\"AppVerticle#prepareNecessaryQueries\"),\" method:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"private\"),\" Future<Void> \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"prepareNecessaryQueries\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"()\"),\" \"),`{\n    Future<PreparedStatement> insertNewLinkForUserPrepFuture = Future.future();\n    client.prepare(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"INSERT INTO rss_by_user (login , rss_link ) VALUES ( ?, ?);\"'),`, insertNewLinkForUserPrepFuture);\n\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"return\"),` insertNewLinkForUserPrepFuture.compose(preparedStatement -> {\n        insertNewLinkForUser = preparedStatement;\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"return\"),` Future.succeededFuture();\n    });\n}\n`)),mdx(\"p\",null,\"Also, we should not for\\xADget to fetch a RSS by the link sent to \",mdx(\"inlineCode\",{parentName:\"p\"},\"FetchVerticle\"),\" via the Event Bus. We can do it in the \",mdx(\"inlineCode\",{parentName:\"p\"},\"FetchVerticle#startFetchEventBusConsumer\"),\" method:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),\"vertx.eventBus().localConsumer(\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"fetch.rss.link\"'),`, message -> {\n    String rssLink = (String) message.body();\n    log.info(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"fetching \"'),` + rssLink);\n    webClient.getAbs(rssLink).send(response -> {\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"if\"),` (response.succeeded()) {\n            String bodyAsString = response.result().bodyAsString(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"UTF-8\"'),`);\n            `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"try\"),` {\n                RssChannel rssChannel = `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"new\"),` RssChannel(bodyAsString);\n\n                BatchStatement batchStatement = `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"new\"),` BatchStatement();\n                BoundStatement channelInfoInsertQuery = insertChannelInfo.bind(\n                        rssLink, `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"new\"),` Date(System.currentTimeMillis()), rssChannel.description, rssChannel.link, rssChannel.title\n                );\n                batchStatement.add(channelInfoInsertQuery);\n\n                `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"for\"),` (Article article : rssChannel.articles) {\n                    batchStatement.add(insertArticleInfo.bind(rssLink, article.pubDate, article.link, article.description, article.title));\n                }\n                Future<ResultSet> insertArticlesFuture = Future.future();\n                cassandraClient.execute(batchStatement, insertArticlesFuture);\n\n                insertArticlesFuture.compose(insertDone -> Future.succeededFuture());\n            } `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"catch\"),` (Exception e) {\n                log.error(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"Unable to fetch: \"'),` + rssLink, e);\n            }\n        } `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"else\"),` {\n            log.error(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"Unable to fetch: \"'),` + rssLink);\n        }\n    });\n});\n`)),mdx(\"p\",null,\"And, fi\\xADnally, this code would not work if \",mdx(\"inlineCode\",{parentName:\"p\"},\"insertChannelInfo\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"insertArticleInfo\"),\" state\\xADments will not be ini\\xADtial\\xADized at ver\\xADti\\xADcle start. Let\\u2019s to this in the \",mdx(\"inlineCode\",{parentName:\"p\"},\"FetchVerticle#prepareNecessaryQueries\"),\" method:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"private\"),\" Future<Void> \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"prepareNecessaryQueries\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"()\"),\" \"),`{\n        Future<PreparedStatement> insertChannelInfoPrepFuture = Future.future();\n        cassandraClient.prepare(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"INSERT INTO channel_info_by_rss_link ( rss_link , last_fetch_time, description , site_link , title ) VALUES (?, ?, ?, ?, ?);\"'),`, insertChannelInfoPrepFuture);\n\n        Future<PreparedStatement> insertArticleInfoPrepFuture = Future.future();\n        cassandraClient.prepare(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"INSERT INTO articles_by_rss_link ( rss_link , pubdate , article_link , description , title ) VALUES ( ?, ?, ?, ?, ?);\"'),`, insertArticleInfoPrepFuture);\n\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"return\"),` CompositeFuture.all(\n                insertChannelInfoPrepFuture.compose(preparedStatement -> {\n                    insertChannelInfo = preparedStatement;\n                    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"return\"),` Future.succeededFuture();\n                }), insertArticleInfoPrepFuture.compose(preparedStatement -> {\n                    insertArticleInfo = preparedStatement;\n                    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"return\"),` Future.succeededFuture();\n                })\n        ).mapEmpty();\n    }\n`)),mdx(\"h2\",e({},{id:\"observing\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#observing\"})),\"Observing\"),mdx(\"p\",null,\"After all these changes, you should en\\xADsure that the first end\\xADpoint is work\\xADing cor\\xADrectly. You need to run the ap\\xADpli\\xADca\\xADtion, go to lo\\xADcal\\xADhost:8080 in\\xADsert a link to a rss feed there(\",mdx(\"a\",e({parentName:\"p\"},{href:\"http://feeds.bbci.co.uk/news/uk/rss.xml\"}),\"BBC UK feed news\"),\" for ex\\xADam\\xADple) and then click the \",mdx(\"em\",{parentName:\"p\"},\"ENTER\"),\" but\\xADton. Now you can con\\xADnect to your local Cas\\xADsan\\xADdra in\\xADstance, for in\\xADstance with \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://docs.datastax.com/en/cql/3.3/cql/cql_reference/cqlsh.html\"}),\"cqlsh\"),\", and find out how RSS feed data had been saved in the rss_reader key\\xADspace:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-sql\"}),\"cqlsh\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\">\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"SELECT\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\"*\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"FROM\"),\" rss_reader.rss_by_user limit \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),`  ;\n\n login `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\"|\"),` rss_link\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"-------+-----------------------------------------\"),`\n Pavel `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\"|\"),\" http:\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\"/\"),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\"/\"),\"feeds.bbci.co.uk\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\"/\"),\"news\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\"/\"),\"uk\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\"/\"),`rss.xml\n\n(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"rows\"),`)\ncqlsh`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-operator\"}),\">\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"SELECT\"),\" description \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"FROM\"),\" rss_reader.articles_by_rss_link  limit \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),`;\n\n description\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"-------------------------------------\"),`\n BBC coverage `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"of\"),` latest developments\n\n(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"rows\"),`)\n`)),mdx(\"h2\",e({},{id:\"conclusion\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#conclusion\"})),\"Conclusion\"),mdx(\"p\",null,\"In this ar\\xADti\\xADcle we fig\\xADured out how to im\\xADple\\xADment the first end\\xADpoint of RSS-\\u200Breader app. If you have any prob\\xADlems with com\\xADplet\\xADing this step you can check\\xADout to \",mdx(\"inlineCode\",{parentName:\"p\"},\"step_2\"),\", where you can find all changes made for com\\xADplet\\xADing this step:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-better-shell\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-meta\"}),\"$\"),mdx(\"span\",e({parentName:\"code\"},{className:\"bash\"}),\" git checkout step_2\"),`\n`)),mdx(\"p\",null,\"Thanks for read\\xADing this. I hope you en\\xADjoyed read\\xADing this ar\\xADti\\xADcle. See you soon on our \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://gitter.im/eclipse-vertx/vertx-users\"}),\"Git\\xADter chan\\xADnel\"),\"!\"))}MDXContent.isMDXComponent=!0;\n","scope":{}}},"prevPost":{"meta":{"title":"The RSS reader tutorial (Step 2)","category":"guides","authors":[{"name":"Pavel Drankov","github_id":"Sammers21"}],"summary":"In this second installment of our Vert.x Cassandra Client tutorial, we will add an endpoint that produces an array of RSS channels for a given user ID."},"date":"2018-09-05","slug":"the-rss-reader-tutorial-step-2"},"nextPost":{"meta":{"title":"Eclipse Vert.x 3.5.3","category":"releases","authors":[{"name":"Julien Viet","github_id":"vietj"}],"summary":"We have just released Vert.x 3.5.3, a bug fix release of Vert.x 3.5.x."},"date":"2018-07-13","slug":"eclipse-vert-x-3-5-3"},"relatedPosts":[{"meta":{"title":"The RSS reader tutorial (Step 2)","category":"guides","authors":[{"name":"Pavel Drankov","github_id":"Sammers21"}],"summary":"In this second installment of our Vert.x Cassandra Client tutorial, we will add an endpoint that produces an array of RSS channels for a given user ID."},"date":"2018-09-05","slug":"the-rss-reader-tutorial-step-2"},{"meta":{"title":"Easy SSO for Vert.x with Keycloak","category":"guides","authors":[{"name":"Thomas Darimont","github_id":"thomasdarimont"}],"summary":"In this blog post, you'll learn how to implement Single Sign-on with OpenID Connect and how to use Keycloak together with Eclipse Vert.x."},"date":"2020-03-16","slug":"easy-sso-for-vert-x-with-keycloak"},{"meta":{"title":"Unit and Integration Tests","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"Let’s refresh our mind about what we developed so far in the introduction to vert.x series. We forgot an important task. We didn’t test the API."},"date":"2015-08-03","slug":"unit-and-integration-tests"}]},"__N_SSG":true}