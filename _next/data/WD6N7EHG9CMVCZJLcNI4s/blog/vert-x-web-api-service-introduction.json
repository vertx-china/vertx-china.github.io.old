{"pageProps":{"categories":["releases","guides","news"],"post":{"meta":{"title":"Vert.x Web API Service Introduction","category":"guides","authors":[{"name":"Francesco Guardiani","github_id":"slinkydeveloper"}],"summary":"This blog post teaches you how to use the new module vertx-web-api-service to combine the Web Router and the OpenAPI Router Factory with service proxies."},"date":"2018-12-13","slug":"vert-x-web-api-service-introduction","readingTime":{"text":"6 min read","minutes":5.555,"time":333300,"words":1111},"content":{"compiledSource":"var i=Object.defineProperty,d=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var r=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;var l=(a,s,n)=>s in a?i(a,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[s]=n,e=(a,s)=>{for(var n in s||(s={}))p.call(s,n)&&l(a,n,s[n]);if(r)for(var n of r(s))o.call(s,n)&&l(a,n,s[n]);return a},c=(a,s)=>d(a,N(s));var m=(a,s)=>{var n={};for(var t in a)p.call(a,t)&&s.indexOf(t)<0&&(n[t]=a[t]);if(a!=null&&r)for(var t of r(a))s.indexOf(t)<0&&o.call(a,t)&&(n[t]=a[t]);return n};const makeShortcode=a=>function(n){return console.warn(\"Component \"+a+\" was not imported, exported, or provided by MDXProvider as global scope\"),mdx(\"div\",e({},n))},Link=makeShortcode(\"Link\"),layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var t=n,{components:a}=t,s=m(t,[\"components\"]);return mdx(MDXLayout,c(e(e({},layoutProps),s),{components:a,mdxType:\"MDXLayout\"}),mdx(\"p\",null,\"Vert.x 3.6 in\\xADtro\\xADduces a new mod\\xADule called \",mdx(\"inlineCode\",{parentName:\"p\"},\"vertx-web-api-service\"),\". With the new Web API Ser\\xADvices you can eas\\xADily com\\xADbine the \",mdx(Link,{href:\"/docs/vertx-web/java/\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"Vert.x Web Router\")),\" and the \",mdx(Link,{href:\"/docs/vertx-web-api-contract/java/\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"Vert.x Ope\\xADnAPI Router Fac\\xADtory\")),\" fea\\xADtures with \",mdx(Link,{href:\"/docs/vertx-service-proxy/java/\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"Vert.x Ser\\xADvices on Event Bus\")),\".\"),mdx(\"h2\",e({},{id:\"small-recap-on-openapi-and-vertx-web-api-contract\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#small-recap-on-openapi-and-vertx-web-api-contract\"})),\"Small recap on OpenAPI and Vert.x Web API Contract\"),mdx(\"p\",null,\"Let\\u2019s start from this Ope\\xADnAPI de\\xADf\\xADi\\xADn\\xADi\\xADtion:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-yaml\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"openapi:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-number\"}),\"3.0\"),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-number\"}),\".0\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"paths:\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"/api/transactions:\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"get:\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"operationId:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"getTransactionsList\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"description:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"Get\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"transactions\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"list\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"filtered\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"by\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"sender\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"x-vertx-event-bus:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"transactions_manager.myapp\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"parameters:\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-bullet\"}),\"-\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"name:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"from\"),`\n          `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"in:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"query\"),`\n          `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"description:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"Matches\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"exactly\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"the\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"email\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"from\"),`\n          `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"style:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"form\"),`\n          `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"explode:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-literal\"}),\"false\"),`\n          `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"schema:\"),`\n            `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"type:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"array\"),`\n            `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"items:\"),`\n              `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"type:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"string\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"responses:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"...\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"post:\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"operationId:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"addTransaction\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"x-vertx-event-bus:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"transactions_manager.myapp\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"requestBody:\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"required:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-literal\"}),\"true\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"content:\"),`\n          `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"application/json:\"),`\n            `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"schema:\"),`\n              `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"$ref:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"#/components/schemas/Transaction\"'),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"responses:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"...\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"/api/transactions/{transactionId}:\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"parameters:\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-bullet\"}),\"-\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"name:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"transactionId\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"in:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"path\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"required:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-literal\"}),\"true\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"schema:\"),`\n          `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"type:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"string\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"put:\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"operationId:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"updateTransaction\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"x-vertx-event-bus:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"transactions_manager.myapp\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"requestBody:\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"required:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-literal\"}),\"true\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"content:\"),`\n          `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"application/json:\"),`\n            `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"schema:\"),`\n              `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"$ref:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"#/components/schemas/Transaction\"'),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"responses:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"...\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"delete:\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"operationId:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"removeTransaction\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"x-vertx-event-bus:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"transactions_manager.myapp\"),`\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"responses:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"...\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"components:\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"schemas:\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"Transaction:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"...\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-attr\"}),\"Error:\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),\"...\"),`\n`)),mdx(\"p\",null,\"We de\\xADfined \",mdx(\"inlineCode\",{parentName:\"p\"},\"getTransactionsList\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"addTransaction\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"updateTransaction\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"removeTransaction\"),\" op\\xADer\\xADa\\xADtions. Now with \",mdx(\"inlineCode\",{parentName:\"p\"},\"OpenAPI3RouterFactory\"),\" we cre\\xADate a \",mdx(\"inlineCode\",{parentName:\"p\"},\"Router\"),\" that ac\\xADcepts this var\\xADi\\xADous op\\xADer\\xADa\\xADtion re\\xADquests:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),\"OpenAPI3RouterFactory.create(vertx, \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"src/main/resources/petstore.yaml\"'),`, ar -> {\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"if\"),` (ar.succeeded()) {\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Spec loaded with success\"),`\n    OpenAPI3RouterFactory routerFactory = ar.result();\n    routerFactory.addHandlerByOperationId(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"getTransactionsList\"'),`, routingContext -> {\n      RequestParameters params = routingContext.get(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"parsedParameters\"'),`);\n      RequestParameter from = params.queryParameter(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"from\"'),`);\n      `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// getTransactionsList business logic\"),`\n    });\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// add handlers for addTransaction, updateTransaction and removeTransaction\"),`\n    Router router = routerFactory.getRouter();\n  } `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"else\"),` {\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Something went wrong during router factory initialization\"),`\n    Throwable exception = ar.cause();\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Log exception, fail verticle deployment ... etc\"),`\n  }\n});\n`)),mdx(\"p\",null,\"The \",mdx(\"inlineCode\",{parentName:\"p\"},\"OpenAPI3RouterFactory\"),\" pro\\xADvides an easy way to cre\\xADate a spec\\xADi\\xADfi\\xADca\\xADtion com\\xADpli\\xADant \",mdx(\"inlineCode\",{parentName:\"p\"},\"Router\"),\", but it doesn\\u2019t pro\\xADvide a mech\\xADa\\xADnism to de\\xADcou\\xADple the busi\\xADness logic from your op\\xADer\\xADa\\xADtion han\\xADdlers.\"),mdx(\"p\",null,\"In a typ\\xADi\\xADcal Vert.x ap\\xADpli\\xADca\\xADtion, when you re\\xADceive a re\\xADquest to your router, you would for\\xADward it to an event bus end\\xADpoint that per\\xADforms some ac\\xADtions and sends the re\\xADsult back to the op\\xADer\\xADa\\xADtion han\\xADdler.\"),mdx(\"p\",null,\"Vert.x Web API Ser\\xADvice sim\\xADpli\\xADfies that in\\xADte\\xADgra\\xADtion be\\xADtween \",mdx(\"inlineCode\",{parentName:\"p\"},\"RouterFactory\"),\" and \",mdx(\"inlineCode\",{parentName:\"p\"},\"EventBus\"),\" with a new code gen\\xADer\\xADa\\xADtor. The final re\\xADsult is a \",mdx(\"em\",{parentName:\"p\"},\"loose cou\\xADpling\"),\" be\\xADtween the Web Router logic and your busi\\xADness logic.\"),mdx(\"h2\",e({},{id:\"lets-get-started-with-vertx-web-api-services\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#lets-get-started-with-vertx-web-api-services\"})),\"Let\\u2019s get started with Vert.x Web Api Services!\"),mdx(\"p\",null,\"To use \",mdx(\"inlineCode\",{parentName:\"p\"},\"vertx-web-api-service\"),\" you need to add a cou\\xADple of de\\xADpen\\xADden\\xADcies to your project. In a Maven POM file that would be:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-xml\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"<\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"dependency\"),\">\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"<\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"groupId\"),\">\"),\"io.vertx\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"</\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"groupId\"),\">\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"<\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"artifactId\"),\">\"),\"vertx-codegen\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"</\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"artifactId\"),\">\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"<\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"version\"),\">\"),\"3.6.0\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"</\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"version\"),\">\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"<\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"classifier\"),\">\"),\"processor\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"</\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"classifier\"),\">\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"</\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"dependency\"),\">\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"<\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"dependency\"),\">\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"<\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"groupId\"),\">\"),\"io.vertx\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"</\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"groupId\"),\">\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"<\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"artifactId\"),\">\"),\"vertx-web-api-service\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"</\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"artifactId\"),\">\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"<\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"version\"),\">\"),\"3.6.0\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"</\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"version\"),\">\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-tag\"}),\"</\",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-name\"}),\"dependency\"),\">\"),`\n`)),mdx(\"p\",null,\"We will pro\\xADceed in this order:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"Model the ser\\xADvice in\\xADter\\xADface\"),mdx(\"li\",{parentName:\"ol\"},\"Rewrite it to work with Web Api Ser\\xADvices\"),mdx(\"li\",{parentName:\"ol\"},\"Im\\xADple\\xADment the ser\\xADvice\"),mdx(\"li\",{parentName:\"ol\"},\"Mount the ser\\xADvice on the event bus\"),mdx(\"li\",{parentName:\"ol\"},\"Use the router fac\\xADtory to build a router with han\\xADdlers that con\\xADnects to our event bus ser\\xADvices\")),mdx(\"h2\",e({},{id:\"model-your-service\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#model-your-service\"})),\"Model your service\"),mdx(\"p\",null,\"Let\\u2019s say that we want to model a ser\\xADvice that man\\xADages all op\\xADer\\xADa\\xADtions re\\xADgard\\xADing CRUD trans\\xADac\\xADtions. An ex\\xADam\\xADple in\\xADter\\xADface for this asyn\\xADchro\\xADnous ser\\xADvice could be:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"public\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-class\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"interface\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"TransactionsManagerService\"),\" \"),`{\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"getTransactionsList\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(List<String> from, Handler<AsyncResult<List<Transaction>>> resultHandler)\")),`;\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"addTransaction\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(Transaction transaction, Handler<AsyncResult<Transaction>> resultHandler)\")),`;\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"updateTransaction\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(String transactionId, Transaction transaction, Handler<AsyncResult<Transaction>> resultHandler)\")),`;\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"removeTransaction\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(String transactionId, Handler<AsyncResult<Integer>> resultHandler)\")),`;\n}\n`)),mdx(\"p\",null,\"For each op\\xADer\\xADa\\xADtion, we have some pa\\xADra\\xADme\\xADters, de\\xADpend\\xADing on the op\\xADer\\xADa\\xADtion, and a call\\xADback (\",mdx(\"inlineCode\",{parentName:\"p\"},\"resultHandler\"),\") that should be called when the op\\xADer\\xADa\\xADtion suc\\xADceeds or fails.\"),mdx(\"p\",null,\"With \",mdx(Link,{href:\"/docs/vertx-service-proxy/java/\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"Vert.x Ser\\xADvice Proxy\")),\", you can de\\xADfine an event bus ser\\xADvice with a Java in\\xADter\\xADface sim\\xADi\\xADlar to the one we just saw and then an\\xADno\\xADtate it with \",mdx(\"inlineCode\",{parentName:\"p\"},\"@ProxyGen\"),\". This an\\xADno\\xADta\\xADtion will gen\\xADer\\xADate a \",mdx(\"em\",{parentName:\"p\"},\"ser\\xADvice han\\xADdler\"),\" for the de\\xADfined ser\\xADvice that can be plugged to the event bus with \",mdx(\"inlineCode\",{parentName:\"p\"},\"ServiceBinder\"),\". \",mdx(\"inlineCode\",{parentName:\"p\"},\"vertx-web-api-service\"),\" works in a very sim\\xADi\\xADlar way: you need to an\\xADno\\xADtate the Java in\\xADter\\xADface with \",mdx(\"inlineCode\",{parentName:\"p\"},\"@WebApiServiceGen\"),\" and it will gen\\xADer\\xADate the ser\\xADvice han\\xADdler for the event bus.\"),mdx(\"p\",null,\"Let\\u2019s rewrite the \",mdx(\"inlineCode\",{parentName:\"p\"},\"TransactionsManagerService\"),\" to work with Web API Ser\\xADvice:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"import\"),` io.vertx.ext.web.api.*;\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"import\"),` io.vertx.ext.web.api.generator.WebApiServiceGen;\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-meta\"}),\"@WebApiServiceGen\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"public\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-class\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"interface\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"TransactionsManagerService\"),\" \"),`{\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"getTransactionsList\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(List<String> from, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)\")),`;\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"addTransaction\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(Transaction body, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)\")),`;\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"updateTransaction\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(String transactionId, Transaction body, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)\")),`;\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"removeTransaction\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(String transactionId, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)\")),`;\n\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Factory method to instantiate the implementation\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"static\"),\" TransactionsManagerService \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"create\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(Vertx vertx)\"),\" \"),`{\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"return\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"new\"),` TransactionsManagerServiceImpl(vertx);\n  }\n}\n\n`)),mdx(\"p\",null,\"First of all, look at the an\\xADno\\xADta\\xADtion \",mdx(\"inlineCode\",{parentName:\"p\"},\"@WebApiServiceGen\"),\". This an\\xADno\\xADta\\xADtion will trig\\xADger the code gen\\xADer\\xADa\\xADtor that gen\\xADer\\xADates the event bus han\\xADdler for this ser\\xADvice. Each method has the same two last pa\\xADra\\xADme\\xADters:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"OperationRequest context\"),\": this data ob\\xADject con\\xADtains the head\\xADers and the pa\\xADra\\xADme\\xADters of the HTTP re\\xADquest\"),mdx(\"li\",{parentName:\"ul\"},mdx(\"inlineCode\",{parentName:\"li\"},\"Handler<AsyncResult<OperationResponse>> resultHandler\"),\": this call\\xADback ac\\xADcepts an \",mdx(\"inlineCode\",{parentName:\"li\"},\"OperationResponse\"),\" data ob\\xADject that will en\\xADcap\\xADsu\\xADlate the body of the re\\xADsult, the sta\\xADtus code, the sta\\xADtus mes\\xADsage and the head\\xADers\")),mdx(\"p\",null,\"The gen\\xADer\\xADated han\\xADdler re\\xADceives only the \",mdx(\"inlineCode\",{parentName:\"p\"},\"OperationRequest\"),\" data ob\\xADject and ex\\xADtracts from it all op\\xADer\\xADa\\xADtion pa\\xADra\\xADme\\xADters. For ex\\xADam\\xADple, when the router re\\xADceives a re\\xADquest at \",mdx(\"inlineCode\",{parentName:\"p\"},\"getTransactionsList\"),\", it sends to \",mdx(\"inlineCode\",{parentName:\"p\"},\"TransactionsManagerService\"),\" the \",mdx(\"inlineCode\",{parentName:\"p\"},\"OperationRequest\"),\" con\\xADtain\\xADing the \",mdx(\"inlineCode\",{parentName:\"p\"},\"RequestParameters\"),\" map. From this map, the ser\\xADvice gen\\xADer\\xADated han\\xADdler ex\\xADtracts the \",mdx(\"inlineCode\",{parentName:\"p\"},\"from\"),\" pa\\xADra\\xADme\\xADter. \"),mdx(\"p\",null,\"There\\xADfore \",mdx(\"strong\",{parentName:\"p\"},\"op\\xADer\\xADa\\xADtion pa\\xADra\\xADme\\xADters names should match method pa\\xADra\\xADme\\xADter names\"),\".\"),mdx(\"p\",null,\"When you want to ex\\xADtract the body you must use \",mdx(\"inlineCode\",{parentName:\"p\"},\"body\"),\" key\\xADword. For more de\\xADtails, please refer to the \",mdx(Link,{href:\"/docs/vertx-web-api-service/java/\",passHref:!0,mdxType:\"Link\"},mdx(\"a\",e({parentName:\"p\"},{href:\"\"}),\"doc\\xADu\\xADmen\\xADta\\xADtion\")),\".\"),mdx(\"h2\",e({},{id:\"implement-the-service\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#implement-the-service\"})),\"Implement the service\"),mdx(\"p\",null,\"Now that you have your in\\xADter\\xADface, you can im\\xADple\\xADment the ser\\xADvice:\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"public\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-class\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"class\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"TransactionsManagerServiceImpl\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"implements\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"TransactionsManagerService\"),\" \"),`{\n\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"private\"),` Vertx vertx;\n\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"public\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"TransactionsManagerServiceImpl\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(Vertx vertx)\"),\" \"),\"{  \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"this\"),`.vertx = vertx;  }\n\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-meta\"}),\"@Override\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"public\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-keyword\"}),\"void\"),\" \",mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-title\"}),\"getTransactionsList\"),mdx(\"span\",e({parentName:\"span\"},{className:\"hljs-params\"}),\"(List<String> from, OperationRequest context, Handler<AsyncResult<OperationResponse>> resultHandler)\")),`{\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Write your business logic here\"),`\n    resultHandler.handle(Future.succeededFuture(OperationResult.completedWithJson(resultJson)));\n  }\n\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Implement other operations\"),`\n\n}\n`)),mdx(\"p\",null,\"Check the \",mdx(\"inlineCode\",{parentName:\"p\"},\"OperationResult\"),\" doc\\xADu\\xADmen\\xADta\\xADtion to look at var\\xADi\\xADous handy meth\\xADods to cre\\xADate a com\\xADplete re\\xADsponse.\"),mdx(\"h2\",e({},{id:\"mount-the-service\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#mount-the-service\"})),\"Mount the Service\"),mdx(\"p\",null,\"Now that you have your ser\\xADvice in\\xADter\\xADface and im\\xADple\\xADmen\\xADta\\xADtion, you can mount your ser\\xADvice with \",mdx(\"inlineCode\",{parentName:\"p\"},\"ServiceBinder\"),\":\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),\"ServiceBinder serviceBinder = \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"new\"),` ServiceBinder(vertx);\n\nTransactionsManagerService transactionsManagerService = TransactionsManagerService.create(vertx);\nregisteredConsumers.add(\n  serviceBinder\n    .setAddress(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"transactions_manager.myapp\"'),`)\n    .register(TransactionsManagerService.class, transactionsManagerService)\n);\n`)),mdx(\"h2\",e({},{id:\"and-the-router-factory\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#and-the-router-factory\"})),\"And the Router Factory?\"),mdx(\"p\",null,\"The ser\\xADvice is up and run\\xADning, but we need to con\\xADnect it to the \",mdx(\"inlineCode\",{parentName:\"p\"},\"Router\"),\" built by \",mdx(\"inlineCode\",{parentName:\"p\"},\"OpenAPI3RouterFactory\"),\":\"),mdx(\"pre\",null,mdx(\"code\",e({parentName:\"pre\"},{className:\"hljs language-java\"}),\"OpenAPI3RouterFactory.create(\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"this\"),\".vertx, \",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-string\"}),'\"my_spec.yaml\"'),`, openAPI3RouterFactoryAsyncResult -> {\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"if\"),` (openAPI3RouterFactoryAsyncResult.succeeded()) {\n    OpenAPI3RouterFactory routerFactory = openAPI3RouterFactoryAsyncResult.result();\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Mount services on event bus based on extensions\"),`\n    routerFactory.mountServicesFromExtensions(); `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// <- Pure magic happens!\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Generate the router\"),`\n    Router router = routerFactory.getRouter();\n    server = vertx.createHttpServer(`,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"new\"),\" HttpServerOptions().setPort(\",mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-number\"}),\"8080\"),`));\n    server.requestHandler(router).listen();\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Initialization completed\"),`\n  } `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-keyword\"}),\"else\"),` {\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"hljs-comment\"}),\"// Something went wrong during router factory initialization\"),`\n  }\n});\n`)),mdx(\"p\",null,\"In our spec ex\\xADam\\xADple we added an ex\\xADten\\xADsion \",mdx(\"inlineCode\",{parentName:\"p\"},\"x-vertx-event-bus\"),\" to each op\\xADer\\xADa\\xADtion that spec\\xADi\\xADfies the ad\\xADdress of the ser\\xADvice. Using this ex\\xADten\\xADsion, you only need to call \",mdx(\"inlineCode\",{parentName:\"p\"},\"OpenAPI3RouterFactory.mountServicesFromExtensions()\"),\" to trig\\xADger a scan of all op\\xADer\\xADa\\xADtions and mount all found ser\\xADvice ad\\xADdresses. For each op\\xADer\\xADa\\xADtion that con\\xADtains \",mdx(\"inlineCode\",{parentName:\"p\"},\"x-vertx-event-bus\"),\", the Router Fac\\xADtory in\\xADstan\\xADti\\xADates an han\\xADdler that routes the in\\xADcom\\xADing re\\xADquests to the ad\\xADdress you spec\\xADi\\xADfied.\"),mdx(\"p\",null,\"This is one of the meth\\xADods you can use to match ser\\xADvices with router op\\xADer\\xADa\\xADtion han\\xADdlers. Check the doc\\xADu\\xADmen\\xADta\\xADtion for all de\\xADtails.\"),mdx(\"h2\",e({},{id:\"more-examples\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":!0,tabIndex:-1,className:\"heading-anchor\",href:\"#more-examples\"})),\"More examples\"),mdx(\"p\",null,\"Check out the com\\xADplete ex\\xADam\\xADple in \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/vert-x3/vertx-examples/tree/master/web-api-service-example\"}),\"vertx-\\u200Bexamples repo\"),\".\"),mdx(\"p\",null,\"Thanks you for your time, stay tuned for more up\\xADdates! And please pro\\xADvide feed\\xADback about this new pack\\xADage!\"))}MDXContent.isMDXComponent=!0;\n","scope":{}}},"prevPost":{"meta":{"title":"Eclipse Vert.x 3.6.2","category":"releases","authors":[{"name":"Julien Viet","github_id":"vietj"}],"summary":"We have just released Vert.x 3.6.2, a bug fix release of Vert.x 3.6.x."},"date":"2018-12-17","slug":"eclipse-vert-x-3-6-2"},"nextPost":{"meta":{"title":"HTTP response validation with the Vert.x Web Client","category":"guides","authors":[{"name":"Thomas Segismont","github_id":"tsegismont"}],"summary":"Learn how to use response predicates from the Vert.x Web module to validate HTTP responses and to automatically generate error messages."},"date":"2018-12-10","slug":"http-response-validation-with-the-vert-x-web-client"},"relatedPosts":[{"meta":{"title":"Some Rest with Vert.x","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"This post is part of the Introduction to Vert.x series. Let’s go a bit further this time and develop a CRUD-ish application"},"date":"2015-07-27","slug":"some-rest-with-vert-x"},{"meta":{"title":"Real-time bidding with Websockets and Vert.x","category":"guides","authors":[{"name":"Marcin Warczyglowa","github_id":"mwarc"}],"summary":"The expectations of users for interactivity with web applications have changed over the past few years.\n    Users during bidding in auction no longer want to press the refresh button."},"date":"2016-01-15","slug":"real-time-bidding-with-websockets-and-vert-x"},{"meta":{"title":"Things to keep in mind concerning CSRF attacks","category":"guides","authors":[{"name":"Xhelal Likaj","github_id":"xhlika"}],"summary":"Eclipse Vert.x like most frameworks provides an anti-CSRF defense. However, no framework can prevent all attack vectors that exist in the web. Therefore, developers need to be aware of some dangers and common attack vectors concerning CSRF defenses."},"date":"2021-01-23","slug":"eclipse-vert-x-CSRF-concerns"}]},"__N_SSG":true}