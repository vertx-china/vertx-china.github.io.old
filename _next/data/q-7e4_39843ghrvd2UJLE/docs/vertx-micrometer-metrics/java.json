{"pageProps":{"slug":"vertx-micrometer-metrics/java","title":"Vert.x Micrometer 指标监控","fallbackGitHubStars":null,"toc":"<div id=\"toc\" class=\"toc\">\n<div id=\"toctitle\">Table of Contents</div>\n<ul class=\"sectlevel1\">\n<li><a href=\"#_features\">特性</a></li>\n<li><a href=\"#_influxdb\">InfluxDB</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_prerequisites\">预先准备</a></li>\n<li><a href=\"#_getting_started\">开始</a></li>\n<li><a href=\"#_configuration_examples\">配置示例</a></li>\n</ul>\n</li>\n<li><a href=\"#_prometheus\">Prometheus</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_prerequisites0\">预先准备</a></li>\n<li><a href=\"#_getting_started0\">开始</a></li>\n<li><a href=\"#_configuration_examples0\">配置示例</a></li>\n</ul>\n</li>\n<li><a href=\"#_jmx\">JMX</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_getting_started1\">开始</a></li>\n<li><a href=\"#_configuration_examples1\">配置示例</a></li>\n</ul>\n</li>\n<li><a href=\"#_other_backends_or_combinations\">其他后端或其组合</a></li>\n<li><a href=\"#_advanced_usage\">高级用法</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_averages_and_quantiles_in_prometheus\">Prometheus 中的平均值和分位数</a></li>\n<li><a href=\"#_disable_some_metric_domains\">禁用一些指标域</a></li>\n<li><a href=\"#_use_defined_metrics\">用户定义的指标</a></li>\n<li><a href=\"#_reusing_an_existing_registry\">复用一个已存在的 registry</a></li>\n<li><a href=\"#_jvm_or_other_instrumentations\">JVM 或者其他平台</a></li>\n<li><a href=\"#_metric_names\">指标名称</a></li>\n<li><a href=\"#_labels_and_matchers\">Labels 和 matchers</a></li>\n<li><a href=\"#_snapshots\">快照</a></li>\n</ul>\n</li>\n<li><a href=\"#_vert_x_core_tools_metrics\">Vert.x core tools 指标</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_net_client\">Net Client</a></li>\n<li><a href=\"#_http_client\">HTTP Client</a></li>\n<li><a href=\"#_net_server\">Net Server</a></li>\n<li><a href=\"#_http_server\">HTTP Server</a></li>\n<li><a href=\"#_datagram_socket\">Datagram socket</a></li>\n<li><a href=\"#_event_bus\">Event Bus</a></li>\n</ul>\n</li>\n<li><a href=\"#_vert_x_pool_metrics\">Vert.x pool 指标</a></li>\n<li><a href=\"#_other_clients\">其他客户端</a></li>\n</ul>\n</div>","contents":"<h1>Vert.x Micrometer 指标监控</h1>\n\n<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>这个项目是 Vert.x Metrics Service Provider Interface (SPI) 的一个实现。\n它使用 <a href=\"http://micrometer.io/\">Micrometer</a> 来管理运行指标并向后端报告。</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_features\"><a class=\"anchor\" href=\"#_features\"></a>特性</h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Vert.x core 组件监控：TCP/HTTP 客户端和服务端、 <code><a href=\"../../apidocs/io/vertx/core/datagram/DatagramSocket.html\">DatagramSocket</a></code> 、\n<code><a href=\"../../apidocs/io/vertx/core/eventbus/EventBus.html\">EventBus</a></code> 和各类 pool</p>\n</li>\n<li>\n<p>用户通过Micrometer定义的监控指标</p>\n</li>\n<li>\n<p>向所有 Micrometer 支持的后端发送报告</p>\n</li>\n<li>\n<p>内置可选项： <a href=\"https://www.influxdata.com/\">InfluxDB</a> 、 <a href=\"https://prometheus.io/\">Prometheus</a> 、 JMX 报告。</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_influxdb\"><a class=\"anchor\" href=\"#_influxdb\"></a>InfluxDB</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_prerequisites\"><a class=\"anchor\" href=\"#_prerequisites\"></a>预先准备</h3>\n<div class=\"paragraph\">\n<p>按照 <a href=\"https://docs.influxdata.com/influxdb/latest/introduction/getting_started/\">说明文档启动并运行 InfluxDb</a> 。</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_getting_started\"><a class=\"anchor\" href=\"#_getting_started\"></a>开始</h3>\n<div class=\"paragraph\">\n<p>必须要在classpath下添加 <em>vertx-micrometer-metrics</em> 和 <em>micrometer-registry-influx</em> 模块。</p>\n</div>\n<div class=\"paragraph\">\n<p>Maven 用户应在 pom文件中添加如下依赖：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-xml\" data-lang=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.vertx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>vertx-micrometer-metrics<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>4.0.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.micrometer<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>micrometer-registry-influx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>${micrometer.version}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span></code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Gradle 用户，添加如下依赖：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-groovy\" data-lang=\"groovy\">compile <span class=\"hljs-string\">'io.vertx:vertx-micrometer-metrics:4.0.2'</span>\ncompile <span class=\"hljs-string\">'io.micrometer:micrometer-registry-influx:${micrometer.version}'</span></code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_configuration_examples\"><a class=\"anchor\" href=\"#_configuration_examples\"></a>配置示例</h3>\n<div class=\"paragraph\">\n<p>Vert.x默认情况下不开启SPI的实现。您必需在Vert.x options中启用。</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setInfluxDbOptions(<span class=\"hljs-keyword\">new</span> VertxInfluxDbOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_using_a_specific_uri_and_database_name\"><a class=\"anchor\" href=\"#_using_a_specific_uri_and_database_name\"></a>使用指定的URI和数据库名</h4>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setInfluxDbOptions(<span class=\"hljs-keyword\">new</span> VertxInfluxDbOptions().setEnabled(<span class=\"hljs-keyword\">true</span>)\n      .setUri(<span class=\"hljs-string\">\"http://influxdb.example.com:8888\"</span>)\n      .setDb(<span class=\"hljs-string\">\"sales-department\"</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_with_autentication\"><a class=\"anchor\" href=\"#_with_autentication\"></a>认证</h4>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setInfluxDbOptions(<span class=\"hljs-keyword\">new</span> VertxInfluxDbOptions().setEnabled(<span class=\"hljs-keyword\">true</span>)\n      .setUserName(<span class=\"hljs-string\">\"username\"</span>)\n      .setPassword(<span class=\"hljs-string\">\"password\"</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_prometheus\"><a class=\"anchor\" href=\"#_prometheus\"></a>Prometheus</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_prerequisites0\"><a class=\"anchor\" href=\"#_prerequisites0\"></a>预先准备</h3>\n<div class=\"paragraph\">\n<p>按照 <a href=\"https://prometheus.io/docs/prometheus/latest/getting_started/\">手册启动并运行Prometheus</a> 。</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_getting_started0\"><a class=\"anchor\" href=\"#_getting_started0\"></a>开始</h3>\n<div class=\"paragraph\">\n<p>必须在classpath中添加 <em>vertx-micrometer-metrics</em> 和 <em>micrometer-registry-prometheus</em> 模块。\n您也许需要 <em>vertx-web</em> 来开放监控指标。</p>\n</div>\n<div class=\"paragraph\">\n<p>Maven用户在pom文件中添加如下依赖：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-xml\" data-lang=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.vertx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>vertx-micrometer-metrics<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>4.0.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.micrometer<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>micrometer-registry-prometheus<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>${micrometer.version}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span></code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Gradle 用户，添加如下依赖：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-groovy\" data-lang=\"groovy\">compile <span class=\"hljs-string\">'io.vertx:vertx-micrometer-metrics:4.0.2'</span>\ncompile <span class=\"hljs-string\">'io.micrometer:micrometer-registry-prometheus:${micrometer.version}'</span></code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_configuration_examples0\"><a class=\"anchor\" href=\"#_configuration_examples0\"></a>配置示例</h3>\n<div class=\"paragraph\">\n<p>Vert.x默认情况下不开启SPI的实现。您必需在Vert.x options中将其启用。</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_using_an_embedded_http_server_with_custom_endpoint\"><a class=\"anchor\" href=\"#_using_an_embedded_http_server_with_custom_endpoint\"></a>将嵌入式HTTP服务器与自定义终端（custom endpoint）一起使用</h4>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions().setEnabled(<span class=\"hljs-keyword\">true</span>)\n      .setStartEmbeddedServer(<span class=\"hljs-keyword\">true</span>)\n      .setEmbeddedServerOptions(<span class=\"hljs-keyword\">new</span> HttpServerOptions().setPort(<span class=\"hljs-number\">8080</span>))\n      .setEmbeddedServerEndpoint(<span class=\"hljs-string\">\"/metrics/vertx\"</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>如果没有指定默认服务终端，那么默认为  <em>/metrics</em> 。</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_binding_metrics_to_an_existing_vert_x_web_router\"><a class=\"anchor\" href=\"#_binding_metrics_to_an_existing_vert_x_web_router\"></a>将指标绑定到已存在的Web路由器</h4>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));\n\n<span class=\"hljs-comment\">// 稍后，创建路由器</span>\nRouter router = Router.router(vertx);\nrouter.route(<span class=\"hljs-string\">\"/metrics\"</span>).handler(PrometheusScrapingHandler.create());\nvertx.createHttpServer().requestHandler(router).listen(<span class=\"hljs-number\">8080</span>);</code></pre>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_jmx\"><a class=\"anchor\" href=\"#_jmx\"></a>JMX</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_getting_started1\"><a class=\"anchor\" href=\"#_getting_started1\"></a>开始</h3>\n<div class=\"paragraph\">\n<p>必须要在classpath中添加 <em>vertx-micrometer-metrics</em> 和 <em>micrometer-registry-jmx</em> 。</p>\n</div>\n<div class=\"paragraph\">\n<p>Maven用户在pom文件中添加如下依赖：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-xml\" data-lang=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.vertx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>vertx-micrometer-metrics<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>4.0.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.micrometer<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>micrometer-registry-jmx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>${micrometer.version}<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span></code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Gradle 用户，添加如下依赖：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-groovy\" data-lang=\"groovy\">compile <span class=\"hljs-string\">'io.vertx:vertx-micrometer-metrics:4.0.2'</span>\ncompile <span class=\"hljs-string\">'io.micrometer:micrometer-registry-jmx:${micrometer.version}'</span></code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_configuration_examples1\"><a class=\"anchor\" href=\"#_configuration_examples1\"></a>配置示例</h3>\n<div class=\"paragraph\">\n<p>Vert.x默认情况下不开启SPI的实现。您必须在Vert.x options中启用它。</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setJmxMetricsOptions(<span class=\"hljs-keyword\">new</span> VertxJmxMetricsOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_with_step_and_domain\"><a class=\"anchor\" href=\"#_with_step_and_domain\"></a>添加 step 和 domain</h4>\n<div class=\"paragraph\">\n<p>在Micrometer中， <code>step</code> 是指报告周期，以秒为单位。 <code>domain</code> 是\nMBeans被注册域名之下的JMX域名。</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setJmxMetricsOptions(<span class=\"hljs-keyword\">new</span> VertxJmxMetricsOptions().setEnabled(<span class=\"hljs-keyword\">true</span>)\n      .setStep(<span class=\"hljs-number\">5</span>)\n      .setDomain(<span class=\"hljs-string\">\"my.metrics.domain\"</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_other_backends_or_combinations\"><a class=\"anchor\" href=\"#_other_backends_or_combinations\"></a>其他后端或其组合</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>即使Vert.x并不对所有的Micrometer支持的后台提供实现，但是\n创建Micrometer注册信息并将其传入Vert.x依然是可能的。</p>\n</div>\n<div class=\"paragraph\">\n<p>The list of available backends includes Graphite, Ganglia, Atlas, <a href=\"http://micrometer.io/docs\">etc</a>.\nIt also enables the <a href=\"http://micrometer.io/docs/concepts#_composite_registries\">Micrometer Composite Registry</a>\nin order to report the same metrics to multiple backends.\n可用的后端包括 Graphite、Ganglia、Atlas <a href=\"http://micrometer.io/docs\">等等</a> 。\n它也允许 <a href=\"http://micrometer.io/docs/concepts#_composite_registries\">Micrometer 组合注册</a> 从而可以向多个后端报告同一项指标。</p>\n</div>\n<div class=\"paragraph\">\n<p>在以下例子中，指标同时向 JMX 和 Graphite报告：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">CompositeMeterRegistry myRegistry = <span class=\"hljs-keyword\">new</span> CompositeMeterRegistry();\nmyRegistry.add(<span class=\"hljs-keyword\">new</span> JmxMeterRegistry(s -&gt; <span class=\"hljs-keyword\">null</span>, Clock.SYSTEM));\nmyRegistry.add(<span class=\"hljs-keyword\">new</span> GraphiteMeterRegistry(s -&gt; <span class=\"hljs-keyword\">null</span>, Clock.SYSTEM));\n\nVertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions()\n  .setMetricsOptions(<span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setMicrometerRegistry(myRegistry)\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_advanced_usage\"><a class=\"anchor\" href=\"#_advanced_usage\"></a>高级用法</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>请查阅 <code><a href=\"../../apidocs/io/vertx/micrometer/MicrometerMetricsOptions.html\">MicrometerMetricsOptions</a></code> 以获取更多的options信息。</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_averages_and_quantiles_in_prometheus\"><a class=\"anchor\" href=\"#_averages_and_quantiles_in_prometheus\"></a>Prometheus 中的平均值和分位数</h3>\n<div class=\"paragraph\">\n<p>默认情况下，当使用Prometheus注册信息时，指标的直方图不会包括平均值和分位数的分析。</p>\n</div>\n<div class=\"paragraph\">\n<p>平均值并非开箱即用，他们通常是用 <code>promql</code> <a href=\"https://prometheus.io/docs/practices/histograms/#count-and-sum-of-observations\">在查询时计算出来</a> 的。\n例如，Http客户端在过去5分钟内平均响应时间：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code> rate(vertx_http_client_response_time_seconds_sum[5m])\n/\n rate(vertx_http_client_response_time_seconds_count[5m])</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>要计算分位数，则有两个方案可选择。第一种，激活全局分位数分析，\n并让 Prometheus 的 <code>histogram_quantile</code> 函数可以使用分位数：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions().setEnabled(<span class=\"hljs-keyword\">true</span>)\n      .setPublishQuantiles(<span class=\"hljs-keyword\">true</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>然后，例如用 <code>promql</code> 查询HTTP client响应时间在最近5分钟内百分之九十九的分位点：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code> histogram_quantile(0.99, sum(rate(vertx_http_client_response_time_seconds_bucket[5m])) by (le))</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>这个方案的优点是可以在 <code>promql</code> 中跨维度聚合使用。\n坏处是它为了统计数据而创建了大量的时间序列。</p>\n</div>\n<div class=\"paragraph\">\n<p>第二个方案是创建分析限制，不许跨维度聚合。\n这就需要直接访问 Micrometer / Prometheus 注册信息：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">PrometheusMeterRegistry registry = (PrometheusMeterRegistry) BackendRegistries.getDefaultNow();\nregistry.config().meterFilter(\n    <span class=\"hljs-keyword\">new</span> MeterFilter() {\n      <span class=\"hljs-meta\">@Override</span>\n      <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> DistributionStatisticConfig <span class=\"hljs-title\">configure</span><span class=\"hljs-params\">(Meter.Id id, DistributionStatisticConfig config)</span> </span>{\n        <span class=\"hljs-keyword\">return</span> DistributionStatisticConfig.builder()\n            .percentiles(<span class=\"hljs-number\">0.95</span>, <span class=\"hljs-number\">0.99</span>)\n            .build()\n            .merge(config);\n      }\n    });</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>也可以从以下链接见到更多的直方图和百分比：</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>from <a href=\"https://micrometer.io/docs/concepts#_histograms_and_percentiles\">Micrometer doc</a></p>\n</li>\n<li>\n<p>from <a href=\"https://prometheus.io/docs/prometheus/latest/querying/functions/#histogram_quantile\">Prometheus doc</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>另外，您可以下载一些 <a href=\"https://github.com/vert-x3/vertx-examples/tree/master/micrometer-metrics-examples\">完整工作示例</a> 。\n其中有少量安装 Prometheus和在Grafana中创建视图仪表盘的说明。</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_disable_some_metric_domains\"><a class=\"anchor\" href=\"#_disable_some_metric_domains\"></a>禁用一些指标域</h3>\n<div class=\"paragraph\">\n<p>可以使用 <code><a href=\"../../apidocs/io/vertx/micrometer/MicrometerMetricsOptions.html#disabledMetricsCategories\">disabledMetricsCategories</a></code> 来\n限制对Vert.x模块的监控。</p>\n</div>\n<div class=\"paragraph\">\n<p>完整的域列表详见 <code><a href=\"../../apidocs/io/vertx/micrometer/MetricsDomain.html\">MetricsDomain</a></code> 。</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_use_defined_metrics\"><a class=\"anchor\" href=\"#_use_defined_metrics\"></a>用户定义的指标</h3>\n<div class=\"paragraph\">\n<p>Micrometer 注册信息可以被访问，以便于创建新的指标或者抓去已存在的。\n默认使用一个唯一的注册信息，并共享于JVM中的Vert.x实例。</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">MeterRegistry registry = BackendRegistries.getDefaultNow();</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>通过在options中给出注册信息名称的方式，可以给每个Vert.x实例分配注册信息。\n然后可以分别获取：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setInfluxDbOptions(<span class=\"hljs-keyword\">new</span> VertxInfluxDbOptions().setEnabled(<span class=\"hljs-keyword\">true</span>)) <span class=\"hljs-comment\">// or VertxPrometheusOptions</span>\n    .setRegistryName(<span class=\"hljs-string\">\"my registry\"</span>)\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));\n\n<span class=\"hljs-comment\">// Later on:</span>\nMeterRegistry registry = BackendRegistries.getNow(<span class=\"hljs-string\">\"my registry\"</span>);</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>做为示例，这里有一个自定义定时器来追踪代码块的执行时间，且经常被调用：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">MeterRegistry registry = BackendRegistries.getDefaultNow();\nTimer timer = Timer\n  .builder(<span class=\"hljs-string\">\"my.timer\"</span>)\n  .description(<span class=\"hljs-string\">\"a description of what this timer does\"</span>)\n  .register(registry);\n\nvertx.setPeriodic(<span class=\"hljs-number\">1000</span>, l -&gt; {\n  timer.record(() -&gt; {\n    <span class=\"hljs-comment\">// Running here some operation to monitor</span>\n  });\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>更多示例关于Micrometer注册信息文档以及如何创建指标，详见 <a href=\"http://micrometer.io/docs/concepts#_registry\">Micrometer doc</a> 。</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_reusing_an_existing_registry\"><a class=\"anchor\" href=\"#_reusing_an_existing_registry\"></a>复用一个已存在的 registry</h3>\n<div class=\"paragraph\">\n<p>您可以复用一个现存的 registry （或从Prometheus java客户端获取 <code>CollectorRegistry</code> ），\n在 Vert.x metrics options 中注入它：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">PrometheusMeterRegistry registry = <span class=\"hljs-keyword\">new</span> PrometheusMeterRegistry(PrometheusConfig.DEFAULT);\n\n<span class=\"hljs-comment\">// You could also reuse an existing registry from the Prometheus Java client:</span>\nCollectorRegistry prometheusClientRegistry = <span class=\"hljs-keyword\">new</span> CollectorRegistry();\nregistry = <span class=\"hljs-keyword\">new</span> PrometheusMeterRegistry(PrometheusConfig.DEFAULT, prometheusClientRegistry, Clock.SYSTEM);\n\n<span class=\"hljs-comment\">// It's reused in MicrometerMetricsOptions.</span>\n<span class=\"hljs-comment\">// Prometheus options configured here, such as \"setPublishQuantiles(true)\", will affect the whole registry.</span>\nVertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions().setEnabled(<span class=\"hljs-keyword\">true</span>)\n      .setPublishQuantiles(<span class=\"hljs-keyword\">true</span>))\n    .setMicrometerRegistry(registry)\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_jvm_or_other_instrumentations\"><a class=\"anchor\" href=\"#_jvm_or_other_instrumentations\"></a>JVM 或者其他平台</h3>\n<div class=\"paragraph\">\n<p>因为已经提供了对Micrometer registry的原始访问方式，所以可以直接使用 Micrometer API 。\n例如，监控JVM：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">MeterRegistry registry = BackendRegistries.getDefaultNow();\n\n<span class=\"hljs-keyword\">new</span> ClassLoaderMetrics().bindTo(registry);\n<span class=\"hljs-keyword\">new</span> JvmMemoryMetrics().bindTo(registry);\n<span class=\"hljs-keyword\">new</span> JvmGcMetrics().bindTo(registry);\n<span class=\"hljs-keyword\">new</span> ProcessorMetrics().bindTo(registry);\n<span class=\"hljs-keyword\">new</span> JvmThreadMetrics().bindTo(registry);</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p><em>详见 <a href=\"http://micrometer.io/docs/ref/jvm\">Micrometer 文档</a>。</em></p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_metric_names\"><a class=\"anchor\" href=\"#_metric_names\"></a>指标名称</h3>\n<div class=\"paragraph\">\n<p>每一个Vert.x提供的指标都可以通过options重命名，\n用 <code><a href=\"../../apidocs/io/vertx/micrometer/MetricsNaming.html\">MetricsNaming</a></code> 和 <code><a href=\"../../apidocs/io/vertx/micrometer/MicrometerMetricsOptions.html#setMetricsNaming-io.vertx.micrometer.MetricsNaming-\">setMetricsNaming</a></code> 即可。\n在 Vert.x 4 中，默认指标名称出现了变化，目的在于更好的适应于后端约定，\n但是依旧可以用 Vert.x 3.x 的指标名称，以求兼容：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n    .setMetricsNaming(MetricsNaming.v3Names())\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_labels_and_matchers\"><a class=\"anchor\" href=\"#_labels_and_matchers\"></a>Labels 和 matchers</h3>\n<div class=\"paragraph\">\n<p>Vert.x Micrometer Metrics 定义了一系列label（又称为 tag 或 field），用于对某一指标提供维度。\n例如，和事件总线消息相关的指标有 <em>address</em> label，\n它允许对一个事件总线地址查询时间序列，或者对比每个地址的时间序列，\n或者做各种API允许的聚合操作。</p>\n</div>\n<div class=\"paragraph\">\n<p>当设置指标option的时候，您可以指定您想要开启的label：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n    .setLabels(EnumSet.of(Label.REMOTE, Label.LOCAL, Label.HTTP_CODE, Label.HTTP_PATH))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>完整的label列表详见： <code><a href=\"../../apidocs/io/vertx/micrometer/Label.html\">Label</a></code> 。</p>\n</div>\n<div class=\"admonitionblock warning\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">警告</div>\n</td>\n<td class=\"content\">\n启用label可能导致由大量值对象引起的后台问题以及性能问题。\n所以必须谨慎使用它。\n大体上，如果可能的label值是有界值，那么启用label是一个比较好的做法。\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>正因如此，默认开启的label被限制为已知的有界值。</p>\n</div>\n<div class=\"paragraph\">\n<p>除了启用/禁用，您也可以对label做更多的操作。这有两种方式可以做到：</p>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_using_matchers\"><a class=\"anchor\" href=\"#_using_matchers\"></a>使用 matcher</h4>\n<div class=\"paragraph\">\n<p><code><a href=\"../../apidocs/io/vertx/micrometer/Match.html\">Match</a></code> 对象可以通过字符串\n直接匹配或者正则匹配（前者更高效）的方式来过滤或者重命名label值</p>\n</div>\n<div class=\"paragraph\">\n<p>以下为一个仅用 <em>local=localhost:8080</em> 的label来限制Http服务指标的示例：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">Vertx vertx = Vertx.vertx(<span class=\"hljs-keyword\">new</span> VertxOptions().setMetricsOptions(\n  <span class=\"hljs-keyword\">new</span> MicrometerMetricsOptions()\n    .setPrometheusOptions(<span class=\"hljs-keyword\">new</span> VertxPrometheusOptions().setEnabled(<span class=\"hljs-keyword\">true</span>))\n    .addLabelMatch(<span class=\"hljs-keyword\">new</span> Match()\n      <span class=\"hljs-comment\">// Restrict HTTP server metrics to those with label \"local=localhost:8080\" only</span>\n      .setDomain(MetricsDomain.HTTP_SERVER)\n      .setLabel(<span class=\"hljs-string\">\"local\"</span>)\n      .setValue(<span class=\"hljs-string\">\"localhost:8080\"</span>))\n    .setEnabled(<span class=\"hljs-keyword\">true</span>)));</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>当Match中指定了 <em>alias</em> ，它就会被用来做重命名而不是过滤。</p>\n</div>\n<div class=\"paragraph\">\n<p>Matcher 对于通过配置来控制label尤为管用，\n它们要通过 <code><a href=\"../../apidocs/io/vertx/micrometer/MicrometerMetricsOptions.html\">MicrometerMetricsOptions</a></code> 来设置。</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_using_micrometer_s_meterfilter\"><a class=\"anchor\" href=\"#_using_micrometer_s_meterfilter\"></a>使用 Micrometer 的 MeterFilter</h4>\n<div class=\"paragraph\">\n<p>Micrometer 的 <a href=\"http://micrometer.io/docs/concepts#_meter_filters\">MeterFilter API</a> 可以被直接获取，以便定义规则（rule）和标签（label）。\n相比于Matcher，他提供了更多操作标签的特性，但是不能从配置中定义他。\n所以，这两者各有优劣。</p>\n</div>\n<div class=\"paragraph\">\n<p>以下为一个示例，使用正则表达式作为通用格式来替换HTTP请求中实际的 <code>path</code> 标签：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">MeterRegistry registry = BackendRegistries.getDefaultNow();\nPattern pattern = Pattern.compile(<span class=\"hljs-string\">\"/foo/bar/.*\"</span>);\n\nregistry.config().meterFilter(\n  MeterFilter.replaceTagValues(Label.HTTP_PATH.toString(), actualPath -&gt; {\n    Matcher m = pattern.matcher(actualPath);\n    <span class=\"hljs-keyword\">if</span> (m.matches()) {\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">\"/foo/bar/:id\"</span>;\n    }\n    <span class=\"hljs-keyword\">return</span> actualPath;\n  }, <span class=\"hljs-string\">\"\"</span>));</code></pre>\n</div>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">注意</div>\n</td>\n<td class=\"content\">\nMatchers 在底层使用的是 MeterFilters。\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_snapshots\"><a class=\"anchor\" href=\"#_snapshots\"></a>快照</h3>\n<div class=\"paragraph\">\n<p>创建一个 <code><a href=\"../../apidocs/io/vertx/micrometer/MetricsService.html\">MetricsService</a></code> 可以用 <code><a href=\"../../apidocs/io/vertx/core/metrics/Measured.html\">Measured</a></code> 对象，\n这样便于对相关指标和度量做出一个快照。\n这个快照以 <code><a href=\"../../apidocs/io/vertx/core/json/JsonObject.html\">JsonObject</a></code> 形式返回。</p>\n</div>\n<div class=\"paragraph\">\n<p>一个所熟知的 <em>Measured</em> 对象便是 <code><a href=\"../../apidocs/io/vertx/core/Vertx.html\">Vertx</a></code> ：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">MetricsService metricsService = MetricsService.create(vertx);\nJsonObject metrics = metricsService.getMetricsSnapshot();\nSystem.out.println(metrics);</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>其他组件，例如 <code><a href=\"../../apidocs/io/vertx/core/eventbus/EventBus.html\">EventBus</a></code> 或 <code><a href=\"../../apidocs/io/vertx/core/http/HttpServer.html\">HttpServer</a></code>\n是可测量的：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">HttpServer server = vertx.createHttpServer();\nMetricsService metricsService = MetricsService.create(server);\nJsonObject metrics = metricsService.getMetricsSnapshot();\nSystem.out.println(metrics);</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>最终，可以按照基本名称来过滤返回的指标：</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-java\" data-lang=\"java\">MetricsService metricsService = MetricsService.create(vertx);\n<span class=\"hljs-comment\">// Client + server</span>\nJsonObject metrics = metricsService.getMetricsSnapshot(<span class=\"hljs-string\">\"vertx.http\"</span>);\nSystem.out.println(metrics);</code></pre>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_vert_x_core_tools_metrics\"><a class=\"anchor\" href=\"#_vert_x_core_tools_metrics\"></a>Vert.x core tools 指标</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>本节列举了所有由Vert.x core tools生成的指标。</p>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">注意</div>\n</td>\n<td class=\"content\">\n指标后台可能存在不同的约定或规则来命名指标\n以下是Vert.x 4 中默认的名称，他们以下划线做分隔符。\n实际的名称可能基于指标后台而发生变化。\n</td>\n</tr>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_net_client\"><a class=\"anchor\" href=\"#_net_client\"></a>Net Client</h3>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 35%;\">\n<col style=\"width: 20%;\">\n<col style=\"width: 10%;\">\n<col style=\"width: 35%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">指标名称</th>\n<th class=\"tableblock halign-left valign-top\">标签</th>\n<th class=\"tableblock halign-left valign-top\">类型</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_net_client_bytes_read</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">从远程服务接收到的字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_net_client_bytes_written</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">发送到远程服务的字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_net_client_active_connections</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">当前正处于打开状态的连接数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_net_client_errors</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>class</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">错误数。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_http_client\"><a class=\"anchor\" href=\"#_http_client\"></a>HTTP Client</h3>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 35%;\">\n<col style=\"width: 20%;\">\n<col style=\"width: 10%;\">\n<col style=\"width: 35%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">指标名称</th>\n<th class=\"tableblock halign-left valign-top\">标签</th>\n<th class=\"tableblock halign-left valign-top\">类型</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_bytes_read</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">从远程服务接收到的字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_bytes_written</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">发送到远程服务的字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_active_connections</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">当前正处于打开状态的连接数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_errors</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>class</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">错误数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_queue_time_seconds</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Timer</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">被执行之前，在队列中花费的时间，秒为单位。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_queue_pending</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">队列中挂起状态的元素数量。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_ active_requests</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">当前正在执行且正等待响应的请求数量。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_requests_total</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">已发送的请求数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_request_bytes</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Summary</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">请求的大小（字节数）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_response_time_seconds</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code>, <code>code</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Timer</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">响应时间（秒）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_responses_total</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code>, <code>code</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">接收到的响应数量。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_response_bytes</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code>, <code>code</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Summary</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">响应的大小（字节数）</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_active_ws_connections</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">当前打开状态的websocket数量。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_net_server\"><a class=\"anchor\" href=\"#_net_server\"></a>Net Server</h3>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 35%;\">\n<col style=\"width: 20%;\">\n<col style=\"width: 10%;\">\n<col style=\"width: 35%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">指标名称</th>\n<th class=\"tableblock halign-left valign-top\">标签</th>\n<th class=\"tableblock halign-left valign-top\">类型</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_net_server_bytes_read</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Net Server收到的字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_net_server_bytes_written</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Net Server发送的字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_net_server_active_connections</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Net Server 开启的连接数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_net_server_errors</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>class</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">错误数。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_http_server\"><a class=\"anchor\" href=\"#_http_server\"></a>HTTP Server</h3>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 35%;\">\n<col style=\"width: 20%;\">\n<col style=\"width: 10%;\">\n<col style=\"width: 35%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">指标名称</th>\n<th class=\"tableblock halign-left valign-top\">标签</th>\n<th class=\"tableblock halign-left valign-top\">类型</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_bytes_read</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">HTTP Server接收的字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_bytes_written</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">HTTP Server发送的字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_active_connections</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">HTTP Server开启的连接数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_errors</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>class</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">错误数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_active_requests</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">当前正在执行状态的请求数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_requests_total</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code>, <code>code</code>, <code>route</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">执行完毕的请求数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_request_resets_total</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">被重置的请求数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_request_bytes</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Summary</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">请求大小（字节）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_response_time_seconds</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code>, <code>code</code>, <code>route</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Timer</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">请求执行的时间（秒）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_server_response_bytes</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code>, <code>path</code>, <code>method</code>, <code>code</code>, <code>route</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Summary</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">响应大小（字节）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_http_client_active_ws_connections</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code>, <code>remote</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">当前开启状态的websocket。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_datagram_socket\"><a class=\"anchor\" href=\"#_datagram_socket\"></a>Datagram socket</h3>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 35%;\">\n<col style=\"width: 20%;\">\n<col style=\"width: 10%;\">\n<col style=\"width: 35%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">指标名称</th>\n<th class=\"tableblock halign-left valign-top\">标签</th>\n<th class=\"tableblock halign-left valign-top\">类型</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_datagram_bytes_read</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>local</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Summary</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">于 <code>&lt;host&gt;:&lt;port&gt;</code> 上接收到的字节总数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_datagram_bytes_written</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">(none)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Summary</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">发送到远程的字节总数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_datagram_errors</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>class</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">错误总数。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_event_bus\"><a class=\"anchor\" href=\"#_event_bus\"></a>Event Bus</h3>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 35%;\">\n<col style=\"width: 20%;\">\n<col style=\"width: 10%;\">\n<col style=\"width: 35%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">指标名称</th>\n<th class=\"tableblock halign-left valign-top\">标签</th>\n<th class=\"tableblock halign-left valign-top\">类型</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_bytes_read</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Summary</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">从事件总线集群读取消息时接收到的总字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_bytes_written</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Summary</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">向事件总线集群发送消息的总字节数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_handlers</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">正在使用中的事件总线处理器数量。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_pending</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code>,<code>side</code> (local/remote)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">还未被执行的消息数。 <code>N</code> 个处理器被注册在同一个地址时，向此地址广播一个消息的话，\n这个值则是 <code>N</code> 。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_processed</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code>,<code>side</code> (local/remote)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">已执行完毕的消息数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_published</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code>,<code>side</code> (local/remote)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">消息广播数（广播/订阅）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_discarded</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code>,<code>side</code> (local/remote)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">被丢弃的消息数（例如，处理器未注册时被挂起的消息或消息溢出）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_sent</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code>,<code>side</code> (local/remote)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">发送的消息数（点对点）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_received</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code>,<code>side</code> (local/remote)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">接收的消息数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_delivered</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code>,<code>side</code> (local/remote)</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">已发送到处理器的消息数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_eventbus_reply_failures</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>address</code>,<code>failure</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">回复失败的消息数。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_vert_x_pool_metrics\"><a class=\"anchor\" href=\"#_vert_x_pool_metrics\"></a>Vert.x pool 指标</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>本章列举出了所有监控 Vert.x pool 而生成的指标。</p>\n</div>\n<div class=\"paragraph\">\n<p>当前支持两个类型：</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><em>worker</em> （见 <code><a href=\"../../apidocs/io/vertx/core/WorkerExecutor.html\">WorkerExecutor</a></code> ）</p>\n</li>\n<li>\n<p><em>datasource</em> （用 Vert.x JDBC client 创建）</p>\n</li>\n</ul>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">注意</div>\n</td>\n<td class=\"content\">\nVert.x 前期创建两个worker pools，即 <em>worker-thread</em> 和 <em>internal-blocking</em> 。\n</td>\n</tr>\n</table>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 35%;\">\n<col style=\"width: 20%;\">\n<col style=\"width: 10%;\">\n<col style=\"width: 35%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">指标名称</th>\n<th class=\"tableblock halign-left valign-top\">标签</th>\n<th class=\"tableblock halign-left valign-top\">类型</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_pool_queue_time_seconds</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>pool_type</code>,<code>pool_name</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Timer</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">被执行之前，在队列中花费的时间（秒）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_pool_queue_pending</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>pool_type</code>,<code>pool_name</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">队列中挂起状态的元素数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_pool_usage</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>pool_type</code>,<code>pool_name</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Timer</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">使用资源的时间（例如，worker pools 的执行时间）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_pool_in_use</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>pool_type</code>,<code>pool_name</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">被占用的资源数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_pool_completed</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>pool_type</code>,<code>pool_name</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">此资源下的已完成的元素数（例如，worker pool已执行完毕的任务数）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_pool_ratio</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>pool_type</code>,<code>pool_name</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">（仅在pool指定最大值的情况下才存在）。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_other_clients\"><a class=\"anchor\" href=\"#_other_clients\"></a>其他客户端</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>除了核心的HTTP 客户端 / Net 客户端以外，Vert.x客户端可以实现一组标准的客户端指标。例如，SQL client。</p>\n</div>\n<div class=\"paragraph\">\n<p>这些客户端指标以 \"客户端类型\" 标识符命名，下表中以 <code>$TYPE</code> 代替。\n例如， 对于SQL客户端来讲， <code>vertx_$TYPE_queue_pending</code> 就是 <code>vertx_sql_queue_pending</code> 。</p>\n</div>\n<div class=\"paragraph\">\n<p><code>namespace</code> 标签的意义，由客户端的实现来描述。</p>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 35%;\">\n<col style=\"width: 20%;\">\n<col style=\"width: 10%;\">\n<col style=\"width: 35%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">指标名称</th>\n<th class=\"tableblock halign-left valign-top\">标签</th>\n<th class=\"tableblock halign-left valign-top\">类型</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_$TYPE_queue_pending</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>remote</code>, <code>namespace</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">队列中挂起状态的元素数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_$TYPE_queue_time_seconds</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>remote</code>, <code>namespace</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Timer</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">被执行之前，在队列中花费的时间（秒）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_$TYPE_processing_pending</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>remote</code>, <code>namespace</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Gauge</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">正在执行的元素数。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_$TYPE_processing_time_seconds</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>remote</code>, <code>namespace</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Timer</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">从开始发送请求到响应结束的执行时间（秒）。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>vertx_$TYPE_resets_total</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\"><code>remote</code>, <code>namespace</code></p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Counter</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">重置数。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>"},"__N_SSG":true}