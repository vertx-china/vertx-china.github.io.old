<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&amp;display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><link rel="alternate" type="application/rss+xml" href="/feed/rss.xml"/><link rel="alternate" type="application/atom+xml" href="/feed/atom.xml"/><link rel="alternate" type="application/json" href="/feed/feed.json"/><title>MSSQL Client | Eclipse Vert.x</title><link rel="preload" href="https://api.github.com/repos/eclipse-vertx/vertx-sql-client" as="fetch" crossorigin="anonymous"/><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/css/styles.bee17d6f.chunk.css" as="style"/><link rel="stylesheet" href="/_next/static/css/styles.bee17d6f.chunk.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-b6e20584df76f29b6f35.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.fcef98db13e2318579fb.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.7064a0f84b2a7c13404a.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" as="script"/><link rel="preload" href="/_next/static/chunks/5df0631eea625b022d3730b3f1bf573e1b8deb37.2c5d42edba8dda0b0ba3.js" as="script"/><link rel="preload" href="/_next/static/chunks/31acfd8439b7c9eee4abe9f59c7500d6c943ee0d.7689a0583e30048c05ff.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-3a425d1828d3af7aa498.js" as="script"/></head><body data-build-time="2021-06-02T09:11:03.921Z" data-build-commit-id="223b08705af97d9d79091ffc1512b0704b1eb17b" data-build-run-id="898771215"><div id="__next"><main class="page docs"><header><div class="navbar"><div class="navbar-content container"><div class="navbar-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMjMyLjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3ptNDE0LTI2Ni45aC0xNS4zdjQyLjJoLTguNVY2LjloLTE1LjJWMGgzOXY2Ljl6TTExOTMgMGwxNC4yIDM3LjdMMTIyMS4zIDBoMTF2NDkuMWgtOC41VjMyLjlsLjgtMjEuNy0xNC41IDM3LjloLTYuMWwtMTQuNS0zNy44LjggMjEuNnYxNi4yaC04LjVWMGgxMS4yeiIvPjwvc3ZnPg==" alt="Vert.x Logo"/></a></div><div class="navbar-collapse-button"><span></span><span></span><span></span></div><div class="navbar-right"><div class="navbar-menu"><span class="navbar-menu-item with-drop-down"><div class="dropdown"><a class="dropdown-title">开始<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/introduction-to-vertx-and-reactive/"><li class="dropdown-item">简介</li></a><a href="/get-started/"><li class="dropdown-item">开始</li></a><a href="https://start.vertx.io/" target="_blank" rel="noreferrer"><li class="dropdown-item">应用生成器 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="navbar-menu-item" href="/docs/">文档</a><span class="navbar-menu-item with-drop-down"><div class="dropdown"><a class="dropdown-title">资源<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu"><a href="/faq/"><li class="dropdown-item">答疑</li></a><a href="/channels/"><li class="dropdown-item">联系渠道</li></a><a href="https://how-to.vertx.io/" target="_blank" rel="noreferrer"><li class="dropdown-item">操作指南 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/vertx-eventbus-bridge-clients" target="_blank" rel="noreferrer"><li class="dropdown-item">EventBus Bridge Clients <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="navbar-menu-item" href="/blog/">博客</a><a class="navbar-menu-item" href="/community/">社区</a><a class="navbar-menu-item" href="/translation/">翻译团队</a></div><div class="navbar-social"><a href="https://github.com/vert-x3/vertx-awesome" class="navbar-social-link" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" class="navbar-social-link" title="Stack Overflow" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>Stack Overflow</title><path d="M18.986 21.865v-6.404h2.134V24H1.844v-8.539h2.13v6.404h15.012zM6.111 19.731H16.85v-2.137H6.111v2.137zm.259-4.852l10.48 2.189.451-2.07-10.478-2.187-.453 2.068zm1.359-5.056l9.705 4.53.903-1.95-9.706-4.53-.902 1.936v.014zm2.715-4.785l8.217 6.855 1.359-1.62-8.216-6.853-1.35 1.617-.01.001zM15.751 0l-1.746 1.294 6.405 8.604 1.746-1.294L15.749 0h.002z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" class="navbar-social-link" title="YouTube" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>YouTube</title><path d="M23.499 6.203a3.008 3.008 0 00-2.089-2.089c-1.87-.501-9.4-.501-9.4-.501s-7.509-.01-9.399.501a3.008 3.008 0 00-2.088 2.09A31.258 31.26 0 000 12.01a31.258 31.26 0 00.523 5.785 3.008 3.008 0 002.088 2.089c1.869.502 9.4.502 9.4.502s7.508 0 9.399-.502a3.008 3.008 0 002.089-2.09 31.258 31.26 0 00.5-5.784 31.258 31.26 0 00-.5-5.808zm-13.891 9.4V8.407l6.266 3.604z"></path></svg></a><a href="https://discord.gg/KzEMwP2" class="navbar-social-link" title="Discord" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title>Discord</title><path d="M20.222 0c1.406 0 2.54 1.137 2.607 2.475V24l-2.677-2.273-1.47-1.338-1.604-1.398.67 2.205H3.71c-1.402 0-2.54-1.065-2.54-2.476V2.48C1.17 1.142 2.31.003 3.715.003h16.5L20.222 0zm-6.118 5.683h-.03l-.202.2c2.073.6 3.076 1.537 3.076 1.537-1.336-.668-2.54-1.002-3.744-1.137-.87-.135-1.74-.064-2.475 0h-.2c-.47 0-1.47.2-2.81.735-.467.203-.735.336-.735.336s1.002-1.002 3.21-1.537l-.135-.135s-1.672-.064-3.477 1.27c0 0-1.805 3.144-1.805 7.02 0 0 1 1.74 3.743 1.806 0 0 .4-.533.805-1.002-1.54-.468-2.14-1.404-2.14-1.404s.134.066.335.2h.06c.03 0 .044.015.06.03v.006c.016.016.03.03.06.03.33.136.66.27.93.4.466.202 1.065.403 1.8.536.93.135 1.996.2 3.21 0 .6-.135 1.2-.267 1.8-.535.39-.2.87-.4 1.397-.737 0 0-.6.936-2.205 1.404.33.466.795 1 .795 1 2.744-.06 3.81-1.8 3.87-1.726 0-3.87-1.815-7.02-1.815-7.02-1.635-1.214-3.165-1.26-3.435-1.26l.056-.02zm.168 4.413c.703 0 1.27.6 1.27 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334.002-.74.573-1.338 1.27-1.338zm-4.543 0c.7 0 1.266.6 1.266 1.335 0 .74-.57 1.34-1.27 1.34-.7 0-1.27-.6-1.27-1.334 0-.74.57-1.338 1.27-1.338z"></path></svg></a><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" class="navbar-social-link" title="Vert.x 用户组" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title>Vert.x 用户组</title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a><a href="https://shang.qq.com/wpa/qunwpa?idkey=587f58cacb9557e3291b46098e0fe09427b98a1c0f866da23c04c2762bc7e2ad" class="navbar-social-link" title="Vert.x中国用户组QQ群" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Vert.x中国用户组QQ群"><title>Vert.x中国用户组QQ群</title><path d="M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673zM12.662 4.846c.039-1.052.659-1.878 1.385-1.846s1.281.912 1.242 1.964c-.039 1.051-.659 1.878-1.385 1.846s-1.282-.912-1.242-1.964zM9.954 3c.725-.033 1.345.794 1.384 1.846.04 1.052-.517 1.931-1.242 1.963-.726.033-1.346-.794-1.385-1.845C8.672 3.912 9.228 3.033 9.954 3zM7.421 8.294c.194-.43 2.147-.908 4.566-.908h.026c2.418 0 4.372.479 4.566.908a.14.14 0 0 1 .014.061c0 .031-.01.059-.026.083-.163.238-2.333 1.416-4.553 1.416h-.026c-2.221 0-4.39-1.178-4.553-1.416a.136.136 0 0 1-.014-.144zm10.422 8.622c-.22 3.676-2.403 5.987-5.774 6.021h-.137c-3.37-.033-5.554-2.345-5.773-6.021-.081-1.35.001-2.496.147-3.43.318.063.638.122.958.176v3.506s1.658.334 3.318.103v-3.225c.488.027.96.04 1.406.034h.025c1.678.021 3.714-.204 5.683-.594.146.934.227 2.08.147 3.43zM10.48 5.804c.313-.041.542-.409.508-.825-.033-.415-.314-.72-.629-.679-.313.04-.541.409-.508.824.034.417.315.72.629.68zM14.479 5.156c.078.037.221.042.289-.146.035-.095.025-.165-.009-.214-.023-.033-.133-.118-.371-.176-.904-.22-1.341.384-1.405.499-.04.072-.012.176.056.227.067.051.139.037.179-.006.58-.628 1.21-.208 1.261-.184z"></path></svg></a></div></div></div></div></header><div class="page-content docs-content"><div class="container"><div class="docs-content-wrapper"><aside class=""><div class="docs-content-wrapper-sidebar"><div class="search-panel"><div class="search"><input type="text" placeholder="Search..." value=""/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon-delete"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></div><ul class="search-results"></ul><div class="search-results-none">No results.</div></div><div class="docs-content-toc"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_usage">Usage</a></li>
<li><a href="#_getting_started">Getting started</a></li>
<li><a href="#_connecting_to_sql_server">Connecting to SQL Server</a></li>
<li><a href="#_configuration">Configuration</a>
<ul class="sectlevel2">
<li><a href="#_data_object">Data Object</a></li>
<li><a href="#_connection_uri">Connection URI</a></li>
</ul>
</li>
<li><a href="#_connect_retries">Connect retries</a></li>
<li><a href="#_running_queries">Running queries</a>
<ul class="sectlevel2">
<li><a href="#_prepared_queries">Prepared queries</a></li>
</ul>
</li>
<li><a href="#_using_connections">Using connections</a>
<ul class="sectlevel2">
<li><a href="#_getting_a_connection">Getting a connection</a></li>
<li><a href="#_simplified_connection_api">Simplified connection API</a></li>
</ul>
</li>
<li><a href="#_using_transactions">Using transactions</a>
<ul class="sectlevel2">
<li><a href="#_transactions_with_connections">Transactions with connections</a></li>
<li><a href="#_simplified_transaction_api">Simplified transaction API</a></li>
</ul>
</li>
<li><a href="#_tracing_queries">Tracing queries</a></li>
<li><a href="#_data_types_supported">Data types supported</a>
<ul class="sectlevel2">
<li><a href="#_using_java_enum_types">Using Java <code>enum</code> types</a></li>
<li><a href="#_handling_null">Handling <code>NULL</code></a></li>
</ul>
</li>
<li><a href="#_collector_queries">Collector queries</a></li>
</ul>
</div></div></div></aside><div class="docs-content-sidebar-toggle"><div style="position:relative"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div></div><div class="docs-content-inner"><div class="docs-content-metadata"><div class="docs-content-metadata-left"><div class="docs-content-metadata-repo"><div class="github-stars"><a href="https://github.com/eclipse-vertx/vertx-sql-client"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>null stars</a></div></div><div><a href="https://vertx.io/docs/apidocs"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg> API</a></div><div class="docs-content-metadata-edit"><a href="https://github.com/eclipse-vertx/vertx-sql-client/tree/master/vertx-mssql-client/src/main/asciidoc"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> 改进翻译</a></div><span class="docs-content-metadata-version"><div class="dropdown"><a class="dropdown-title">v4.1.0<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="dropdown-menu align-right"><a href="/docs/vertx-mssql-client/java/"><li class="dropdown-item active has-active-siblings"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="dropdown-check-icon"><polyline points="20 6 9 17 4 12"></polyline></svg>Latest (v<!-- -->4.1.0<!-- -->)</li></a></ul></div></span></div><div class="docs-content-metadata-label"><div class="label small nowrap">Technical Preview</div></div></div><div><h1>Reactive MSSQL Client</h1>

<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Reactive MSSQL Client is a client for Microsoft SQL Server with a straightforward API focusing on
scalability and low overhead.</p>
</div>
<div class="paragraph">
<p><strong>Features</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Event driven</p>
</li>
<li>
<p>Lightweight</p>
</li>
<li>
<p>Built-in connection pooling</p>
</li>
<li>
<p>Direct memory to object without unnecessary copies</p>
</li>
<li>
<p>Java 8 Date and Time</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Not supported yet</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prepared queries caching</p>
</li>
<li>
<p>Batch and cursor</p>
</li>
<li>
<p>Row streaming</p>
</li>
<li>
<p>Some <a href="https://github.com/eclipse-vertx/vertx-sql-client/issues/608#issuecomment-629390027">data types</a> are not supported</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage"><a class="anchor" href="#_usage"></a>Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use the Reactive MSSQL Client add the following dependency to the <em>dependencies</em> section of your build descriptor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven (in your <code>pom.xml</code>):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-mssql-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle (in your <code>build.gradle</code> file):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">dependencies {
 compile <span class="hljs-string">'io.vertx:vertx-mssql-client:4.1.0'</span>
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a>Getting started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here is the simplest way to connect, query and disconnect</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MSSQLConnectOptions connectOptions = <span class="hljs-keyword">new</span> MSSQLConnectOptions()
  .setPort(<span class="hljs-number">1433</span>)
  .setHost(<span class="hljs-string">"the-host"</span>)
  .setDatabase(<span class="hljs-string">"the-db"</span>)
  .setUser(<span class="hljs-string">"user"</span>)
  .setPassword(<span class="hljs-string">"secret"</span>);

<span class="hljs-comment">// Pool options</span>
PoolOptions poolOptions = <span class="hljs-keyword">new</span> PoolOptions()
  .setMaxSize(<span class="hljs-number">5</span>);

<span class="hljs-comment">// Create the client pool</span>
MSSQLPool client = MSSQLPool.pool(connectOptions, poolOptions);

<span class="hljs-comment">// A simple query</span>
client
  .query(<span class="hljs-string">"SELECT * FROM users WHERE id='julien'"</span>)
  .execute(ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    RowSet result = ar.result();
    System.out.println(<span class="hljs-string">"Got "</span> + result.size() + <span class="hljs-string">" rows "</span>);
  } <span class="hljs-keyword">else</span> {
    System.out.println(<span class="hljs-string">"Failure: "</span> + ar.cause().getMessage());
  }

  <span class="hljs-comment">// Now close the pool</span>
  client.close();
});</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connecting_to_sql_server"><a class="anchor" href="#_connecting_to_sql_server"></a>Connecting to SQL Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most of the time you will use a pool to connect to MSSQL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MSSQLConnectOptions connectOptions = <span class="hljs-keyword">new</span> MSSQLConnectOptions()
  .setPort(<span class="hljs-number">1433</span>)
  .setHost(<span class="hljs-string">"the-host"</span>)
  .setDatabase(<span class="hljs-string">"the-db"</span>)
  .setUser(<span class="hljs-string">"user"</span>)
  .setPassword(<span class="hljs-string">"secret"</span>);

<span class="hljs-comment">// Pool options</span>
PoolOptions poolOptions = <span class="hljs-keyword">new</span> PoolOptions()
  .setMaxSize(<span class="hljs-number">5</span>);

<span class="hljs-comment">// Create the pooled client</span>
MSSQLPool client = MSSQLPool.pool(connectOptions, poolOptions);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The pooled client uses a connection pool and any operation will borrow a connection from the pool
to execute the operation and release it to the pool.</p>
</div>
<div class="paragraph">
<p>If you are running with Vert.x you can pass it your Vertx instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MSSQLConnectOptions connectOptions = <span class="hljs-keyword">new</span> MSSQLConnectOptions()
  .setPort(<span class="hljs-number">1433</span>)
  .setHost(<span class="hljs-string">"the-host"</span>)
  .setDatabase(<span class="hljs-string">"the-db"</span>)
  .setUser(<span class="hljs-string">"user"</span>)
  .setPassword(<span class="hljs-string">"secret"</span>);

<span class="hljs-comment">// Pool options</span>
PoolOptions poolOptions = <span class="hljs-keyword">new</span> PoolOptions()
  .setMaxSize(<span class="hljs-number">5</span>);
<span class="hljs-comment">// Create the pooled client</span>
MSSQLPool client = MSSQLPool.pool(vertx, connectOptions, poolOptions);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You need to release the pool when you don&#8217;t need it anymore:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">pool.close();</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you need to execute several operations on the same connection, you need to use a client
<code><a href="../../apidocs/io/vertx/mssqlclient/MSSQLConnection.html">connection</a></code>.</p>
</div>
<div class="paragraph">
<p>You can easily get one from the pool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MSSQLConnectOptions connectOptions = <span class="hljs-keyword">new</span> MSSQLConnectOptions()
  .setPort(<span class="hljs-number">1433</span>)
  .setHost(<span class="hljs-string">"the-host"</span>)
  .setDatabase(<span class="hljs-string">"the-db"</span>)
  .setUser(<span class="hljs-string">"user"</span>)
  .setPassword(<span class="hljs-string">"secret"</span>);

<span class="hljs-comment">// Pool options</span>
PoolOptions poolOptions = <span class="hljs-keyword">new</span> PoolOptions()
  .setMaxSize(<span class="hljs-number">5</span>);

<span class="hljs-comment">// Create the pooled client</span>
MSSQLPool client = MSSQLPool.pool(vertx, connectOptions, poolOptions);

<span class="hljs-comment">// Get a connection from the pool</span>
client.getConnection().compose(conn -&gt; {
  System.out.println(<span class="hljs-string">"Got a connection from the pool"</span>);

  <span class="hljs-comment">// All operations execute on the same connection</span>
  <span class="hljs-keyword">return</span> conn
    .query(<span class="hljs-string">"SELECT * FROM users WHERE id='julien'"</span>)
    .execute()
    .compose(res -&gt; conn
      .query(<span class="hljs-string">"SELECT * FROM users WHERE id='emad'"</span>)
      .execute())
    .onComplete(ar -&gt; {
      <span class="hljs-comment">// Release the connection to the pool</span>
      conn.close();
    });
}).onComplete(ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {

    System.out.println(<span class="hljs-string">"Done"</span>);
  } <span class="hljs-keyword">else</span> {
    System.out.println(<span class="hljs-string">"Something went wrong "</span> + ar.cause().getMessage());
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once you are done with the connection you must close it to release it to the pool, so it can be reused.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="anchor" href="#_configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_data_object"><a class="anchor" href="#_data_object"></a>Data Object</h3>
<div class="paragraph">
<p>A simple way to configure the client is to specify a <code>MSSQLConnectOptions</code> data object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MSSQLConnectOptions connectOptions = <span class="hljs-keyword">new</span> MSSQLConnectOptions()
  .setPort(<span class="hljs-number">1433</span>)
  .setHost(<span class="hljs-string">"the-host"</span>)
  .setDatabase(<span class="hljs-string">"the-db"</span>)
  .setUser(<span class="hljs-string">"user"</span>)
  .setPassword(<span class="hljs-string">"secret"</span>);

<span class="hljs-comment">// Pool Options</span>
PoolOptions poolOptions = <span class="hljs-keyword">new</span> PoolOptions().setMaxSize(<span class="hljs-number">5</span>);

<span class="hljs-comment">// Create the pool from the data object</span>
MSSQLPool pool = MSSQLPool.pool(vertx, connectOptions, poolOptions);

pool.getConnection(ar -&gt; {
  <span class="hljs-comment">// Handling your connection</span>
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_connection_uri"><a class="anchor" href="#_connection_uri"></a>Connection URI</h3>
<div class="paragraph">
<p>As an alternative to configuring the client with a <code><a href="../../apidocs/io/vertx/mssqlclient/MSSQLConnectOptions.html">MSSQLConnectOptions</a></code> data object, you can use a connection URI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String connectionUri = <span class="hljs-string">"sqlserver://dbuser:secretpassword@database.server.com:3211/mydb"</span>;

<span class="hljs-comment">// Create the pool from the connection URI</span>
MSSQLPool pool = MSSQLPool.pool(connectionUri);

<span class="hljs-comment">// Create the connection from the connection URI</span>
MSSQLConnection.connect(vertx, connectionUri, res -&gt; {
  <span class="hljs-comment">// Handling your connection</span>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The connection URI format is defined by the client in an idiomatic way: <code>sqlserver://[user[:[password]]@]host[:port][/database][?attribute1=value1&amp;attribute2=value2&#8230;&#8203;]</code></p>
</div>
<div class="paragraph">
<p>Currently, the client supports the following parameter keywords in connection uri (keys are case-insensitive):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>host</p>
</li>
<li>
<p>port</p>
</li>
<li>
<p>user</p>
</li>
<li>
<p>password</p>
</li>
<li>
<p>database</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connect_retries"><a class="anchor" href="#_connect_retries"></a>Connect retries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can configure the client to retry when a connection fails to be established.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">options
  .setReconnectAttempts(<span class="hljs-number">2</span>)
  .setReconnectInterval(<span class="hljs-number">1000</span>);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_queries"><a class="anchor" href="#_running_queries"></a>Running queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you don&#8217;t need a transaction or run single queries, you can run queries directly on the pool; the pool
will use one of its connection to run the query and return the result to you.</p>
</div>
<div class="paragraph">
<p>Here is how to run simple queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .query(<span class="hljs-string">"SELECT * FROM users WHERE id='julien'"</span>)
  .execute(ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    RowSet&lt;Row&gt; result = ar.result();
    System.out.println(<span class="hljs-string">"Got "</span> + result.size() + <span class="hljs-string">" rows "</span>);
  } <span class="hljs-keyword">else</span> {
    System.out.println(<span class="hljs-string">"Failure: "</span> + ar.cause().getMessage());
  }
});</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_prepared_queries"><a class="anchor" href="#_prepared_queries"></a>Prepared queries</h3>
<div class="paragraph">
<p>You can do the same with prepared queries.</p>
</div>
<div class="paragraph">
<p>The SQL string can refer to parameters by position, using the database syntax `@1`, `@2`, etc…​</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .preparedQuery(<span class="hljs-string">"SELECT * FROM users WHERE id=@p1"</span>)
  .execute(Tuple.of(<span class="hljs-string">"julien"</span>), ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    RowSet&lt;Row&gt; rows = ar.result();
    System.out.println(<span class="hljs-string">"Got "</span> + rows.size() + <span class="hljs-string">" rows "</span>);
  } <span class="hljs-keyword">else</span> {
    System.out.println(<span class="hljs-string">"Failure: "</span> + ar.cause().getMessage());
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Query methods provides an asynchronous <code><a href="../../apidocs/io/vertx/sqlclient/RowSet.html">RowSet</a></code> instance that works for <em>SELECT</em> queries</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .preparedQuery(<span class="hljs-string">"SELECT first_name, last_name FROM users"</span>)
  .execute(ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    RowSet&lt;Row&gt; rows = ar.result();
    <span class="hljs-keyword">for</span> (Row row : rows) {
      System.out.println(<span class="hljs-string">"User "</span> + row.getString(<span class="hljs-number">0</span>) + <span class="hljs-string">" "</span> + row.getString(<span class="hljs-number">1</span>));
    }
  } <span class="hljs-keyword">else</span> {
    System.out.println(<span class="hljs-string">"Failure: "</span> + ar.cause().getMessage());
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>or <em>UPDATE</em>/<em>INSERT</em> queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .preparedQuery(<span class="hljs-string">"INSERT INTO users (first_name, last_name) VALUES (@p1, @p2)"</span>)
  .execute(Tuple.of(<span class="hljs-string">"Julien"</span>, <span class="hljs-string">"Viet"</span>), ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    RowSet&lt;Row&gt; rows = ar.result();
    System.out.println(rows.rowCount());
  } <span class="hljs-keyword">else</span> {
    System.out.println(<span class="hljs-string">"Failure: "</span> + ar.cause().getMessage());
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code><a href="../../apidocs/io/vertx/sqlclient/Row.html">Row</a></code> gives you access to your data by index</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">System.out.println(<span class="hljs-string">"User "</span> + row.getString(<span class="hljs-number">0</span>) + <span class="hljs-string">" "</span> + row.getString(<span class="hljs-number">1</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>or by name</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">System.out.println(<span class="hljs-string">"User "</span> + row.getString(<span class="hljs-string">"first_name"</span>) + <span class="hljs-string">" "</span> + row.getString(<span class="hljs-string">"last_name"</span>));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client will not do any magic here and the column name is identified with the name in the table regardless of how your SQL text is.</p>
</div>
<div class="paragraph">
<p>You can access a wide variety of of types</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">String firstName = row.getString(<span class="hljs-string">"first_name"</span>);
Boolean male = row.getBoolean(<span class="hljs-string">"male"</span>);
Integer age = row.getInteger(<span class="hljs-string">"age"</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use cached prepared statements to execute one-shot prepared queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">connectOptions.setCachePreparedStatements(<span class="hljs-keyword">true</span>);
client
  .preparedQuery(<span class="hljs-string">"SELECT * FROM users WHERE id = @p1"</span>)
  .execute(Tuple.of(<span class="hljs-string">"julien"</span>), ar -&gt; {
    <span class="hljs-keyword">if</span> (ar.succeeded()) {
      RowSet&lt;Row&gt; rows = ar.result();
      System.out.println(<span class="hljs-string">"Got "</span> + rows.size() + <span class="hljs-string">" rows "</span>);
    } <span class="hljs-keyword">else</span> {
      System.out.println(<span class="hljs-string">"Failure: "</span> + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can create a <code>PreparedStatement</code> and manage the lifecycle by yourself.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">sqlConnection
  .prepare(<span class="hljs-string">"SELECT * FROM users WHERE id = @p1"</span>, ar -&gt; {
    <span class="hljs-keyword">if</span> (ar.succeeded()) {
      PreparedStatement preparedStatement = ar.result();
      preparedStatement.query()
        .execute(Tuple.of(<span class="hljs-string">"julien"</span>), ar2 -&gt; {
          <span class="hljs-keyword">if</span> (ar2.succeeded()) {
            RowSet&lt;Row&gt; rows = ar2.result();
            System.out.println(<span class="hljs-string">"Got "</span> + rows.size() + <span class="hljs-string">" rows "</span>);
            preparedStatement.close();
          } <span class="hljs-keyword">else</span> {
            System.out.println(<span class="hljs-string">"Failure: "</span> + ar2.cause().getMessage());
          }
        });
    } <span class="hljs-keyword">else</span> {
      System.out.println(<span class="hljs-string">"Failure: "</span> + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_connections"><a class="anchor" href="#_using_connections"></a>Using connections</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_getting_a_connection"><a class="anchor" href="#_getting_a_connection"></a>Getting a connection</h3>
<div class="paragraph">
<p>When you need to execute sequential queries (without a transaction), you can create a new connection
or borrow one from the pool. Remember that between acquiring the connection from the pool and returning it to the pool, you should take care of the connection because it might be closed by the server for some reason such as an idle time out.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">pool
  .getConnection()
  .compose(connection -&gt;
    connection
      .preparedQuery(<span class="hljs-string">"INSERT INTO Users (first_name,last_name) VALUES (@p1, @p2)"</span>)
      .executeBatch(Arrays.asList(
        Tuple.of(<span class="hljs-string">"Julien"</span>, <span class="hljs-string">"Viet"</span>),
        Tuple.of(<span class="hljs-string">"Emad"</span>, <span class="hljs-string">"Alblueshi"</span>)
      ))
      .compose(res -&gt; connection
        <span class="hljs-comment">// Do something with rows</span>
        .query(<span class="hljs-string">"SELECT COUNT(*) FROM Users"</span>)
        .execute()
        .map(rows -&gt; rows.iterator().next().getInteger(<span class="hljs-number">0</span>)))
      <span class="hljs-comment">// Return the connection to the pool</span>
      .eventually(v -&gt; connection.close())
  ).onSuccess(count -&gt; {
  System.out.println(<span class="hljs-string">"Insert users, now the number of users is "</span> + count);
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Prepared queries can be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">connection
  .prepare(<span class="hljs-string">"SELECT * FROM users WHERE first_name LIKE @p1"</span>)
  .compose(pq -&gt;
    pq.query()
      .execute(Tuple.of(<span class="hljs-string">"Julien"</span>))
      .eventually(v -&gt; pq.close())
  ).onSuccess(rows -&gt; {
  <span class="hljs-comment">// All rows</span>
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_simplified_connection_api"><a class="anchor" href="#_simplified_connection_api"></a>Simplified connection API</h3>
<div class="paragraph">
<p>When you use a pool, you can call <code><a href="../../apidocs/io/vertx/sqlclient/Pool.html#withConnection-java.util.function.Function-io.vertx.core.Handler-">withConnection</a></code> to pass it a function executed
within a connection.</p>
</div>
<div class="paragraph">
<p>It borrows a connection from the pool and calls the function with this connection.</p>
</div>
<div class="paragraph">
<p>The function must return a future of an arbitrary result.</p>
</div>
<div class="paragraph">
<p>After the future completes, the connection is returned to the pool and the overall result is provided.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">pool.withConnection(connection -&gt;
  connection
    .preparedQuery(<span class="hljs-string">"INSERT INTO Users (first_name,last_name) VALUES (@p1, @p2)"</span>)
    .executeBatch(Arrays.asList(
      Tuple.of(<span class="hljs-string">"Julien"</span>, <span class="hljs-string">"Viet"</span>),
      Tuple.of(<span class="hljs-string">"Emad"</span>, <span class="hljs-string">"Alblueshi"</span>)
    ))
    .compose(res -&gt; connection
      <span class="hljs-comment">// Do something with rows</span>
      .query(<span class="hljs-string">"SELECT COUNT(*) FROM Users"</span>)
      .execute()
      .map(rows -&gt; rows.iterator().next().getInteger(<span class="hljs-number">0</span>)))
).onSuccess(count -&gt; {
  System.out.println(<span class="hljs-string">"Insert users, now the number of users is "</span> + count);
});</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_transactions"><a class="anchor" href="#_using_transactions"></a>Using transactions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_transactions_with_connections"><a class="anchor" href="#_transactions_with_connections"></a>Transactions with connections</h3>
<div class="paragraph">
<p>You can execute transaction using SQL <code>BEGIN</code>/<code>COMMIT</code>/<code>ROLLBACK</code>, if you do so you must use
a <code><a href="../../apidocs/io/vertx/sqlclient/SqlConnection.html">SqlConnection</a></code> and manage it yourself.</p>
</div>
<div class="paragraph">
<p>Or you can use the transaction API of <code><a href="../../apidocs/io/vertx/sqlclient/SqlConnection.html">SqlConnection</a></code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">pool.getConnection()
  <span class="hljs-comment">// Transaction must use a connection</span>
  .onSuccess(conn -&gt; {
    <span class="hljs-comment">// Begin the transaction</span>
    conn.begin()
      .compose(tx -&gt; conn
        <span class="hljs-comment">// Various statements</span>
        .query(<span class="hljs-string">"INSERT INTO Users (first_name,last_name) VALUES ('Julien','Viet')"</span>)
        .execute()
        .compose(res2 -&gt; conn
          .query(<span class="hljs-string">"INSERT INTO Users (first_name,last_name) VALUES ('Emad','Alblueshi')"</span>)
          .execute())
        <span class="hljs-comment">// Commit the transaction</span>
        .compose(res3 -&gt; tx.commit()))
      <span class="hljs-comment">// Return the connection to the pool</span>
      .eventually(v -&gt; conn.close())
      .onSuccess(v -&gt; System.out.println(<span class="hljs-string">"Transaction succeeded"</span>))
      .onFailure(err -&gt; System.out.println(<span class="hljs-string">"Transaction failed: "</span> + err.getMessage()));
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the database server reports the current transaction is failed (e.g the infamous <em>current transaction is aborted, commands ignored until
end of transaction block</em>), the transaction is rollbacked and the <code><a href="../../apidocs/io/vertx/sqlclient/Transaction.html#completion--">completion</a></code> future
is failed with a <code><a href="../../apidocs/io/vertx/sqlclient/TransactionRollbackException.html">TransactionRollbackException</a></code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">tx.completion()
  .onFailure(err -&gt; {
    System.out.println(<span class="hljs-string">"Transaction failed =&gt; rolled back"</span>);
  });</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_simplified_transaction_api"><a class="anchor" href="#_simplified_transaction_api"></a>Simplified transaction API</h3>
<div class="paragraph">
<p>When you use a pool, you can call <code><a href="../../apidocs/io/vertx/sqlclient/Pool.html#withTransaction-java.util.function.Function-io.vertx.core.Handler-">withTransaction</a></code> to pass it a function executed
within a transaction.</p>
</div>
<div class="paragraph">
<p>It borrows a connection from the pool, begins the transaction and calls the function with a client executing all
operations in the scope of this transaction.</p>
</div>
<div class="paragraph">
<p>The function must return a future of an arbitrary result:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>when the future succeeds the client will commit the transaction</p>
</li>
<li>
<p>when the future fails the client will rollback the transaction</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After the transaction completes, the connection is returned to the pool and the overall result is provided.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">pool.withTransaction(client -&gt; client
  .query(<span class="hljs-string">"INSERT INTO Users (first_name,last_name) VALUES ('Julien','Viet')"</span>)
  .execute()
  .flatMap(res -&gt; client
    .query(<span class="hljs-string">"INSERT INTO Users (first_name,last_name) VALUES ('Julien','Viet')"</span>)
    .execute()
    <span class="hljs-comment">// Map to a message result</span>
    .map(<span class="hljs-string">"Users inserted"</span>)))
  .onSuccess(v -&gt; System.out.println(<span class="hljs-string">"Transaction succeeded"</span>))
  .onFailure(err -&gt; System.out.println(<span class="hljs-string">"Transaction failed: "</span> + err.getMessage()));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tracing_queries"><a class="anchor" href="#_tracing_queries"></a>Tracing queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The SQL client can trace query execution when Vert.x has tracing enabled.</p>
</div>
<div class="paragraph">
<p>The client reports the following <em>client</em> spans:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Query</code> operation name</p>
</li>
<li>
<p>tags</p>
</li>
<li>
<p><code>db.user</code>: the database username</p>
</li>
<li>
<p><code>db.instance</code>: the database instance</p>
</li>
<li>
<p><code>db.statement</code>: the SQL query</p>
</li>
<li>
<p><code>db.type</code>: <em>sql</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default tracing policy is <code><a href="../../apidocs/io/vertx/core/tracing/TracingPolicy.html#PROPAGATE">PROPAGATE</a></code>, the client
will only create a span when involved in an active trace.</p>
</div>
<div class="paragraph">
<p>You can change the client policy with <code><a href="../../apidocs/io/vertx/sqlclient/SqlConnectOptions.html#setTracingPolicy-io.vertx.core.tracing.TracingPolicy-">setTracingPolicy</a></code>,
e.g you can set <code><a href="../../apidocs/io/vertx/core/tracing/TracingPolicy.html#ALWAYS">ALWAYS</a></code> to always report
a span:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">options.setTracingPolicy(TracingPolicy.ALWAYS);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_types_supported"><a class="anchor" href="#_data_types_supported"></a>Data types supported</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Currently, the client supports the following SQL Server types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TINYINT(<code>java.lang.Short</code>)</p>
</li>
<li>
<p>SMALLINT(<code>java.lang.Short</code>)</p>
</li>
<li>
<p>INT(<code>java.lang.Integer</code>)</p>
</li>
<li>
<p>BIGINT(<code>java.lang.Long</code>)</p>
</li>
<li>
<p>BIT(<code>java.lang.Boolean</code>)</p>
</li>
<li>
<p>REAL(<code>java.lang.Float</code>)</p>
</li>
<li>
<p>DOUBLE(<code>java.lang.Double</code>)</p>
</li>
<li>
<p>NUMERIC/DECIMAL(<code><a href="../../apidocs/java/math/BigDecimal.html">BigDecimal</a></code>)</p>
</li>
<li>
<p>CHAR/VARCHAR(<code>java.lang.String</code>)</p>
</li>
<li>
<p>NCHAR/NVARCHAR(<code>java.lang.String</code>)</p>
</li>
<li>
<p>DATE(<code>java.time.LocalDate</code>)</p>
</li>
<li>
<p>TIME(<code>java.time.LocalTime</code>)</p>
</li>
<li>
<p>DATETIME2(<code>java.time.LocalDateTime</code>)</p>
</li>
<li>
<p>DATETIMEOFFSET(<code>java.time.OffsetDateTime</code>)</p>
</li>
<li>
<p>BINARY/VARBINARY(<code>io.vertx.core.buffer.Buffer</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Tuple decoding uses the above types when storing values.</p>
</div>
<div class="sect2">
<h3 id="_using_java_enum_types"><a class="anchor" href="#_using_java_enum_types"></a>Using Java <code>enum</code> types</h3>
<div class="paragraph">
<p>SQL Server does not have <code>ENUM</code> data type, but the client can map the retrieved string/numeric data type to enum.</p>
</div>
<div class="paragraph">
<p>You can encode Java enums like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .preparedQuery(<span class="hljs-string">"INSERT INTO colors VALUES (@p1)"</span>)
  .execute(Tuple.of(Color.red),  res -&gt; {
    <span class="hljs-comment">// ...</span>
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can decode a Java enum like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .preparedQuery(<span class="hljs-string">"SELECT color FROM colors"</span>)
  .execute()
  .onComplete(res -&gt; {
    <span class="hljs-keyword">if</span> (res.succeeded()) {
      RowSet&lt;Row&gt; rows = res.result();
      <span class="hljs-keyword">for</span> (Row row : rows) {
        System.out.println(row.get(Color<span class="hljs-class">.<span class="hljs-keyword">class</span>, "<span class="hljs-title">color</span>"))</span>;
      }
    }
  });</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handling_null"><a class="anchor" href="#_handling_null"></a>Handling <code>NULL</code></h3>
<div class="paragraph">
<p>If you modify a <code>Tuple</code> with one of the <code>addXXX</code> methods, <code>null</code> values are handled transparently.</p>
</div>
<div class="paragraph">
<p>The client can infer the right SQL type when executing a prepared query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Tuple tuple = Tuple.tuple()
  .addInteger(<span class="hljs-number">17</span>)
  .addString(<span class="hljs-string">"The Man Who Knew Too Much"</span>)
  .addString(<span class="hljs-keyword">null</span>);
client
  .preparedQuery(<span class="hljs-string">"INSERT INTO movies (id, title, plot) VALUES (@p1, @p2, @p3)"</span>)
  .execute(tuple, res -&gt; {
    <span class="hljs-comment">// ...</span>
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Otherwise, you should declare the type explicitely using one of the <code><a href="../../apidocs/io/vertx/sqlclient/data/NullValue.html">NullValue</a></code> constants or the <code><a href="../../apidocs/io/vertx/sqlclient/data/NullValue.html#of-java.lang.Class-">NullValue.of</a></code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Tuple tuple = Tuple.of(<span class="hljs-number">17</span>, <span class="hljs-string">"The Man Who Knew Too Much"</span>, NullValue.String);
client
  .preparedQuery(<span class="hljs-string">"INSERT INTO movies (id, title, plot) VALUES (@p1, @p2, @p3)"</span>)
  .execute(tuple, res -&gt; {
    <span class="hljs-comment">// ...</span>
  });</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_collector_queries"><a class="anchor" href="#_collector_queries"></a>Collector queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use Java collectors with the query API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Collector&lt;Row, ?, Map&lt;Long, String&gt;&gt; collector = Collectors.toMap(
  row -&gt; row.getLong(<span class="hljs-string">"id"</span>),
  row -&gt; row.getString(<span class="hljs-string">"last_name"</span>));

<span class="hljs-comment">// Run the query with the collector</span>
client.query(<span class="hljs-string">"SELECT * FROM users"</span>)
  .collecting(collector)
  .execute(ar -&gt; {
    <span class="hljs-keyword">if</span> (ar.succeeded()) {
      SqlResult&lt;Map&lt;Long, String&gt;&gt; result = ar.result();

      <span class="hljs-comment">// Get the map created by the collector</span>
      Map&lt;Long, String&gt; map = result.value();
      System.out.println(<span class="hljs-string">"Got "</span> + map);
    } <span class="hljs-keyword">else</span> {
      System.out.println(<span class="hljs-string">"Failure: "</span> + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>The collector processing must not keep a reference on the <code><a href="../../apidocs/io/vertx/sqlclient/Row.html">Row</a></code> as
there is a single row used for processing the entire set.</p>
</div>
<div class="paragraph">
<p>The Java <code>Collectors</code> provides many interesting predefined collectors, for example you can
create easily create a string directly from the row set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Collector&lt;Row, ?, String&gt; collector = Collectors.mapping(
  row -&gt; row.getString(<span class="hljs-string">"last_name"</span>),
  Collectors.joining(<span class="hljs-string">","</span>, <span class="hljs-string">"("</span>, <span class="hljs-string">")"</span>)
);

<span class="hljs-comment">// Run the query with the collector</span>
client.query(<span class="hljs-string">"SELECT * FROM users"</span>)
  .collecting(collector)
  .execute(ar -&gt; {
    <span class="hljs-keyword">if</span> (ar.succeeded()) {
      SqlResult&lt;String&gt; result = ar.result();

      <span class="hljs-comment">// Get the string created by the collector</span>
      String list = result.value();
      System.out.println(<span class="hljs-string">"Got "</span> + list);
    } <span class="hljs-keyword">else</span> {
      System.out.println(<span class="hljs-string">"Failure: "</span> + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
</div>
</div></div></div></div></div></div><footer><div class="container"><div class="footer-nav-section"><div class="footer-nav-list footer-logo"><a href="/"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAxMjMyLjYgMzE1LjIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6Izc4MmE5MX08L3N0eWxlPjxwYXRoIGQ9Ik0xMjAuOSAyMTQuMkwxOTAuNSAwaDUyLjNsLTk4LjUgMjczLjhIOTguMkwwIDBoNTIuMWw2OC44IDIxNC4yem0yOTEuMi02Mi42SDI5OS42djg0LjJINDMxdjM4SDI1MlYwaDE3Ny43djM4LjRIMjk5LjZWMTE0aDExMi41djM3LjZ6bTgzLjctMTEzLjJINTQ2YzE2LjUuMyAyOSA0LjQgMzcuMyAxMi40IDguMyA4IDEyLjUgMTkuNCAxMi41IDM0IDAgMTQtNC41IDI1LjEtMTMuNSAzMy4yLTkgOC4xLTIxLjYgMTIuMS0zNy42IDEyLjFoLTI3LjF2MjQuMmw4Ni4xIDExOS41aDUxdi0yLjRsLTc3LjItMTA2LjdjMjQuOS01LjUgNDMuMy0yMS43IDUyLjYtMzUuOSA4LjItMTIuNiAxMy4zLTI3LjcgMTMuMy00NiAwLTI2LjgtOC42LTQ3LjQtMjUuOC02MS41QzYwMC41IDcuMSA1NzYuMSAwIDU0NC41IDBoLTk2LjN2MjczLjhoNDcuNiIvPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDUyLjMgMTU3LjdsLTQxLjUgNjIuNyAyOS43IDUzLjRoODUuMXoiLz48Y2lyY2xlIGNsYXNzPSJzdDAiIGN4PSI4MjcuOSIgY3k9IjI3NC43IiByPSI0MC41Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTEwMzcgMGwtNDcuNiA3NC4yTDk0OSAwaC04NGw4NS4zIDEzNS44LTY3LjEgMTA1LjdjNS43IDkuNSA5LjEgMjAuNSA5LjIgMzIuNGg1MC4xTDExMjEuMyAwSDEwMzd6Ii8+PHBhdGggZD0iTTc2My41IDI3My44Yy4xLTkuOSAyLjUtMTkuMiA2LjYtMjcuNVYzOC40aDg1LjRWMEg2MzguMnYzOC40aDg0LjZ2MjM1LjRoNDAuN3ptNDE0LTI2Ni45aC0xNS4zdjQyLjJoLTguNVY2LjloLTE1LjJWMGgzOXY2Ljl6TTExOTMgMGwxNC4yIDM3LjdMMTIyMS4zIDBoMTF2NDkuMWgtOC41VjMyLjlsLjgtMjEuNy0xNC41IDM3LjloLTYuMWwtMTQuNS0zNy44LjggMjEuNnYxNi4yaC04LjVWMGgxMS4yeiIvPjwvc3ZnPg==" alt="Vert.x Logo"/></a></div><div class="footer-nav-list"><h5>Eclipse Vert.x</h5><ul class=""><li><a class="navbar-menu-item" href="/docs/">文档</a></li><li><a href="/download/">下载</a></li><li><a href="/blog/">博客</a></li><li><a href="/community/">社区</a></li><li><a href="/translation/">翻译团队</a></li><li><a href="https://github.com/eclipse-vertx/vert.x">GitHub</a></li><li><a href="https://github.com/vertx-china/vertx-web-site">翻译GitHub</a></li></ul></div><div class="footer-nav-list"><h5>资源</h5><ul class=""><li><a href="/faq/">答疑</a></li><li><a href="/channels/">联系渠道</a></li><li><a href="https://how-to.vertx.io/">操作指南</a></li><li><a href="https://start.vertx.io/">应用生成器</a></li></ul></div><div class="footer-nav-list"><h5>Eclipse</h5><ul class=""><li><a href="https://www.eclipse.org/">Eclipse 基金会</a></li><li><a href="https://www.eclipse.org/legal/privacy.php">隐私政策</a></li><li><a href="https://www.eclipse.org/legal/termsofuse.php">使用条款</a></li><li><a href="https://www.eclipse.org/legal/copyright.php">版权代理</a></li><li><a href="https://www.eclipse.org/legal/">法律资源</a></li></ul></div></div><div class="footer-copyright"><div class="footer-copyright-remarks">© <!-- -->2021<!-- --> Eclipse Vert.x™<br/>Eclipse Vert.x™ 是开源的，并在<a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer">Eclipse Public License 2.0</a>和<a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer">Apache License 2.0</a>协议下获得了双重许可。<br class="footer-copyright-break"/>网站由 <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer">Michel Krämer</a> 设计。</div><div class="footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer"><img src="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAyODEuMyA5MS4xIiB4bWw6c3BhY2U9InByZXNlcnZlIj48c3R5bGU+LnN0MHtmaWxsOiNmNzk0MjJ9LnN0MXtmaWxsOiMzZDNjM2J9PC9zdHlsZT48ZyBpZD0iTGF5ZXJfMV8xXyI+PHBhdGggY2xhc3M9InN0MCIgZD0iTTI2NS43IDg0TDI1NyA3M2gtMi43djE3LjdoMy4zdi0xMmw5LjMgMTJoMi4xVjczaC0zLjN2MTF6bS0zMi40LTguM2M0LjIgMCA1LjggMy4zIDUuOCA2LjNzLTEuNiA2LTUuOCA2LTUuNy0zLjEtNS44LTYgMS43LTYuMyA1LjgtNi4zem0wLTNjLTYuMSAwLTkuMSA0LjctOS4xIDkuMyAwIDQuNyAyLjkgOS4xIDkuMSA5LjFzOS00LjYgOS4xLTkuMi0zLTkuMi05LjEtOS4yem0tMjEuMiAxOFY3M2gtMy4zdjE3LjdoMy4zem0tMjMuNiAwaDMuM1Y3Nmg1LjZ2LTNoLTE0LjZ2M2g1LjZsLjEgMTQuN3ptLTE4LjktNi41SDE2M2wzLjMtNy42IDMuMyA3LjZ6bTIuOCA2LjVoMy42TDE2OC4yIDczaC0zLjZsLTggMTcuN2gzLjZsMS41LTMuM2g5LjNsMS40IDMuM3ptLTM4LTE0LjZoMy42YzMuOSAwIDUuNSAyLjggNS41IDUuNS4xIDIuOC0xLjUgNS44LTUuNSA1LjhoLTMuNlY3Ni4xem0zLjctMy4xaC02Ljl2MTcuN2g2LjljNi4yIDAgOC45LTQuNSA4LjktOXMtMi44LTguNy04LjktOC43em0tMjIuNCAxMUwxMDcgNzNoLTIuN3YxNy43aDMuM3YtMTJsOS4zIDEyaDIuMVY3M2gtMy4zdjExek04OC4yIDczdjEwLjJjMCAzLTEuNiA0LjktNC4zIDQuOXMtNC42LTEuNy00LjYtNC45VjczSDc2djEwLjFjMCA1LjMgMy42IDcuOSA3LjkgNy45IDQuNCAwIDcuNy0yLjcgNy43LTcuOVY3M2gtMy40em0tMzMgMi43YzQuMiAwIDUuOCAzLjMgNS44IDYuM3MtMS42IDYtNS44IDYtNS43LTMuMS01LjgtNiAxLjctNi4zIDUuOC02LjN6bTAtM2MtNi4xIDAtOS4xIDQuNy05LjEgOS4zczIuOSA5LjEgOS4xIDkuMSA5LTQuNiA5LjEtOS4yLTMtOS4yLTkuMS05LjJ6bS0yOS43IDE4di02LjVoOC45di0zLjFoLTguOXYtNC44aDkuNFY3M0gyMi4ydjE3LjZoMy4zeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNjkuNCA1NC40aC0yMi4ydi04LjloMjEuNHYtNi45aC0yMS40di05LjFoMjIuMnYtNy4yaC0yOS42djM5LjVoMjkuNnYtNy40em0tNDAtMjUuNmMtMy02LjEtOS40LTcuOC0xNS41LTcuOC03LjMgMC0xNS4zIDMuNC0xNS4zIDExLjUgMCA4LjkgNy40IDExIDE1LjUgMTIgNS4yLjYgOS4xIDIuMSA5LjEgNS44IDAgNC4zLTQuNCA1LjktOS4xIDUuOXMtOS40LTEuOS0xMS4xLTYuM2wtNi4yIDMuMmMyLjkgNy4yIDkuMSA5LjcgMTcuMiA5LjcgOC44IDAgMTYuNi0zLjggMTYuNi0xMi42IDAtOS40LTcuNy0xMS42LTE1LjktMTIuNi00LjctLjYtOC44LTEuNS04LjgtNSAwLTIuOSAyLjYtNS4yIDguMi01LjIgNC4zIDAgOCAyLjIgOS40IDQuNGw1LjktM3pNMTc2IDIyLjJjLTYuMi0uMS0xMi40IDAtMTguNiAwdjM5LjVoNy40VjUwLjFIMTc2YzE5LjQgMCAxOS40LTI3LjkgMC0yNy45em0tMTEuMSA3LjFIMTc2YzkuNSAwIDkuNSAxNCAwIDE0aC0xMS4ybC4xLTE0em0tMTggMzIuNVYyMi4yaC03LjR2MzkuNWw3LjQuMXptLTQ0LTM5LjZ2MzkuNWgyNy43di02LjloLTIwLjNWMjIuMmgtNy40ek05MC43IDUxLjdjLTIuNyAyLjUtNi4yIDQtOS45IDQtOS44IDAtMTMuNS02LjgtMTMuNi0xMy40czQuMS0xMy43IDEzLjYtMTMuN2MzLjUtLjEgNyAxLjMgOS41IDMuN2w1LTQuOGMtMy44LTMuOS05LjEtNi0xNC41LTYtMTQuMyAwLTIxIDEwLjUtMjAuOSAyMC44czYuMyAyMC4zIDIwLjkgMjAuM2M1LjYuMSAxMS0yIDE1LTUuOWwtNS4xLTV6bS0zOSAyLjdIMjkuNXYtOC45aDIxLjR2LTYuOUgyOS41di05LjFoMjIuMnYtNy4ySDIyLjJ2MzkuNWgyOS42bC0uMS03LjR6Ii8+PHBhdGggY2xhc3M9InN0MCIgZD0iTTkuOCAxOC4yQzE4LjggNC4xIDM2LjktLjggNTIuMSA2bC0xLS43QzM1LjctNC42IDE1LjItLjEgNS4zIDE1LjNzLTUuNCAzNS45IDEwIDQ1LjhsMS4xLjZDMy44IDUwLjguOCAzMi4zIDkuOCAxOC4yeiIvPjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yNzIuMiAyNi4xYzAtMi41IDIuMS00LjYgNC42LTQuNiAyLjUgMCA0LjYgMi4xIDQuNiA0LjYgMCAyLjUtMi4xIDQuNi00LjYgNC42LTIuNiAwLTQuNi0yLjEtNC42LTQuNnptOC42IDBjMC0yLjItMS44LTQuMS00LTQuMXMtNC4xIDEuOC00LjEgNC4xYzAgMi4yIDEuNyA0IDMuOSA0LjFoLjFjMi4zIDAgNC4xLTEuOCA0LjEtNC4xem0tNi0yLjVoMi4zYzEuMSAwIDEuOS41IDEuOSAxLjYgMCAuNy0uNCAxLjMtMS4xIDEuNWwxLjIgMS43aC0xLjRsLTEtMS41aC0uN3YxLjVoLTEuMWwtLjEtNC44em0yLjIgMi4zYy41IDAgLjgtLjMuOC0uN3MtLjMtLjctLjgtLjdoLTF2MS4zbDEgLjF6Ii8+PC9nPjwvc3ZnPg==" alt="Eclipse foundation Logo"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"4.1.0/vertx-mssql-client/java","title":"Reactive MSSQL Client","fallbackGitHubStars":null,"toc":"\u003cdiv id=\"toc\" class=\"toc\"\u003e\n\u003cdiv id=\"toctitle\"\u003eTable of Contents\u003c/div\u003e\n\u003cul class=\"sectlevel1\"\u003e\n\u003cli\u003e\u003ca href=\"#_usage\"\u003eUsage\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_getting_started\"\u003eGetting started\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_connecting_to_sql_server\"\u003eConnecting to SQL Server\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_configuration\"\u003eConfiguration\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_data_object\"\u003eData Object\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_connection_uri\"\u003eConnection URI\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_connect_retries\"\u003eConnect retries\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_running_queries\"\u003eRunning queries\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_prepared_queries\"\u003ePrepared queries\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_connections\"\u003eUsing connections\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_getting_a_connection\"\u003eGetting a connection\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_simplified_connection_api\"\u003eSimplified connection API\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_transactions\"\u003eUsing transactions\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_transactions_with_connections\"\u003eTransactions with connections\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_simplified_transaction_api\"\u003eSimplified transaction API\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_tracing_queries\"\u003eTracing queries\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_data_types_supported\"\u003eData types supported\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_using_java_enum_types\"\u003eUsing Java \u003ccode\u003eenum\u003c/code\u003e types\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handling_null\"\u003eHandling \u003ccode\u003eNULL\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_collector_queries\"\u003eCollector queries\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e","contents":"\u003ch1\u003eReactive MSSQL Client\u003c/h1\u003e\n\n\u003cdiv id=\"preamble\"\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe Reactive MSSQL Client is a client for Microsoft SQL Server with a straightforward API focusing on\nscalability and low overhead.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003cstrong\u003eFeatures\u003c/strong\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eEvent driven\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLightweight\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBuilt-in connection pooling\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDirect memory to object without unnecessary copies\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eJava 8 Date and Time\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003cstrong\u003eNot supported yet\u003c/strong\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ePrepared queries caching\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBatch and cursor\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRow streaming\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSome \u003ca href=\"https://github.com/eclipse-vertx/vertx-sql-client/issues/608#issuecomment-629390027\"\u003edata types\u003c/a\u003e are not supported\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_usage\"\u003e\u003ca class=\"anchor\" href=\"#_usage\"\u003e\u003c/a\u003eUsage\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use the Reactive MSSQL Client add the following dependency to the \u003cem\u003edependencies\u003c/em\u003e section of your build descriptor:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eMaven (in your \u003ccode\u003epom.xml\u003c/code\u003e):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-mssql-client\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e4.1.0\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eGradle (in your \u003ccode\u003ebuild.gradle\u003c/code\u003e file):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003edependencies {\n compile \u003cspan class=\"hljs-string\"\u003e'io.vertx:vertx-mssql-client:4.1.0'\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_getting_started\"\u003e\u003ca class=\"anchor\" href=\"#_getting_started\"\u003e\u003c/a\u003eGetting started\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere is the simplest way to connect, query and disconnect\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eMSSQLConnectOptions connectOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MSSQLConnectOptions()\n  .setPort(\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e)\n  .setHost(\u003cspan class=\"hljs-string\"\u003e\"the-host\"\u003c/span\u003e)\n  .setDatabase(\u003cspan class=\"hljs-string\"\u003e\"the-db\"\u003c/span\u003e)\n  .setUser(\u003cspan class=\"hljs-string\"\u003e\"user\"\u003c/span\u003e)\n  .setPassword(\u003cspan class=\"hljs-string\"\u003e\"secret\"\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// Pool options\u003c/span\u003e\nPoolOptions poolOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e PoolOptions()\n  .setMaxSize(\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// Create the client pool\u003c/span\u003e\nMSSQLPool client = MSSQLPool.pool(connectOptions, poolOptions);\n\n\u003cspan class=\"hljs-comment\"\u003e// A simple query\u003c/span\u003e\nclient\n  .query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users WHERE id='julien'\"\u003c/span\u003e)\n  .execute(ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    RowSet result = ar.result();\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Got \"\u003c/span\u003e + result.size() + \u003cspan class=\"hljs-string\"\u003e\" rows \"\u003c/span\u003e);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar.cause().getMessage());\n  }\n\n  \u003cspan class=\"hljs-comment\"\u003e// Now close the pool\u003c/span\u003e\n  client.close();\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_connecting_to_sql_server\"\u003e\u003ca class=\"anchor\" href=\"#_connecting_to_sql_server\"\u003e\u003c/a\u003eConnecting to SQL Server\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMost of the time you will use a pool to connect to MSSQL:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eMSSQLConnectOptions connectOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MSSQLConnectOptions()\n  .setPort(\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e)\n  .setHost(\u003cspan class=\"hljs-string\"\u003e\"the-host\"\u003c/span\u003e)\n  .setDatabase(\u003cspan class=\"hljs-string\"\u003e\"the-db\"\u003c/span\u003e)\n  .setUser(\u003cspan class=\"hljs-string\"\u003e\"user\"\u003c/span\u003e)\n  .setPassword(\u003cspan class=\"hljs-string\"\u003e\"secret\"\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// Pool options\u003c/span\u003e\nPoolOptions poolOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e PoolOptions()\n  .setMaxSize(\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// Create the pooled client\u003c/span\u003e\nMSSQLPool client = MSSQLPool.pool(connectOptions, poolOptions);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe pooled client uses a connection pool and any operation will borrow a connection from the pool\nto execute the operation and release it to the pool.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you are running with Vert.x you can pass it your Vertx instance:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eMSSQLConnectOptions connectOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MSSQLConnectOptions()\n  .setPort(\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e)\n  .setHost(\u003cspan class=\"hljs-string\"\u003e\"the-host\"\u003c/span\u003e)\n  .setDatabase(\u003cspan class=\"hljs-string\"\u003e\"the-db\"\u003c/span\u003e)\n  .setUser(\u003cspan class=\"hljs-string\"\u003e\"user\"\u003c/span\u003e)\n  .setPassword(\u003cspan class=\"hljs-string\"\u003e\"secret\"\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// Pool options\u003c/span\u003e\nPoolOptions poolOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e PoolOptions()\n  .setMaxSize(\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e);\n\u003cspan class=\"hljs-comment\"\u003e// Create the pooled client\u003c/span\u003e\nMSSQLPool client = MSSQLPool.pool(vertx, connectOptions, poolOptions);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou need to release the pool when you don\u0026#8217;t need it anymore:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003epool.close();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you need to execute several operations on the same connection, you need to use a client\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/mssqlclient/MSSQLConnection.html\"\u003econnection\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can easily get one from the pool:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eMSSQLConnectOptions connectOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MSSQLConnectOptions()\n  .setPort(\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e)\n  .setHost(\u003cspan class=\"hljs-string\"\u003e\"the-host\"\u003c/span\u003e)\n  .setDatabase(\u003cspan class=\"hljs-string\"\u003e\"the-db\"\u003c/span\u003e)\n  .setUser(\u003cspan class=\"hljs-string\"\u003e\"user\"\u003c/span\u003e)\n  .setPassword(\u003cspan class=\"hljs-string\"\u003e\"secret\"\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// Pool options\u003c/span\u003e\nPoolOptions poolOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e PoolOptions()\n  .setMaxSize(\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// Create the pooled client\u003c/span\u003e\nMSSQLPool client = MSSQLPool.pool(vertx, connectOptions, poolOptions);\n\n\u003cspan class=\"hljs-comment\"\u003e// Get a connection from the pool\u003c/span\u003e\nclient.getConnection().compose(conn -\u0026gt; {\n  System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Got a connection from the pool\"\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-comment\"\u003e// All operations execute on the same connection\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e conn\n    .query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users WHERE id='julien'\"\u003c/span\u003e)\n    .execute()\n    .compose(res -\u0026gt; conn\n      .query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users WHERE id='emad'\"\u003c/span\u003e)\n      .execute())\n    .onComplete(ar -\u0026gt; {\n      \u003cspan class=\"hljs-comment\"\u003e// Release the connection to the pool\u003c/span\u003e\n      conn.close();\n    });\n}).onComplete(ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Done\"\u003c/span\u003e);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Something went wrong \"\u003c/span\u003e + ar.cause().getMessage());\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOnce you are done with the connection you must close it to release it to the pool, so it can be reused.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_configuration\"\u003e\u003ca class=\"anchor\" href=\"#_configuration\"\u003e\u003c/a\u003eConfiguration\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_data_object\"\u003e\u003ca class=\"anchor\" href=\"#_data_object\"\u003e\u003c/a\u003eData Object\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA simple way to configure the client is to specify a \u003ccode\u003eMSSQLConnectOptions\u003c/code\u003e data object.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eMSSQLConnectOptions connectOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MSSQLConnectOptions()\n  .setPort(\u003cspan class=\"hljs-number\"\u003e1433\u003c/span\u003e)\n  .setHost(\u003cspan class=\"hljs-string\"\u003e\"the-host\"\u003c/span\u003e)\n  .setDatabase(\u003cspan class=\"hljs-string\"\u003e\"the-db\"\u003c/span\u003e)\n  .setUser(\u003cspan class=\"hljs-string\"\u003e\"user\"\u003c/span\u003e)\n  .setPassword(\u003cspan class=\"hljs-string\"\u003e\"secret\"\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// Pool Options\u003c/span\u003e\nPoolOptions poolOptions = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e PoolOptions().setMaxSize(\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// Create the pool from the data object\u003c/span\u003e\nMSSQLPool pool = MSSQLPool.pool(vertx, connectOptions, poolOptions);\n\npool.getConnection(ar -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Handling your connection\u003c/span\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_connection_uri\"\u003e\u003ca class=\"anchor\" href=\"#_connection_uri\"\u003e\u003c/a\u003eConnection URI\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAs an alternative to configuring the client with a \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/mssqlclient/MSSQLConnectOptions.html\"\u003eMSSQLConnectOptions\u003c/a\u003e\u003c/code\u003e data object, you can use a connection URI:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eString connectionUri = \u003cspan class=\"hljs-string\"\u003e\"sqlserver://dbuser:secretpassword@database.server.com:3211/mydb\"\u003c/span\u003e;\n\n\u003cspan class=\"hljs-comment\"\u003e// Create the pool from the connection URI\u003c/span\u003e\nMSSQLPool pool = MSSQLPool.pool(connectionUri);\n\n\u003cspan class=\"hljs-comment\"\u003e// Create the connection from the connection URI\u003c/span\u003e\nMSSQLConnection.connect(vertx, connectionUri, res -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Handling your connection\u003c/span\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe connection URI format is defined by the client in an idiomatic way: \u003ccode\u003esqlserver://[user[:[password]]@]host[:port][/database][?attribute1=value1\u0026amp;attribute2=value2\u0026#8230;\u0026#8203;]\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCurrently, the client supports the following parameter keywords in connection uri (keys are case-insensitive):\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ehost\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eport\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003euser\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003epassword\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003edatabase\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_connect_retries\"\u003e\u003ca class=\"anchor\" href=\"#_connect_retries\"\u003e\u003c/a\u003eConnect retries\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can configure the client to retry when a connection fails to be established.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eoptions\n  .setReconnectAttempts(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e)\n  .setReconnectInterval(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_running_queries\"\u003e\u003ca class=\"anchor\" href=\"#_running_queries\"\u003e\u003c/a\u003eRunning queries\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you don\u0026#8217;t need a transaction or run single queries, you can run queries directly on the pool; the pool\nwill use one of its connection to run the query and return the result to you.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere is how to run simple queries:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eclient\n  .query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users WHERE id='julien'\"\u003c/span\u003e)\n  .execute(ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    RowSet\u0026lt;Row\u0026gt; result = ar.result();\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Got \"\u003c/span\u003e + result.size() + \u003cspan class=\"hljs-string\"\u003e\" rows \"\u003c/span\u003e);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar.cause().getMessage());\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_prepared_queries\"\u003e\u003ca class=\"anchor\" href=\"#_prepared_queries\"\u003e\u003c/a\u003ePrepared queries\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can do the same with prepared queries.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe SQL string can refer to parameters by position, using the database syntax `@1`, `@2`, etc…​\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eclient\n  .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users WHERE id=@p1\"\u003c/span\u003e)\n  .execute(Tuple.of(\u003cspan class=\"hljs-string\"\u003e\"julien\"\u003c/span\u003e), ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    RowSet\u0026lt;Row\u0026gt; rows = ar.result();\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Got \"\u003c/span\u003e + rows.size() + \u003cspan class=\"hljs-string\"\u003e\" rows \"\u003c/span\u003e);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar.cause().getMessage());\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eQuery methods provides an asynchronous \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/RowSet.html\"\u003eRowSet\u003c/a\u003e\u003c/code\u003e instance that works for \u003cem\u003eSELECT\u003c/em\u003e queries\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eclient\n  .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"SELECT first_name, last_name FROM users\"\u003c/span\u003e)\n  .execute(ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    RowSet\u0026lt;Row\u0026gt; rows = ar.result();\n    \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (Row row : rows) {\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\"User \"\u003c/span\u003e + row.getString(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) + \u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003e + row.getString(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e));\n    }\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar.cause().getMessage());\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eor \u003cem\u003eUPDATE\u003c/em\u003e/\u003cem\u003eINSERT\u003c/em\u003e queries:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eclient\n  .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO users (first_name, last_name) VALUES (@p1, @p2)\"\u003c/span\u003e)\n  .execute(Tuple.of(\u003cspan class=\"hljs-string\"\u003e\"Julien\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Viet\"\u003c/span\u003e), ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    RowSet\u0026lt;Row\u0026gt; rows = ar.result();\n    System.out.println(rows.rowCount());\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar.cause().getMessage());\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/Row.html\"\u003eRow\u003c/a\u003e\u003c/code\u003e gives you access to your data by index\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eSystem.out.println(\u003cspan class=\"hljs-string\"\u003e\"User \"\u003c/span\u003e + row.getString(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e) + \u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003e + row.getString(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eor by name\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eSystem.out.println(\u003cspan class=\"hljs-string\"\u003e\"User \"\u003c/span\u003e + row.getString(\u003cspan class=\"hljs-string\"\u003e\"first_name\"\u003c/span\u003e) + \u003cspan class=\"hljs-string\"\u003e\" \"\u003c/span\u003e + row.getString(\u003cspan class=\"hljs-string\"\u003e\"last_name\"\u003c/span\u003e));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe client will not do any magic here and the column name is identified with the name in the table regardless of how your SQL text is.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can access a wide variety of of types\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eString firstName = row.getString(\u003cspan class=\"hljs-string\"\u003e\"first_name\"\u003c/span\u003e);\nBoolean male = row.getBoolean(\u003cspan class=\"hljs-string\"\u003e\"male\"\u003c/span\u003e);\nInteger age = row.getInteger(\u003cspan class=\"hljs-string\"\u003e\"age\"\u003c/span\u003e);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can use cached prepared statements to execute one-shot prepared queries:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003econnectOptions.setCachePreparedStatements(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e);\nclient\n  .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users WHERE id = @p1\"\u003c/span\u003e)\n  .execute(Tuple.of(\u003cspan class=\"hljs-string\"\u003e\"julien\"\u003c/span\u003e), ar -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n      RowSet\u0026lt;Row\u0026gt; rows = ar.result();\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Got \"\u003c/span\u003e + rows.size() + \u003cspan class=\"hljs-string\"\u003e\" rows \"\u003c/span\u003e);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar.cause().getMessage());\n    }\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can create a \u003ccode\u003ePreparedStatement\u003c/code\u003e and manage the lifecycle by yourself.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esqlConnection\n  .prepare(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users WHERE id = @p1\"\u003c/span\u003e, ar -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n      PreparedStatement preparedStatement = ar.result();\n      preparedStatement.query()\n        .execute(Tuple.of(\u003cspan class=\"hljs-string\"\u003e\"julien\"\u003c/span\u003e), ar2 -\u0026gt; {\n          \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar2.succeeded()) {\n            RowSet\u0026lt;Row\u0026gt; rows = ar2.result();\n            System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Got \"\u003c/span\u003e + rows.size() + \u003cspan class=\"hljs-string\"\u003e\" rows \"\u003c/span\u003e);\n            preparedStatement.close();\n          } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n            System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar2.cause().getMessage());\n          }\n        });\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar.cause().getMessage());\n    }\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_connections\"\u003e\u003ca class=\"anchor\" href=\"#_using_connections\"\u003e\u003c/a\u003eUsing connections\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_getting_a_connection\"\u003e\u003ca class=\"anchor\" href=\"#_getting_a_connection\"\u003e\u003c/a\u003eGetting a connection\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you need to execute sequential queries (without a transaction), you can create a new connection\nor borrow one from the pool. Remember that between acquiring the connection from the pool and returning it to the pool, you should take care of the connection because it might be closed by the server for some reason such as an idle time out.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003epool\n  .getConnection()\n  .compose(connection -\u0026gt;\n    connection\n      .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO Users (first_name,last_name) VALUES (@p1, @p2)\"\u003c/span\u003e)\n      .executeBatch(Arrays.asList(\n        Tuple.of(\u003cspan class=\"hljs-string\"\u003e\"Julien\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Viet\"\u003c/span\u003e),\n        Tuple.of(\u003cspan class=\"hljs-string\"\u003e\"Emad\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Alblueshi\"\u003c/span\u003e)\n      ))\n      .compose(res -\u0026gt; connection\n        \u003cspan class=\"hljs-comment\"\u003e// Do something with rows\u003c/span\u003e\n        .query(\u003cspan class=\"hljs-string\"\u003e\"SELECT COUNT(*) FROM Users\"\u003c/span\u003e)\n        .execute()\n        .map(rows -\u0026gt; rows.iterator().next().getInteger(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)))\n      \u003cspan class=\"hljs-comment\"\u003e// Return the connection to the pool\u003c/span\u003e\n      .eventually(v -\u0026gt; connection.close())\n  ).onSuccess(count -\u0026gt; {\n  System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Insert users, now the number of users is \"\u003c/span\u003e + count);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePrepared queries can be created:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003econnection\n  .prepare(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users WHERE first_name LIKE @p1\"\u003c/span\u003e)\n  .compose(pq -\u0026gt;\n    pq.query()\n      .execute(Tuple.of(\u003cspan class=\"hljs-string\"\u003e\"Julien\"\u003c/span\u003e))\n      .eventually(v -\u0026gt; pq.close())\n  ).onSuccess(rows -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// All rows\u003c/span\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_simplified_connection_api\"\u003e\u003ca class=\"anchor\" href=\"#_simplified_connection_api\"\u003e\u003c/a\u003eSimplified connection API\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you use a pool, you can call \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/Pool.html#withConnection-java.util.function.Function-io.vertx.core.Handler-\"\u003ewithConnection\u003c/a\u003e\u003c/code\u003e to pass it a function executed\nwithin a connection.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt borrows a connection from the pool and calls the function with this connection.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe function must return a future of an arbitrary result.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAfter the future completes, the connection is returned to the pool and the overall result is provided.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003epool.withConnection(connection -\u0026gt;\n  connection\n    .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO Users (first_name,last_name) VALUES (@p1, @p2)\"\u003c/span\u003e)\n    .executeBatch(Arrays.asList(\n      Tuple.of(\u003cspan class=\"hljs-string\"\u003e\"Julien\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Viet\"\u003c/span\u003e),\n      Tuple.of(\u003cspan class=\"hljs-string\"\u003e\"Emad\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"Alblueshi\"\u003c/span\u003e)\n    ))\n    .compose(res -\u0026gt; connection\n      \u003cspan class=\"hljs-comment\"\u003e// Do something with rows\u003c/span\u003e\n      .query(\u003cspan class=\"hljs-string\"\u003e\"SELECT COUNT(*) FROM Users\"\u003c/span\u003e)\n      .execute()\n      .map(rows -\u0026gt; rows.iterator().next().getInteger(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e)))\n).onSuccess(count -\u0026gt; {\n  System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Insert users, now the number of users is \"\u003c/span\u003e + count);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_transactions\"\u003e\u003ca class=\"anchor\" href=\"#_using_transactions\"\u003e\u003c/a\u003eUsing transactions\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_transactions_with_connections\"\u003e\u003ca class=\"anchor\" href=\"#_transactions_with_connections\"\u003e\u003c/a\u003eTransactions with connections\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can execute transaction using SQL \u003ccode\u003eBEGIN\u003c/code\u003e/\u003ccode\u003eCOMMIT\u003c/code\u003e/\u003ccode\u003eROLLBACK\u003c/code\u003e, if you do so you must use\na \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/SqlConnection.html\"\u003eSqlConnection\u003c/a\u003e\u003c/code\u003e and manage it yourself.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOr you can use the transaction API of \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/SqlConnection.html\"\u003eSqlConnection\u003c/a\u003e\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003epool.getConnection()\n  \u003cspan class=\"hljs-comment\"\u003e// Transaction must use a connection\u003c/span\u003e\n  .onSuccess(conn -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// Begin the transaction\u003c/span\u003e\n    conn.begin()\n      .compose(tx -\u0026gt; conn\n        \u003cspan class=\"hljs-comment\"\u003e// Various statements\u003c/span\u003e\n        .query(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO Users (first_name,last_name) VALUES ('Julien','Viet')\"\u003c/span\u003e)\n        .execute()\n        .compose(res2 -\u0026gt; conn\n          .query(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO Users (first_name,last_name) VALUES ('Emad','Alblueshi')\"\u003c/span\u003e)\n          .execute())\n        \u003cspan class=\"hljs-comment\"\u003e// Commit the transaction\u003c/span\u003e\n        .compose(res3 -\u0026gt; tx.commit()))\n      \u003cspan class=\"hljs-comment\"\u003e// Return the connection to the pool\u003c/span\u003e\n      .eventually(v -\u0026gt; conn.close())\n      .onSuccess(v -\u0026gt; System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Transaction succeeded\"\u003c/span\u003e))\n      .onFailure(err -\u0026gt; System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Transaction failed: \"\u003c/span\u003e + err.getMessage()));\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen the database server reports the current transaction is failed (e.g the infamous \u003cem\u003ecurrent transaction is aborted, commands ignored until\nend of transaction block\u003c/em\u003e), the transaction is rollbacked and the \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/Transaction.html#completion--\"\u003ecompletion\u003c/a\u003e\u003c/code\u003e future\nis failed with a \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/TransactionRollbackException.html\"\u003eTransactionRollbackException\u003c/a\u003e\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003etx.completion()\n  .onFailure(err -\u0026gt; {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Transaction failed =\u0026gt; rolled back\"\u003c/span\u003e);\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_simplified_transaction_api\"\u003e\u003ca class=\"anchor\" href=\"#_simplified_transaction_api\"\u003e\u003c/a\u003eSimplified transaction API\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you use a pool, you can call \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/Pool.html#withTransaction-java.util.function.Function-io.vertx.core.Handler-\"\u003ewithTransaction\u003c/a\u003e\u003c/code\u003e to pass it a function executed\nwithin a transaction.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt borrows a connection from the pool, begins the transaction and calls the function with a client executing all\noperations in the scope of this transaction.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe function must return a future of an arbitrary result:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ewhen the future succeeds the client will commit the transaction\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ewhen the future fails the client will rollback the transaction\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAfter the transaction completes, the connection is returned to the pool and the overall result is provided.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003epool.withTransaction(client -\u0026gt; client\n  .query(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO Users (first_name,last_name) VALUES ('Julien','Viet')\"\u003c/span\u003e)\n  .execute()\n  .flatMap(res -\u0026gt; client\n    .query(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO Users (first_name,last_name) VALUES ('Julien','Viet')\"\u003c/span\u003e)\n    .execute()\n    \u003cspan class=\"hljs-comment\"\u003e// Map to a message result\u003c/span\u003e\n    .map(\u003cspan class=\"hljs-string\"\u003e\"Users inserted\"\u003c/span\u003e)))\n  .onSuccess(v -\u0026gt; System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Transaction succeeded\"\u003c/span\u003e))\n  .onFailure(err -\u0026gt; System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Transaction failed: \"\u003c/span\u003e + err.getMessage()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_tracing_queries\"\u003e\u003ca class=\"anchor\" href=\"#_tracing_queries\"\u003e\u003c/a\u003eTracing queries\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe SQL client can trace query execution when Vert.x has tracing enabled.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe client reports the following \u003cem\u003eclient\u003c/em\u003e spans:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eQuery\u003c/code\u003e operation name\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003etags\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003edb.user\u003c/code\u003e: the database username\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003edb.instance\u003c/code\u003e: the database instance\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003edb.statement\u003c/code\u003e: the SQL query\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003edb.type\u003c/code\u003e: \u003cem\u003esql\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe default tracing policy is \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/tracing/TracingPolicy.html#PROPAGATE\"\u003ePROPAGATE\u003c/a\u003e\u003c/code\u003e, the client\nwill only create a span when involved in an active trace.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can change the client policy with \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/SqlConnectOptions.html#setTracingPolicy-io.vertx.core.tracing.TracingPolicy-\"\u003esetTracingPolicy\u003c/a\u003e\u003c/code\u003e,\ne.g you can set \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/tracing/TracingPolicy.html#ALWAYS\"\u003eALWAYS\u003c/a\u003e\u003c/code\u003e to always report\na span:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eoptions.setTracingPolicy(TracingPolicy.ALWAYS);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_data_types_supported\"\u003e\u003ca class=\"anchor\" href=\"#_data_types_supported\"\u003e\u003c/a\u003eData types supported\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCurrently, the client supports the following SQL Server types:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eTINYINT(\u003ccode\u003ejava.lang.Short\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSMALLINT(\u003ccode\u003ejava.lang.Short\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eINT(\u003ccode\u003ejava.lang.Integer\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBIGINT(\u003ccode\u003ejava.lang.Long\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBIT(\u003ccode\u003ejava.lang.Boolean\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eREAL(\u003ccode\u003ejava.lang.Float\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDOUBLE(\u003ccode\u003ejava.lang.Double\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNUMERIC/DECIMAL(\u003ccode\u003e\u003ca href=\"../../apidocs/java/math/BigDecimal.html\"\u003eBigDecimal\u003c/a\u003e\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCHAR/VARCHAR(\u003ccode\u003ejava.lang.String\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eNCHAR/NVARCHAR(\u003ccode\u003ejava.lang.String\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDATE(\u003ccode\u003ejava.time.LocalDate\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTIME(\u003ccode\u003ejava.time.LocalTime\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDATETIME2(\u003ccode\u003ejava.time.LocalDateTime\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDATETIMEOFFSET(\u003ccode\u003ejava.time.OffsetDateTime\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBINARY/VARBINARY(\u003ccode\u003eio.vertx.core.buffer.Buffer\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTuple decoding uses the above types when storing values.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_using_java_enum_types\"\u003e\u003ca class=\"anchor\" href=\"#_using_java_enum_types\"\u003e\u003c/a\u003eUsing Java \u003ccode\u003eenum\u003c/code\u003e types\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSQL Server does not have \u003ccode\u003eENUM\u003c/code\u003e data type, but the client can map the retrieved string/numeric data type to enum.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can encode Java enums like this:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eclient\n  .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO colors VALUES (@p1)\"\u003c/span\u003e)\n  .execute(Tuple.of(Color.red),  res -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// ...\u003c/span\u003e\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can decode a Java enum like this:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eclient\n  .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"SELECT color FROM colors\"\u003c/span\u003e)\n  .execute()\n  .onComplete(res -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (res.succeeded()) {\n      RowSet\u0026lt;Row\u0026gt; rows = res.result();\n      \u003cspan class=\"hljs-keyword\"\u003efor\u003c/span\u003e (Row row : rows) {\n        System.out.println(row.get(Color\u003cspan class=\"hljs-class\"\u003e.\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e, \"\u003cspan class=\"hljs-title\"\u003ecolor\u003c/span\u003e\"))\u003c/span\u003e;\n      }\n    }\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_handling_null\"\u003e\u003ca class=\"anchor\" href=\"#_handling_null\"\u003e\u003c/a\u003eHandling \u003ccode\u003eNULL\u003c/code\u003e\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you modify a \u003ccode\u003eTuple\u003c/code\u003e with one of the \u003ccode\u003eaddXXX\u003c/code\u003e methods, \u003ccode\u003enull\u003c/code\u003e values are handled transparently.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe client can infer the right SQL type when executing a prepared query:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTuple tuple = Tuple.tuple()\n  .addInteger(\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e)\n  .addString(\u003cspan class=\"hljs-string\"\u003e\"The Man Who Knew Too Much\"\u003c/span\u003e)\n  .addString(\u003cspan class=\"hljs-keyword\"\u003enull\u003c/span\u003e);\nclient\n  .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO movies (id, title, plot) VALUES (@p1, @p2, @p3)\"\u003c/span\u003e)\n  .execute(tuple, res -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// ...\u003c/span\u003e\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOtherwise, you should declare the type explicitely using one of the \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/data/NullValue.html\"\u003eNullValue\u003c/a\u003e\u003c/code\u003e constants or the \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/data/NullValue.html#of-java.lang.Class-\"\u003eNullValue.of\u003c/a\u003e\u003c/code\u003e method:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTuple tuple = Tuple.of(\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"The Man Who Knew Too Much\"\u003c/span\u003e, NullValue.String);\nclient\n  .preparedQuery(\u003cspan class=\"hljs-string\"\u003e\"INSERT INTO movies (id, title, plot) VALUES (@p1, @p2, @p3)\"\u003c/span\u003e)\n  .execute(tuple, res -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// ...\u003c/span\u003e\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_collector_queries\"\u003e\u003ca class=\"anchor\" href=\"#_collector_queries\"\u003e\u003c/a\u003eCollector queries\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can use Java collectors with the query API:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eCollector\u0026lt;Row, ?, Map\u0026lt;Long, String\u0026gt;\u0026gt; collector = Collectors.toMap(\n  row -\u0026gt; row.getLong(\u003cspan class=\"hljs-string\"\u003e\"id\"\u003c/span\u003e),\n  row -\u0026gt; row.getString(\u003cspan class=\"hljs-string\"\u003e\"last_name\"\u003c/span\u003e));\n\n\u003cspan class=\"hljs-comment\"\u003e// Run the query with the collector\u003c/span\u003e\nclient.query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users\"\u003c/span\u003e)\n  .collecting(collector)\n  .execute(ar -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n      SqlResult\u0026lt;Map\u0026lt;Long, String\u0026gt;\u0026gt; result = ar.result();\n\n      \u003cspan class=\"hljs-comment\"\u003e// Get the map created by the collector\u003c/span\u003e\n      Map\u0026lt;Long, String\u0026gt; map = result.value();\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Got \"\u003c/span\u003e + map);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar.cause().getMessage());\n    }\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe collector processing must not keep a reference on the \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/sqlclient/Row.html\"\u003eRow\u003c/a\u003e\u003c/code\u003e as\nthere is a single row used for processing the entire set.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe Java \u003ccode\u003eCollectors\u003c/code\u003e provides many interesting predefined collectors, for example you can\ncreate easily create a string directly from the row set:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eCollector\u0026lt;Row, ?, String\u0026gt; collector = Collectors.mapping(\n  row -\u0026gt; row.getString(\u003cspan class=\"hljs-string\"\u003e\"last_name\"\u003c/span\u003e),\n  Collectors.joining(\u003cspan class=\"hljs-string\"\u003e\",\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\"(\"\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\")\"\u003c/span\u003e)\n);\n\n\u003cspan class=\"hljs-comment\"\u003e// Run the query with the collector\u003c/span\u003e\nclient.query(\u003cspan class=\"hljs-string\"\u003e\"SELECT * FROM users\"\u003c/span\u003e)\n  .collecting(collector)\n  .execute(ar -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n      SqlResult\u0026lt;String\u0026gt; result = ar.result();\n\n      \u003cspan class=\"hljs-comment\"\u003e// Get the string created by the collector\u003c/span\u003e\n      String list = result.value();\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Got \"\u003c/span\u003e + list);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\"Failure: \"\u003c/span\u003e + ar.cause().getMessage());\n    }\n  });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e","version":"4.1.0"},"__N_SSG":true},"page":"/docs/[[...slug]]","query":{"slug":["4.1.0","vertx-mssql-client","java"]},"buildId":"2T2-0R5NWIBQOFvhKVyrm","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-9a5c89434732593ca2fd.js"></script><script src="/_next/static/chunks/main-b6e20584df76f29b6f35.js" async=""></script><script src="/_next/static/chunks/webpack-d7b2fb72fb7257504a38.js" async=""></script><script src="/_next/static/chunks/framework.fcef98db13e2318579fb.js" async=""></script><script src="/_next/static/chunks/commons.5b8771ac6e8a338f82f1.js" async=""></script><script src="/_next/static/chunks/styles.7064a0f84b2a7c13404a.js" async=""></script><script src="/_next/static/chunks/pages/_app-3dbbc9c041333077c167.js" async=""></script><script src="/_next/static/chunks/5df0631eea625b022d3730b3f1bf573e1b8deb37.2c5d42edba8dda0b0ba3.js" async=""></script><script src="/_next/static/chunks/31acfd8439b7c9eee4abe9f59c7500d6c943ee0d.7689a0583e30048c05ff.js" async=""></script><script src="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-3a425d1828d3af7aa498.js" async=""></script><script src="/_next/static/2T2-0R5NWIBQOFvhKVyrm/_buildManifest.js" async=""></script><script src="/_next/static/2T2-0R5NWIBQOFvhKVyrm/_ssgManifest.js" async=""></script></body></html>