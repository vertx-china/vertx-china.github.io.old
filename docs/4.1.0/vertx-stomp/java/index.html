<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><link rel="alternate" type="application/rss+xml" href="/feed/rss.xml"/><link rel="alternate" type="application/atom+xml" href="/feed/atom.xml"/><link rel="alternate" type="application/json" href="/feed/feed.json"/><title>STOMP | Eclipse Vert.x</title><link rel="preload" href="https://api.github.com/repos/vert-x3/vertx-stomp" as="fetch" crossorigin="anonymous" class="jsx-d38685edc31911e0"/><meta name="next-head-count" content="14"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-6853d859ade043b9.js" defer=""></script><script src="/_next/static/chunks/framework-01395af778c6fb71.js" defer=""></script><script src="/_next/static/chunks/main-2ea7ab41ab691905.js" defer=""></script><script src="/_next/static/chunks/pages/_app-155bbedc7d6c4b74.js" defer=""></script><script src="/_next/static/chunks/778-5eaf13e353ab0b06.js" defer=""></script><script src="/_next/static/chunks/619-34d9218a66d5b123.js" defer=""></script><script src="/_next/static/chunks/629-5a87bb724d19315e.js" defer=""></script><script src="/_next/static/chunks/923-e93d8f14ebe18c9e.js" defer=""></script><script src="/_next/static/chunks/434-be9324d6e5b718aa.js" defer=""></script><script src="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-b6a025bc5d4ae207.js" defer=""></script><script src="/_next/static/DxYj1qG9XZR4Q5BZwOJ88/_buildManifest.js" defer=""></script><script src="/_next/static/DxYj1qG9XZR4Q5BZwOJ88/_ssgManifest.js" defer=""></script><script src="/_next/static/DxYj1qG9XZR4Q5BZwOJ88/_middlewareManifest.js" defer=""></script><style id="__jsx-400ec7965926e858">.dropdown-item.jsx-400ec7965926e858{white-space:nowrap;
line-height:2;
width:100%;
padding:0 1.5rem;
cursor:pointer}
.dropdown-item.jsx-400ec7965926e858:hover{background-color:#e9ecef}
.dropdown-item.active.jsx-400ec7965926e858{font-weight:400;
padding-left:.75rem}
.dropdown-item.has-active-siblings.jsx-400ec7965926e858:not(.active){padding-left:calc(0.75rem + 16px + 0.5em)}
.dropdown-item.jsx-400ec7965926e858 .dropdown-check-icon.jsx-400ec7965926e858{width:16px;
margin-right:.5em;
margin-top:1px}</style><style id="__jsx-6650573c8f14945d">.dropdown.jsx-6650573c8f14945d{position:relative;
display:inline-block}
.dropdown.jsx-6650573c8f14945d .dropdown-title.jsx-6650573c8f14945d{margin-right:0;
cursor:pointer;
-webkit-user-select:none;
-moz-user-select:none;
-ms-user-select:none;
user-select:none}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.jsx-6650573c8f14945d{position:absolute;
background-color:#f8f9fa;
box-shadow:0 2px 5px 0 rgba(0, 0, 0, .1);
border-radius:.8rem;
list-style-type:none;
padding:.6666666667rem 0;
margin:.25rem 0 0 0;
z-index:100;
display:none;
-webkit-user-select:none;
-moz-user-select:none;
-ms-user-select:none;
user-select:none}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.jsx-6650573c8f14945d a{color:#4d4d4d;
-webkit-text-decoration:none;
text-decoration:none;
font-weight:300}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.align-right.jsx-6650573c8f14945d{right:0}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.visible.jsx-6650573c8f14945d{display:block}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.jsx-6650573c8f14945d a.jsx-6650573c8f14945d:hover{color:inherit}
.dropdown.jsx-6650573c8f14945d svg{margin-bottom:2px}</style><style id="__jsx-75cbc16d79a176fb">.tooltip.jsx-75cbc16d79a176fb{font-size:.75rem;
color:#4d4d4d;
background-color:#f8f9fa;
border-radius:.4rem;
padding:0 .4rem;
box-shadow:0 0 5px rgba(0, 0, 0, .3);
display:none;
white-space:nowrap;
-webkit-user-select:none;
-moz-user-select:none;
-ms-user-select:none;
user-select:none}
.tooltip.visible.jsx-75cbc16d79a176fb{display:block}
.tooltip.jsx-75cbc16d79a176fb .tooltip-arrow.jsx-75cbc16d79a176fb, .tooltip.jsx-75cbc16d79a176fb .tooltip-arrow.jsx-75cbc16d79a176fb::before{position:absolute;
width:8px;
height:8px;
z-index:-1}
.tooltip.jsx-75cbc16d79a176fb .tooltip-arrow.jsx-75cbc16d79a176fb::before{content:"";
-webkit-transform:rotate(45deg);
-moz-transform:rotate(45deg);
-ms-transform:rotate(45deg);
transform:rotate(45deg);
background:#f8f9fa;
box-shadow:-2px -2px 2px rgba(0, 0, 0, .1)}
.tooltip[data-popper-placement^=top].jsx-75cbc16d79a176fb>.tooltip-arrow.jsx-75cbc16d79a176fb{bottom:-4px}
.tooltip[data-popper-placement^=top].jsx-75cbc16d79a176fb>.tooltip-arrow.jsx-75cbc16d79a176fb::before{-webkit-transform:rotate(225deg);
-moz-transform:rotate(225deg);
-ms-transform:rotate(225deg);
transform:rotate(225deg)}
.tooltip[data-popper-placement^=bottom].jsx-75cbc16d79a176fb>.tooltip-arrow.jsx-75cbc16d79a176fb{top:-4px}
.tooltip[data-popper-placement^=left].jsx-75cbc16d79a176fb>.tooltip-arrow.jsx-75cbc16d79a176fb{right:-4px}
.tooltip[data-popper-placement^=left].jsx-75cbc16d79a176fb>.tooltip-arrow.jsx-75cbc16d79a176fb::before{-webkit-transform:rotate(135deg);
-moz-transform:rotate(135deg);
-ms-transform:rotate(135deg);
transform:rotate(135deg)}
.tooltip[data-popper-placement^=right].jsx-75cbc16d79a176fb>.tooltip-arrow.jsx-75cbc16d79a176fb{left:-4px}
.tooltip[data-popper-placement^=right].jsx-75cbc16d79a176fb>.tooltip-arrow.jsx-75cbc16d79a176fb::before{-webkit-transform:rotate(315deg);
-moz-transform:rotate(315deg);
-ms-transform:rotate(315deg);
transform:rotate(315deg)}</style><style id="__jsx-f705e145f931f504">.navbar{position:absolute;
top:2.75rem;
width:100%}
.navbar a{color:#3c3c3b}
.navbar a.navbar-menu-item, .navbar .dropdown-title{text-transform:uppercase}
.navbar a.navbar-menu-item:hover, .navbar .dropdown-title:hover{-webkit-text-decoration:none;
text-decoration:none;
color:#898987;
-webkit-transition:color .15s ease-in-out;
transition:color .15s ease-in-out}
.navbar .navbar-content{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
position:relative}
.navbar .navbar-content .navbar-logo{-webkit-flex:1;
-ms-flex:1;
flex:1}
.navbar .navbar-content .navbar-logo img{width:8.3rem}
.navbar .navbar-content .navbar-collapse-button{display:none;
cursor:pointer}
@media (max-width:1000px) {.navbar .navbar-content .navbar-collapse-button{display:inline-block}}
.navbar .navbar-content .navbar-collapse-button span{display:block;
width:33px;
height:4px;
margin-bottom:5px;
position:relative;
background:#3c3c3b;
border-radius:3px;
z-index:1;
transform-origin:4px 0;
-webkit-transition:-webkit-transform .5s cubic-bezier(0.77, 0.2, 0.05, 1), background .5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity .55s ease;
transition:transform .5s cubic-bezier(0.77, 0.2, 0.05, 1), background .5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity .55s ease}
.navbar .navbar-content .navbar-collapse-button span:first-child{transform-origin:0% 0%}
.navbar .navbar-content .navbar-collapse-button span:nth-last-child(2){transform-origin:0% 100%}
.navbar .navbar-content .navbar-right{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-align-items:baseline;
-webkit-box-align:baseline;
-ms-flex-align:baseline;
align-items:baseline;
margin-bottom:10px}
@media (max-width:1000px) {.navbar .navbar-content .navbar-right{max-height:0;
-webkit-transition:max-height 200ms ease-in-out;
transition:max-height 200ms ease-in-out;
box-shadow:0 2px 5px 0 rgba(0, 0, 0, .1);
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
position:absolute;
top:2.75rem;
left:.8rem;
right:.8rem;
background-color:#f8f9fa;
overflow-x:auto;
overflow-y:hidden}}
.navbar .navbar-content .navbar-menu .navbar-menu-item{font-weight:400;
margin-right:2.5rem}
.navbar .navbar-content .navbar-menu .navbar-menu-item.with-drop-down{margin-right:1.8rem}
@media (max-width:1250px) {.navbar .navbar-content .navbar-menu .navbar-menu-item{margin-right:1.5rem}}
@media (max-width:1000px) {.navbar .navbar-content .navbar-menu .navbar-menu-item{display:block;
margin-bottom:1rem;
font-size:1.2rem}}
.navbar .navbar-content .navbar-menu .navbar-menu-item .external-link-icon{margin-left:.25em}
@media (max-width:1000px) {.navbar .navbar-content .navbar-menu{-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
padding:1rem}}
.navbar .navbar-content .navbar-social{margin-left:1.6rem;
font-size:.875rem}
.navbar .navbar-content .navbar-social svg{height:16px;
margin-bottom:2px}
@media (max-width:1000px) {.navbar .navbar-content .navbar-social svg{height:1rem}}
@media (max-width:1250px) {.navbar .navbar-content .navbar-social{margin-left:1rem}}
@media (max-width:1000px) {.navbar .navbar-content .navbar-social{margin-left:auto;
padding:0 1rem 1rem 0;
font-size:1rem}}
@media (max-width:768px) {.navbar{top:1rem}}
.page .navbar{top:0;
padding-top:1.5rem;
padding-bottom:1rem;
position:fixed;
background-color:#fff;
z-index:2}</style><style id="__jsx-bf3edc7191e82cb">.search{position:relative}
.search input{color:#adb5bd;
border:1px solid #dee2e6;
border-radius:.4rem;
font-size:.875rem;
padding:.25rem 1.8rem .35rem 1.8rem;
width:100%;
-webkit-transition:color .15s ease-in-out, border-color .15s ease-in-out;
transition:color .15s ease-in-out, border-color .15s ease-in-out;
background-color:transparent}
.search input:focus{border-color:#adb5bd;
color:#3c3c3b}
.search .autosuggest{position:absolute;
top:0;
-webkit-user-select:none;
-moz-user-select:none;
-ms-user-select:none;
user-select:none;
z-index:-100;
opacity:.5}
.search .search-icon, .search .search-icon-delete{position:absolute;
top:.55rem;
height:1rem;
stroke:#adb5bd;
-webkit-transition:stroke .15s ease-in-out;
transition:stroke .15s ease-in-out}
.search .search-icon{left:.4rem}
.search input:focus+.search-icon{stroke:#6f6970}
.search .search-icon-delete{stroke:#6f6970;
right:.4rem;
height:.75rem;
top:.7rem;
opacity:0;
-webkit-transition:opacity .15s ease-in-out;
transition:opacity .15s ease-in-out;
cursor:text}
.search.has-content .search-icon-delete{opacity:1;
cursor:pointer}</style><style id="__jsx-9ece789f808ef724">.search-results, .search-results-none{font-size:.875rem;
overflow:auto;
list-style-type:none;
padding-left:0;
display:none}
.search-results.visible, .search-results-none.visible{display:block}
.search-results{list-style-type:none;
padding:0;
margin-bottom:0}
.search-results li{display:block;
padding:.5rem;
margin-bottom:1rem;
border-radius:.4rem;
border:1px solid transparent;
cursor:pointer;
max-width:17rem;
overflow-x:hidden}
.search-results li.active{background-color:#f8f9fa;
border:1px solid #e9ecef}
.search-results li h5{margin:0 0 .5rem 0;
font-size:1em}
.search-results li .search-results-highlight{background-color:#ff0}
.search-results-none{padding:1rem .5rem;
text-align:center;
width:100%}</style><style id="__jsx-d1843944f2d67b">.search-panel{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
position:relative}</style><style id="__jsx-d38685edc31911e0">.github-stars.jsx-d38685edc31911e0{display:inline-block}
.github-stars.jsx-d38685edc31911e0 .icon.jsx-d38685edc31911e0{margin-right:.25em}
.github-stars.jsx-d38685edc31911e0 .icon.jsx-d38685edc31911e0 svg{height:1rem}</style><style id="__jsx-aeedcf66895f49d7">footer{font-size:.875rem;
padding-top:3rem;
padding-bottom:4rem;
background-color:#f8f9fa;
border-top:1px solid #dee2e6;
margin-top:1rem;
color:#6f6970}
footer h5{font-size:1rem;
margin-top:0;
margin-bottom:1rem;
color:#3c3c3b;
text-transform:uppercase}
footer ul{padding:0;
list-style:none;
line-height:2}
footer a{color:#6f6970}
footer .footer-logo img, footer .footer-copyright-eclipse-logo img{-webkit-filter:grayscale(100);
filter:grayscale(100);
opacity:.5;
-webkit-transition:all .15s ease-in-out;
transition:all .15s ease-in-out}
footer .footer-logo img:hover, footer .footer-copyright-eclipse-logo img:hover{-webkit-filter:grayscale(0);
filter:grayscale(0);
opacity:1}
footer .footer-nav-section{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
margin-bottom:6rem}
footer .footer-nav-section .footer-logo{margin-top:.4rem}
footer .footer-nav-section .footer-logo img{width:8.3rem}
footer .footer-nav-section .footer-nav-list{width:20%}
footer .footer-copyright{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-box-pack:justify;
-webkit-justify-content:space-between;
justify-content:space-between;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center}
footer .footer-copyright a{white-space:nowrap}
footer .footer-copyright .footer-copyright-eclipse-logo{width:17%;
margin-bottom:.5rem}
@media (max-width:1250px) {footer .footer-copyright .footer-copyright-break{display:none}
footer .footer-copyright .footer-copyright-eclipse-logo{width:30%}}
@media (max-width:1000px) {footer .footer-nav-section .footer-nav-list{width:25%}
footer .footer-copyright .footer-copyright-break{display:inline-block}
footer .footer-copyright .footer-copyright-eclipse-logo{width:40%}}
@media (max-width:768px) {footer .footer-nav-section{max-width:100%;
margin-left:auto;
margin-right:auto}}
@media (max-width:640px) {footer .footer-nav-section{max-width:80%;
margin-bottom:3rem;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column}
footer .footer-nav-section h5{cursor:pointer}
footer .footer-nav-section h5::after{display:inline-block;
content:"";
border-top:.4em solid;
border-right:.4em solid transparent;
border-bottom:0;
border-left:.4em solid transparent;
position:absolute;
top:.75rem;
right:0}
footer .footer-nav-section .footer-nav-list{width:100%;
position:relative}
footer .footer-nav-section .footer-nav-list ul{overflow-y:hidden;
max-height:0;
-webkit-transition:all 200ms ease-in-out;
transition:all 200ms ease-in-out}
footer .footer-nav-section .footer-nav-list ul.visible{margin-bottom:2rem}
footer .footer-nav-section .footer-logo{margin:0 auto 3rem auto;
width:auto}
footer .footer-copyright{max-width:80%;
text-align:center;
margin-left:auto;
margin-right:auto;
-webkit-flex-direction:column-reverse;
-ms-flex-direction:column-reverse;
flex-direction:column-reverse}
footer .footer-copyright .footer-copyright-eclipse-logo{width:7.6rem;
margin-bottom:1rem}}</style><style id="__jsx-efcc50be384cabc7">.page-content{margin-top:6em;
margin-bottom:8rem}
.docs .docs-content .docs-content-wrapper{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-box-pack:justify;
-webkit-justify-content:space-between;
justify-content:space-between}
.docs .docs-content .docs-content-wrapper aside{-webkit-flex:0 0 17rem;
-ms-flex:0 0 17rem;
flex:0 0 17rem}
.docs .docs-content .docs-content-wrapper aside .docs-content-wrapper-sidebar{position:-webkit-sticky;
position:sticky;
top:7em}
.docs .docs-content .docs-content-wrapper aside .search-panel{margin-top:1rem;
width:100%}
.docs .docs-content .docs-content-wrapper aside .search-panel .search-results{max-height:calc(100vh - 10rem - 1px)}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc{margin-top:1rem;
overflow-y:auto;
max-height:calc(100vh - 10rem - 3px)}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc #toctitle{display:none}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc ul{margin-top:0;
padding-left:0;
list-style-type:none}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc ul.sectlevel2{display:none}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc ul li{padding:.3333333333rem 0}
.docs .docs-content .docs-content-wrapper aside.docs-has-search-results .docs-content-toc{display:none}
@media (max-width:1250px) {.docs .docs-content .docs-content-wrapper aside{-webkit-flex:0 0 15rem;
-ms-flex:0 0 15rem;
flex:0 0 15rem}}
@media (max-width:1000px) {.docs .docs-content .docs-content-wrapper aside{z-index:1;
position:fixed;
top:0;
right:0;
width:25rem;
height:100vh;
max-width:100%;
padding-top:6rem;
padding-left:2rem;
padding-right:2rem;
background-color:#fff;
border-left:1px solid #dee2e6;
-webkit-transform:translateX(100%);
-moz-transform:translateX(100%);
-ms-transform:translateX(100%);
transform:translateX(100%);
-webkit-transition:-webkit-transform 200ms ease-in-out;
transition:transform 200ms ease-in-out;
will-change:transform}
.docs .docs-content .docs-content-wrapper aside.collapse{-webkit-transform:translateX(0%);
-moz-transform:translateX(0%);
-ms-transform:translateX(0%);
transform:translateX(0%)}}
@media (max-width:640px) {.docs .docs-content .docs-content-wrapper aside{min-width:100%;
border-left:none}}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle{z-index:1000;
cursor:pointer;
display:none;
position:fixed;
-webkit-justify-content:center;
justify-content:center;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
right:2rem;
bottom:2rem;
color:#fff;
background-color:#4d4d4d;
padding:.5rem;
border-radius:.8rem;
-webkit-transition:background-color .15s ease-in-out;
transition:background-color .15s ease-in-out}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle .feather-list, .docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle .feather-x{display:block}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle .feather-x{position:absolute;
left:0;
top:0;
opacity:0;
-webkit-transition:opacity .15s ease-in-out;
transition:opacity .15s ease-in-out}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle:hover{background-color:#3c3c3b}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle.collapse .feather-list{opacity:0}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle.collapse .feather-x{opacity:1}
@media (max-width:1000px) {.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}}
@media (max-width:640px) {.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle{right:1rem;
bottom:1rem}}
.docs .docs-content .docs-content-inner{max-width:calc(100% - 19.5rem);
overflow:hidden}
.docs .docs-content .docs-content-inner .docs-content-metadata{margin-top:1.2rem;
margin-bottom:1.2rem;
display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
flex-wrap:wrap;
-webkit-align-items:baseline;
-webkit-box-align:baseline;
-ms-flex-align:baseline;
align-items:baseline}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata{-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-repo{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
-webkit-flex:1;
-ms-flex:1;
flex:1}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left>*{margin-right:2rem}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left>*:last-child{margin-right:0}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left a{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
color:#6f6970;
white-space:nowrap}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left a:hover{color:#782b90}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left a .feather{margin-right:.25em;
height:1rem}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left{flex-wrap:wrap;
margin-bottom:1rem}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version{-webkit-flex:1;
-ms-flex:1;
flex:1;
display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}
@media (min-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version{-webkit-box-pack:end;
-ms-flex-pack:end;
-webkit-justify-content:flex-end;
justify-content:flex-end}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version svg{height:16px;
margin-bottom:-2px}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version svg{height:1rem;
margin-bottom:-1px}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version .dropdown-menu a{-webkit-text-decoration:none;
text-decoration:none}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version .dropdown-menu a:hover{color:#6f6970}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-label{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
margin-left:2rem}
.docs .docs-content .docs-content-inner h1{padding-top:0;
margin-top:.6rem;
line-height:1.2}
.docs .docs-content .docs-content-inner h1::after{content:"";
width:30%;
display:block;
border:2px solid #782b90;
border-radius:2px;
margin-top:1.1rem}
.docs .docs-content .docs-content-inner .ulist>ul{padding-left:1.1rem}
.docs .docs-content .docs-content-inner h2{border-top:1px solid #dee2e6;
margin-top:5rem;
padding-top:2rem}
.docs .docs-content .docs-content-inner h3, .docs .docs-content .docs-content-inner h4{margin-top:3rem}
@media (max-width:1250px) {.docs .docs-content .docs-content-inner{max-width:calc(100% - 17.5rem)}}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner{max-width:100%}}
.docs .docs-content .admonitionblock{border-top-right-radius:.8rem;
border-bottom-right-radius:.8rem;
background-color:#f8f9fa;
padding:1rem;
margin:1.5rem 0;
border-left:9px solid transparent}
.docs .docs-content .admonitionblock.note, .docs .docs-content .admonitionblock.tip{border-color:#6cb9f0}
.docs .docs-content .admonitionblock.important, .docs .docs-content .admonitionblock.warning, .docs .docs-content .admonitionblock.caution{border-color:#f0a46c}
.docs .docs-content .admonitionblock tr{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column}
.docs .docs-content .admonitionblock .title{font-weight:400}
.docs .docs-content .admonitionblock .title::after{content:":"}
.docs .docs-content dt{font-weight:400}
.docs .docs-content .anchor{opacity:0;
-webkit-align-self:flex-start;
-ms-flex-item-align:flex-start;
align-self:flex-start;
outline:none}
.docs .docs-content .anchor::after{content:"#";
position:absolute;
margin-left:-1.5rem;
color:#ced4da;
padding-right:.45rem}
.docs .docs-content .anchor:hover{opacity:1}
.docs .docs-content h2:hover .anchor, .docs .docs-content h3:hover .anchor, .docs .docs-content h4:hover .anchor, .docs .docs-content h5:hover .anchor, .docs .docs-content h6:hover .anchor{opacity:1}
.docs .docs-content h1 .anchor{display:none}
.docs .docs-content h4 .anchor::after, .docs .docs-content h5 .anchor::after, .docs .docs-content h6 .anchor::after{padding-right:.6rem}</style><style id="__jsx-7824b3ad3820c879">html{line-height:1.15;
-webkit-text-size-adjust:100%}
body{margin:0}
main{display:block}
h1{font-size:2em;
margin:.67em 0}
hr{box-sizing:content-box;
height:0;
overflow:visible}
pre{font-family:monospace, monospace;
font-size:1em}
a{background-color:transparent}
abbr[title]{border-bottom:none;
text-decoration:underline;
text-decoration:underline dotted}
b, strong{font-weight:bolder}
code, kbd, samp{font-family:monospace, monospace;
font-size:1em}
small{font-size:80%}
sub, sup{font-size:75%;
line-height:0;
position:relative;
vertical-align:baseline}
sub{bottom:-0.25em}
sup{top:-0.5em}
img{border-style:none}
button, input, optgroup, select, textarea{font-family:inherit;
font-size:100%;
line-height:1.15;
margin:0}
button, input{overflow:visible}
button, select{text-transform:none}
button, [type=button], [type=reset], [type=submit]{-webkit-appearance:button}
button::-moz-focus-inner, [type=button]::-moz-focus-inner, [type=reset]::-moz-focus-inner, [type=submit]::-moz-focus-inner{border-style:none;
padding:0}
button:-moz-focusring, [type=button]:-moz-focusring, [type=reset]:-moz-focusring, [type=submit]:-moz-focusring{outline:1px dotted ButtonText}
fieldset{padding:.35em .75em .625em}
legend{box-sizing:border-box;
color:inherit;
display:table;
max-width:100%;
padding:0;
white-space:normal}
progress{vertical-align:baseline}
textarea{overflow:auto}
[type=checkbox], [type=radio]{box-sizing:border-box;
padding:0}
[type=number]::-webkit-inner-spin-button, [type=number]::-webkit-outer-spin-button{height:auto}
[type=search]{-webkit-appearance:textfield;
outline-offset:-2px}
[type=search]::-webkit-search-decoration{-webkit-appearance:none}
::-webkit-file-upload-button{-webkit-appearance:button;
font:inherit}
details{display:block}
summary{display:list-item}
template{display:none}
[hidden]{display:none}
.hljs, pre{display:block;
overflow-x:auto;
padding:.5em;
background:#3a2840;
color:#fff}
.hljs.language-shell :not(.bash)+.bash, .hljs.language-better-shell :not(.bash)+.bash, pre.language-shell :not(.bash)+.bash, pre.language-better-shell :not(.bash)+.bash{color:#d2a8e0}
pre{border-radius:.8rem;
padding:1rem;
font-size:.875rem;
margin:1.5rem 0}
.hljs-keyword, .hljs-selector-tag, .hljs-tag{color:#d2a8e0}
.hljs-template-tag{color:red}
.hljs-number{color:#6cb9f0}
.hljs-variable, .hljs-template-variable, .hljs-attribute, .hljs-literal{color:#c9e5f9}
.hljs-subst{color:red}
.hljs-title, .hljs-name, .hljs-selector-id, .hljs-selector-class, .hljs-section, .hljs-type{color:#f0a46c}
.hljs-symbol, .hljs-bullet, .hljs-link{color:#d2a8e0}
.hljs-deletion, .hljs-string, .hljs-built_in, .hljs-builtin-name{color:#6cb9f0}
.hljs-addition, .hljs-comment, .hljs-quote, .hljs-meta{color:#adb5bd}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:bold}
#nprogress{pointer-events:none}
#nprogress .bar{background:#29d;
position:fixed;
z-index:1031;
top:0;
left:0;
width:100%;
height:2px}
#nprogress .peg{display:block;
position:absolute;
right:0px;
width:100px;
height:100%;
box-shadow:0 0 10px #29d, 0 0 5px #29d;
opacity:1;
-webkit-transform:rotate(3deg) translate(0px, -4px);
-ms-transform:rotate(3deg) translate(0px, -4px);
-webkit-transform:rotate(3deg) translate(0px, -4px);
-moz-transform:rotate(3deg) translate(0px, -4px);
-ms-transform:rotate(3deg) translate(0px, -4px);
transform:rotate(3deg) translate(0px, -4px)}
#nprogress .spinner{display:block;
position:fixed;
z-index:1031;
top:15px;
right:15px}
#nprogress .spinner-icon{width:18px;
height:18px;
box-sizing:border-box;
border:solid 2px transparent;
border-top-color:#29d;
border-left-color:#29d;
border-radius:50%;
-webkit-animation:nprogress-spinner 400ms linear infinite;
-webkit-animation:nprogress-spinner 400ms linear infinite;
animation:nprogress-spinner 400ms linear infinite}
.nprogress-custom-parent{overflow:hidden;
position:relative}
.nprogress-custom-parent #nprogress .spinner, .nprogress-custom-parent #nprogress .bar{position:absolute}
@keyframes nprogress-spinner {0% {-webkit-transform:rotate(0deg)}100% {-webkit-transform:rotate(360deg)}}
@keyframes nprogress-spinner {0% {transform:rotate(0deg)}100% {transform:rotate(360deg)}}
#nprogress .bar{background:#782b90}
#nprogress .peg{box-shadow:0 0 10px #782b90, 0 0 5px #782b90}
#nprogress .spinner-icon{border-top-color:#782b90;
border-left-color:#782b90}
html{box-sizing:border-box}
*, *::before, *::after{box-sizing:inherit}
:root{font-size:18px}
@media (max-width:1000px) {:root{font-size:17.1px}}
@media (max-width:768px) {:root{font-size:16.2px}}
@media (max-width:640px) {:root{font-size:15.3px}}
body, input{font-family:Roboto, sans-serif;
font-weight:300;
line-height:1.7;
color:#3c3c3b}
input{outline:none}
h1, h2, h3, h4, h5, h6{font-weight:400}
h1{font-size:2.5rem}
h2{font-size:2rem}
h3{font-size:1.75rem}
h4{font-size:1.5rem}
h5{font-size:1.25rem}
h6{font-size:1.1rem}
.container{width:100%;
padding-right:.8rem;
padding-left:.8rem;
margin-right:auto;
margin-left:auto}
@media (min-width:640px) {.container{max-width:620px}}
@media (min-width:768px) {.container{max-width:738px}}
@media (min-width:1000px) {.container{max-width:950px}}
@media (min-width:1250px) {.container{max-width:1180px}}
@media (min-width:1250px) {.container-narrow{max-width:950px}}
.img-fluid{max-width:100%}
a{-webkit-text-decoration:none;
text-decoration:none;
color:#782b90}
a:hover{text-decoration:underline;
color:#571f69}
img{vertical-align:middle}
svg{overflow:hidden;
vertical-align:middle}
code, pre{font-family:"Roboto Mono", SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
p code{display:-webkit-inline-box;
display:-webkit-inline-flex;
display:-ms-inline-flexbox;
display:inline-flex;
max-width:100%;
overflow:auto}
.heading-anchor{opacity:0;
-webkit-align-self:flex-start;
-ms-flex-item-align:flex-start;
align-self:flex-start;
outline:none}
.heading-anchor::after{content:"#";
position:absolute;
margin-left:-1.5rem;
color:#ced4da;
padding-right:.45rem}
.heading-anchor:hover{opacity:1}
h2:hover .heading-anchor, h3:hover .heading-anchor, h4:hover .heading-anchor, h5:hover .heading-anchor, h6:hover .heading-anchor{opacity:1}
h1 .heading-anchor{display:none}
h4 .heading-anchor::after, h5 .heading-anchor::after, h6 .heading-anchor::after{padding-right:.6rem}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap">@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Me5g.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu72xKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu5mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7GxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300;400&display=swap">@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZKCA.woff) format('woff')}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-59Y.woff) format('woff')}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCkYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCAYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCgYb9lecyVC4A.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCcYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCsYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCoYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCQYb9lecyU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19-7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19a7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-1967DQk6YvNkeg.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19G7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-1927DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19y7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19K7DQk6YvM.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap">@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vqPQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SeW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_QOW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_R-W-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_S-W-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SuW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW-AJi8SJQt.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body data-build-time="2022-05-05T22:55:21.503Z" data-build-commit-id="74c7933730aaf9b2d601c96696b7cbaa4beb5d95" data-build-run-id="2278663533"><div id="__next" data-reactroot=""><main class="jsx-efcc50be384cabc7 page docs"><header><div class="jsx-f705e145f931f504 navbar"><div class="jsx-f705e145f931f504 navbar-content container"><div class="jsx-f705e145f931f504 navbar-logo"><a class="jsx-f705e145f931f504" href="/"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 1232.6 315.2&#x27; style=&#x27;enable-background:new 0 0 1232.6 315.2&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23782a91%7d%3c/style%3e%3cpath d=&#x27;M120.9 214.2 190.5 0h52.3l-98.5 273.8H98.2L0 0h52.1l68.8 214.2zm291.2-62.6H299.6v84.2H431v38H252V0h177.7v38.4H299.6V114h112.5v37.6zm83.7-113.2H546c16.5.3 29 4.4 37.3 12.4 8.3 8 12.5 19.4 12.5 34 0 14-4.5 25.1-13.5 33.2-9 8.1-21.6 12.1-37.6 12.1h-27.1v24.2l86.1 119.5h51v-2.4l-77.2-106.7c24.9-5.5 43.3-21.7 52.6-35.9 8.2-12.6 13.3-27.7 13.3-46 0-26.8-8.6-47.4-25.8-61.5C600.5 7.1 576.1 0 544.5 0h-96.3v273.8h47.6&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1052.3 157.7-41.5 62.7 29.7 53.4h85.1z&#x27;/%3e%3ccircle class=&#x27;st0&#x27; cx=&#x27;827.9&#x27; cy=&#x27;274.7&#x27; r=&#x27;40.5&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1037 0-47.6 74.2L949 0h-84l85.3 135.8-67.1 105.7c5.7 9.5 9.1 20.5 9.2 32.4h50.1L1121.3 0H1037z&#x27;/%3e%3cpath d=&#x27;M763.5 273.8c.1-9.9 2.5-19.2 6.6-27.5V38.4h85.4V0H638.2v38.4h84.6v235.4h40.7zm414-266.9h-15.3v42.2h-8.5V6.9h-15.2V0h39v6.9zM1193 0l14.2 37.7L1221.3 0h11v49.1h-8.5V32.9l.8-21.7-14.5 37.9h-6.1l-14.5-37.8.8 21.6v16.2h-8.5V0h11.2z&#x27;/%3e%3c/svg%3e" alt="Vert.x Logo" class="jsx-f705e145f931f504"/></a></div><div class="jsx-f705e145f931f504 navbar-collapse-button"><span class="jsx-f705e145f931f504"></span><span class="jsx-f705e145f931f504"></span><span class="jsx-f705e145f931f504"></span></div><div class="jsx-f705e145f931f504 navbar-right"><div class="jsx-f705e145f931f504 navbar-menu"><span class="jsx-f705e145f931f504 navbar-menu-item with-drop-down"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">开始<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu"><a class="jsx-f705e145f931f504" href="/introduction-to-vertx-and-reactive/"><li class="jsx-400ec7965926e858 dropdown-item">简介</li></a><a class="jsx-f705e145f931f504" href="/get-started/"><li class="jsx-400ec7965926e858 dropdown-item">开始</li></a><a href="https://start.vertx.io/" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">应用生成器 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="jsx-f705e145f931f504 navbar-menu-item" href="/docs/">文档</a><span class="jsx-f705e145f931f504 navbar-menu-item with-drop-down"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">资源<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu"><a class="jsx-f705e145f931f504" href="/faq/"><li class="jsx-400ec7965926e858 dropdown-item">答疑</li></a><a class="jsx-f705e145f931f504" href="/channels/"><li class="jsx-400ec7965926e858 dropdown-item">联系渠道</li></a><a href="https://how-to.vertx.io/" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">操作指南 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/vertx-eventbus-bridge-clients" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">EventBus Bridge Clients <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/advanced-vertx-guide" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">Advanced Vert.x Guide <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="jsx-f705e145f931f504 navbar-menu-item" href="/blog/">博客</a><a class="jsx-f705e145f931f504 navbar-menu-item" href="/community/">社区</a><a class="jsx-f705e145f931f504 navbar-menu-item" href="/translation/">翻译团队</a></div><div class="jsx-f705e145f931f504 navbar-social"><span class="jsx-75cbc16d79a176fb "><a href="https://github.com/vert-x3/vertx-awesome" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title></title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Awesome Vert.x<div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://stackoverflow.com/questions/tagged/vert.x" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title></title><path d="M15.725 0l-1.72 1.277 6.39 8.588 1.716-1.277L15.725 0zm-3.94 3.418l-1.369 1.644 8.225 6.85 1.369-1.644-8.225-6.85zm-3.15 4.465l-.905 1.94 9.702 4.517.904-1.94-9.701-4.517zm-1.85 4.86l-.44 2.093 10.473 2.201.44-2.092-10.473-2.203zM1.89 15.47V24h19.19v-8.53h-2.133v6.397H4.021v-6.396H1.89zm4.265 2.133v2.13h10.66v-2.13H6.154Z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Stack Overflow<div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title></title><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">YouTube<div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://discord.gg/KzEMwP2" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title></title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Discord<div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title></title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Vert.x User Group<div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://qm.qq.com/cgi-bin/qm/qr?k=I4Z94iAgTJXB6FyR_U5scsJHtkjb1pif&amp;jump_from=webapi" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Vert.x中国用户组QQ群"><title></title><path d="M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673zM12.662 4.846c.039-1.052.659-1.878 1.385-1.846s1.281.912 1.242 1.964c-.039 1.051-.659 1.878-1.385 1.846s-1.282-.912-1.242-1.964zM9.954 3c.725-.033 1.345.794 1.384 1.846.04 1.052-.517 1.931-1.242 1.963-.726.033-1.346-.794-1.385-1.845C8.672 3.912 9.228 3.033 9.954 3zM7.421 8.294c.194-.43 2.147-.908 4.566-.908h.026c2.418 0 4.372.479 4.566.908a.14.14 0 0 1 .014.061c0 .031-.01.059-.026.083-.163.238-2.333 1.416-4.553 1.416h-.026c-2.221 0-4.39-1.178-4.553-1.416a.136.136 0 0 1-.014-.144zm10.422 8.622c-.22 3.676-2.403 5.987-5.774 6.021h-.137c-3.37-.033-5.554-2.345-5.773-6.021-.081-1.35.001-2.496.147-3.43.318.063.638.122.958.176v3.506s1.658.334 3.318.103v-3.225c.488.027.96.04 1.406.034h.025c1.678.021 3.714-.204 5.683-.594.146.934.227 2.08.147 3.43zM10.48 5.804c.313-.041.542-.409.508-.825-.033-.415-.314-.72-.629-.679-.313.04-.541.409-.508.824.034.417.315.72.629.68zM14.479 5.156c.078.037.221.042.289-.146.035-.095.025-.165-.009-.214-.023-.033-.133-.118-.371-.176-.904-.22-1.341.384-1.405.499-.04.072-.012.176.056.227.067.051.139.037.179-.006.58-.628 1.21-.208 1.261-.184z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Vert.x中国用户组QQ群<div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://qun.qq.com/qqweb/qunpro/share?_wv=3&amp;_wwv=128&amp;inviteCode=1reLvB&amp;from=246610&amp;biz=ka" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 200 200" aria-label=""><path d="M13 73L16 49L52 49L58 14L82 14L77 49L135 49L141 14L166 14L160 49L195 49L192 73L157 73L148 124L184 124L181 149L144 149L137 193L90 149L61 149L55 185L31 185L36 149L0 149L6 124L100 124L120 144L131 75L72 75L64 124L40 124L48 73Z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Vert.x中国用户组QQ频道<div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div></div></div></div></div></header><div class="jsx-efcc50be384cabc7 page-content docs-content"><div class="jsx-efcc50be384cabc7 container"><div class="jsx-efcc50be384cabc7 docs-content-wrapper"><aside class="jsx-efcc50be384cabc7 "><div class="jsx-efcc50be384cabc7 docs-content-wrapper-sidebar"><div class="jsx-d1843944f2d67b search-panel"><div class="jsx-bf3edc7191e82cb search"><input type="text" disabled="" class="jsx-bf3edc7191e82cb autosuggest"/><input type="text" placeholder="Search..." value="" class="jsx-bf3edc7191e82cb"/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon-delete"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></div><ul class="jsx-9ece789f808ef724 search-results"></ul><div class="jsx-9ece789f808ef724 search-results-none">No results.</div></div><div class="jsx-efcc50be384cabc7 docs-content-toc"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_using_vertx_stomp">使用 vertx-stomp</a></li>
<li><a href="#_stomp_server">STOMP 服务器</a>
<ul class="sectlevel2">
<li><a href="#_creating_a_stomp_server">创建 STOMP 服务器</a></li>
<li><a href="#_closing_a_stomp_server">关闭 STOMP 服务器</a></li>
<li><a href="#_configuration">配置服务端</a></li>
<li><a href="#_subscriptions">订阅</a></li>
<li><a href="#_type_of_destinations">消息目的地点类型</a></li>
<li><a href="#_providing_your_own_type_of_destination">提供您自定义的目的地点类型</a></li>
<li><a href="#_acknowledgment">确认消息</a></li>
<li><a href="#_customizing_the_stomp_server">自定义 STOMP 服务器配置</a></li>
</ul>
</li>
<li><a href="#_stomp_client">STOMP 客户端</a>
<ul class="sectlevel2">
<li><a href="#_creating_a_stomp_client">创建 STOMP 客户端</a></li>
<li><a href="#_closing_a_stomp_client">关闭 STOMP 客户端</a></li>
<li><a href="#_handling_errors">错误处理</a></li>
<li><a href="#_configuration_2">配置客户端</a></li>
<li><a href="#_subscribing_to_destinations">订阅</a></li>
<li><a href="#_sending_messages">发送消息</a></li>
<li><a href="#_acknowledgements">确认消息</a></li>
<li><a href="#_transactions">事务</a></li>
<li><a href="#_receipt">确认消息</a></li>
</ul>
</li>
<li><a href="#_using_the_stomp_server_as_a_bridge_to_the_vert_x_event_bus">使用 STOMP 服务器桥接 Vert.x 事件总线</a></li>
<li><a href="#_using_the_stomp_server_with_web_sockets">使用基于 websocket 的 STOMP 服务器</a></li>
<li><a href="#_registering_received_and_writing_frame_handlers">注册接收消息处理器和写入消息处理器</a></li>
</ul>
</div></div></div></aside><div class="jsx-efcc50be384cabc7 docs-content-sidebar-toggle"><div style="position:relative" class="jsx-efcc50be384cabc7"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div></div><div class="jsx-efcc50be384cabc7 docs-content-inner"><div class="jsx-efcc50be384cabc7 docs-content-metadata"><div class="jsx-efcc50be384cabc7 docs-content-metadata-left"><div class="jsx-efcc50be384cabc7 docs-content-metadata-repo"><div class="jsx-d38685edc31911e0 github-stars"><a href="https://github.com/vert-x3/vertx-stomp" class="jsx-d38685edc31911e0"><div class="jsx-d38685edc31911e0 icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></div> <!-- -->null stars</a></div></div><div class="jsx-efcc50be384cabc7"><a href="https://vertx.io/docs/apidocs" class="jsx-efcc50be384cabc7"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg> API</a></div><div class="jsx-efcc50be384cabc7 docs-content-metadata-edit"><a href="https://github.com/vertx-china/vertx-web-site/tree/master/docs/translation/vertx-stomp/java"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> 改进翻译</a></div><span class="jsx-efcc50be384cabc7 docs-content-metadata-version"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">v4.2.7<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu align-right"><a href="/docs/vertx-stomp/java/"><li class="jsx-400ec7965926e858 dropdown-item active has-active-siblings"><span class="jsx-400ec7965926e858 dropdown-check-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></span>Latest (v<!-- -->4.2.7<!-- -->)</li></a><a href="/docs/4.1.8/vertx-stomp/java/"><li class="jsx-400ec7965926e858 dropdown-item has-active-siblings">v<!-- -->4.1.8</li></a><a href="/docs/4.0.3/vertx-stomp/java/"><li class="jsx-400ec7965926e858 dropdown-item has-active-siblings">v<!-- -->4.0.3</li></a><a href="/docs/3.9.13/vertx-stomp/java/"><li class="jsx-400ec7965926e858 dropdown-item has-active-siblings">v<!-- -->3.9.13</li></a></ul></div></span></div></div><div class="jsx-efcc50be384cabc7"><h1>Vert.x-Stomp</h1>

<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>STOMP 即简单(流)文本定向消息。 STOMP
提供了一种可交互的消息管线，因此 STOMP 客户端可以与任意的 STOMP 消息中介（broker） 通信，并
基于各种不同的语言，平台与消息中介实现信息的交互和操作。 参阅 <a href="https://stomp.github.io/index.html" class="bare">https://stomp.github.io/index.html</a> 了解更多关于 STOMP 的信息。</p>
</div>
<div class="paragraph">
<p>Vertx-Stomp 提供了 STOMP 客户端和服务端的实现。 您可以使用其他客户端连接 Vert.x 的 STOMP 服务端，也可以
使用 Vert.x 的 STOMP 客户端连接其他服务端实现。 Vert.x 提供的服务端和客户端都支持 STOMP 的 1.0，1.1 和 1.2
版本  (参见 <a href="https://stomp.github.io/stomp-specification-1.2.html)。" class="bare">https://stomp.github.io/stomp-specification-1.2.html)。</a> 该 STOMP 服务端也可以用于跟
Vert.x 的事件总线桥接, 或者直接与 websocket 客户端建立连接 (使用 StompJS)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_vertx_stomp"><a class="anchor" href="#_using_vertx_stomp"></a>使用 vertx-stomp</h2>
<div class="sectionbody">
<div class="paragraph">
<p>为了使用 Vert.x Stomp 服务端和客户端, 需要将以下依赖项添加到您的项目构建描述文件
的 <em>依赖配置</em> 中:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven (在您的 <code>pom.xml</code>):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-stomp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle (在您的 <code>build.gradle</code> 文件中):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">compile <span class="hljs-string">&#x27;io.vertx:vertx-stomp:4.1.0&#x27;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stomp_server"><a class="anchor" href="#_stomp_server"></a>STOMP 服务器</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_creating_a_stomp_server"><a class="anchor" href="#_creating_a_stomp_server"></a>创建 STOMP 服务器</h3>
<div class="paragraph">
<p>以下是使用默认配置去创建 STOMP 服务器的最简单的方法:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx))
    .listen();</code></pre>
</div>
</div>
<div class="paragraph">
<p>这会创建一个符合 STOMP 标准的服务器， 它会监听 <code>localhost:61613</code> 地址</p>
</div>
<div class="paragraph">
<p>您可以使用 <code><a href="../../apidocs/io/vertx/ext/stomp/StompServer.html#listen-int-java.lang.String-">listen</a></code> 方法
去配置服务器监听的主机地址和端口:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx))
    .listen(<span class="hljs-number">1234</span>, <span class="hljs-string">&quot;0.0.0.0&quot;</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果您设置端口号为 <code>-1</code> , TCP 服务器将无法启动。 如果您使用到了 websocket 桥接
这会很有用。 使用以下方式设置回调处理器，以便在服务器就绪时被调用:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-type">StompServer</span> <span class="hljs-variable">server</span> <span class="hljs-operator">=</span> StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx))
    .listen(ar -&gt; {
      <span class="hljs-keyword">if</span> (ar.failed()) {
        System.out.println(<span class="hljs-string">&quot;Failing to start the STOMP server : &quot;</span> + ar.cause().getMessage());
      } <span class="hljs-keyword">else</span> {
        System.out.println(<span class="hljs-string">&quot;Ready to receive STOMP frames&quot;</span>);
      }
    });</code></pre>
</div>
</div>
<div class="paragraph">
<p>该回调处理器接收一个类型是 <code><a href="../../apidocs/io/vertx/ext/stomp/StompServer.html">StompServer</a></code> 的引用参数</p>
</div>
<div class="paragraph">
<p>您也可以使用 <code><a href="../../apidocs/io/vertx/ext/stomp/StompServerOptions.html">StompServerOptions</a></code> 配置服务器监听的主机地址和端口:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StompServerOptions</span>().setPort(<span class="hljs-number">1234</span>).setHost(<span class="hljs-string">&quot;0.0.0.0&quot;</span>))
    .handler(StompServerHandler.create(vertx))
    .listen();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_closing_a_stomp_server"><a class="anchor" href="#_closing_a_stomp_server"></a>关闭 STOMP 服务器</h3>
<div class="paragraph">
<p>使用如下方式关闭 STOMP 服务器:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">server.close(ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    System.out.println(<span class="hljs-string">&quot;The STOMP server has been closed&quot;</span>);
  } <span class="hljs-keyword">else</span> {
    System.out.println(<span class="hljs-string">&quot;The STOMP server failed to close : &quot;</span> + ar.cause().getMessage());
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration"><a class="anchor" href="#_configuration"></a>配置服务端</h3>
<div class="paragraph">
<p>使用 <code><a href="../../apidocs/io/vertx/ext/stomp/StompServerOptions.html">StompServerOptions</a></code> 配置 STOMP 服务器的多项参数</p>
</div>
<div class="paragraph">
<p>首先，STOMP 服务器是基于
<code><a href="../../apidocs/io/vertx/core/net/NetServer.html">NetServer</a></code> 的， 因此您可以在  <code><a href="../../apidocs/io/vertx/ext/stomp/StompServerOptions.html">StompServerOptions</a></code> 中配置
底层使用的 <code><a href="../../apidocs/io/vertx/core/net/NetServer.html">NetServer</a></code>。或者您也可以将
您想要使用的 <code><a href="../../apidocs/io/vertx/core/net/NetServer.html">NetServer</a></code> 实例作为参数传入:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx, netServer)
    .handler(StompServerHandler.create(vertx))
    .listen();</code></pre>
</div>
</div>
<div class="paragraph">
<p>该配置类 <code><a href="../../apidocs/io/vertx/ext/stomp/StompServerOptions.html">StompServerOptions</a></code> 可以让您设置以下选项：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>STOMP 服务器默认监听的主机地址和端口 - 默认为 <code>0.0.0.0:61613</code>.</p>
</li>
<li>
<p>STOMP 服务器是否使用安全验证 - 默认为 <code>false</code></p>
</li>
<li>
<p>STOMP 协议消息体的最大尺寸限制 - 默认为 10 Mb</p>
</li>
<li>
<p>STOMP 协议消息体的最大首部限制 - 默认为 1000</p>
</li>
<li>
<p>STOMP 协议消息体中首部行长度的最大限制 - 默认为 10240</p>
</li>
<li>
<p>STOMP 协议的心跳时间 - 默认为 <code>1000, 1000</code></p>
</li>
<li>
<p>支持的 STOMP 协议版本 (默认为 1.0, 1.1 和 1.2)</p>
</li>
<li>
<p>STOMP 协议中事务所支持的最大消息数量 (默认为 1000)</p>
</li>
<li>
<p>分块传输的最大尺寸 - 默认为 1000 (参见 <code><a href="../../apidocs/io/vertx/ext/stomp/StompServerOptions.html#setTransactionChunkSize-int-">setTransactionChunkSize</a></code> )</p>
</li>
<li>
<p>一个客户端可以使用的最大订阅数量 - 默认为 1000</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>如下所示，使用 JsonObject 配置 STOMP 协议的心跳时间：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StompServerOptions</span>().setHeartbeat(
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonObject</span>().put(<span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-number">1000</span>).put(<span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-number">1000</span>)))
    .handler(StompServerHandler.create(vertx))
    .listen();</code></pre>
</div>
</div>
<div class="paragraph">
<p>要使用安全认证功能，需要提供 <code><a href="../../apidocs/io/vertx/ext/auth/authentication/AuthenticationProvider.html">AuthenticationProvider</a></code> 以处理
认证请求：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StompServerOptions</span>().setSecured(<span class="hljs-literal">true</span>))
    .handler(StompServerHandler.create(vertx).authProvider(provider))
    .listen();</code></pre>
</div>
</div>
<div class="paragraph">
<p>更多关于 <code><a href="../../apidocs/io/vertx/ext/auth/authentication/AuthenticationProvider.html">AuthenticationProvider</a></code> 的信息请参考
<a href="http://vertx.io/docs/#authentication_and_authorisation">此文档</a>.</p>
</div>
<div class="paragraph">
<p>如果一个消息体的大小超过了限制, 那么它会被拒绝接收，并且客户端会收到一个 <code>ERROR</code> 消息。 按照协议
要求，在发送这种错误消息后，客户端的连接需要立即关闭。 如果发送的消息不符合其他
要求的限制，客户端也需要立即关闭。</p>
</div>
</div>
<div class="sect2">
<h3 id="_subscriptions"><a class="anchor" href="#_subscriptions"></a>订阅</h3>
<div class="paragraph">
<p>默认的 STOMP 服务器将订阅的目的地点作为普通的字符串处理。 因此它不会对其进行解析
和分级。 默认的 STOMP 服务器使用 <em>topic</em> 模式处理订阅 (因此消息会被分发给所有
对应的订阅客户端)</p>
</div>
</div>
<div class="sect2">
<h3 id="_type_of_destinations"><a class="anchor" href="#_type_of_destinations"></a>消息目的地点类型</h3>
<div class="paragraph">
<p>默认情况下， STOMP 服务器将消息发送的 <em>目的地点</em> 作为 topic 类型处理。 因此消息会被发送给所有的订阅者。 您可以
配置 STOMP 服务器将消息发送的目的地作为 queue 类型处理, 或两种模式都支持：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx)
        .destinationFactory((v, name) -&gt; {
          <span class="hljs-keyword">if</span> (name.startsWith(<span class="hljs-string">&quot;/queue&quot;</span>)) {
            <span class="hljs-keyword">return</span> Destination.queue(vertx, name);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> Destination.topic(vertx, name);
          }
        }))
    .listen();</code></pre>
</div>
</div>
<div class="paragraph">
<p>在以上代码中， 所有以 <code>/queue</code> 开头的目的地点均被作为 queue 类型处理，而其他的目的地点被当作 topic 类型。 目的地点是在 STOMP 服务器
第一次接收到对应的订阅消息时被创建的</p>
</div>
<div class="paragraph">
<p>STOMP 服务器通过返回 <code>null</code> 以拒绝目的地点的创建：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx)
        .destinationFactory((v, name) -&gt; {
          <span class="hljs-keyword">if</span> (name.startsWith(<span class="hljs-string">&quot;/forbidden&quot;</span>)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (name.startsWith(<span class="hljs-string">&quot;/queue&quot;</span>)) {
            <span class="hljs-keyword">return</span> Destination.queue(vertx, name);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> Destination.topic(vertx, name);
          }
        }))
    .listen();</code></pre>
</div>
</div>
<div class="paragraph">
<p>在这种情况下， 订阅客户端会收到一个 <code>ERROR</code> 消息</p>
</div>
<div class="paragraph">
<p>queue 类型的目的地点使用轮询调度策略向订阅者分发消息</p>
</div>
</div>
<div class="sect2">
<h3 id="_providing_your_own_type_of_destination"><a class="anchor" href="#_providing_your_own_type_of_destination"></a>提供您自定义的目的地点类型</h3>
<div class="paragraph">
<p>Vert.x 提供的 STOMP 有意没有实现任何高级特性。 如果您需要更高级的消息分发策略，
可以提供自定义的 <code><a href="../../apidocs/io/vertx/ext/stomp/DestinationFactory.html">DestinationFactory</a></code> 实现
以返回您自定义的 <code><a href="../../apidocs/io/vertx/ext/stomp/Destination.html">Destination</a></code> 实例。</p>
</div>
</div>
<div class="sect2">
<h3 id="_acknowledgment"><a class="anchor" href="#_acknowledgment"></a>确认消息</h3>
<div class="paragraph">
<p>默认情况下， STOMP 服务器如果没有收到一个消息的确认消息不会做任何处理。 您可以通过提供您自定义的
 <code><a href="../../apidocs/io/vertx/ext/stomp/Destination.html">Destination</a></code> 以实现对确认消息的处理</p>
</div>
<div class="paragraph">
<p>自定义的目的地点类型应该实现</p>
</div>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/stomp/StompServerHandler.html#onAck-io.vertx.ext.stomp.StompServerConnection-io.vertx.ext.stomp.Frame-java.util.List-">onAck</a></code>
和
<code><a href="../../apidocs/io/vertx/ext/stomp/StompServerHandler.html#onNack-io.vertx.ext.stomp.StompServerConnection-io.vertx.ext.stomp.Frame-java.util.List-">onNack</a></code>
方法以供 <code><a href="../../apidocs/io/vertx/ext/stomp/StompServerHandler.html">StompServerHandler</a></code> 实现特定行为：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx)
        .onAckHandler(acknowledgement -&gt; {
          <span class="hljs-comment">// Action to execute when the frames (one in `client-individual` mode, several</span>
          <span class="hljs-comment">// in `client` mode are acknowledged.</span>
        })
        .onNackHandler(acknowledgement -&gt; {
          <span class="hljs-comment">// Action to execute when the frames (1 in `client-individual` mode, several in</span>
          <span class="hljs-comment">// `client` mode are not acknowledged.</span>
        }))
    .listen();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_customizing_the_stomp_server"><a class="anchor" href="#_customizing_the_stomp_server"></a>自定义 STOMP 服务器配置</h3>
<div class="paragraph">
<p>除了上文所述的回调, 您还可以配置 STOMP 服务器的几乎所有配置, 例如收到
指定消息类型的响应动作, 发送给客户端的 <code>ping</code> 消息 (为了实现
心跳)。以下是示例</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx)
            .closeHandler(connection -&gt; {
              <span class="hljs-comment">// 客户端关闭的回调</span>
            })
            .beginHandler(frame -&gt; {
              <span class="hljs-comment">// 开始传输事务的回调</span>
            })
            .commitHandler(frame -&gt; {
                  <span class="hljs-comment">// 传输事务完成的回调</span>
                }
            )
        <span class="hljs-comment">//...</span>
    ).listen();</code></pre>
</div>
</div>
<div class="paragraph">
<p>注意，改变默认的实现可能会导致对 STOMP 标准的破坏。 所以请参考
默认的实现。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stomp_client"><a class="anchor" href="#_stomp_client"></a>STOMP 客户端</h2>
<div class="sectionbody">
<div class="paragraph">
<p>STOMP 客户端可以连接到 STOMP 服务器并且接受和发送数据。</p>
</div>
<div class="sect2">
<h3 id="_creating_a_stomp_client"><a class="anchor" href="#_creating_a_stomp_client"></a>创建 STOMP 客户端</h3>
<div class="paragraph">
<p>通过以下方式使用默认配置创建 <code><a href="../../apidocs/io/vertx/ext/stomp/StompClient.html">StompClient</a></code> 实例：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect()
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>以上的代码片段创建了一个客户端连接到 "0.0.0.0:61613"。 一旦连接成功, 您就可以获得一个
<code><a href="../../apidocs/io/vertx/ext/stomp/StompClientConnection.html">StompClientConnection</a></code> 实例用于和服务端交互。 您可以
通过以下方式配置客户端的连接地址和端口：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect(<span class="hljs-number">61613</span>, <span class="hljs-string">&quot;0.0.0.0&quot;</span>)
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>为了捕获因为安全认证原因导致的异常， 或其他因为交互时
产生的异常而返回的错误信息, 您可以提供一个 <em>异常处理器</em> 给 Stomp 客户端。 所有
被该 STOMP 客户端创建的连接都会默认继承该异常处理器 (但他们也可以各自单独设置异常处理器)：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .errorFrameHandler(frame -&gt; {
    <span class="hljs-comment">// 接受错误消息</span>
  })
  .connect(<span class="hljs-number">61613</span>, <span class="hljs-string">&quot;0.0.0.0&quot;</span>)
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>您也可以使用 <code><a href="../../apidocs/io/vertx/ext/stomp/StompClientOptions.html">StompClientOptions</a></code> 来配置 STOMP 客户端的连接地址和端口:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient
  .create(vertx, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StompClientOptions</span>().setHost(<span class="hljs-string">&quot;localhost&quot;</span>).setPort(<span class="hljs-number">1234</span>))
  .connect()
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_closing_a_stomp_client"><a class="anchor" href="#_closing_a_stomp_client"></a>关闭 STOMP 客户端</h3>
<div class="paragraph">
<p>您可以关闭 STOMP 客户端:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-type">StompClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> StompClient
  .create(vertx, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StompClientOptions</span>().setHost(<span class="hljs-string">&quot;localhost&quot;</span>).setPort(<span class="hljs-number">1234</span>));

client
  .connect()
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));

client.close();</code></pre>
</div>
</div>
<div class="paragraph">
<p>然而, 使用以上方式关闭客户端不会告知 STOMP 服务器断开连接。 为了显式的断开连接， 您应当
使用 <code><a href="../../apidocs/io/vertx/ext/stomp/StompClientConnection.html#disconnect--">disconnect</a></code> 方法:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient
  .create(vertx, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StompClientOptions</span>().setHost(<span class="hljs-string">&quot;localhost&quot;</span>).setPort(<span class="hljs-number">1234</span>))
  .connect()
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
    connection.disconnect();
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果您使用了心跳并且 STOMP 客户端在配置的心跳时间内没有检测到服务端的活动， 连接
会自动关闭</p>
</div>
</div>
<div class="sect2">
<h3 id="_handling_errors"><a class="anchor" href="#_handling_errors"></a>错误处理</h3>
<div class="paragraph">
<p>对于 <code><a href="../../apidocs/io/vertx/ext/stomp/StompClientConnection.html">StompClientConnection</a></code> 的实例, 您可以注册一个错误处理器用于接收
服务端发送的 <code>ERROR</code> 消息。 注意服务端会在发送该错误消息后关闭连接：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient
  .create(vertx, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StompClientOptions</span>().setHost(<span class="hljs-string">&quot;localhost&quot;</span>).setPort(<span class="hljs-number">1234</span>))
  .connect()
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
    connection
      .errorHandler(frame -&gt;
        System.out.println(<span class="hljs-string">&quot;ERROR frame received : &quot;</span> + frame));
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果客户端发现当前的连接被丢弃时会收到通知。 STOMP 客户端通过心跳机制
监视连接是否失效。 当 STOMP 服务器在心跳时间窗口内没有发送心跳, 那么连接会被
关闭并且 <code>connectionDroppedHandler</code> 会被调用 (如果设置了的话)。 为了设置 <code>connectionDroppedHandler</code>, 您需要调用
<code><a href="../../apidocs/io/vertx/ext/stomp/StompClientConnection.html#connectionDroppedHandler-io.vertx.core.Handler-">connectionDroppedHandler</a></code> 方法。该处理器可以起到
让该 STOMP 客户端实例重新连接服务器的作用。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect()
  .onSuccess(connection -&gt; {

    connection.connectionDroppedHandler(con -&gt; {
      <span class="hljs-comment">// 该连接已被丢失</span>
      <span class="hljs-comment">// 您需要重新建立连接或切换使用另一个连接</span>
    });

    connection.send(<span class="hljs-string">&quot;/queue&quot;</span>, Buffer.buffer(<span class="hljs-string">&quot;Hello&quot;</span>))
      .onSuccess(frame -&gt; System.out.println(<span class="hljs-string">&quot;Message processed by the server&quot;</span>)
      );
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_2"><a class="anchor" href="#_configuration_2"></a>配置客户端</h3>
<div class="paragraph">
<p>您可以通过在创建 <code><a href="../../apidocs/io/vertx/ext/stomp/StompClient.html">StompClient</a></code> 时传入
<code><a href="../../apidocs/io/vertx/ext/stomp/StompClientOptions.html">StompClientOptions</a></code> 以自定义多项配置。 由于
STOMP 客户端底层依赖了 <code><a href="../../apidocs/io/vertx/core/net/NetClient.html">NetClient</a></code>， 因此您可以在 <code><a href="../../apidocs/io/vertx/ext/stomp/StompClientOptions.html">StompClientOptions</a></code> 中配置
底层的 NetClient。 或者您也可以在 <code><a href="../../apidocs/io/vertx/ext/stomp/StompClient.html#connect-io.vertx.core.net.NetClient-io.vertx.core.Handler-">connect</a></code> 方法中
传入一个
您想使用的 <code><a href="../../apidocs/io/vertx/core/net/NetClient.html">NetClient</a></code>：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect(netClient)
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
    connection
      .errorHandler(frame -&gt;
        System.out.println(<span class="hljs-string">&quot;ERROR frame received : &quot;</span> + frame));
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>使用 <code><a href="../../apidocs/io/vertx/ext/stomp/StompClientOptions.html">StompClientOptions</a></code> 可以配置：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>连接 STOMP 服务器的地址和端口</p>
</li>
<li>
<p>连接 STOMP 服务器的登录和密码</p>
</li>
<li>
<p>如果没有显式设置 <code>content-length</code> 首部，是否自动添加 (默认开启)</p>
</li>
<li>
<p>是否用 <code>STOMP</code> 指令来替换 <code>CONNECT</code> 指令 (默认关闭)</p>
</li>
<li>
<p>在 <code>CONNECT</code> 消息中 <code>host</code> 首部是否被忽略  (默认关闭)</p>
</li>
<li>
<p>心跳时间配置 (默认为 1000, 1000)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_subscribing_to_destinations"><a class="anchor" href="#_subscribing_to_destinations"></a>订阅</h3>
<div class="paragraph">
<p>为了订阅消息的目的地点，使用</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect()
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
    connection.subscribe(<span class="hljs-string">&quot;/queue&quot;</span>, frame -&gt;
      System.out.println(<span class="hljs-string">&quot;Just received a frame from /queue : &quot;</span> + frame));
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>为了取消订阅，使用:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect()
  .onSuccess(connection -&gt; {
    <span class="hljs-comment">// 使用连接</span>
    connection.subscribe(<span class="hljs-string">&quot;/queue&quot;</span>, frame -&gt;
      System.out.println(<span class="hljs-string">&quot;Just received a frame from /queue : &quot;</span> + frame));

    <span class="hljs-comment">// ....</span>

    connection.unsubscribe(<span class="hljs-string">&quot;/queue&quot;</span>);
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sending_messages"><a class="anchor" href="#_sending_messages"></a>发送消息</h3>
<div class="paragraph">
<p>为了发送消息，使用:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect()
  .onSuccess(connection -&gt; {
    Map&lt;String, String&gt; headers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    headers.put(<span class="hljs-string">&quot;header1&quot;</span>, <span class="hljs-string">&quot;value1&quot;</span>);
    connection.send(<span class="hljs-string">&quot;/queue&quot;</span>, headers, Buffer.buffer(<span class="hljs-string">&quot;Hello&quot;</span>));
    <span class="hljs-comment">//没有首部:</span>
    connection.send(<span class="hljs-string">&quot;/queue&quot;</span>, Buffer.buffer(<span class="hljs-string">&quot;World&quot;</span>));
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>在 Java 和 Groovy 语言中， 您可以使用 <code><a href="../../apidocs/io/vertx/ext/stomp/utils/Headers.html">Headers</a></code> 类用于简化首部的创建</p>
</div>
</div>
<div class="sect2">
<h3 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>确认消息</h3>
<div class="paragraph">
<p>STOMP 客户端可以发送 <code>ACK</code> 和 <code>NACK</code> 消息：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect()
  .onSuccess(connection -&gt; {
    connection.subscribe(<span class="hljs-string">&quot;/queue&quot;</span>, frame -&gt; {
      connection.ack(frame.getAck());
      <span class="hljs-comment">// 或者</span>
      connection.nack(frame.getAck());
    });
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_transactions"><a class="anchor" href="#_transactions"></a>事务</h3>
<div class="paragraph">
<p>STOMP 客户端也可以创建事务。 <code>ACK</code>, <code>NACK</code> 和 <code>SEND</code> 消息只有在事务被提交时才会
发送。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect()
  .onSuccess(connection -&gt; {
    Map&lt;String, String&gt; headers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
    headers.put(<span class="hljs-string">&quot;transaction&quot;</span>, <span class="hljs-string">&quot;my-transaction&quot;</span>);
    connection.beginTX(<span class="hljs-string">&quot;my-transaction&quot;</span>);
    connection.send(<span class="hljs-string">&quot;/queue&quot;</span>, headers, Buffer.buffer(<span class="hljs-string">&quot;Hello&quot;</span>));
    connection.send(<span class="hljs-string">&quot;/queue&quot;</span>, headers, Buffer.buffer(<span class="hljs-string">&quot;World&quot;</span>));
    connection.send(<span class="hljs-string">&quot;/queue&quot;</span>, headers, Buffer.buffer(<span class="hljs-string">&quot;!!!&quot;</span>));
    connection.commit(<span class="hljs-string">&quot;my-transaction&quot;</span>);
    <span class="hljs-comment">// 或者</span>
    connection.abort(<span class="hljs-string">&quot;my-transaction&quot;</span>);
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_receipt"><a class="anchor" href="#_receipt"></a>确认消息</h3>
<div class="paragraph">
<p>每次发送指令可以设置一个 <em>确认</em> 处理器, 该处理器会在服务端确认处理完消息后被调用：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">StompClient.create(vertx)
  .connect()
  .onSuccess(connection -&gt; {
    connection
      .send(<span class="hljs-string">&quot;/queue&quot;</span>, Buffer.buffer(<span class="hljs-string">&quot;Hello&quot;</span>))
      .onSuccess(frame -&gt;
        System.out.println(<span class="hljs-string">&quot;Message processed by the server&quot;</span>));
  })
  .onFailure(err -&gt;
    System.out.println(
      <span class="hljs-string">&quot;Failed to connect to the STOMP server: &quot;</span> + err.toString()));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_stomp_server_as_a_bridge_to_the_vert_x_event_bus"><a class="anchor" href="#_using_the_stomp_server_as_a_bridge_to_the_vert_x_event_bus"></a>使用 STOMP 服务器桥接 Vert.x 事件总线</h2>
<div class="sectionbody">
<div class="paragraph">
<p>STOMP 服务器可以桥接 Vert.x 的事件总线。 这种桥接是双向的，这意味着 STOMP 消息
可以被转换为事件总线中的消息，并且事件总线中的消息可以被转化为 STOMP 消息。</p>
</div>
<div class="paragraph">
<p>为了使用桥接， 您需要配置入站和出站地址。 入站地址是指需要转入事件总线的
 STOMP 消息的目的地点。 这些 STOMP 消息的目的地点会被作为事件总线的地址。 出站地址
是指需要被转化为 STOMP 消息的事件总线地址。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx)
        .bridge(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BridgeOptions</span>()
            .addInboundPermitted(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PermittedOptions</span>().setAddress(<span class="hljs-string">&quot;/toBus&quot;</span>))
            .addOutboundPermitted(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PermittedOptions</span>().setAddress(<span class="hljs-string">&quot;/toStomp&quot;</span>))
        )
    )
    .listen();</code></pre>
</div>
</div>
<div class="paragraph">
<p>默认情况下， 桥接使用 发布/订阅 模式发送消息 (topic 模式)。 您也可以配置它使用点对点模式去发送
消息， 这样就只会有一个 STOMP 客户端或事件总线的消费者被调用:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx)
            .bridge(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BridgeOptions</span>()
                    .addInboundPermitted(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PermittedOptions</span>().setAddress(<span class="hljs-string">&quot;/toBus&quot;</span>))
                    .addOutboundPermitted(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PermittedOptions</span>().setAddress(<span class="hljs-string">&quot;/toStomp&quot;</span>))
                    .setPointToPoint(<span class="hljs-literal">true</span>)
            )
    )
    .listen();</code></pre>
</div>
</div>
<div class="paragraph">
<p>出入站的许可字符串可以作为一个 "正则字符串" 或者一个 <em>匹配项</em>。 <em>匹配项</em> 是指
消息体需要满足的特定结构。 以下代码展示了消息体必须拥有字段 "foo" ，并且其
值为 "bar"。 结构匹配当前只支持 Json 数据类型。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx)
        .bridge(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BridgeOptions</span>()
            .addInboundPermitted(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PermittedOptions</span>().setAddress(<span class="hljs-string">&quot;/toBus&quot;</span>)
                .setMatch(<span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonObject</span>().put(<span class="hljs-string">&quot;foo&quot;</span>, <span class="hljs-string">&quot;bar&quot;</span>)))
            .addOutboundPermitted(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PermittedOptions</span>().setAddress(<span class="hljs-string">&quot;/toStomp&quot;</span>))
            .setPointToPoint(<span class="hljs-literal">true</span>)
        )
    )
    .listen();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_stomp_server_with_web_sockets"><a class="anchor" href="#_using_the_stomp_server_with_web_sockets"></a>使用基于 websocket 的 STOMP 服务器</h2>
<div class="sectionbody">
<div class="paragraph">
<p>如果您想使用一个 Javascript 客户端 (在 node.js 或浏览器中) 直接连接 STOMP 服务器, 您可以使用
websocket。 STOMP 协议目前完成了适配，可以基于 websocket 工作，参见
<a href="http://jmesnil.net/stomp-websocket/doc/">StompJS</a> 。 使用 JavaScript 客户端直接连接到 STOMP 服务器并且
使用 websocket 协议发送消息。 这样也可以使用 websocket 接收 STOMP 消息。</p>
</div>
<div class="paragraph">
<p>为了配置服务器使用 StompJS, 您需要：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>使用 websocket 桥接并且配置 websocket 需要监听的路径 (默认为 <code>/stomp</code>)</p>
</li>
<li>
<p>在您的应用中引入 <a href="http://jmesnil.net/stomp-websocket/doc/#download">StompJS</a> (您的应用可以是
HTML 页面上的脚本, 或者一个 node 模块 (<a href="https://www.npmjs.com/package/stompjs" class="bare">https://www.npmjs.com/package/stompjs</a>)</p>
</li>
<li>
<p>连接到服务器</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>为了完成第一步， 您首先需要创建一个 HTTP 服务器, 并且将
<code><a href="../../apidocs/io/vertx/ext/stomp/StompServer.html#webSocketHandler--">webSocketHandler</a></code> 的结果传递给
<code><a href="../../apidocs/io/vertx/core/http/HttpServer.html#webSocketHandler-io.vertx.core.Handler-">webSocketHandler</a></code> 方法:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-type">StompServer</span> <span class="hljs-variable">server</span> <span class="hljs-operator">=</span> StompServer.create(vertx, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StompServerOptions</span>()
    .setPort(-<span class="hljs-number">1</span>) <span class="hljs-comment">// 禁用 tcp 端口，这一项是可选的</span>
    .setWebsocketBridge(<span class="hljs-literal">true</span>) <span class="hljs-comment">// 开启 websocket 支持</span>
    .setWebsocketPath(<span class="hljs-string">&quot;/stomp&quot;</span>)) <span class="hljs-comment">// 配置 websocket 路径，默认是 /stomp</span>
    .handler(StompServerHandler.create(vertx));

Future&lt;HttpServer&gt; http = vertx.createHttpServer(
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpServerOptions</span>().setWebSocketSubProtocols(Arrays.asList(<span class="hljs-string">&quot;v10.stomp&quot;</span>, <span class="hljs-string">&quot;v11.stomp&quot;</span>))
)
    .webSocketHandler(server.webSocketHandler())
    .listen(<span class="hljs-number">8080</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>不要忘了声明要支持的子协议， 否则连接会被拒绝。</p>
</div>
<div class="paragraph">
<p>以下示例代码来自  <a href="http://jmesnil.net/stomp-websocket/doc/">the StompJS documentation</a> ，展示了 STOMP 客户端如何连接
到服务器：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript"><span class="hljs-keyword">var</span> url = <span class="hljs-string">&quot;ws://localhost:8080/stomp&quot;</span>;
<span class="hljs-keyword">var</span> client = <span class="hljs-title class_">Stomp</span>.<span class="hljs-title function_">client</span>(url);
<span class="hljs-keyword">var</span> callback = <span class="hljs-keyword">function</span>(<span class="hljs-params">frame</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(frame);
};

client.<span class="hljs-title function_">connect</span>({}, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
<span class="hljs-keyword">var</span> subscription = client.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&quot;foo&quot;</span>, callback);
});</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_registering_received_and_writing_frame_handlers"><a class="anchor" href="#_registering_received_and_writing_frame_handlers"></a>注册接收消息处理器和写入消息处理器</h2>
<div class="sectionbody">
<div class="paragraph">
<p>STOMP 客户端， 客户端连接和服务端都支持注册一个接收
<code><a href="../../apidocs/io/vertx/ext/stomp/Frame.html">Frame</a></code> 的处理器，该处理器会在每次接收到消息时被调用。 您可以通过
它去打印数据包的日志或实现其他自定义的行为。 该处理器也会在接收 <code>PING</code>
消息, 和其他 <em>非法 / 未知</em> 类型消息时被调用：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx).receivedFrameHandler(sf -&gt; {
      System.out.println(sf.frame());
    }))
    .listen();

<span class="hljs-type">StompClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> StompClient.create(vertx).receivedFrameHandler(frame -&gt; System.out.println(frame));</code></pre>
</div>
</div>
<div class="paragraph">
<p>该处理器是在消息体被处理前调用的，因此可以使用它来 <em>修改</em> 消息体内容</p>
</div>
<div class="paragraph">
<p>使用了不合法的指令的消息会被当做 <code>UNKNOWN</code> 指令类型来处理。 原本的指令值会被写入
首部，其字段为 <code><a href="../../apidocs/io/vertx/ext/stomp/Frame.html#STOMP_FRAME_COMMAND">Frame.STOMP_FRAME_COMMAND</a></code></p>
</div>
<div class="paragraph">
<p>您也可以设置一个处理器，该处理器会在数据包被发送前调用 (写入到网络前):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Future&lt;StompServer&gt; server = StompServer.create(vertx)
    .handler(StompServerHandler.create(vertx))
    .writingFrameHandler(sf -&gt; {
      System.out.println(sf.frame());
    })
    .listen();

<span class="hljs-type">StompClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> StompClient.create(vertx).writingFrameHandler(frame -&gt; {
  System.out.println(frame);
});</code></pre>
</div>
</div>
</div>
</div></div></div></div></div></div><footer class="jsx-aeedcf66895f49d7"><div class="jsx-aeedcf66895f49d7 container"><div class="jsx-aeedcf66895f49d7 footer-nav-section"><div class="jsx-aeedcf66895f49d7 footer-nav-list footer-logo"><a class="jsx-aeedcf66895f49d7" href="/"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 1232.6 315.2&#x27; style=&#x27;enable-background:new 0 0 1232.6 315.2&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23782a91%7d%3c/style%3e%3cpath d=&#x27;M120.9 214.2 190.5 0h52.3l-98.5 273.8H98.2L0 0h52.1l68.8 214.2zm291.2-62.6H299.6v84.2H431v38H252V0h177.7v38.4H299.6V114h112.5v37.6zm83.7-113.2H546c16.5.3 29 4.4 37.3 12.4 8.3 8 12.5 19.4 12.5 34 0 14-4.5 25.1-13.5 33.2-9 8.1-21.6 12.1-37.6 12.1h-27.1v24.2l86.1 119.5h51v-2.4l-77.2-106.7c24.9-5.5 43.3-21.7 52.6-35.9 8.2-12.6 13.3-27.7 13.3-46 0-26.8-8.6-47.4-25.8-61.5C600.5 7.1 576.1 0 544.5 0h-96.3v273.8h47.6&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1052.3 157.7-41.5 62.7 29.7 53.4h85.1z&#x27;/%3e%3ccircle class=&#x27;st0&#x27; cx=&#x27;827.9&#x27; cy=&#x27;274.7&#x27; r=&#x27;40.5&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1037 0-47.6 74.2L949 0h-84l85.3 135.8-67.1 105.7c5.7 9.5 9.1 20.5 9.2 32.4h50.1L1121.3 0H1037z&#x27;/%3e%3cpath d=&#x27;M763.5 273.8c.1-9.9 2.5-19.2 6.6-27.5V38.4h85.4V0H638.2v38.4h84.6v235.4h40.7zm414-266.9h-15.3v42.2h-8.5V6.9h-15.2V0h39v6.9zM1193 0l14.2 37.7L1221.3 0h11v49.1h-8.5V32.9l.8-21.7-14.5 37.9h-6.1l-14.5-37.8.8 21.6v16.2h-8.5V0h11.2z&#x27;/%3e%3c/svg%3e" alt="Vert.x Logo" class="jsx-aeedcf66895f49d7"/></a></div><div class="jsx-aeedcf66895f49d7 footer-nav-list"><h5 class="jsx-aeedcf66895f49d7">Eclipse Vert.x</h5><ul class="jsx-aeedcf66895f49d7 "><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7 navbar-menu-item" href="/docs/">文档</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/download/">下载</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/blog/">博客</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/community/">社区</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/translation/">翻译团队</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://github.com/eclipse-vertx/vert.x" class="jsx-aeedcf66895f49d7">GitHub</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://github.com/vertx-china/vertx-web-site" class="jsx-aeedcf66895f49d7">翻译GitHub</a></li></ul></div><div class="jsx-aeedcf66895f49d7 footer-nav-list"><h5 class="jsx-aeedcf66895f49d7">资源</h5><ul class="jsx-aeedcf66895f49d7 "><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/faq/">答疑</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/channels/">联系渠道</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://how-to.vertx.io/" class="jsx-aeedcf66895f49d7">操作指南</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://start.vertx.io/" class="jsx-aeedcf66895f49d7">应用生成器</a></li><li class="jsx-aeedcf66895f49d7"><a href="/.well-known/security.txt" class="jsx-aeedcf66895f49d7">security.txt</a></li></ul></div><div class="jsx-aeedcf66895f49d7 footer-nav-list"><h5 class="jsx-aeedcf66895f49d7">Eclipse</h5><ul class="jsx-aeedcf66895f49d7 "><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/" class="jsx-aeedcf66895f49d7">Eclipse 基金会</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/privacy.php" class="jsx-aeedcf66895f49d7">隐私政策</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/termsofuse.php" class="jsx-aeedcf66895f49d7">使用条款</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/copyright.php" class="jsx-aeedcf66895f49d7">版权代理</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/" class="jsx-aeedcf66895f49d7">法律资源</a></li></ul></div></div><div class="jsx-aeedcf66895f49d7 footer-copyright"><div class="jsx-aeedcf66895f49d7 footer-copyright-remarks">© <!-- -->2022<!-- --> Eclipse Vert.x™<br class="jsx-aeedcf66895f49d7"/>Eclipse Vert.x™ 是开源的，并在<a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7">Eclipse Public License 2.0</a>和<a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7">Apache License 2.0</a>协议下获得了双重许可。<br class="jsx-aeedcf66895f49d7 footer-copyright-break"/>网站由 <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7">Michel Krämer</a> 设计。</div><div class="jsx-aeedcf66895f49d7 footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 281.3 91.1&#x27; style=&#x27;enable-background:new 0 0 281.3 91.1&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23f79422%7d.st1%7bfill:%233d3c3b%7d%3c/style%3e%3cg id=&#x27;Layer_1_1_&#x27;%3e%3cpath class=&#x27;st0&#x27; d=&#x27;M265.7 84 257 73h-2.7v17.7h3.3v-12l9.3 12h2.1V73h-3.3v11zm-32.4-8.3c4.2 0 5.8 3.3 5.8 6.3s-1.6 6-5.8 6-5.7-3.1-5.8-6 1.7-6.3 5.8-6.3zm0-3c-6.1 0-9.1 4.7-9.1 9.3 0 4.7 2.9 9.1 9.1 9.1s9-4.6 9.1-9.2-3-9.2-9.1-9.2zm-21.2 18V73h-3.3v17.7h3.3zm-23.6 0h3.3V76h5.6v-3h-14.6v3h5.6l.1 14.7zm-18.9-6.5H163l3.3-7.6 3.3 7.6zm2.8 6.5h3.6L168.2 73h-3.6l-8 17.7h3.6l1.5-3.3h9.3l1.4 3.3zm-38-14.6h3.6c3.9 0 5.5 2.8 5.5 5.5.1 2.8-1.5 5.8-5.5 5.8h-3.6V76.1zm3.7-3.1h-6.9v17.7h6.9c6.2 0 8.9-4.5 8.9-9s-2.8-8.7-8.9-8.7zm-22.4 11L107 73h-2.7v17.7h3.3v-12l9.3 12h2.1V73h-3.3v11zM88.2 73v10.2c0 3-1.6 4.9-4.3 4.9s-4.6-1.7-4.6-4.9V73H76v10.1c0 5.3 3.6 7.9 7.9 7.9 4.4 0 7.7-2.7 7.7-7.9V73h-3.4zm-33 2.7c4.2 0 5.8 3.3 5.8 6.3s-1.6 6-5.8 6-5.7-3.1-5.8-6 1.7-6.3 5.8-6.3zm0-3c-6.1 0-9.1 4.7-9.1 9.3s2.9 9.1 9.1 9.1 9-4.6 9.1-9.2-3-9.2-9.1-9.2zm-29.7 18v-6.5h8.9v-3.1h-8.9v-4.8h9.4V73H22.2v17.6h3.3z&#x27;/%3e%3cpath class=&#x27;st1&#x27; d=&#x27;M269.4 54.4h-22.2v-8.9h21.4v-6.9h-21.4v-9.1h22.2v-7.2h-29.6v39.5h29.6v-7.4zm-40-25.6c-3-6.1-9.4-7.8-15.5-7.8-7.3 0-15.3 3.4-15.3 11.5 0 8.9 7.4 11 15.5 12 5.2.6 9.1 2.1 9.1 5.8 0 4.3-4.4 5.9-9.1 5.9s-9.4-1.9-11.1-6.3l-6.2 3.2c2.9 7.2 9.1 9.7 17.2 9.7 8.8 0 16.6-3.8 16.6-12.6 0-9.4-7.7-11.6-15.9-12.6-4.7-.6-8.8-1.5-8.8-5 0-2.9 2.6-5.2 8.2-5.2 4.3 0 8 2.2 9.4 4.4l5.9-3zM176 22.2c-6.2-.1-12.4 0-18.6 0v39.5h7.4V50.1H176c19.4 0 19.4-27.9 0-27.9zm-11.1 7.1H176c9.5 0 9.5 14 0 14h-11.2l.1-14zm-18 32.5V22.2h-7.4v39.5l7.4.1zm-44-39.6v39.5h27.7v-6.9h-20.3V22.2h-7.4zM90.7 51.7c-2.7 2.5-6.2 4-9.9 4-9.8 0-13.5-6.8-13.6-13.4s4.1-13.7 13.6-13.7c3.5-.1 7 1.3 9.5 3.7l5-4.8c-3.8-3.9-9.1-6-14.5-6-14.3 0-21 10.5-20.9 20.8s6.3 20.3 20.9 20.3c5.6.1 11-2 15-5.9l-5.1-5zm-39 2.7H29.5v-8.9h21.4v-6.9H29.5v-9.1h22.2v-7.2H22.2v39.5h29.6l-.1-7.4z&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;M9.8 18.2C18.8 4.1 36.9-.8 52.1 6l-1-.7C35.7-4.6 15.2-.1 5.3 15.3s-5.4 35.9 10 45.8l1.1.6C3.8 50.8.8 32.3 9.8 18.2z&#x27;/%3e%3cpath class=&#x27;st1&#x27; d=&#x27;M272.2 26.1c0-2.5 2.1-4.6 4.6-4.6 2.5 0 4.6 2.1 4.6 4.6 0 2.5-2.1 4.6-4.6 4.6-2.6 0-4.6-2.1-4.6-4.6zm8.6 0c0-2.2-1.8-4.1-4-4.1s-4.1 1.8-4.1 4.1c0 2.2 1.7 4 3.9 4.1h.1c2.3 0 4.1-1.8 4.1-4.1zm-6-2.5h2.3c1.1 0 1.9.5 1.9 1.6 0 .7-.4 1.3-1.1 1.5l1.2 1.7h-1.4l-1-1.5h-.7v1.5h-1.1l-.1-4.8zm2.2 2.3c.5 0 .8-.3.8-.7s-.3-.7-.8-.7h-1v1.3l1 .1z&#x27;/%3e%3c/g%3e%3c/svg%3e" alt="Eclipse foundation Logo" class="jsx-aeedcf66895f49d7"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"4.1.0/vertx-stomp/java","title":"Vert.x-Stomp","fallbackGitHubStars":null,"toc":"\u003cdiv id=\"toc\" class=\"toc\"\u003e\n\u003cdiv id=\"toctitle\"\u003eTable of Contents\u003c/div\u003e\n\u003cul class=\"sectlevel1\"\u003e\n\u003cli\u003e\u003ca href=\"#_using_vertx_stomp\"\u003e使用 vertx-stomp\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_stomp_server\"\u003eSTOMP 服务器\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_creating_a_stomp_server\"\u003e创建 STOMP 服务器\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_closing_a_stomp_server\"\u003e关闭 STOMP 服务器\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_configuration\"\u003e配置服务端\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_subscriptions\"\u003e订阅\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_type_of_destinations\"\u003e消息目的地点类型\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_providing_your_own_type_of_destination\"\u003e提供您自定义的目的地点类型\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_acknowledgment\"\u003e确认消息\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_customizing_the_stomp_server\"\u003e自定义 STOMP 服务器配置\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_stomp_client\"\u003eSTOMP 客户端\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_creating_a_stomp_client\"\u003e创建 STOMP 客户端\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_closing_a_stomp_client\"\u003e关闭 STOMP 客户端\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handling_errors\"\u003e错误处理\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_configuration_2\"\u003e配置客户端\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_subscribing_to_destinations\"\u003e订阅\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_sending_messages\"\u003e发送消息\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_acknowledgements\"\u003e确认消息\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_transactions\"\u003e事务\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_receipt\"\u003e确认消息\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_the_stomp_server_as_a_bridge_to_the_vert_x_event_bus\"\u003e使用 STOMP 服务器桥接 Vert.x 事件总线\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_the_stomp_server_with_web_sockets\"\u003e使用基于 websocket 的 STOMP 服务器\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_registering_received_and_writing_frame_handlers\"\u003e注册接收消息处理器和写入消息处理器\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e","contents":"\u003ch1\u003eVert.x-Stomp\u003c/h1\u003e\n\n\u003cdiv id=\"preamble\"\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSTOMP 即简单(流)文本定向消息。 STOMP\n提供了一种可交互的消息管线，因此 STOMP 客户端可以与任意的 STOMP 消息中介（broker） 通信，并\n基于各种不同的语言，平台与消息中介实现信息的交互和操作。 参阅 \u003ca href=\"https://stomp.github.io/index.html\" class=\"bare\"\u003ehttps://stomp.github.io/index.html\u003c/a\u003e 了解更多关于 STOMP 的信息。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVertx-Stomp 提供了 STOMP 客户端和服务端的实现。 您可以使用其他客户端连接 Vert.x 的 STOMP 服务端，也可以\n使用 Vert.x 的 STOMP 客户端连接其他服务端实现。 Vert.x 提供的服务端和客户端都支持 STOMP 的 1.0，1.1 和 1.2\n版本  (参见 \u003ca href=\"https://stomp.github.io/stomp-specification-1.2.html)。\" class=\"bare\"\u003ehttps://stomp.github.io/stomp-specification-1.2.html)。\u003c/a\u003e 该 STOMP 服务端也可以用于跟\nVert.x 的事件总线桥接, 或者直接与 websocket 客户端建立连接 (使用 StompJS)\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_vertx_stomp\"\u003e\u003ca class=\"anchor\" href=\"#_using_vertx_stomp\"\u003e\u003c/a\u003e使用 vertx-stomp\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e为了使用 Vert.x Stomp 服务端和客户端, 需要将以下依赖项添加到您的项目构建描述文件\n的 \u003cem\u003e依赖配置\u003c/em\u003e 中:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eMaven (在您的 \u003ccode\u003epom.xml\u003c/code\u003e):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-stomp\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e4.1.0\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eGradle (在您的 \u003ccode\u003ebuild.gradle\u003c/code\u003e 文件中):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003ecompile \u003cspan class=\"hljs-string\"\u003e\u0026#x27;io.vertx:vertx-stomp:4.1.0\u0026#x27;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_stomp_server\"\u003e\u003ca class=\"anchor\" href=\"#_stomp_server\"\u003e\u003c/a\u003eSTOMP 服务器\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_creating_a_stomp_server\"\u003e\u003ca class=\"anchor\" href=\"#_creating_a_stomp_server\"\u003e\u003c/a\u003e创建 STOMP 服务器\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e以下是使用默认配置去创建 STOMP 服务器的最简单的方法:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx))\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e这会创建一个符合 STOMP 标准的服务器， 它会监听 \u003ccode\u003elocalhost:61613\u003c/code\u003e 地址\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e您可以使用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServer.html#listen-int-java.lang.String-\"\u003elisten\u003c/a\u003e\u003c/code\u003e 方法\n去配置服务器监听的主机地址和端口:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx))\n    .listen(\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;0.0.0.0\u0026quot;\u003c/span\u003e);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果您设置端口号为 \u003ccode\u003e-1\u003c/code\u003e , TCP 服务器将无法启动。 如果您使用到了 websocket 桥接\n这会很有用。 使用以下方式设置回调处理器，以便在服务器就绪时被调用:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-type\"\u003eStompServer\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003eserver\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx))\n    .listen(ar -\u0026gt; {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.failed()) {\n        System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Failing to start the STOMP server : \u0026quot;\u003c/span\u003e + ar.cause().getMessage());\n      } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Ready to receive STOMP frames\u0026quot;\u003c/span\u003e);\n      }\n    });\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e该回调处理器接收一个类型是 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServer.html\"\u003eStompServer\u003c/a\u003e\u003c/code\u003e 的引用参数\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e您也可以使用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServerOptions.html\"\u003eStompServerOptions\u003c/a\u003e\u003c/code\u003e 配置服务器监听的主机地址和端口:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStompServerOptions\u003c/span\u003e().setPort(\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e).setHost(\u003cspan class=\"hljs-string\"\u003e\u0026quot;0.0.0.0\u0026quot;\u003c/span\u003e))\n    .handler(StompServerHandler.create(vertx))\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_closing_a_stomp_server\"\u003e\u003ca class=\"anchor\" href=\"#_closing_a_stomp_server\"\u003e\u003c/a\u003e关闭 STOMP 服务器\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e使用如下方式关闭 STOMP 服务器:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eserver.close(ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;The STOMP server has been closed\u0026quot;\u003c/span\u003e);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;The STOMP server failed to close : \u0026quot;\u003c/span\u003e + ar.cause().getMessage());\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_configuration\"\u003e\u003ca class=\"anchor\" href=\"#_configuration\"\u003e\u003c/a\u003e配置服务端\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e使用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServerOptions.html\"\u003eStompServerOptions\u003c/a\u003e\u003c/code\u003e 配置 STOMP 服务器的多项参数\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e首先，STOMP 服务器是基于\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/net/NetServer.html\"\u003eNetServer\u003c/a\u003e\u003c/code\u003e 的， 因此您可以在  \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServerOptions.html\"\u003eStompServerOptions\u003c/a\u003e\u003c/code\u003e 中配置\n底层使用的 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/net/NetServer.html\"\u003eNetServer\u003c/a\u003e\u003c/code\u003e。或者您也可以将\n您想要使用的 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/net/NetServer.html\"\u003eNetServer\u003c/a\u003e\u003c/code\u003e 实例作为参数传入:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx, netServer)\n    .handler(StompServerHandler.create(vertx))\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e该配置类 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServerOptions.html\"\u003eStompServerOptions\u003c/a\u003e\u003c/code\u003e 可以让您设置以下选项：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eSTOMP 服务器默认监听的主机地址和端口 - 默认为 \u003ccode\u003e0.0.0.0:61613\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSTOMP 服务器是否使用安全验证 - 默认为 \u003ccode\u003efalse\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSTOMP 协议消息体的最大尺寸限制 - 默认为 10 Mb\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSTOMP 协议消息体的最大首部限制 - 默认为 1000\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSTOMP 协议消息体中首部行长度的最大限制 - 默认为 10240\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSTOMP 协议的心跳时间 - 默认为 \u003ccode\u003e1000, 1000\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e支持的 STOMP 协议版本 (默认为 1.0, 1.1 和 1.2)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSTOMP 协议中事务所支持的最大消息数量 (默认为 1000)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e分块传输的最大尺寸 - 默认为 1000 (参见 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServerOptions.html#setTransactionChunkSize-int-\"\u003esetTransactionChunkSize\u003c/a\u003e\u003c/code\u003e )\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e一个客户端可以使用的最大订阅数量 - 默认为 1000\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如下所示，使用 JsonObject 配置 STOMP 协议的心跳时间：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStompServerOptions\u003c/span\u003e().setHeartbeat(\n    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eJsonObject\u003c/span\u003e().put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;x\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e).put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;y\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e)))\n    .handler(StompServerHandler.create(vertx))\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e要使用安全认证功能，需要提供 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/auth/authentication/AuthenticationProvider.html\"\u003eAuthenticationProvider\u003c/a\u003e\u003c/code\u003e 以处理\n认证请求：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStompServerOptions\u003c/span\u003e().setSecured(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e))\n    .handler(StompServerHandler.create(vertx).authProvider(provider))\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e更多关于 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/auth/authentication/AuthenticationProvider.html\"\u003eAuthenticationProvider\u003c/a\u003e\u003c/code\u003e 的信息请参考\n\u003ca href=\"http://vertx.io/docs/#authentication_and_authorisation\"\u003e此文档\u003c/a\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果一个消息体的大小超过了限制, 那么它会被拒绝接收，并且客户端会收到一个 \u003ccode\u003eERROR\u003c/code\u003e 消息。 按照协议\n要求，在发送这种错误消息后，客户端的连接需要立即关闭。 如果发送的消息不符合其他\n要求的限制，客户端也需要立即关闭。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_subscriptions\"\u003e\u003ca class=\"anchor\" href=\"#_subscriptions\"\u003e\u003c/a\u003e订阅\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e默认的 STOMP 服务器将订阅的目的地点作为普通的字符串处理。 因此它不会对其进行解析\n和分级。 默认的 STOMP 服务器使用 \u003cem\u003etopic\u003c/em\u003e 模式处理订阅 (因此消息会被分发给所有\n对应的订阅客户端)\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_type_of_destinations\"\u003e\u003ca class=\"anchor\" href=\"#_type_of_destinations\"\u003e\u003c/a\u003e消息目的地点类型\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e默认情况下， STOMP 服务器将消息发送的 \u003cem\u003e目的地点\u003c/em\u003e 作为 topic 类型处理。 因此消息会被发送给所有的订阅者。 您可以\n配置 STOMP 服务器将消息发送的目的地作为 queue 类型处理, 或两种模式都支持：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx)\n        .destinationFactory((v, name) -\u0026gt; {\n          \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (name.startsWith(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e)) {\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Destination.queue(vertx, name);\n          } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Destination.topic(vertx, name);\n          }\n        }))\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e在以上代码中， 所有以 \u003ccode\u003e/queue\u003c/code\u003e 开头的目的地点均被作为 queue 类型处理，而其他的目的地点被当作 topic 类型。 目的地点是在 STOMP 服务器\n第一次接收到对应的订阅消息时被创建的\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSTOMP 服务器通过返回 \u003ccode\u003enull\u003c/code\u003e 以拒绝目的地点的创建：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx)\n        .destinationFactory((v, name) -\u0026gt; {\n          \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (name.startsWith(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/forbidden\u0026quot;\u003c/span\u003e)) {\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e;\n          } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (name.startsWith(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e)) {\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Destination.queue(vertx, name);\n          } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Destination.topic(vertx, name);\n          }\n        }))\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e在这种情况下， 订阅客户端会收到一个 \u003ccode\u003eERROR\u003c/code\u003e 消息\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003equeue 类型的目的地点使用轮询调度策略向订阅者分发消息\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_providing_your_own_type_of_destination\"\u003e\u003ca class=\"anchor\" href=\"#_providing_your_own_type_of_destination\"\u003e\u003c/a\u003e提供您自定义的目的地点类型\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x 提供的 STOMP 有意没有实现任何高级特性。 如果您需要更高级的消息分发策略，\n可以提供自定义的 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/DestinationFactory.html\"\u003eDestinationFactory\u003c/a\u003e\u003c/code\u003e 实现\n以返回您自定义的 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/Destination.html\"\u003eDestination\u003c/a\u003e\u003c/code\u003e 实例。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_acknowledgment\"\u003e\u003ca class=\"anchor\" href=\"#_acknowledgment\"\u003e\u003c/a\u003e确认消息\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e默认情况下， STOMP 服务器如果没有收到一个消息的确认消息不会做任何处理。 您可以通过提供您自定义的\n \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/Destination.html\"\u003eDestination\u003c/a\u003e\u003c/code\u003e 以实现对确认消息的处理\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e自定义的目的地点类型应该实现\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServerHandler.html#onAck-io.vertx.ext.stomp.StompServerConnection-io.vertx.ext.stomp.Frame-java.util.List-\"\u003eonAck\u003c/a\u003e\u003c/code\u003e\n和\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServerHandler.html#onNack-io.vertx.ext.stomp.StompServerConnection-io.vertx.ext.stomp.Frame-java.util.List-\"\u003eonNack\u003c/a\u003e\u003c/code\u003e\n方法以供 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServerHandler.html\"\u003eStompServerHandler\u003c/a\u003e\u003c/code\u003e 实现特定行为：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx)\n        .onAckHandler(acknowledgement -\u0026gt; {\n          \u003cspan class=\"hljs-comment\"\u003e// Action to execute when the frames (one in `client-individual` mode, several\u003c/span\u003e\n          \u003cspan class=\"hljs-comment\"\u003e// in `client` mode are acknowledged.\u003c/span\u003e\n        })\n        .onNackHandler(acknowledgement -\u0026gt; {\n          \u003cspan class=\"hljs-comment\"\u003e// Action to execute when the frames (1 in `client-individual` mode, several in\u003c/span\u003e\n          \u003cspan class=\"hljs-comment\"\u003e// `client` mode are not acknowledged.\u003c/span\u003e\n        }))\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_customizing_the_stomp_server\"\u003e\u003ca class=\"anchor\" href=\"#_customizing_the_stomp_server\"\u003e\u003c/a\u003e自定义 STOMP 服务器配置\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e除了上文所述的回调, 您还可以配置 STOMP 服务器的几乎所有配置, 例如收到\n指定消息类型的响应动作, 发送给客户端的 \u003ccode\u003eping\u003c/code\u003e 消息 (为了实现\n心跳)。以下是示例\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx)\n            .closeHandler(connection -\u0026gt; {\n              \u003cspan class=\"hljs-comment\"\u003e// 客户端关闭的回调\u003c/span\u003e\n            })\n            .beginHandler(frame -\u0026gt; {\n              \u003cspan class=\"hljs-comment\"\u003e// 开始传输事务的回调\u003c/span\u003e\n            })\n            .commitHandler(frame -\u0026gt; {\n                  \u003cspan class=\"hljs-comment\"\u003e// 传输事务完成的回调\u003c/span\u003e\n                }\n            )\n        \u003cspan class=\"hljs-comment\"\u003e//...\u003c/span\u003e\n    ).listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e注意，改变默认的实现可能会导致对 STOMP 标准的破坏。 所以请参考\n默认的实现。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_stomp_client\"\u003e\u003ca class=\"anchor\" href=\"#_stomp_client\"\u003e\u003c/a\u003eSTOMP 客户端\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSTOMP 客户端可以连接到 STOMP 服务器并且接受和发送数据。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_creating_a_stomp_client\"\u003e\u003ca class=\"anchor\" href=\"#_creating_a_stomp_client\"\u003e\u003c/a\u003e创建 STOMP 客户端\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e通过以下方式使用默认配置创建 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClient.html\"\u003eStompClient\u003c/a\u003e\u003c/code\u003e 实例：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e以上的代码片段创建了一个客户端连接到 \"0.0.0.0:61613\"。 一旦连接成功, 您就可以获得一个\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClientConnection.html\"\u003eStompClientConnection\u003c/a\u003e\u003c/code\u003e 实例用于和服务端交互。 您可以\n通过以下方式配置客户端的连接地址和端口：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect(\u003cspan class=\"hljs-number\"\u003e61613\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;0.0.0.0\u0026quot;\u003c/span\u003e)\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e为了捕获因为安全认证原因导致的异常， 或其他因为交互时\n产生的异常而返回的错误信息, 您可以提供一个 \u003cem\u003e异常处理器\u003c/em\u003e 给 Stomp 客户端。 所有\n被该 STOMP 客户端创建的连接都会默认继承该异常处理器 (但他们也可以各自单独设置异常处理器)：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .errorFrameHandler(frame -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 接受错误消息\u003c/span\u003e\n  })\n  .connect(\u003cspan class=\"hljs-number\"\u003e61613\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;0.0.0.0\u0026quot;\u003c/span\u003e)\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e您也可以使用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClientOptions.html\"\u003eStompClientOptions\u003c/a\u003e\u003c/code\u003e 来配置 STOMP 客户端的连接地址和端口:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient\n  .create(vertx, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStompClientOptions\u003c/span\u003e().setHost(\u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e).setPort(\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e))\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_closing_a_stomp_client\"\u003e\u003ca class=\"anchor\" href=\"#_closing_a_stomp_client\"\u003e\u003c/a\u003e关闭 STOMP 客户端\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e您可以关闭 STOMP 客户端:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-type\"\u003eStompClient\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003eclient\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e StompClient\n  .create(vertx, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStompClientOptions\u003c/span\u003e().setHost(\u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e).setPort(\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e));\n\nclient\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\n\nclient.close();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e然而, 使用以上方式关闭客户端不会告知 STOMP 服务器断开连接。 为了显式的断开连接， 您应当\n使用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClientConnection.html#disconnect--\"\u003edisconnect\u003c/a\u003e\u003c/code\u003e 方法:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient\n  .create(vertx, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStompClientOptions\u003c/span\u003e().setHost(\u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e).setPort(\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e))\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n    connection.disconnect();\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果您使用了心跳并且 STOMP 客户端在配置的心跳时间内没有检测到服务端的活动， 连接\n会自动关闭\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_handling_errors\"\u003e\u003ca class=\"anchor\" href=\"#_handling_errors\"\u003e\u003c/a\u003e错误处理\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e对于 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClientConnection.html\"\u003eStompClientConnection\u003c/a\u003e\u003c/code\u003e 的实例, 您可以注册一个错误处理器用于接收\n服务端发送的 \u003ccode\u003eERROR\u003c/code\u003e 消息。 注意服务端会在发送该错误消息后关闭连接：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient\n  .create(vertx, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStompClientOptions\u003c/span\u003e().setHost(\u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e).setPort(\u003cspan class=\"hljs-number\"\u003e1234\u003c/span\u003e))\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n    connection\n      .errorHandler(frame -\u0026gt;\n        System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;ERROR frame received : \u0026quot;\u003c/span\u003e + frame));\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果客户端发现当前的连接被丢弃时会收到通知。 STOMP 客户端通过心跳机制\n监视连接是否失效。 当 STOMP 服务器在心跳时间窗口内没有发送心跳, 那么连接会被\n关闭并且 \u003ccode\u003econnectionDroppedHandler\u003c/code\u003e 会被调用 (如果设置了的话)。 为了设置 \u003ccode\u003econnectionDroppedHandler\u003c/code\u003e, 您需要调用\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClientConnection.html#connectionDroppedHandler-io.vertx.core.Handler-\"\u003econnectionDroppedHandler\u003c/a\u003e\u003c/code\u003e 方法。该处理器可以起到\n让该 STOMP 客户端实例重新连接服务器的作用。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n\n    connection.connectionDroppedHandler(con -\u0026gt; {\n      \u003cspan class=\"hljs-comment\"\u003e// 该连接已被丢失\u003c/span\u003e\n      \u003cspan class=\"hljs-comment\"\u003e// 您需要重新建立连接或切换使用另一个连接\u003c/span\u003e\n    });\n\n    connection.send(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, Buffer.buffer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello\u0026quot;\u003c/span\u003e))\n      .onSuccess(frame -\u0026gt; System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Message processed by the server\u0026quot;\u003c/span\u003e)\n      );\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_configuration_2\"\u003e\u003ca class=\"anchor\" href=\"#_configuration_2\"\u003e\u003c/a\u003e配置客户端\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e您可以通过在创建 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClient.html\"\u003eStompClient\u003c/a\u003e\u003c/code\u003e 时传入\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClientOptions.html\"\u003eStompClientOptions\u003c/a\u003e\u003c/code\u003e 以自定义多项配置。 由于\nSTOMP 客户端底层依赖了 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/net/NetClient.html\"\u003eNetClient\u003c/a\u003e\u003c/code\u003e， 因此您可以在 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClientOptions.html\"\u003eStompClientOptions\u003c/a\u003e\u003c/code\u003e 中配置\n底层的 NetClient。 或者您也可以在 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClient.html#connect-io.vertx.core.net.NetClient-io.vertx.core.Handler-\"\u003econnect\u003c/a\u003e\u003c/code\u003e 方法中\n传入一个\n您想使用的 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/net/NetClient.html\"\u003eNetClient\u003c/a\u003e\u003c/code\u003e：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect(netClient)\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n    connection\n      .errorHandler(frame -\u0026gt;\n        System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;ERROR frame received : \u0026quot;\u003c/span\u003e + frame));\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e使用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompClientOptions.html\"\u003eStompClientOptions\u003c/a\u003e\u003c/code\u003e 可以配置：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e连接 STOMP 服务器的地址和端口\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e连接 STOMP 服务器的登录和密码\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e如果没有显式设置 \u003ccode\u003econtent-length\u003c/code\u003e 首部，是否自动添加 (默认开启)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e是否用 \u003ccode\u003eSTOMP\u003c/code\u003e 指令来替换 \u003ccode\u003eCONNECT\u003c/code\u003e 指令 (默认关闭)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e在 \u003ccode\u003eCONNECT\u003c/code\u003e 消息中 \u003ccode\u003ehost\u003c/code\u003e 首部是否被忽略  (默认关闭)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e心跳时间配置 (默认为 1000, 1000)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_subscribing_to_destinations\"\u003e\u003ca class=\"anchor\" href=\"#_subscribing_to_destinations\"\u003e\u003c/a\u003e订阅\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e为了订阅消息的目的地点，使用\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n    connection.subscribe(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, frame -\u0026gt;\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Just received a frame from /queue : \u0026quot;\u003c/span\u003e + frame));\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e为了取消订阅，使用:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 使用连接\u003c/span\u003e\n    connection.subscribe(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, frame -\u0026gt;\n      System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Just received a frame from /queue : \u0026quot;\u003c/span\u003e + frame));\n\n    \u003cspan class=\"hljs-comment\"\u003e// ....\u003c/span\u003e\n\n    connection.unsubscribe(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e);\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_sending_messages\"\u003e\u003ca class=\"anchor\" href=\"#_sending_messages\"\u003e\u003c/a\u003e发送消息\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e为了发送消息，使用:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    Map\u0026lt;String, String\u0026gt; headers = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHashMap\u003c/span\u003e\u0026lt;\u0026gt;();\n    headers.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;header1\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;value1\u0026quot;\u003c/span\u003e);\n    connection.send(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, headers, Buffer.buffer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello\u0026quot;\u003c/span\u003e));\n    \u003cspan class=\"hljs-comment\"\u003e//没有首部:\u003c/span\u003e\n    connection.send(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, Buffer.buffer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;World\u0026quot;\u003c/span\u003e));\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e在 Java 和 Groovy 语言中， 您可以使用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/utils/Headers.html\"\u003eHeaders\u003c/a\u003e\u003c/code\u003e 类用于简化首部的创建\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_acknowledgements\"\u003e\u003ca class=\"anchor\" href=\"#_acknowledgements\"\u003e\u003c/a\u003e确认消息\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSTOMP 客户端可以发送 \u003ccode\u003eACK\u003c/code\u003e 和 \u003ccode\u003eNACK\u003c/code\u003e 消息：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    connection.subscribe(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, frame -\u0026gt; {\n      connection.ack(frame.getAck());\n      \u003cspan class=\"hljs-comment\"\u003e// 或者\u003c/span\u003e\n      connection.nack(frame.getAck());\n    });\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_transactions\"\u003e\u003ca class=\"anchor\" href=\"#_transactions\"\u003e\u003c/a\u003e事务\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSTOMP 客户端也可以创建事务。 \u003ccode\u003eACK\u003c/code\u003e, \u003ccode\u003eNACK\u003c/code\u003e 和 \u003ccode\u003eSEND\u003c/code\u003e 消息只有在事务被提交时才会\n发送。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    Map\u0026lt;String, String\u0026gt; headers = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHashMap\u003c/span\u003e\u0026lt;\u0026gt;();\n    headers.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;transaction\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;my-transaction\u0026quot;\u003c/span\u003e);\n    connection.beginTX(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-transaction\u0026quot;\u003c/span\u003e);\n    connection.send(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, headers, Buffer.buffer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello\u0026quot;\u003c/span\u003e));\n    connection.send(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, headers, Buffer.buffer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;World\u0026quot;\u003c/span\u003e));\n    connection.send(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, headers, Buffer.buffer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;!!!\u0026quot;\u003c/span\u003e));\n    connection.commit(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-transaction\u0026quot;\u003c/span\u003e);\n    \u003cspan class=\"hljs-comment\"\u003e// 或者\u003c/span\u003e\n    connection.abort(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-transaction\u0026quot;\u003c/span\u003e);\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_receipt\"\u003e\u003ca class=\"anchor\" href=\"#_receipt\"\u003e\u003c/a\u003e确认消息\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e每次发送指令可以设置一个 \u003cem\u003e确认\u003c/em\u003e 处理器, 该处理器会在服务端确认处理完消息后被调用：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eStompClient.create(vertx)\n  .connect()\n  .onSuccess(connection -\u0026gt; {\n    connection\n      .send(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/queue\u0026quot;\u003c/span\u003e, Buffer.buffer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello\u0026quot;\u003c/span\u003e))\n      .onSuccess(frame -\u0026gt;\n        System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Message processed by the server\u0026quot;\u003c/span\u003e));\n  })\n  .onFailure(err -\u0026gt;\n    System.out.println(\n      \u003cspan class=\"hljs-string\"\u003e\u0026quot;Failed to connect to the STOMP server: \u0026quot;\u003c/span\u003e + err.toString()));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_the_stomp_server_as_a_bridge_to_the_vert_x_event_bus\"\u003e\u003ca class=\"anchor\" href=\"#_using_the_stomp_server_as_a_bridge_to_the_vert_x_event_bus\"\u003e\u003c/a\u003e使用 STOMP 服务器桥接 Vert.x 事件总线\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSTOMP 服务器可以桥接 Vert.x 的事件总线。 这种桥接是双向的，这意味着 STOMP 消息\n可以被转换为事件总线中的消息，并且事件总线中的消息可以被转化为 STOMP 消息。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e为了使用桥接， 您需要配置入站和出站地址。 入站地址是指需要转入事件总线的\n STOMP 消息的目的地点。 这些 STOMP 消息的目的地点会被作为事件总线的地址。 出站地址\n是指需要被转化为 STOMP 消息的事件总线地址。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx)\n        .bridge(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBridgeOptions\u003c/span\u003e()\n            .addInboundPermitted(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePermittedOptions\u003c/span\u003e().setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/toBus\u0026quot;\u003c/span\u003e))\n            .addOutboundPermitted(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePermittedOptions\u003c/span\u003e().setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/toStomp\u0026quot;\u003c/span\u003e))\n        )\n    )\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e默认情况下， 桥接使用 发布/订阅 模式发送消息 (topic 模式)。 您也可以配置它使用点对点模式去发送\n消息， 这样就只会有一个 STOMP 客户端或事件总线的消费者被调用:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx)\n            .bridge(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBridgeOptions\u003c/span\u003e()\n                    .addInboundPermitted(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePermittedOptions\u003c/span\u003e().setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/toBus\u0026quot;\u003c/span\u003e))\n                    .addOutboundPermitted(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePermittedOptions\u003c/span\u003e().setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/toStomp\u0026quot;\u003c/span\u003e))\n                    .setPointToPoint(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n            )\n    )\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e出入站的许可字符串可以作为一个 \"正则字符串\" 或者一个 \u003cem\u003e匹配项\u003c/em\u003e。 \u003cem\u003e匹配项\u003c/em\u003e 是指\n消息体需要满足的特定结构。 以下代码展示了消息体必须拥有字段 \"foo\" ，并且其\n值为 \"bar\"。 结构匹配当前只支持 Json 数据类型。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx)\n        .bridge(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eBridgeOptions\u003c/span\u003e()\n            .addInboundPermitted(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePermittedOptions\u003c/span\u003e().setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/toBus\u0026quot;\u003c/span\u003e)\n                .setMatch(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eJsonObject\u003c/span\u003e().put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;foo\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;bar\u0026quot;\u003c/span\u003e)))\n            .addOutboundPermitted(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003ePermittedOptions\u003c/span\u003e().setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/toStomp\u0026quot;\u003c/span\u003e))\n            .setPointToPoint(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n        )\n    )\n    .listen();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_the_stomp_server_with_web_sockets\"\u003e\u003ca class=\"anchor\" href=\"#_using_the_stomp_server_with_web_sockets\"\u003e\u003c/a\u003e使用基于 websocket 的 STOMP 服务器\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果您想使用一个 Javascript 客户端 (在 node.js 或浏览器中) 直接连接 STOMP 服务器, 您可以使用\nwebsocket。 STOMP 协议目前完成了适配，可以基于 websocket 工作，参见\n\u003ca href=\"http://jmesnil.net/stomp-websocket/doc/\"\u003eStompJS\u003c/a\u003e 。 使用 JavaScript 客户端直接连接到 STOMP 服务器并且\n使用 websocket 协议发送消息。 这样也可以使用 websocket 接收 STOMP 消息。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e为了配置服务器使用 StompJS, 您需要：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"olist arabic\"\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\n\u003cp\u003e使用 websocket 桥接并且配置 websocket 需要监听的路径 (默认为 \u003ccode\u003e/stomp\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e在您的应用中引入 \u003ca href=\"http://jmesnil.net/stomp-websocket/doc/#download\"\u003eStompJS\u003c/a\u003e (您的应用可以是\nHTML 页面上的脚本, 或者一个 node 模块 (\u003ca href=\"https://www.npmjs.com/package/stompjs\" class=\"bare\"\u003ehttps://www.npmjs.com/package/stompjs\u003c/a\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e连接到服务器\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e为了完成第一步， 您首先需要创建一个 HTTP 服务器, 并且将\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/StompServer.html#webSocketHandler--\"\u003ewebSocketHandler\u003c/a\u003e\u003c/code\u003e 的结果传递给\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/http/HttpServer.html#webSocketHandler-io.vertx.core.Handler-\"\u003ewebSocketHandler\u003c/a\u003e\u003c/code\u003e 方法:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-type\"\u003eStompServer\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003eserver\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e StompServer.create(vertx, \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eStompServerOptions\u003c/span\u003e()\n    .setPort(-\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e// 禁用 tcp 端口，这一项是可选的\u003c/span\u003e\n    .setWebsocketBridge(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e) \u003cspan class=\"hljs-comment\"\u003e// 开启 websocket 支持\u003c/span\u003e\n    .setWebsocketPath(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/stomp\u0026quot;\u003c/span\u003e)) \u003cspan class=\"hljs-comment\"\u003e// 配置 websocket 路径，默认是 /stomp\u003c/span\u003e\n    .handler(StompServerHandler.create(vertx));\n\nFuture\u0026lt;HttpServer\u0026gt; http = vertx.createHttpServer(\n    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHttpServerOptions\u003c/span\u003e().setWebSocketSubProtocols(Arrays.asList(\u003cspan class=\"hljs-string\"\u003e\u0026quot;v10.stomp\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;v11.stomp\u0026quot;\u003c/span\u003e))\n)\n    .webSocketHandler(server.webSocketHandler())\n    .listen(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e不要忘了声明要支持的子协议， 否则连接会被拒绝。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e以下示例代码来自  \u003ca href=\"http://jmesnil.net/stomp-websocket/doc/\"\u003ethe StompJS documentation\u003c/a\u003e ，展示了 STOMP 客户端如何连接\n到服务器：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e url = \u003cspan class=\"hljs-string\"\u003e\u0026quot;ws://localhost:8080/stomp\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e client = \u003cspan class=\"hljs-title class_\"\u003eStomp\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eclient\u003c/span\u003e(url);\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e callback = \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eframe\u003c/span\u003e) {\n  \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(frame);\n};\n\nclient.\u003cspan class=\"hljs-title function_\"\u003econnect\u003c/span\u003e({}, \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) {\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e subscription = client.\u003cspan class=\"hljs-title function_\"\u003esubscribe\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;foo\u0026quot;\u003c/span\u003e, callback);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_registering_received_and_writing_frame_handlers\"\u003e\u003ca class=\"anchor\" href=\"#_registering_received_and_writing_frame_handlers\"\u003e\u003c/a\u003e注册接收消息处理器和写入消息处理器\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSTOMP 客户端， 客户端连接和服务端都支持注册一个接收\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/Frame.html\"\u003eFrame\u003c/a\u003e\u003c/code\u003e 的处理器，该处理器会在每次接收到消息时被调用。 您可以通过\n它去打印数据包的日志或实现其他自定义的行为。 该处理器也会在接收 \u003ccode\u003ePING\u003c/code\u003e\n消息, 和其他 \u003cem\u003e非法 / 未知\u003c/em\u003e 类型消息时被调用：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx).receivedFrameHandler(sf -\u0026gt; {\n      System.out.println(sf.frame());\n    }))\n    .listen();\n\n\u003cspan class=\"hljs-type\"\u003eStompClient\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003eclient\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e StompClient.create(vertx).receivedFrameHandler(frame -\u0026gt; System.out.println(frame));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e该处理器是在消息体被处理前调用的，因此可以使用它来 \u003cem\u003e修改\u003c/em\u003e 消息体内容\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e使用了不合法的指令的消息会被当做 \u003ccode\u003eUNKNOWN\u003c/code\u003e 指令类型来处理。 原本的指令值会被写入\n首部，其字段为 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/stomp/Frame.html#STOMP_FRAME_COMMAND\"\u003eFrame.STOMP_FRAME_COMMAND\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e您也可以设置一个处理器，该处理器会在数据包被发送前调用 (写入到网络前):\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eFuture\u0026lt;StompServer\u0026gt; server = StompServer.create(vertx)\n    .handler(StompServerHandler.create(vertx))\n    .writingFrameHandler(sf -\u0026gt; {\n      System.out.println(sf.frame());\n    })\n    .listen();\n\n\u003cspan class=\"hljs-type\"\u003eStompClient\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003eclient\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e=\u003c/span\u003e StompClient.create(vertx).writingFrameHandler(frame -\u0026gt; {\n  System.out.println(frame);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e","version":"4.1.0"},"__N_SSG":true},"page":"/docs/[[...slug]]","query":{"slug":["4.1.0","vertx-stomp","java"]},"buildId":"DxYj1qG9XZR4Q5BZwOJ88","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>