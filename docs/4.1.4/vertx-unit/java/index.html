<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><link rel="alternate" type="application/rss+xml" href="/feed/rss.xml"/><link rel="alternate" type="application/atom+xml" href="/feed/atom.xml"/><link rel="alternate" type="application/json" href="/feed/feed.json"/><title>Vert.x 单元测试 | Eclipse Vert.x</title><link rel="preload" href="https://api.github.com/repos/vert-x3/vertx-unit" as="fetch" crossorigin="anonymous" class="jsx-d38685edc31911e0"/><meta name="next-head-count" content="14"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-f635b472c367d1c7.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d7fe1c01d653763a.js" defer=""></script><script src="/_next/static/chunks/615-af27e2775b51966c.js" defer=""></script><script src="/_next/static/chunks/619-afdae842ceadd4b2.js" defer=""></script><script src="/_next/static/chunks/81-19fda51682297a85.js" defer=""></script><script src="/_next/static/chunks/536-a9af9dadd93f0749.js" defer=""></script><script src="/_next/static/chunks/434-02978711e0879a69.js" defer=""></script><script src="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-810f1ca9040e790a.js" defer=""></script><script src="/_next/static/sTF7RnW1bBFtb3eCJ3RUK/_buildManifest.js" defer=""></script><script src="/_next/static/sTF7RnW1bBFtb3eCJ3RUK/_ssgManifest.js" defer=""></script><script src="/_next/static/sTF7RnW1bBFtb3eCJ3RUK/_middlewareManifest.js" defer=""></script><style id="__jsx-400ec7965926e858">.dropdown-item.jsx-400ec7965926e858{white-space:nowrap;
line-height:2;
width:100%;
padding:0 1.5rem;
cursor:pointer}
.dropdown-item.jsx-400ec7965926e858:hover{background-color:#e9ecef}
.dropdown-item.active.jsx-400ec7965926e858{font-weight:400;
padding-left:.75rem}
.dropdown-item.has-active-siblings.jsx-400ec7965926e858:not(.active){padding-left:calc(0.75rem + 16px + 0.5em)}
.dropdown-item.jsx-400ec7965926e858 .dropdown-check-icon.jsx-400ec7965926e858{width:16px;
margin-right:.5em;
margin-top:1px}</style><style id="__jsx-6650573c8f14945d">.dropdown.jsx-6650573c8f14945d{position:relative;
display:inline-block}
.dropdown.jsx-6650573c8f14945d .dropdown-title.jsx-6650573c8f14945d{margin-right:0;
cursor:pointer;
-webkit-user-select:none;
-moz-user-select:none;
-ms-user-select:none;
user-select:none}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.jsx-6650573c8f14945d{position:absolute;
background-color:#f8f9fa;
box-shadow:0 2px 5px 0 rgba(0, 0, 0, .1);
border-radius:.8rem;
list-style-type:none;
padding:.6666666667rem 0;
margin:.25rem 0 0 0;
z-index:100;
display:none;
-webkit-user-select:none;
-moz-user-select:none;
-ms-user-select:none;
user-select:none}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.jsx-6650573c8f14945d a{color:#4d4d4d;
-webkit-text-decoration:none;
text-decoration:none;
font-weight:300}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.align-right.jsx-6650573c8f14945d{right:0}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.visible.jsx-6650573c8f14945d{display:block}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.jsx-6650573c8f14945d a.jsx-6650573c8f14945d:hover{color:inherit}
.dropdown.jsx-6650573c8f14945d svg{margin-bottom:2px}</style><style id="__jsx-f705e145f931f504">.navbar{position:absolute;
top:2.75rem;
width:100%}
.navbar a{color:#3c3c3b}
.navbar a.navbar-menu-item, .navbar .dropdown-title{text-transform:uppercase}
.navbar a.navbar-menu-item:hover, .navbar .dropdown-title:hover{-webkit-text-decoration:none;
text-decoration:none;
color:#898987;
-webkit-transition:color .15s ease-in-out;
transition:color .15s ease-in-out}
.navbar .navbar-content{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
position:relative}
.navbar .navbar-content .navbar-logo{-webkit-flex:1;
-ms-flex:1;
flex:1}
.navbar .navbar-content .navbar-logo img{width:8.3rem}
.navbar .navbar-content .navbar-collapse-button{display:none;
cursor:pointer}
@media (max-width:1000px) {.navbar .navbar-content .navbar-collapse-button{display:inline-block}}
.navbar .navbar-content .navbar-collapse-button span{display:block;
width:33px;
height:4px;
margin-bottom:5px;
position:relative;
background:#3c3c3b;
border-radius:3px;
z-index:1;
transform-origin:4px 0;
-webkit-transition:-webkit-transform .5s cubic-bezier(0.77, 0.2, 0.05, 1), background .5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity .55s ease;
transition:transform .5s cubic-bezier(0.77, 0.2, 0.05, 1), background .5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity .55s ease}
.navbar .navbar-content .navbar-collapse-button span:first-child{transform-origin:0% 0%}
.navbar .navbar-content .navbar-collapse-button span:nth-last-child(2){transform-origin:0% 100%}
.navbar .navbar-content .navbar-right{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-align-items:baseline;
-webkit-box-align:baseline;
-ms-flex-align:baseline;
align-items:baseline;
margin-bottom:10px}
@media (max-width:1000px) {.navbar .navbar-content .navbar-right{max-height:0;
-webkit-transition:max-height 200ms ease-in-out;
transition:max-height 200ms ease-in-out;
box-shadow:0 2px 5px 0 rgba(0, 0, 0, .1);
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
position:absolute;
top:2.75rem;
left:.8rem;
right:.8rem;
background-color:#f8f9fa;
overflow-x:auto;
overflow-y:hidden}}
.navbar .navbar-content .navbar-menu .navbar-menu-item{font-weight:400;
margin-right:2.5rem}
.navbar .navbar-content .navbar-menu .navbar-menu-item.with-drop-down{margin-right:1.8rem}
@media (max-width:1250px) {.navbar .navbar-content .navbar-menu .navbar-menu-item{margin-right:1.5rem}}
@media (max-width:1000px) {.navbar .navbar-content .navbar-menu .navbar-menu-item{display:block;
margin-bottom:1rem;
font-size:1.2rem}}
.navbar .navbar-content .navbar-menu .navbar-menu-item .external-link-icon{margin-left:.25em}
@media (max-width:1000px) {.navbar .navbar-content .navbar-menu{-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
padding:1rem}}
.navbar .navbar-content .navbar-social{margin-left:1.6rem;
font-size:.875rem}
.navbar .navbar-content .navbar-social svg{height:16px;
margin-bottom:2px}
@media (max-width:1000px) {.navbar .navbar-content .navbar-social svg{height:1rem}}
@media (max-width:1250px) {.navbar .navbar-content .navbar-social{margin-left:1rem}}
@media (max-width:1000px) {.navbar .navbar-content .navbar-social{margin-left:auto;
padding:0 1rem 1rem 0;
font-size:1rem}}
@media (max-width:768px) {.navbar{top:1rem}}
.page .navbar{top:0;
padding-top:1.5rem;
padding-bottom:1rem;
position:fixed;
background-color:#fff;
z-index:2}</style><style id="__jsx-20d862052e50feff">.search input{color:#adb5bd;
border:1px solid #dee2e6;
border-radius:.4rem;
font-size:.875rem;
padding:.25rem 1.8rem .35rem 1.8rem;
width:100%;
-webkit-transition:color .15s ease-in-out, border-color .15s ease-in-out;
transition:color .15s ease-in-out, border-color .15s ease-in-out}
.search input:focus{border-color:#adb5bd;
color:#3c3c3b}
.search .search-icon, .search .search-icon-delete{position:absolute;
top:.55rem;
height:1rem;
stroke:#adb5bd;
-webkit-transition:stroke .15s ease-in-out;
transition:stroke .15s ease-in-out}
.search .search-icon{left:.4rem}
.search input:focus+.search-icon{stroke:#6f6970}
.search .search-icon-delete{stroke:#6f6970;
right:.4rem;
height:.75rem;
top:.7rem;
opacity:0;
-webkit-transition:opacity .15s ease-in-out;
transition:opacity .15s ease-in-out;
cursor:text}
.search.has-content .search-icon-delete{opacity:1;
cursor:pointer}</style><style id="__jsx-117e429f22e394dc">.search-results, .search-results-none{font-size:.875rem;
overflow:auto;
list-style-type:none;
padding-left:0;
display:none}
.search-results.visible, .search-results-none.visible{display:block}
.search-results{list-style-type:none;
padding:0;
margin-bottom:0}
.search-results li{display:block;
padding:.5rem;
margin-bottom:1rem;
border-radius:.4rem;
border:1px solid transparent;
cursor:pointer}
.search-results li.active{background-color:#f8f9fa;
border:1px solid #e9ecef}
.search-results li h5{margin:0 0 .5rem 0;
font-size:1em}
.search-results li .search-results-highlight{background-color:#ff0}
.search-results-none{padding:1rem .5rem;
text-align:center;
width:100%}</style><style id="__jsx-d1843944f2d67b">.search-panel{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
position:relative}</style><style id="__jsx-d38685edc31911e0">.github-stars.jsx-d38685edc31911e0{display:inline-block}
.github-stars.jsx-d38685edc31911e0 .icon.jsx-d38685edc31911e0{margin-right:.25em}
.github-stars.jsx-d38685edc31911e0 .icon.jsx-d38685edc31911e0 svg{height:1rem}</style><style id="__jsx-aeedcf66895f49d7">footer{font-size:.875rem;
padding-top:3rem;
padding-bottom:4rem;
background-color:#f8f9fa;
border-top:1px solid #dee2e6;
margin-top:1rem;
color:#6f6970}
footer h5{font-size:1rem;
margin-top:0;
margin-bottom:1rem;
color:#3c3c3b;
text-transform:uppercase}
footer ul{padding:0;
list-style:none;
line-height:2}
footer a{color:#6f6970}
footer .footer-logo img, footer .footer-copyright-eclipse-logo img{-webkit-filter:grayscale(100);
filter:grayscale(100);
opacity:.5;
-webkit-transition:all .15s ease-in-out;
transition:all .15s ease-in-out}
footer .footer-logo img:hover, footer .footer-copyright-eclipse-logo img:hover{-webkit-filter:grayscale(0);
filter:grayscale(0);
opacity:1}
footer .footer-nav-section{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
margin-bottom:6rem}
footer .footer-nav-section .footer-logo{margin-top:.4rem}
footer .footer-nav-section .footer-logo img{width:8.3rem}
footer .footer-nav-section .footer-nav-list{width:20%}
footer .footer-copyright{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-box-pack:justify;
-webkit-justify-content:space-between;
justify-content:space-between;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center}
footer .footer-copyright a{white-space:nowrap}
footer .footer-copyright .footer-copyright-eclipse-logo{width:17%;
margin-bottom:.5rem}
@media (max-width:1250px) {footer .footer-copyright .footer-copyright-break{display:none}
footer .footer-copyright .footer-copyright-eclipse-logo{width:30%}}
@media (max-width:1000px) {footer .footer-nav-section .footer-nav-list{width:25%}
footer .footer-copyright .footer-copyright-break{display:inline-block}
footer .footer-copyright .footer-copyright-eclipse-logo{width:40%}}
@media (max-width:768px) {footer .footer-nav-section{max-width:100%;
margin-left:auto;
margin-right:auto}}
@media (max-width:640px) {footer .footer-nav-section{max-width:80%;
margin-bottom:3rem;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column}
footer .footer-nav-section h5{cursor:pointer}
footer .footer-nav-section h5::after{display:inline-block;
content:"";
border-top:.4em solid;
border-right:.4em solid transparent;
border-bottom:0;
border-left:.4em solid transparent;
position:absolute;
top:.75rem;
right:0}
footer .footer-nav-section .footer-nav-list{width:100%;
position:relative}
footer .footer-nav-section .footer-nav-list ul{overflow-y:hidden;
max-height:0;
-webkit-transition:all 200ms ease-in-out;
transition:all 200ms ease-in-out}
footer .footer-nav-section .footer-nav-list ul.visible{margin-bottom:2rem}
footer .footer-nav-section .footer-logo{margin:0 auto 3rem auto;
width:auto}
footer .footer-copyright{max-width:80%;
text-align:center;
margin-left:auto;
margin-right:auto;
-webkit-flex-direction:column-reverse;
-ms-flex-direction:column-reverse;
flex-direction:column-reverse}
footer .footer-copyright .footer-copyright-eclipse-logo{width:7.6rem;
margin-bottom:1rem}}</style><style id="__jsx-efcc50be384cabc7">.page-content{margin-top:6em;
margin-bottom:8rem}
.docs .docs-content .docs-content-wrapper{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-box-pack:justify;
-webkit-justify-content:space-between;
justify-content:space-between}
.docs .docs-content .docs-content-wrapper aside{-webkit-flex:0 0 17rem;
-ms-flex:0 0 17rem;
flex:0 0 17rem}
.docs .docs-content .docs-content-wrapper aside .docs-content-wrapper-sidebar{position:-webkit-sticky;
position:sticky;
top:7em}
.docs .docs-content .docs-content-wrapper aside .search-panel{margin-top:1rem;
width:100%}
.docs .docs-content .docs-content-wrapper aside .search-panel .search-results{max-height:calc(100vh - 10rem - 1px)}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc{margin-top:1rem;
overflow-y:auto;
max-height:calc(100vh - 10rem - 3px)}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc #toctitle{display:none}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc ul{margin-top:0;
padding-left:0;
list-style-type:none}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc ul.sectlevel2{display:none}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc ul li{padding:.3333333333rem 0}
.docs .docs-content .docs-content-wrapper aside.docs-has-search-results .docs-content-toc{display:none}
@media (max-width:1250px) {.docs .docs-content .docs-content-wrapper aside{-webkit-flex:0 0 15rem;
-ms-flex:0 0 15rem;
flex:0 0 15rem}}
@media (max-width:1000px) {.docs .docs-content .docs-content-wrapper aside{z-index:1;
position:fixed;
top:0;
right:0;
width:25rem;
height:100vh;
max-width:100%;
padding-top:6rem;
padding-left:2rem;
padding-right:2rem;
background-color:#fff;
border-left:1px solid #dee2e6;
-webkit-transform:translateX(100%);
-moz-transform:translateX(100%);
-ms-transform:translateX(100%);
transform:translateX(100%);
-webkit-transition:-webkit-transform 200ms ease-in-out;
transition:transform 200ms ease-in-out;
will-change:transform}
.docs .docs-content .docs-content-wrapper aside.collapse{-webkit-transform:translateX(0%);
-moz-transform:translateX(0%);
-ms-transform:translateX(0%);
transform:translateX(0%)}}
@media (max-width:640px) {.docs .docs-content .docs-content-wrapper aside{min-width:100%;
border-left:none}}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle{z-index:1000;
cursor:pointer;
display:none;
position:fixed;
-webkit-justify-content:center;
justify-content:center;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
right:2rem;
bottom:2rem;
color:#fff;
background-color:#4d4d4d;
padding:.5rem;
border-radius:.8rem;
-webkit-transition:background-color .15s ease-in-out;
transition:background-color .15s ease-in-out}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle .feather-list, .docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle .feather-x{display:block}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle .feather-x{position:absolute;
left:0;
top:0;
opacity:0;
-webkit-transition:opacity .15s ease-in-out;
transition:opacity .15s ease-in-out}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle:hover{background-color:#3c3c3b}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle.collapse .feather-list{opacity:0}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle.collapse .feather-x{opacity:1}
@media (max-width:1000px) {.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}}
@media (max-width:640px) {.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle{right:1rem;
bottom:1rem}}
.docs .docs-content .docs-content-inner{max-width:calc(100% - 19.5rem);
overflow:hidden}
.docs .docs-content .docs-content-inner .docs-content-metadata{margin-top:1.2rem;
margin-bottom:1.2rem;
display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
flex-wrap:wrap;
-webkit-align-items:baseline;
-webkit-box-align:baseline;
-ms-flex-align:baseline;
align-items:baseline}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata{-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-repo{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
-webkit-flex:1;
-ms-flex:1;
flex:1}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left>*{margin-right:2rem}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left>*:last-child{margin-right:0}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left a{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
color:#6f6970;
white-space:nowrap}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left a:hover{color:#782b90}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left a .feather{margin-right:.25em;
height:1rem}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left{flex-wrap:wrap;
margin-bottom:1rem}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version{-webkit-flex:1;
-ms-flex:1;
flex:1;
display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}
@media (min-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version{-webkit-box-pack:end;
-ms-flex-pack:end;
-webkit-justify-content:flex-end;
justify-content:flex-end}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version svg{height:16px;
margin-bottom:-2px}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version svg{height:1rem;
margin-bottom:-1px}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version .dropdown-menu a{-webkit-text-decoration:none;
text-decoration:none}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version .dropdown-menu a:hover{color:#6f6970}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-label{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
margin-left:2rem}
.docs .docs-content .docs-content-inner h1{padding-top:0;
margin-top:.6rem;
line-height:1.2}
.docs .docs-content .docs-content-inner h1::after{content:"";
width:30%;
display:block;
border:2px solid #782b90;
border-radius:2px;
margin-top:1.1rem}
.docs .docs-content .docs-content-inner .ulist>ul{padding-left:1.1rem}
.docs .docs-content .docs-content-inner h2{border-top:1px solid #dee2e6;
margin-top:5rem;
padding-top:2rem}
.docs .docs-content .docs-content-inner h3, .docs .docs-content .docs-content-inner h4{margin-top:3rem}
@media (max-width:1250px) {.docs .docs-content .docs-content-inner{max-width:calc(100% - 17.5rem)}}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner{max-width:100%}}
.docs .docs-content .admonitionblock{border-top-right-radius:.8rem;
border-bottom-right-radius:.8rem;
background-color:#f8f9fa;
padding:1rem;
margin:1.5rem 0;
border-left:9px solid transparent}
.docs .docs-content .admonitionblock.note, .docs .docs-content .admonitionblock.tip{border-color:#6cb9f0}
.docs .docs-content .admonitionblock.important, .docs .docs-content .admonitionblock.warning, .docs .docs-content .admonitionblock.caution{border-color:#f0a46c}
.docs .docs-content .admonitionblock tr{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column}
.docs .docs-content .admonitionblock .title{font-weight:400}
.docs .docs-content .admonitionblock .title::after{content:":"}
.docs .docs-content dt{font-weight:400}
.docs .docs-content .anchor{opacity:0;
-webkit-align-self:flex-start;
-ms-flex-item-align:flex-start;
align-self:flex-start;
outline:none}
.docs .docs-content .anchor::after{content:"#";
position:absolute;
margin-left:-1.5rem;
color:#ced4da;
padding-right:.45rem}
.docs .docs-content .anchor:hover{opacity:1}
.docs .docs-content h2:hover .anchor, .docs .docs-content h3:hover .anchor, .docs .docs-content h4:hover .anchor, .docs .docs-content h5:hover .anchor, .docs .docs-content h6:hover .anchor{opacity:1}
.docs .docs-content h1 .anchor{display:none}
.docs .docs-content h4 .anchor::after, .docs .docs-content h5 .anchor::after, .docs .docs-content h6 .anchor::after{padding-right:.6rem}</style><style id="__jsx-7824b3ad3820c879">html{line-height:1.15;
-webkit-text-size-adjust:100%}
body{margin:0}
main{display:block}
h1{font-size:2em;
margin:.67em 0}
hr{box-sizing:content-box;
height:0;
overflow:visible}
pre{font-family:monospace, monospace;
font-size:1em}
a{background-color:transparent}
abbr[title]{border-bottom:none;
text-decoration:underline;
text-decoration:underline dotted}
b, strong{font-weight:bolder}
code, kbd, samp{font-family:monospace, monospace;
font-size:1em}
small{font-size:80%}
sub, sup{font-size:75%;
line-height:0;
position:relative;
vertical-align:baseline}
sub{bottom:-0.25em}
sup{top:-0.5em}
img{border-style:none}
button, input, optgroup, select, textarea{font-family:inherit;
font-size:100%;
line-height:1.15;
margin:0}
button, input{overflow:visible}
button, select{text-transform:none}
button, [type=button], [type=reset], [type=submit]{-webkit-appearance:button}
button::-moz-focus-inner, [type=button]::-moz-focus-inner, [type=reset]::-moz-focus-inner, [type=submit]::-moz-focus-inner{border-style:none;
padding:0}
button:-moz-focusring, [type=button]:-moz-focusring, [type=reset]:-moz-focusring, [type=submit]:-moz-focusring{outline:1px dotted ButtonText}
fieldset{padding:.35em .75em .625em}
legend{box-sizing:border-box;
color:inherit;
display:table;
max-width:100%;
padding:0;
white-space:normal}
progress{vertical-align:baseline}
textarea{overflow:auto}
[type=checkbox], [type=radio]{box-sizing:border-box;
padding:0}
[type=number]::-webkit-inner-spin-button, [type=number]::-webkit-outer-spin-button{height:auto}
[type=search]{-webkit-appearance:textfield;
outline-offset:-2px}
[type=search]::-webkit-search-decoration{-webkit-appearance:none}
::-webkit-file-upload-button{-webkit-appearance:button;
font:inherit}
details{display:block}
summary{display:list-item}
template{display:none}
[hidden]{display:none}
.hljs, pre{display:block;
overflow-x:auto;
padding:.5em;
background:#3a2840;
color:#fff}
.hljs.language-shell :not(.bash)+.bash, .hljs.language-better-shell :not(.bash)+.bash, pre.language-shell :not(.bash)+.bash, pre.language-better-shell :not(.bash)+.bash{color:#d2a8e0}
pre{border-radius:.8rem;
padding:1rem;
font-size:.875rem;
margin:1.5rem 0}
.hljs-keyword, .hljs-selector-tag, .hljs-tag{color:#d2a8e0}
.hljs-template-tag{color:red}
.hljs-number{color:#6cb9f0}
.hljs-variable, .hljs-template-variable, .hljs-attribute, .hljs-literal{color:#c9e5f9}
.hljs-subst{color:red}
.hljs-title, .hljs-name, .hljs-selector-id, .hljs-selector-class, .hljs-section, .hljs-type{color:#f0a46c}
.hljs-symbol, .hljs-bullet, .hljs-link{color:#d2a8e0}
.hljs-deletion, .hljs-string, .hljs-built_in, .hljs-builtin-name{color:#6cb9f0}
.hljs-addition, .hljs-comment, .hljs-quote, .hljs-meta{color:#adb5bd}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:bold}
#nprogress{pointer-events:none}
#nprogress .bar{background:#29d;
position:fixed;
z-index:1031;
top:0;
left:0;
width:100%;
height:2px}
#nprogress .peg{display:block;
position:absolute;
right:0px;
width:100px;
height:100%;
box-shadow:0 0 10px #29d, 0 0 5px #29d;
opacity:1;
-webkit-transform:rotate(3deg) translate(0px, -4px);
-ms-transform:rotate(3deg) translate(0px, -4px);
-webkit-transform:rotate(3deg) translate(0px, -4px);
-moz-transform:rotate(3deg) translate(0px, -4px);
-ms-transform:rotate(3deg) translate(0px, -4px);
transform:rotate(3deg) translate(0px, -4px)}
#nprogress .spinner{display:block;
position:fixed;
z-index:1031;
top:15px;
right:15px}
#nprogress .spinner-icon{width:18px;
height:18px;
box-sizing:border-box;
border:solid 2px transparent;
border-top-color:#29d;
border-left-color:#29d;
border-radius:50%;
-webkit-animation:nprogress-spinner 400ms linear infinite;
-webkit-animation:nprogress-spinner 400ms linear infinite;
animation:nprogress-spinner 400ms linear infinite}
.nprogress-custom-parent{overflow:hidden;
position:relative}
.nprogress-custom-parent #nprogress .spinner, .nprogress-custom-parent #nprogress .bar{position:absolute}
@keyframes nprogress-spinner {0% {-webkit-transform:rotate(0deg)}100% {-webkit-transform:rotate(360deg)}}
@keyframes nprogress-spinner {0% {transform:rotate(0deg)}100% {transform:rotate(360deg)}}
#nprogress .bar{background:#782b90}
#nprogress .peg{box-shadow:0 0 10px #782b90, 0 0 5px #782b90}
#nprogress .spinner-icon{border-top-color:#782b90;
border-left-color:#782b90}
html{box-sizing:border-box}
*, *::before, *::after{box-sizing:inherit}
:root{font-size:18px}
@media (max-width:1000px) {:root{font-size:17.1px}}
@media (max-width:768px) {:root{font-size:16.2px}}
@media (max-width:640px) {:root{font-size:15.3px}}
body, input{font-family:Roboto, sans-serif;
font-weight:300;
line-height:1.7;
color:#3c3c3b}
input{outline:none}
h1, h2, h3, h4, h5, h6{font-weight:400}
h1{font-size:2.5rem}
h2{font-size:2rem}
h3{font-size:1.75rem}
h4{font-size:1.5rem}
h5{font-size:1.25rem}
h6{font-size:1.1rem}
.container{width:100%;
padding-right:.8rem;
padding-left:.8rem;
margin-right:auto;
margin-left:auto}
@media (min-width:640px) {.container{max-width:620px}}
@media (min-width:768px) {.container{max-width:738px}}
@media (min-width:1000px) {.container{max-width:950px}}
@media (min-width:1250px) {.container{max-width:1180px}}
@media (min-width:1250px) {.container-narrow{max-width:950px}}
.img-fluid{max-width:100%}
a{-webkit-text-decoration:none;
text-decoration:none;
color:#782b90}
a:hover{text-decoration:underline;
color:#571f69}
img{vertical-align:middle}
svg{overflow:hidden;
vertical-align:middle}
code, pre{font-family:"Roboto Mono", SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
p code{display:-webkit-inline-box;
display:-webkit-inline-flex;
display:-ms-inline-flexbox;
display:inline-flex;
max-width:100%;
overflow:auto}
.heading-anchor{opacity:0;
-webkit-align-self:flex-start;
-ms-flex-item-align:flex-start;
align-self:flex-start;
outline:none}
.heading-anchor::after{content:"#";
position:absolute;
margin-left:-1.5rem;
color:#ced4da;
padding-right:.45rem}
.heading-anchor:hover{opacity:1}
h2:hover .heading-anchor, h3:hover .heading-anchor, h4:hover .heading-anchor, h5:hover .heading-anchor, h6:hover .heading-anchor{opacity:1}
h1 .heading-anchor{display:none}
h4 .heading-anchor::after, h5 .heading-anchor::after, h6 .heading-anchor::after{padding-right:.6rem}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap">@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Me5g.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu72xKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu5mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7GxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300;400&display=swap">@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZKCA.woff) format('woff')}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-59Y.woff) format('woff')}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCkYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCAYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCgYb9lecyVC4A.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCcYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCsYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCoYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCQYb9lecyU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19-7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19a7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-1967DQk6YvNkeg.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19G7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-1927DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19y7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19K7DQk6YvM.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap">@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vqPQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SeW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_QOW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_R-W-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_S-W-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SuW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW-AJi8SJQt.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body data-build-time="2022-02-23T09:35:16.316Z" data-build-commit-id="8b877d2cb301a26f9c0da168ea98a1691baec2ff" data-build-run-id="1886450826"><div id="__next" data-reactroot=""><main class="jsx-efcc50be384cabc7 page docs"><header><div class="jsx-f705e145f931f504 navbar"><div class="jsx-f705e145f931f504 navbar-content container"><div class="jsx-f705e145f931f504 navbar-logo"><a class="jsx-f705e145f931f504" href="/"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 1232.6 315.2&#x27; style=&#x27;enable-background:new 0 0 1232.6 315.2&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23782a91%7d%3c/style%3e%3cpath d=&#x27;M120.9 214.2 190.5 0h52.3l-98.5 273.8H98.2L0 0h52.1l68.8 214.2zm291.2-62.6H299.6v84.2H431v38H252V0h177.7v38.4H299.6V114h112.5v37.6zm83.7-113.2H546c16.5.3 29 4.4 37.3 12.4 8.3 8 12.5 19.4 12.5 34 0 14-4.5 25.1-13.5 33.2-9 8.1-21.6 12.1-37.6 12.1h-27.1v24.2l86.1 119.5h51v-2.4l-77.2-106.7c24.9-5.5 43.3-21.7 52.6-35.9 8.2-12.6 13.3-27.7 13.3-46 0-26.8-8.6-47.4-25.8-61.5C600.5 7.1 576.1 0 544.5 0h-96.3v273.8h47.6&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1052.3 157.7-41.5 62.7 29.7 53.4h85.1z&#x27;/%3e%3ccircle class=&#x27;st0&#x27; cx=&#x27;827.9&#x27; cy=&#x27;274.7&#x27; r=&#x27;40.5&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1037 0-47.6 74.2L949 0h-84l85.3 135.8-67.1 105.7c5.7 9.5 9.1 20.5 9.2 32.4h50.1L1121.3 0H1037z&#x27;/%3e%3cpath d=&#x27;M763.5 273.8c.1-9.9 2.5-19.2 6.6-27.5V38.4h85.4V0H638.2v38.4h84.6v235.4h40.7zm414-266.9h-15.3v42.2h-8.5V6.9h-15.2V0h39v6.9zM1193 0l14.2 37.7L1221.3 0h11v49.1h-8.5V32.9l.8-21.7-14.5 37.9h-6.1l-14.5-37.8.8 21.6v16.2h-8.5V0h11.2z&#x27;/%3e%3c/svg%3e" alt="Vert.x Logo" class="jsx-f705e145f931f504"/></a></div><div class="jsx-f705e145f931f504 navbar-collapse-button"><span class="jsx-f705e145f931f504"></span><span class="jsx-f705e145f931f504"></span><span class="jsx-f705e145f931f504"></span></div><div class="jsx-f705e145f931f504 navbar-right"><div class="jsx-f705e145f931f504 navbar-menu"><span class="jsx-f705e145f931f504 navbar-menu-item with-drop-down"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">开始<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu"><a class="jsx-f705e145f931f504" href="/introduction-to-vertx-and-reactive/"><li class="jsx-400ec7965926e858 dropdown-item">简介</li></a><a class="jsx-f705e145f931f504" href="/get-started/"><li class="jsx-400ec7965926e858 dropdown-item">开始</li></a><a href="https://start.vertx.io/" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">应用生成器 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="jsx-f705e145f931f504 navbar-menu-item" href="/docs/">文档</a><span class="jsx-f705e145f931f504 navbar-menu-item with-drop-down"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">资源<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu"><a class="jsx-f705e145f931f504" href="/faq/"><li class="jsx-400ec7965926e858 dropdown-item">答疑</li></a><a class="jsx-f705e145f931f504" href="/channels/"><li class="jsx-400ec7965926e858 dropdown-item">联系渠道</li></a><a href="https://how-to.vertx.io/" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">操作指南 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/vertx-eventbus-bridge-clients" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">EventBus Bridge Clients <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/advanced-vertx-guide" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">Advanced Vert.x Guide <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="jsx-f705e145f931f504 navbar-menu-item" href="/blog/">博客</a><a class="jsx-f705e145f931f504 navbar-menu-item" href="/community/">社区</a><a class="jsx-f705e145f931f504 navbar-menu-item" href="/translation/">翻译团队</a></div><div class="jsx-f705e145f931f504 navbar-social"><a href="https://github.com/vert-x3/vertx-awesome" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" title="Stack Overflow" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>stackoverflow</title><path d="M15.725 0l-1.72 1.277 6.39 8.588 1.716-1.277L15.725 0zm-3.94 3.418l-1.369 1.644 8.225 6.85 1.369-1.644-8.225-6.85zm-3.15 4.465l-.905 1.94 9.702 4.517.904-1.94-9.701-4.517zm-1.85 4.86l-.44 2.093 10.473 2.201.44-2.092-10.473-2.203zM1.89 15.47V24h19.19v-8.53h-2.133v6.397H4.021v-6.396H1.89zm4.265 2.133v2.13h10.66v-2.13H6.154Z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" title="YouTube" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>youtube</title><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path></svg></a><a href="https://discord.gg/KzEMwP2" title="Discord" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title>discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"></path></svg></a><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" title="Vert.x 用户组" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title>Vert.x 用户组</title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a><a href="https://qm.qq.com/cgi-bin/qm/qr?k=QFrKfwIVTuShDdh7puvfJWjqOx4C014c&amp;jump_from=webapi" title="Vert.x中国用户组QQ群" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Vert.x中国用户组QQ群"><title>Vert.x中国用户组QQ群</title><path d="M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673zM12.662 4.846c.039-1.052.659-1.878 1.385-1.846s1.281.912 1.242 1.964c-.039 1.051-.659 1.878-1.385 1.846s-1.282-.912-1.242-1.964zM9.954 3c.725-.033 1.345.794 1.384 1.846.04 1.052-.517 1.931-1.242 1.963-.726.033-1.346-.794-1.385-1.845C8.672 3.912 9.228 3.033 9.954 3zM7.421 8.294c.194-.43 2.147-.908 4.566-.908h.026c2.418 0 4.372.479 4.566.908a.14.14 0 0 1 .014.061c0 .031-.01.059-.026.083-.163.238-2.333 1.416-4.553 1.416h-.026c-2.221 0-4.39-1.178-4.553-1.416a.136.136 0 0 1-.014-.144zm10.422 8.622c-.22 3.676-2.403 5.987-5.774 6.021h-.137c-3.37-.033-5.554-2.345-5.773-6.021-.081-1.35.001-2.496.147-3.43.318.063.638.122.958.176v3.506s1.658.334 3.318.103v-3.225c.488.027.96.04 1.406.034h.025c1.678.021 3.714-.204 5.683-.594.146.934.227 2.08.147 3.43zM10.48 5.804c.313-.041.542-.409.508-.825-.033-.415-.314-.72-.629-.679-.313.04-.541.409-.508.824.034.417.315.72.629.68zM14.479 5.156c.078.037.221.042.289-.146.035-.095.025-.165-.009-.214-.023-.033-.133-.118-.371-.176-.904-.22-1.341.384-1.405.499-.04.072-.012.176.056.227.067.051.139.037.179-.006.58-.628 1.21-.208 1.261-.184z"></path></svg></a><a href="https://qun.qq.com/qqweb/qunpro/share?_wv=3&amp;_wwv=128&amp;inviteCode=1reLvB&amp;from=246610&amp;biz=ka" title="Vert.x中国用户组QQ群" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 200 200" aria-label="Vert.x中国用户组QQ群"><title>Vert.x中国用户组QQ群</title><path d="M13 73L16 49L52 49L58 14L82 14L77 49L135 49L141 14L166 14L160 49L195 49L192 73L157 73L148 124L184 124L181 149L144 149L137 193L90 149L61 149L55 185L31 185L36 149L0 149L6 124L100 124L120 144L131 75L72 75L64 124L40 124L48 73Z"></path></svg></a></div></div></div></div></header><div class="jsx-efcc50be384cabc7 page-content docs-content"><div class="jsx-efcc50be384cabc7 container"><div class="jsx-efcc50be384cabc7 docs-content-wrapper"><aside class="jsx-efcc50be384cabc7 "><div class="jsx-efcc50be384cabc7 docs-content-wrapper-sidebar"><div class="jsx-d1843944f2d67b search-panel"><div class="jsx-20d862052e50feff search"><input type="text" placeholder="Search..." value="" class="jsx-20d862052e50feff"/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon-delete"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></div><ul class="jsx-117e429f22e394dc search-results"></ul><div class="jsx-117e429f22e394dc search-results-none">No results.</div></div><div class="jsx-efcc50be384cabc7 docs-content-toc"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">介绍</a></li>
<li><a href="#_writing_a_test_suite">编写一个测试套件</a></li>
<li><a href="#_asserting">断言</a>
<ul class="sectlevel2">
<li><a href="#_assertequals">assertEquals</a></li>
<li><a href="#_assertnotequals">assertNotEquals</a></li>
<li><a href="#_assertnull">assertNull</a></li>
<li><a href="#_assertnotnull">assertNotNull</a></li>
<li><a href="#_assertinrange">assertInRange</a></li>
<li><a href="#_asserttrue_and_assertfalse">断言成功以及断言失败</a></li>
<li><a href="#_failing">失败</a></li>
<li><a href="#_using_third_party_assertion_framework">使用第三方断言框架</a></li>
</ul>
</li>
<li><a href="#_asynchronous_testing">异步测试</a></li>
<li><a href="#_asynchronous_assertions">异步断言</a></li>
<li><a href="#_repeating_test">重复测试</a></li>
<li><a href="#_sharing_objects">共享对象</a></li>
<li><a href="#_running">运行</a>
<ul class="sectlevel2">
<li><a href="#_test_suite_completion">测试套件执行完毕</a></li>
<li><a href="#_time_out">超时</a></li>
<li><a href="#_event_loop">事件循环（Event loop）</a></li>
</ul>
</li>
<li><a href="#_reporting">测试报告</a>
<ul class="sectlevel2">
<li><a href="#_console_reporting">控制台报告</a></li>
<li><a href="#_file_reporting">文件报告</a></li>
<li><a href="#_log_reporting">日志报告</a></li>
<li><a href="#_event_bus_reporting">事件总线报告</a></li>
</ul>
</li>
<li><a href="#_vertx_integration">Vertx 整合</a></li>
<li><a href="#_junit_integration">Junit 整合</a>
<ul class="sectlevel2">
<li><a href="#_running_a_test_on_a_vert_x_context">在 Vert.x 上下文中执行一个测试</a></li>
<li><a href="#_timeout">超时</a></li>
<li><a href="#_parameterized_tests">参数化测试</a></li>
<li><a href="#_repeating_a_test">重复测试</a></li>
<li><a href="#_using_with_other_assertion_libraries">用其他断言库</a></li>
</ul>
</li>
<li><a href="#_java_language_integration">Java 语言整合</a>
<ul class="sectlevel2">
<li><a href="#_test_suite_integration">测试套件整合</a></li>
</ul>
</li>
</ul>
</div></div></div></aside><div class="jsx-efcc50be384cabc7 docs-content-sidebar-toggle"><div style="position:relative" class="jsx-efcc50be384cabc7"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div></div><div class="jsx-efcc50be384cabc7 docs-content-inner"><div class="jsx-efcc50be384cabc7 docs-content-metadata"><div class="jsx-efcc50be384cabc7 docs-content-metadata-left"><div class="jsx-efcc50be384cabc7 docs-content-metadata-repo"><div class="jsx-d38685edc31911e0 github-stars"><a href="https://github.com/vert-x3/vertx-unit" class="jsx-d38685edc31911e0"><div class="jsx-d38685edc31911e0 icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></div> <!-- -->null stars</a></div></div><div class="jsx-efcc50be384cabc7"><a href="https://vertx.io/docs/apidocs" class="jsx-efcc50be384cabc7"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg> API</a></div><div class="jsx-efcc50be384cabc7 docs-content-metadata-examples"><a href="https://github.com/vert-x3/vertx-examples/tree/4.x/unit-examples"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg> Examples</a></div><div class="jsx-efcc50be384cabc7 docs-content-metadata-edit"><a href="https://github.com/vertx-china/vertx-web-site/tree/master/docs/translation/vertx-unit/java"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg> 改进翻译</a></div><span class="jsx-efcc50be384cabc7 docs-content-metadata-version"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">v4.2.5<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu align-right"><a href="/docs/vertx-unit/java/"><li class="jsx-400ec7965926e858 dropdown-item active has-active-siblings"><span class="jsx-400ec7965926e858 dropdown-check-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg></span>Latest (v<!-- -->4.2.5<!-- -->)</li></a><a href="/docs/4.1.8/vertx-unit/java/"><li class="jsx-400ec7965926e858 dropdown-item has-active-siblings">v<!-- -->4.1.8</li></a><a href="/docs/4.0.3/vertx-unit/java/"><li class="jsx-400ec7965926e858 dropdown-item has-active-siblings">v<!-- -->4.0.3</li></a><a href="/docs/3.9.12/vertx-unit/java/"><li class="jsx-400ec7965926e858 dropdown-item has-active-siblings">v<!-- -->3.9.12</li></a></ul></div></span></div></div><div class="jsx-efcc50be384cabc7"><h1>Vertx unit</h1>

<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>异步多语言单元测试。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>介绍</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x Unit 用多语言的异步API在JVM上 运行单元测试。
Vert.x Unit 借鉴了已有的测试框架，例如 <a href="http://junit.org">JUnit</a> or <a href="http://qunitjs.com">QUnit</a>
并同时遵循了Vert.x的做法。</p>
</div>
<div class="paragraph">
<p>所以 Vert.x Unit 自然就成为了测试 Vert.x 应用的选择。</p>
</div>
<div class="paragraph">
<p>要使用 Vert.x Unit，
那么请添加如下依赖：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven （在您的 <code>pom.xml</code> 文件）：</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-unit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.1.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle （在您的 <code>build.gradle</code> 文件）：</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">testCompile ${io.vertx}:${vertx-unit}:<span class="hljs-number">4.1</span><span class="hljs-number">.4</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Vert.x Unit 能够以各种方式使用并可以在您代码中任何位置运行，它仅以正确的方式报告执行结果。
以下示例展示了一个最简的测试用例套件。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite suite = TestSuite.create(<span class="hljs-string">&quot;the_test_suite&quot;</span>);
suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  String s = <span class="hljs-string">&quot;value&quot;</span>;
  context.assertEquals(<span class="hljs-string">&quot;value&quot;</span>, s);
});
suite.run();</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>run</code> 方法执行了整个套件并且执行套件中所有的测试用例。
测试用例套件可能失败也可能通过。如果外界不关心测试结果，
那么测试用例的通过与否便不重要。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite suite = TestSuite.create(<span class="hljs-string">&quot;the_test_suite&quot;</span>);
suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  String s = <span class="hljs-string">&quot;value&quot;</span>;
  context.assertEquals(<span class="hljs-string">&quot;value&quot;</span>, s);
});
suite.run(<span class="hljs-keyword">new</span> TestOptions().addReporter(<span class="hljs-keyword">new</span> ReportOptions().setTo(<span class="hljs-string">&quot;console&quot;</span>)));</code></pre>
</div>
</div>
<div class="paragraph">
<p>执行之时，测试套件会在控制台报告每一步的结果：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Begin test suite the_test_suite
Begin test my_test
Passed my_test
End test suite the_test_suite , run: 1, Failures: 0, Errors: 0</pre>
</div>
</div>
<div class="paragraph">
<p><code>reporters</code> 选项配置了套件执行器的reporter，用以报告测试用例执行结果，
更多信息详见 <a href="#reporting">[reporting]</a> 章节</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_writing_a_test_suite"><a class="anchor" href="#_writing_a_test_suite"></a>编写一个测试套件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>测试套件是一系列测试用例组成的有名称的集合，测试用例则是一个直接回调。
套件生命周期中可以设置回调函数，这些函数可以在执行测试用例前后执行，
也可以在用作初始化/发布服务的套件前后。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite suite = TestSuite.create(<span class="hljs-string">&quot;the_test_suite&quot;</span>);
suite.test(<span class="hljs-string">&quot;my_test_case_1&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 1</span>
});
suite.test(<span class="hljs-string">&quot;my_test_case_2&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 2</span>
});
suite.test(<span class="hljs-string">&quot;my_test_case_3&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 3</span>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>流式API让测试用例可以作链式调用：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite suite = TestSuite.create(<span class="hljs-string">&quot;the_test_suite&quot;</span>);
suite.test(<span class="hljs-string">&quot;my_test_case_1&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 1</span>
}).test(<span class="hljs-string">&quot;my_test_case_2&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 2</span>
}).test(<span class="hljs-string">&quot;my_test_case_3&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 3</span>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>测试用例的声明顺序并不保证其执行顺序，所以测试用例不可以依赖于其他测试用例来运行。
这不是一个好的做法。</p>
</div>
<div class="paragraph">
<p>Vert.x Unit 提供了 <em>before</em> 和 <em>after</em> 回调来作总体的启动或清理资源操作：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite suite = TestSuite.create(<span class="hljs-string">&quot;the_test_suite&quot;</span>);
suite.before(context -&gt; {
  <span class="hljs-comment">// 测试套件启动</span>
}).test(<span class="hljs-string">&quot;my_test_case_1&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 1</span>
}).test(<span class="hljs-string">&quot;my_test_case_2&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 2</span>
}).test(<span class="hljs-string">&quot;my_test_case_3&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 3</span>
}).after(context -&gt; {
  <span class="hljs-comment">// 测试套件清理资源</span>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>这些方法的声明顺序并不重要，示例中在用例之前声明 <em>before</em> ，
在用例之后声明 <em>after</em> ，
然而在运行套件之前，他们可以在任何位置声明，</p>
</div>
<div class="paragraph">
<p><em>before</em> 回调函数执行于所有测试用例之前，如果其运行失败，
则整个测试套件将停止运行并报告失败结果。 <em>after</em> 回调函数在整个测试套件中最后执行，
除非 <em>before</em> 回调函数运行失败。</p>
</div>
<div class="paragraph">
<p>类似的，Vert.x Unit 提供了 <em>beforeEach</em> 和 <em>afterEach</em> 回调，
在每一个测试用例前后执行：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite suite = TestSuite.create(<span class="hljs-string">&quot;the_test_suite&quot;</span>);
suite.beforeEach(context -&gt; {
  <span class="hljs-comment">// 测试用例启动</span>
}).test(<span class="hljs-string">&quot;my_test_case_1&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 1</span>
}).test(<span class="hljs-string">&quot;my_test_case_2&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 2</span>
}).test(<span class="hljs-string">&quot;my_test_case_3&quot;</span>, context -&gt; {
  <span class="hljs-comment">// Test 3</span>
}).afterEach(context -&gt; {
  <span class="hljs-comment">// 测试用例资源清理</span>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>beforeEach</em> 回调函数执行于每一个测试用例之前，一旦其运行失败，那测试用例将不再被执行，
并报告失败结果。 <em>afterEach</em> 回调函数仅在测试用例之后被执行，
除非 <em>beforeEach</em> 函数运行失败。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_asserting"><a class="anchor" href="#_asserting"></a>断言</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x Unit 提供了 <code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html">TestContext</a></code> 对象用来在测试用例中作断言操作。
<em>context</em> 对象提供了用于断言的常用方法。</p>
</div>
<div class="sect2">
<h3 id="_assertequals"><a class="anchor" href="#_assertequals"></a>assertEquals</h3>
<div class="paragraph">
<p>断言两个对象相等，适用于 <em>基本类型</em> 和 <em>json类型</em> 。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  context.assertEquals(<span class="hljs-number">10</span>, callbackCount);
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>有一个重载的方法用于提供测试信息：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  context.assertEquals(<span class="hljs-number">10</span>, callbackCount, <span class="hljs-string">&quot;Should have been 10 instead of &quot;</span> + callbackCount);
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>通常地，每一个断言函数都提供了重载的版本。</p>
</div>
</div>
<div class="sect2">
<h3 id="_assertnotequals"><a class="anchor" href="#_assertnotequals"></a>assertNotEquals</h3>
<div class="paragraph">
<p>与 <em>assertEquals</em> 相反。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  context.assertNotEquals(<span class="hljs-number">10</span>, callbackCount);
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_assertnull"><a class="anchor" href="#_assertnull"></a>assertNull</h3>
<div class="paragraph">
<p>断言一个对象是null，适用于 <em>基本类型</em> 和 <em>json类型</em> 。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  context.assertNull(<span class="hljs-keyword">null</span>);
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_assertnotnull"><a class="anchor" href="#_assertnotnull"></a>assertNotNull</h3>
<div class="paragraph">
<p>与 <em>assertNull</em> 相反。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  context.assertNotNull(<span class="hljs-string">&quot;not null!&quot;</span>);
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_assertinrange"><a class="anchor" href="#_assertinrange"></a>assertInRange</h3>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html#assertInRange-double-double-double-">assertInRange</a></code> 方法作用于实数范围。</p>
</div>
<div class="listingblock">
<div class="content">
<pre>suite.test("my_test_case", context -&gt; {

  // 断言0.1 在误差范围 +/- 0.5范围内等于0.2

  context.assertInRange(0.1, 0.2, 0.5);
});</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_asserttrue_and_assertfalse"><a class="anchor" href="#_asserttrue_and_assertfalse"></a>断言成功以及断言失败</h3>
<div class="paragraph">
<p>对于布尔表达式的断言。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  context.assertTrue(<span class="hljs-keyword">var</span>);
  context.assertFalse(value &gt; <span class="hljs-number">10</span>);
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_failing"><a class="anchor" href="#_failing"></a>失败</h3>
<div class="paragraph">
<p>最后但并非最不重要的，<em>test</em> 提供了一个 <em>fail</em> 方法用来抛出断言错误的异常：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  context.fail(<span class="hljs-string">&quot;That should never happen&quot;</span>);
  <span class="hljs-comment">// 剩下的代码不会执行。</span>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>失败</code> 对象本身既可以是 <em>string</em> 也可以是一个 <em>error</em> 。
<em>error</em> 对象取决于所使用的编程语言，对于 Java 或者 Groovy 而言，可以是任何 <em>Throwable</em> 的子类，
对于 JavaScript 则是一个 <em>error</em> ，对于 Ruby 则是一个 <em>Exception</em>。</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_third_party_assertion_framework"><a class="anchor" href="#_using_third_party_assertion_framework"></a>使用第三方断言框架</h3>
<div class="paragraph">
<p>您也可以用任何其他的断言框架，例如比较流行的 <em>hamcrest</em> 和 <em>assertj</em> 。
我们建议您用 <code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html#verify-io.vertx.core.Handler-">verify</a></code> ，
使用我们提供的 <em>处理器（Handler）</em> 来执行断言。
这样的话，我们才能正确的处理异步测试的结束动作。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; context.verify(v -&gt; {
  <span class="hljs-comment">// 这里 junit中的 Assert 对象可以是 assertj hamcrest或其他库中的Assert对象</span>
  <span class="hljs-comment">// 甚至可以手动抛出 AssertionError</span>
  Assert.assertNotNull(<span class="hljs-string">&quot;not null!&quot;</span>);
  Assert.assertEquals(<span class="hljs-number">10</span>, callbackCount);
}));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_asynchronous_testing"><a class="anchor" href="#_asynchronous_testing"></a>异步测试</h2>
<div class="sectionbody">
<div class="paragraph">
<p>前述示例的前提是，假设所有的测试用例在各自回调之后会结束，
这是测试用例回调函数的默认行为。在测试用例回调函数之后结束测试是可取的，
例如：</p>
</div>
<div class="listingblock">
<div class="title">Async 对象异步的完成测试用例</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  Async async = context.async();
  eventBus.consumer(<span class="hljs-string">&quot;the-address&quot;</span>, msg -&gt; {
    <b class="conum">(2)</b>
    async.complete();
  });
  <b class="conum">(1)</b>
});</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>回调函数结束，但是测试用例没结束</p>
</li>
<li>
<p>总线事件的回调函数来终止测试</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>用 <code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html#async--">async</a></code> 方法创建一个 <code><a href="../../apidocs/io/vertx/ext/unit/Async.html">Async</a></code> 对象表示测试用例还未结束。
当执行 <code><a href="../../apidocs/io/vertx/ext/unit/Async.html#complete--">complete</a></code> 方法时，
测试用例才算结束。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">注意</div>
</td>
<td class="content">
当 <code>complete</code> 回调函数未被执行时，测试用例会在指定超时时间之后失败。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>同一个测试用例中可以创建多个 <code>Async</code> 对象，
必须调用所有Async对象的 <em>completed</em> 方法来终止测试。</p>
</div>
<div class="listingblock">
<div class="title">多个Async对象合作</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {

  HttpClient client = vertx.createHttpClient();
  client.request(HttpMethod.GET, <span class="hljs-number">8080</span>, <span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>, context.asyncAssertSuccess(req -&gt; {
      req.send(context.asyncAssertSuccess(resp -&gt; {
        context.assertEquals(<span class="hljs-number">200</span>, resp.statusCode());
      }));
    }));

  Async async = context.async();
  vertx.eventBus().consumer(<span class="hljs-string">&quot;the-address&quot;</span>, msg -&gt; {
    async.complete();
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Async 对象也可以用在 <em>before</em> 或 <em>after</em> 回调中，
这将很方便的在 <em>before</em> 回调中，实现依赖于多个异步结果的启动操作：</p>
</div>
<div class="listingblock">
<div class="title">执行测试用例之前异步启动 http server</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.before(context -&gt; {
  Async async = context.async();
  HttpServer server = vertx.createHttpServer();
  server.requestHandler(requestHandler);
  server.listen(<span class="hljs-number">8080</span>, ar -&gt; {
    context.assertTrue(ar.succeeded());
    async.complete();
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>您也可以等待 <code><a href="../../apidocs/io/vertx/ext/unit/Async.html">Async</a></code> 直到其结束，
类似Java的 count-down latch：</p>
</div>
<div class="listingblock">
<div class="title">Wait for completion</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Async async = context.async();
HttpServer server = vertx.createHttpServer();
server.requestHandler(requestHandler);
server.listen(<span class="hljs-number">8080</span>, ar -&gt; {
  context.assertTrue(ar.succeeded());
  async.complete();
});

<span class="hljs-comment">// Wait until completion</span>
async.awaitSuccess();</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">警告</div>
</td>
<td class="content">
该方法不应该在事件循环（event loop）上执行！
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Async 可以创建一个初始计数值，
当用 <code><a href="../../apidocs/io/vertx/ext/unit/Async.html#countDown--">countDown</a></code> 方法将 count-down 的值减到0时：</p>
</div>
<div class="listingblock">
<div class="title">等待，直到count-down值为0</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Async async = context.async(<span class="hljs-number">2</span>);
HttpServer server = vertx.createHttpServer();
server.requestHandler(requestHandler);
server.listen(<span class="hljs-number">8080</span>, ar -&gt; {
  context.assertTrue(ar.succeeded());
  async.countDown();
});

vertx.setTimer(<span class="hljs-number">1000</span>, id -&gt; {
  async.complete();
});

<span class="hljs-comment">// Wait until completion of the timer and the http request</span>
async.awaitSuccess();</code></pre>
</div>
</div>
<div class="paragraph">
<p>调用Async的 <code>complete()</code> 方法会像往常一样结束，实际上它将count-down值直接设置为 <code>0</code> 。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_asynchronous_assertions"><a class="anchor" href="#_asynchronous_assertions"></a>异步断言</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html">TestContext</a></code> 提供了很有用的方法，这些方法提供了强大的异步测试框架：</p>
</div>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html#asyncAssertSuccess--">asyncAssertSuccess</a></code> 方法返回一个类似 <code><a href="../../apidocs/io/vertx/ext/unit/Async.html">Async</a></code> {@literal Handler&lt;AsyncResult&lt;T&gt;&gt;} 对象，
它在运行成功时执行 <code>Async</code> 对象，并在失败时，
让整个测试用例失败，并返回失败原因。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Async async = context.async();
vertx.deployVerticle(<span class="hljs-string">&quot;my.verticle&quot;</span>, ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    async.complete();
  } <span class="hljs-keyword">else</span> {
    context.fail(ar.cause());
  }
});

<span class="hljs-comment">// 可用如下代替</span>

vertx.deployVerticle(<span class="hljs-string">&quot;my.verticle&quot;</span>, context.asyncAssertSuccess());</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html#asyncAssertSuccess-io.vertx.core.Handler-">asyncAssertSuccess</a></code> 方法返回一个类似于 <code><a href="../../apidocs/io/vertx/ext/unit/Async.html">Async</a></code> 的 {@literal Handler&lt;AsyncResult&lt;T&gt;&gt;} 对象，
运行成功时它执行了代理 {@literal Handler&lt;T&gt;} ，
而在运行出错时让整个测试用例失败，并返回错误原因。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">AtomicBoolean started = <span class="hljs-keyword">new</span> AtomicBoolean();
Async async = context.async();
vertx.deployVerticle(<span class="hljs-keyword">new</span> AbstractVerticle() {
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">start</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>{
    started.set(<span class="hljs-keyword">true</span>);
  }
}, ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    context.assertTrue(started.get());
    async.complete();
  } <span class="hljs-keyword">else</span> {
    context.fail(ar.cause());
  }
});

<span class="hljs-comment">// Can be replaced by</span>

vertx.deployVerticle(<span class="hljs-string">&quot;my.verticle&quot;</span>, context.asyncAssertSuccess(id -&gt; {
  context.assertTrue(started.get());
}));</code></pre>
</div>
</div>
<div class="paragraph">
<p>当 <code>Handler</code> 退出时，Async对象同时也会处于 <code>completed</code> 状态，除非Async对象在函数调用期间被创建，
这会在 <em>链式</em> 异步操作时提供方便：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Async async = context.async();
vertx.deployVerticle(<span class="hljs-string">&quot;my.verticle&quot;</span>, ar1 -&gt; {
  <span class="hljs-keyword">if</span> (ar1.succeeded()) {
    vertx.deployVerticle(<span class="hljs-string">&quot;my.otherverticle&quot;</span>, ar2 -&gt; {
      <span class="hljs-keyword">if</span> (ar2.succeeded()) {
        async.complete();
      } <span class="hljs-keyword">else</span> {
        context.fail(ar2.cause());
      }
    });
  } <span class="hljs-keyword">else</span> {
    context.fail(ar1.cause());
  }
});

<span class="hljs-comment">// Can be replaced by</span>

vertx.deployVerticle(<span class="hljs-string">&quot;my.verticle&quot;</span>, context.asyncAssertSuccess(id -&gt;
        vertx.deployVerticle(<span class="hljs-string">&quot;my_otherverticle&quot;</span>, context.asyncAssertSuccess())
));</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html#asyncAssertFailure--">asyncAssertFailure</a></code> 方法返回了一个类似 <code><a href="../../apidocs/io/vertx/ext/unit/Async.html">Async</a></code> 的 {@literal Handler&lt;AsyncResult&lt;T&gt;&gt;} 对象,
它在运行失败时执行 <code>Async</code> ，
并在成功时让测试用例失败。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Async async = context.async();
vertx.deployVerticle(<span class="hljs-string">&quot;my.verticle&quot;</span>, ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    context.fail();
  } <span class="hljs-keyword">else</span> {
    async.complete();
  }
});

<span class="hljs-comment">// 可用如下代替</span>

vertx.deployVerticle(<span class="hljs-string">&quot;my.verticle&quot;</span>, context.asyncAssertFailure());</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html#asyncAssertFailure-io.vertx.core.Handler-">asyncAssertFailure</a></code> 方法返回一个类似 <code><a href="../../apidocs/io/vertx/ext/unit/Async.html">Async</a></code> 的  {@literal Handler&lt;AsyncResult&lt;T&gt;&gt;} 对象，
它在运行失败时，
执行代理处理器 {@literal Handler&lt;Throwable&gt;} ，
并在执行成功时让测试用例失败。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Async async = context.async();
vertx.deployVerticle(<span class="hljs-string">&quot;my.verticle&quot;</span>, ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    context.fail();
  } <span class="hljs-keyword">else</span> {
    context.assertTrue(ar.cause() <span class="hljs-keyword">instanceof</span> IllegalArgumentException);
    async.complete();
  }
});

<span class="hljs-comment">// 可用如下代替</span>

vertx.deployVerticle(<span class="hljs-string">&quot;my.verticle&quot;</span>, context.asyncAssertFailure(cause -&gt; {
  context.assertTrue(cause <span class="hljs-keyword">instanceof</span> IllegalArgumentException);
}));</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Handler</code> 退出时，这个Async也会处于完成状态，除非在执行过程中，创建了新的Async对象</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_repeating_test"><a class="anchor" href="#_repeating_test"></a>重复测试</h2>
<div class="sectionbody">
<div class="paragraph">
<p>当测试随机条件或测试不经常失败时，例如在竞争条件下，
为了增加测试失败的可能性，多次运行同一测试是个方便的方式。</p>
</div>
<div class="listingblock">
<div class="title">重复一个测试</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite.create(<span class="hljs-string">&quot;my_suite&quot;</span>).test(<span class="hljs-string">&quot;my_test&quot;</span>, <span class="hljs-number">1000</span>, context -&gt; {
  <span class="hljs-comment">// 这里会执行1000次</span>
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果声明了 <em>beforeEach</em> 和 <em>afterEach</em> 回调，那么每当测试用例执行一次，它们也会被执行一次。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">注意</div>
</td>
<td class="content">
重复的测试用例是顺序执行的
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sharing_objects"><a class="anchor" href="#_sharing_objects"></a>共享对象</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html">TestContext</a></code> 对象提供了 <code>get</code>/<code>put</code>/<code>remove</code> 操作，用于在回调函数之间共享状态。</p>
</div>
<div class="paragraph">
<p>在 <em>before</em> 回调函数中添加的任何对象都可以在其他回调函数中访问到。
每一个测试用例都会操作一个共享状态的副本。所以，对于共享状态的更新仅仅在一个测试用例之内有效。</p>
</div>
<div class="listingblock">
<div class="title">在回调函数之间共享状态</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite.create(<span class="hljs-string">&quot;my_suite&quot;</span>).before(context -&gt; {

  <span class="hljs-comment">// cases host对于所有的测试用例可见</span>
  context.put(<span class="hljs-string">&quot;host&quot;</span>, <span class="hljs-string">&quot;localhost&quot;</span>);

}).beforeEach(context -&gt; {

  <span class="hljs-comment">// 为每一个测试用例生成一个port</span>
  <span class="hljs-keyword">int</span> port = helper.randomPort();

  <span class="hljs-comment">// 获取host</span>
  String host = context.get(<span class="hljs-string">&quot;host&quot;</span>);

  <span class="hljs-comment">// 启动服务</span>
  Async async = context.async();
  HttpServer server = vertx.createHttpServer();
  server.requestHandler(req -&gt; {
    req.response().setStatusCode(<span class="hljs-number">200</span>).end();
  });
  server.listen(port, host, ar -&gt; {
    context.assertTrue(ar.succeeded());
    context.put(<span class="hljs-string">&quot;port&quot;</span>, port);
    async.complete();
  });

}).test(<span class="hljs-string">&quot;my_test&quot;</span>, context -&gt; {

  <span class="hljs-comment">// 获取共享状态</span>
  <span class="hljs-keyword">int</span> port = context.get(<span class="hljs-string">&quot;port&quot;</span>);
  String host = context.get(<span class="hljs-string">&quot;host&quot;</span>);

  <span class="hljs-comment">// 发送请求</span>
  HttpClient client = vertx.createHttpClient();
  client.request(HttpMethod.GET, port, host, <span class="hljs-string">&quot;/resource&quot;</span>, context.asyncAssertSuccess(req -&gt; {
    req.send(context.asyncAssertSuccess(resp -&gt; {
      context.assertEquals(<span class="hljs-number">200</span>, resp.statusCode());
    }));
  }));
});</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">警告</div>
</td>
<td class="content">
只有java才能共享所有类型的对象，其他语言只能共享基本类型和json类型。
其他类型对象的共享操作应该利用当前编程语言的特性来实现。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running"><a class="anchor" href="#_running"></a>运行</h2>
<div class="sectionbody">
<div class="paragraph">
<p>当创建了一个测试套件，除非调用 <code><a href="../../apidocs/io/vertx/ext/unit/TestSuite.html#run--">run</a></code> 方法，否则测试用例不会执行。</p>
</div>
<div class="listingblock">
<div class="title">运行一个测试套件</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.run();</code></pre>
</div>
</div>
<div class="paragraph">
<p>这个测试套件也可以用指定的 <code><a href="../../apidocs/io/vertx/core/Vertx.html">Vertx</a></code> 来运行：</p>
</div>
<div class="listingblock">
<div class="title">提供一个Vertx对象来执行测试用例</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.run(vertx);</code></pre>
</div>
</div>
<div class="paragraph">
<p>当使用 <code>Vertx</code> 对象来运行时，测试套件则会使用该Vert.x对象的 eventloop 来运行测试用例，
更多信息详见 <a href="#event_loop">[event_loop]</a> 一章。</p>
</div>
<div class="paragraph">
<p>一个测试套件可以用Vert.x命令行接口来执行，即使用 <code>vertx test</code> 命令：</p>
</div>
<div class="listingblock">
<div class="title">用Vert.x CLI 执行测试用例</div>
<div class="content">
<pre class="highlight"><code>&gt; vertx test the_test_suite.js
Begin test suite the_test_suite
Succeeded in deploying verticle
Begin test my_test_case
Passed my_test_case
End test suite my_suite , run: 1, Failures: 0, Errors: 0</code></pre>
</div>
</div>
<div class="paragraph">
<p>这种测试套件仅仅需要通过 <code><a href="../../apidocs/io/vertx/ext/unit/TestSuite.html#run--">run</a></code> 命令来执行，
<code>vertx test</code> 命令则负责配置报告和超时等。
例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite suite = TestSuite.create(<span class="hljs-string">&quot;the_test_suite&quot;</span>);
suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, context -&gt; {
  String s = <span class="hljs-string">&quot;value&quot;</span>;
  context.assertEquals(<span class="hljs-string">&quot;value&quot;</span>, s);
});
suite.run();</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>vertx test</code> 命令扩展了 <code>vertx run</code> 命令。它改变了JVM的退出行为，
当测试套件开始执行，并且返回了测试结果（例如success (0) or failure (1)）的时候，JVM才会退出。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">注意</div>
</td>
<td class="content">
同一个Verticle中可以执行多个测试套件，
Vert.x Unit会等待所有的测试套件执行完成。
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_test_suite_completion"><a class="anchor" href="#_test_suite_completion"></a>测试套件执行完毕</h3>
<div class="paragraph">
<p>我们没办法假设测试套件将何时执行完毕，
如果有代码需要在测试用例执行完毕之后才执行，
那么这段代码要声明在 <em>after</em> 回调函数中或者让其作为 <code><a href="../../apidocs/io/vertx/ext/unit/Completion.html">Completion</a></code> 的回调。</p>
</div>
<div class="listingblock">
<div class="title">测试套件 <em>执行回调函数</em></div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestCompletion completion = suite.run(vertx);

<span class="hljs-comment">// 普通的完成回调函数</span>
completion.handler(ar -&gt; {
  <span class="hljs-keyword">if</span> (ar.succeeded()) {
    System.out.println(<span class="hljs-string">&quot;Test suite passed!&quot;</span>);
  } <span class="hljs-keyword">else</span> {
    System.out.println(<span class="hljs-string">&quot;Test suite failed:&quot;</span>);
    ar.cause().printStackTrace();
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/Completion.html">Completion</a></code> 对象也提供了 <code><a href="../../apidocs/io/vertx/ext/unit/Completion.html#resolve-io.vertx.core.Promise-">resolve</a></code> 方法，
该方法接收 <code>Promise</code> 对象参数，这个 <code>Promise</code> 会在测试套件执行时被触发通知。</p>
</div>
<div class="listingblock">
<div class="title">用测试套件解析初始Promise</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestCompletion completion = suite.run();

<span class="hljs-comment">// 当测试套件执行完毕，Promise则被解析</span>
completion.resolve(startPromise);</code></pre>
</div>
</div>
<div class="paragraph">
<p>这样可以轻松的创建一个 <em>test</em> Verticle，这个Verticle是由测试套件部署起来的，
而部署Verticle的代码中可以很容易的知悉成功或者失败。</p>
</div>
<div class="paragraph">
<p>completion 对象也可以像 count-down latch 一样使用，他会阻塞直至测试套件执行完。
这应该用于当前线程与测试套件线程不一样时的场景。</p>
</div>
<div class="listingblock">
<div class="title">阻塞至测试套件执行完毕</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Completion completion = suite.run();

<span class="hljs-comment">//  阻塞至测试套件执行完毕</span>
completion.await();</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>await</code> 方法在线程被interrupt或者超时的时候抛出异常。</p>
</div>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/Completion.html#awaitSuccess--">awaitSuccess</a></code> 方法是一个变种，
它在测试套件运行失败时抛出异常</p>
</div>
<div class="listingblock">
<div class="title">阻塞至测试套件执行成功</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Completion completion = suite.run();

<span class="hljs-comment">// 阻塞至测试套件执行成功 否则抛出异常</span>
completion.awaitSuccess();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_time_out"><a class="anchor" href="#_time_out"></a>超时</h3>
<div class="paragraph">
<p>测试套件中的每一个测试用例都必须在超时时间内执行完毕。默认超时时间是 <em>2分钟</em> ，
超时时间可以用 <em>test options</em> 来设置：</p>
</div>
<div class="listingblock">
<div class="title">设置测试套件的超时时间</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestOptions options = <span class="hljs-keyword">new</span> TestOptions().setTimeout(<span class="hljs-number">10000</span>);

<span class="hljs-comment">// 10秒超时时间</span>
suite.run(options);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_event_loop"><a class="anchor" href="#_event_loop"></a>事件循环（Event loop）</h3>
<div class="paragraph">
<p>Vert.x Unit 是一系列task的执行过程，每个task由前一个task的完成动作来触发。
这些task负责平衡eventloop的调度，
但是这取决于当前执行上下文（例如，测试套件在 <code>main</code> 方法中执行，或者嵌入一个verticle ）
是否配置了 <code>Vertx</code> 对象。</p>
</div>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/TestOptions.html#setUseEventLoop-java.lang.Boolean-">setUseEventLoop</a></code>
以配置事件循环（event loop）的使用方式：</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. 事件循环（Event loop）的使用</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">useEventLoop:null</th>
<th class="tableblock halign-left valign-top">useEventLoop:true</th>
<th class="tableblock halign-left valign-top">useEventLoop:false</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Vertx</code> instance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 vertx event loop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用 vertx event loop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">强制不使用 event loop</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">在 <code>Verticle</code> 中</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用当前 event loop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">使用当前 event loop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">强制不使用 event loop</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">在 <em>main</em> 方法中</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">不使用 event loop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">错误</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">不使用 event loop</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>useEventLoop</code> 默认为 <code>null</code> , 这说明，
如果条件允许则使用一个event loop，当没有event loop 可用时，不使用event loop。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reporting"><a class="anchor" href="#_reporting"></a>测试报告</h2>
<div class="sectionbody">
<div class="paragraph">
<p>测试报告是测试套件中的重要部分，
Vert.x Unit可以用不同配置来运行不同的 reporter。</p>
</div>
<div class="paragraph">
<p>默认情况下，不配置reporter，但是当运行测试套件时，
可以用 <em>test options</em> 来配置一个或多个 reporter：</p>
</div>
<div class="listingblock">
<div class="title">使用终端reporter并将其用作junit xml文件</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ReportOptions consoleReport = <span class="hljs-keyword">new</span> ReportOptions().
    setTo(<span class="hljs-string">&quot;console&quot;</span>);

<span class="hljs-comment">// 将Junit报告信息文件放在当前目录</span>
ReportOptions junitReport = <span class="hljs-keyword">new</span> ReportOptions().
    setTo(<span class="hljs-string">&quot;file:.&quot;</span>).
    setFormat(<span class="hljs-string">&quot;junit&quot;</span>);

suite.run(<span class="hljs-keyword">new</span> TestOptions().
        addReporter(consoleReport).
        addReporter(junitReport)
);</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_console_reporting"><a class="anchor" href="#_console_reporting"></a>控制台报告</h3>
<div class="paragraph">
<p>将信息报告至JVM的 <code>System.out</code> 和 <code>System.err</code> ：</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">报告至</dt>
<dd>
<p><em>终端</em></p>
</dd>
<dt class="hdlist1">格式</dt>
<dd>
<p><em>常规</em> 或 <em>junit</em></p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_file_reporting"><a class="anchor" href="#_file_reporting"></a>文件报告</h3>
<div class="paragraph">
<p>如果想将报告输出至文件，您必须提供一个 <code>Vertx</code> 对象：</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">to</dt>
<dd>
<p><em>file</em> <code>:</code> <em>dir name</em></p>
</dd>
<dt class="hdlist1">格式</dt>
<dd>
<p><em>simple</em> 或 <em>junit</em></p>
</dd>
<dt class="hdlist1">示例</dt>
<dd>
<p><code>file:.</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>文件reporter会在配置的目录中创建文件，这些文件会以测试套件的名称和格式来命名
（例如， <em>常规格式</em> 创建 <em>txt</em> 文件，_
junit格式_ 创建 <em>xml</em> 文件）。</p>
</div>
</div>
<div class="sect2">
<h3 id="_log_reporting"><a class="anchor" href="#_log_reporting"></a>日志报告</h3>
<div class="paragraph">
<p>如果要向logger发送报告，您必须提供一个 <code>Vertx</code> 对象：</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">to</dt>
<dd>
<p><em>log</em> <code>:</code> <em>logger name</em></p>
</dd>
<dt class="hdlist1">示例</dt>
<dd>
<p><code>log:mylogger</code></p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_event_bus_reporting"><a class="anchor" href="#_event_bus_reporting"></a>事件总线报告</h3>
<div class="paragraph">
<p>如果要向事件总线报告事件，那么您必须提供一个 <code>Vertx</code> 对象：</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">to</dt>
<dd>
<p><em>bus</em> <code>:</code> <em>event bus address</em></p>
</dd>
<dt class="hdlist1">示例</dt>
<dd>
<p><code>bus:the-address</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>它将测试套件的执行过程和报告解耦合。</p>
</div>
<div class="paragraph">
<p>通过事件总线发送的消息可以通过 <code><a href="../../apidocs/io/vertx/ext/unit/collect/EventBusCollector.html">EventBusCollector</a></code> 来收集起来，
并实现自定义报告</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">EventBusCollector collector = EventBusCollector.create(
    vertx,
    <span class="hljs-keyword">new</span> ReportingOptions().addReporter(
        <span class="hljs-keyword">new</span> ReportOptions().setTo(<span class="hljs-string">&quot;file:report.xml&quot;</span>).setFormat(<span class="hljs-string">&quot;junit&quot;</span>)));

collector.register(<span class="hljs-string">&quot;the-address&quot;</span>);</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vertx_integration"><a class="anchor" href="#_vertx_integration"></a>Vertx 整合</h2>
<div class="sectionbody">
<div class="paragraph">
<p>默认情况下，断言和失败必须在 <code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html">TestContext</a></code> 之内完成，另外 <em>断言失败</em> 仅仅在Vert.x Unit的调用下才会有效。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;my_test_case&quot;</span>, ctx -&gt; {

  <span class="hljs-comment">// &#x27;失败&#x27;会被Vert.x Unit 报告</span>
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;it failed!&quot;</span>);
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>在一个常规的Vert.x回调中，会忽略失败：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.test(<span class="hljs-string">&quot;test-server&quot;</span>, testContext -&gt; {
  HttpServer server = vertx.createHttpServer().requestHandler(req -&gt; {
    <span class="hljs-keyword">if</span> (req.path().equals(<span class="hljs-string">&quot;/somepath&quot;</span>)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AssertionError(<span class="hljs-string">&quot;Wrong path!&quot;</span>);
    }
    req.response().end();
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>从 Vert.x 3.3 版本开始，您可以设置一个全局异常处理器来报告 event loop 没有捕捉到的异常：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">suite.before(testContext -&gt; {

  <span class="hljs-comment">// 报告未被捕捉到到异常，以其作为 Vert.x Unit 失败事件</span>
  vertx.exceptionHandler(testContext.exceptionHandler());
});

suite.test(<span class="hljs-string">&quot;test-server&quot;</span>, testContext -&gt; {
  HttpServer server = vertx.createHttpServer().requestHandler(req -&gt; {
    <span class="hljs-keyword">if</span> (req.path().equals(<span class="hljs-string">&quot;/somepath&quot;</span>)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AssertionError(<span class="hljs-string">&quot;Wrong path!&quot;</span>);
    }
    req.response().end();
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果异常处理器设置在 <em>before</em> 部分，那么 <code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html">TestContext</a></code> 则会在 <em>before</em>,
<em>test</em> 和 <em>after</em> 部分之间共享。
所以将异常处理器置于 <em>before</em> 部分是一个正确到做法</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_junit_integration"><a class="anchor" href="#_junit_integration"></a>Junit 整合</h2>
<div class="sectionbody">
<div class="paragraph">
<p>尽管Vertx Unit是多语言的，且不是基于Junit的，但是您依然可以在Junit上运行Vert.x Unit测试套件以及测试用例，
并允许您将测试用例整合到JUnit，允许整合到您的build system，也可以整合到IDE中。</p>
</div>
<div class="listingblock">
<div class="title">将一个Java类作为JUnit测试套件</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@RunWith(VertxUnitRunner.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JUnitTestSuite</span> </span>{
  <span class="hljs-meta">@Test</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSomething</span><span class="hljs-params">(TestContext context)</span> </span>{
    context.assertFalse(<span class="hljs-keyword">false</span>);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><a href="../../apidocs/io/vertx/ext/unit/junit/VertxUnitRunner.html">VertxUnitRunner</a></code> 使用Junit注解来对这个类进行解析，
并创建该类对象之后创建测试套件。
该类中的方法应该在参数中声明一个 <code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html">TestContext</a></code> 参数
，不声明该参数也是可以的。
然而 <code>TestContext</code> 是在异步测试过程中能够获取相关Vertx对象的唯一方式。</p>
</div>
<div class="paragraph">
<p>在Groovy语言中，
用 <code>io.vertx.groovy.ext.unit.junit.VertxUnitRunner</code> 也可以达到整合Junit的目的。</p>
</div>
<div class="sect2">
<h3 id="_running_a_test_on_a_vert_x_context"><a class="anchor" href="#_running_a_test_on_a_vert_x_context"></a>在 Vert.x 上下文中执行一个测试</h3>
<div class="paragraph">
<p>默认情况下执行测试方法的是Junit线程。
<code><a href="../../apidocs/io/vertx/ext/unit/junit/RunTestOnContext.html">RunTestOnContext</a></code> Junit rule可以改变这个行为，使测试方法都运行于 Vert.x event loop 线程。</p>
</div>
<div class="paragraph">
<p>因此，当某状态在测试方法/Vert.x处理器之间共享时，您就需要小心了，因为他们并不是在同一个线程上运行的，
例如，在Vert.x处理器中累加一个计数器然后在测试方法中断言计数器的值。
使用恰当地同步机制是解决此问题的一种方式，
另外还可以在Vert.x context中执行测试方法，这样共享状态则会在处理器之间传播。</p>
</div>
<div class="paragraph">
<p>以此目的，<code><a href="../../apidocs/io/vertx/ext/unit/junit/RunTestOnContext.html">RunTestOnContext</a></code> rule 需要一个 <code><a href="../../apidocs/io/vertx/core/Vertx.html">Vertx</a></code> 对象。
您可以主动提供这个对象，如果不提供，这个 rule 会隐式创建它。
这个对象可以在测试执行过程中获取，
这也使该rule成为管理Vert.x实例的一种方式。</p>
</div>
<div class="listingblock">
<div class="title">运行一个Java类作为JUnit测试套件</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@RunWith(VertxUnitRunner.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RunOnContextJUnitTestSuite</span> </span>{

  <span class="hljs-meta">@Rule</span>
  <span class="hljs-keyword">public</span> RunTestOnContext rule = <span class="hljs-keyword">new</span> RunTestOnContext();

  <span class="hljs-meta">@Test</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSomething</span><span class="hljs-params">(TestContext context)</span> </span>{
    <span class="hljs-comment">// 使用这个隐式创建的vertx对象</span>
    Vertx vertx = rule.vertx();
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>rule可以用 {@literal @Rule} 或 {@literal @ClassRule} 注解修饰，
前者管理每个测试的Vert.x对象，后者则管理该测试类中所有测试方法相关的那一个Vertx对象。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">警告</div>
</td>
<td class="content">
切记，用这个rule的时候您不可以阻塞 event loop 。使用像 <code>CountDownLatch</code> 类的做法，
则必须要小心。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_timeout"><a class="anchor" href="#_timeout"></a>超时</h3>
<div class="paragraph">
<p>Vert.x Unit 默认超时时间两分钟，这可以用 <code>@Test</code> 注解中的 <code>timeout</code> 属性来指定：</p>
</div>
<div class="listingblock">
<div class="title">在测试方法级别配置超时时间</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JunitTestWithTimeout</span> </span>{

  <span class="hljs-meta">@Test(timeout = 1000l)</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSomething</span><span class="hljs-params">(TestContext context)</span> </span>{
    <span class="hljs-comment">//...</span>
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>对于更全局的配置，可以用 <code><a href="../../apidocs/io/vertx/ext/unit/junit/Timeout.html">Timeout</a></code> rule：</p>
</div>
<div class="listingblock">
<div class="title">类级别超时时间配置</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@RunWith(VertxUnitRunner.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TimeoutTestSuite</span> </span>{

  <span class="hljs-meta">@Rule</span>
  <span class="hljs-keyword">public</span> Timeout rule = Timeout.seconds(<span class="hljs-number">1</span>);

  <span class="hljs-meta">@Test</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSomething</span><span class="hljs-params">(TestContext context)</span> </span>{
    <span class="hljs-comment">//...</span>
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">注意</div>
</td>
<td class="content">
<code>@Test</code> 的超时设置会覆盖 <code><a href="../../apidocs/io/vertx/ext/unit/junit/Timeout.html">Timeout</a></code> rule 的配置。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_parameterized_tests"><a class="anchor" href="#_parameterized_tests"></a>参数化测试</h3>
<div class="paragraph">
<p>JUnit提供了非常有用的 <code>参数化</code> 测试，
Vert.x Unit 测试可以利用 <code><a href="../../apidocs/io/vertx/ext/unit/junit/VertxUnitRunnerWithParametersFactory.html">VertxUnitRunnerWithParametersFactory</a></code> 来指定执行器：</p>
</div>
<div class="listingblock">
<div class="title">运行参数化的Vert.x Unit测试</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@RunWith(Parameterized.class)</span>
<span class="hljs-meta">@Parameterized</span>.UseParametersRunnerFactory(VertxUnitRunnerWithParametersFactory.class)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleParameterizedTest</span> </span>{

  <span class="hljs-meta">@Parameterized</span>.<span class="hljs-function">Parameters
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Iterable&lt;Integer&gt; <span class="hljs-title">data</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> Arrays.asList(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
  }

  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SimpleParameterizedTest</span><span class="hljs-params">(<span class="hljs-keyword">int</span> value)</span> </span>{
    <span class="hljs-comment">//...</span>
  }

  <span class="hljs-meta">@Test</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSomething</span><span class="hljs-params">(TestContext context)</span> </span>{
    <span class="hljs-comment">// 用当前值来执行测试方法</span>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Groovy语言中，您可以用 <code>io.vertx.groovy.ext.unit.junit.VertxUnitRunnerWithParametersFactory</code> 来实现参数化测试：</p>
</div>
</div>
<div class="sect2">
<h3 id="_repeating_a_test"><a class="anchor" href="#_repeating_a_test"></a>重复测试</h3>
<div class="paragraph">
<p>当测试随机条件或测试不经常失败时，例如在竞争条件下，
为了增加测试失败的可能性，多次运行同一测试是个方便的方式。</p>
</div>
<div class="paragraph">
<p>如果用Junit，测试用例必须用 <code><a href="../../apidocs/io/vertx/ext/unit/junit/Repeat.html">@Repeat</a></code> 注解修饰，来指定重复执行。
测试用例也必须定义根据自身规则定义 <code><a href="../../apidocs/io/vertx/ext/unit/junit/RepeatRule.html">RepeatRule</a></code> 。</p>
</div>
<div class="listingblock">
<div class="title">用Junit重复测试</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-meta">@RunWith(VertxUnitRunner.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RepeatingTest</span> </span>{

  <span class="hljs-meta">@Rule</span>
  <span class="hljs-keyword">public</span> RepeatRule rule = <span class="hljs-keyword">new</span> RepeatRule();

  <span class="hljs-meta">@Repeat(1000)</span>
  <span class="hljs-meta">@Test</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSomething</span><span class="hljs-params">(TestContext context)</span> </span>{
    <span class="hljs-comment">// 执行1000次</span>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果声明了RepeatRule，那么 <em>before</em> 和 <em>after</em> 方法会在每次执行测试方法时都执行一次。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">注意</div>
</td>
<td class="content">
重复测试是顺序执行
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_using_with_other_assertion_libraries"><a class="anchor" href="#_using_with_other_assertion_libraries"></a>用其他断言库</h3>
<div class="paragraph">
<p>Vert.x Unit 的可用性从 Vert.x 3.3 开始有了巨大的提升。您可以用
<a href="http://hamcrest.org/">Hamcrest</a> ，
<a href="http://joel-costigliola.github.io/assertj/">AssertJ</a> ，
<a href="https://github.com/rest-assured/rest-assured/">Rest Assured</a> ，甚至其他您想用的断言库来写测试用例。这是由 <a href="#vertx_integration">[vertx_integration]</a> 章节里介绍的全局异常处理器的机制实现的。</p>
</div>
<div class="paragraph">
<p>您可以在 <a href="https://github.com/vert-x3/vertx-examples/tree/master/unit-examples">vertx-examples</a> 工程中，
找到Vert.x Unit中用 Hamcrest 和 AssertJ 的示例。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_java_language_integration"><a class="anchor" href="#_java_language_integration"></a>Java 语言整合</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_test_suite_integration"><a class="anchor" href="#_test_suite_integration"></a>测试套件整合</h3>
<div class="paragraph">
<p>Java语言提供了class，
而且可以用如下映射规则来直接利用Java class创建测试套件：</p>
</div>
<div class="paragraph">
<p>检查 <code>测试套件对象</code> 的参数和方法，保留带有 <code><a href="../../apidocs/io/vertx/ext/unit/TestContext.html">TestContext</a></code> 参数的public且非静态方法并通过方法名映射到Vert.x Unit测试套件：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>before</code> : before callback</p>
</li>
<li>
<p><code>after</code> : after callback</p>
</li>
<li>
<p><code>beforeEach</code> : beforeEach callback</p>
</li>
<li>
<p><code>afterEach</code> : afterEach callback</p>
</li>
<li>
<p>以 <em>test</em> 开头的名称: 以方法名命名的测试用例</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">用Java类写的测试套件</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTestSuite</span> </span>{

  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSomething</span><span class="hljs-params">(TestContext context)</span> </span>{
    context.assertFalse(<span class="hljs-keyword">false</span>);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>这个类可以很容易的转化成Vert.x 测试套件：</p>
</div>
<div class="listingblock">
<div class="title">从Java对象创建测试套件</div>
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">TestSuite suite = TestSuite.create(<span class="hljs-keyword">new</span> MyTestSuite());</code></pre>
</div>
</div>
</div>
</div>
</div></div></div></div></div></div><footer class="jsx-aeedcf66895f49d7"><div class="jsx-aeedcf66895f49d7 container"><div class="jsx-aeedcf66895f49d7 footer-nav-section"><div class="jsx-aeedcf66895f49d7 footer-nav-list footer-logo"><a class="jsx-aeedcf66895f49d7" href="/"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 1232.6 315.2&#x27; style=&#x27;enable-background:new 0 0 1232.6 315.2&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23782a91%7d%3c/style%3e%3cpath d=&#x27;M120.9 214.2 190.5 0h52.3l-98.5 273.8H98.2L0 0h52.1l68.8 214.2zm291.2-62.6H299.6v84.2H431v38H252V0h177.7v38.4H299.6V114h112.5v37.6zm83.7-113.2H546c16.5.3 29 4.4 37.3 12.4 8.3 8 12.5 19.4 12.5 34 0 14-4.5 25.1-13.5 33.2-9 8.1-21.6 12.1-37.6 12.1h-27.1v24.2l86.1 119.5h51v-2.4l-77.2-106.7c24.9-5.5 43.3-21.7 52.6-35.9 8.2-12.6 13.3-27.7 13.3-46 0-26.8-8.6-47.4-25.8-61.5C600.5 7.1 576.1 0 544.5 0h-96.3v273.8h47.6&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1052.3 157.7-41.5 62.7 29.7 53.4h85.1z&#x27;/%3e%3ccircle class=&#x27;st0&#x27; cx=&#x27;827.9&#x27; cy=&#x27;274.7&#x27; r=&#x27;40.5&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1037 0-47.6 74.2L949 0h-84l85.3 135.8-67.1 105.7c5.7 9.5 9.1 20.5 9.2 32.4h50.1L1121.3 0H1037z&#x27;/%3e%3cpath d=&#x27;M763.5 273.8c.1-9.9 2.5-19.2 6.6-27.5V38.4h85.4V0H638.2v38.4h84.6v235.4h40.7zm414-266.9h-15.3v42.2h-8.5V6.9h-15.2V0h39v6.9zM1193 0l14.2 37.7L1221.3 0h11v49.1h-8.5V32.9l.8-21.7-14.5 37.9h-6.1l-14.5-37.8.8 21.6v16.2h-8.5V0h11.2z&#x27;/%3e%3c/svg%3e" alt="Vert.x Logo" class="jsx-aeedcf66895f49d7"/></a></div><div class="jsx-aeedcf66895f49d7 footer-nav-list"><h5 class="jsx-aeedcf66895f49d7">Eclipse Vert.x</h5><ul class="jsx-aeedcf66895f49d7 "><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7 navbar-menu-item" href="/docs/">文档</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/download/">下载</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/blog/">博客</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/community/">社区</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/translation/">翻译团队</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://github.com/eclipse-vertx/vert.x" class="jsx-aeedcf66895f49d7">GitHub</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://github.com/vertx-china/vertx-web-site" class="jsx-aeedcf66895f49d7">翻译GitHub</a></li></ul></div><div class="jsx-aeedcf66895f49d7 footer-nav-list"><h5 class="jsx-aeedcf66895f49d7">资源</h5><ul class="jsx-aeedcf66895f49d7 "><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/faq/">答疑</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/channels/">联系渠道</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://how-to.vertx.io/" class="jsx-aeedcf66895f49d7">操作指南</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://start.vertx.io/" class="jsx-aeedcf66895f49d7">应用生成器</a></li><li class="jsx-aeedcf66895f49d7"><a href="/.well-known/security.txt" class="jsx-aeedcf66895f49d7">security.txt</a></li></ul></div><div class="jsx-aeedcf66895f49d7 footer-nav-list"><h5 class="jsx-aeedcf66895f49d7">Eclipse</h5><ul class="jsx-aeedcf66895f49d7 "><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/" class="jsx-aeedcf66895f49d7">Eclipse 基金会</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/privacy.php" class="jsx-aeedcf66895f49d7">隐私政策</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/termsofuse.php" class="jsx-aeedcf66895f49d7">使用条款</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/copyright.php" class="jsx-aeedcf66895f49d7">版权代理</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/" class="jsx-aeedcf66895f49d7">法律资源</a></li></ul></div></div><div class="jsx-aeedcf66895f49d7 footer-copyright"><div class="jsx-aeedcf66895f49d7 footer-copyright-remarks">© <!-- -->2022<!-- --> Eclipse Vert.x™<br class="jsx-aeedcf66895f49d7"/>Eclipse Vert.x™ 是开源的，并在<a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7">Eclipse Public License 2.0</a>和<a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7">Apache License 2.0</a>协议下获得了双重许可。<br class="jsx-aeedcf66895f49d7 footer-copyright-break"/>网站由 <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7">Michel Krämer</a> 设计。</div><div class="jsx-aeedcf66895f49d7 footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 281.3 91.1&#x27; style=&#x27;enable-background:new 0 0 281.3 91.1&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23f79422%7d.st1%7bfill:%233d3c3b%7d%3c/style%3e%3cg id=&#x27;Layer_1_1_&#x27;%3e%3cpath class=&#x27;st0&#x27; d=&#x27;M265.7 84 257 73h-2.7v17.7h3.3v-12l9.3 12h2.1V73h-3.3v11zm-32.4-8.3c4.2 0 5.8 3.3 5.8 6.3s-1.6 6-5.8 6-5.7-3.1-5.8-6 1.7-6.3 5.8-6.3zm0-3c-6.1 0-9.1 4.7-9.1 9.3 0 4.7 2.9 9.1 9.1 9.1s9-4.6 9.1-9.2-3-9.2-9.1-9.2zm-21.2 18V73h-3.3v17.7h3.3zm-23.6 0h3.3V76h5.6v-3h-14.6v3h5.6l.1 14.7zm-18.9-6.5H163l3.3-7.6 3.3 7.6zm2.8 6.5h3.6L168.2 73h-3.6l-8 17.7h3.6l1.5-3.3h9.3l1.4 3.3zm-38-14.6h3.6c3.9 0 5.5 2.8 5.5 5.5.1 2.8-1.5 5.8-5.5 5.8h-3.6V76.1zm3.7-3.1h-6.9v17.7h6.9c6.2 0 8.9-4.5 8.9-9s-2.8-8.7-8.9-8.7zm-22.4 11L107 73h-2.7v17.7h3.3v-12l9.3 12h2.1V73h-3.3v11zM88.2 73v10.2c0 3-1.6 4.9-4.3 4.9s-4.6-1.7-4.6-4.9V73H76v10.1c0 5.3 3.6 7.9 7.9 7.9 4.4 0 7.7-2.7 7.7-7.9V73h-3.4zm-33 2.7c4.2 0 5.8 3.3 5.8 6.3s-1.6 6-5.8 6-5.7-3.1-5.8-6 1.7-6.3 5.8-6.3zm0-3c-6.1 0-9.1 4.7-9.1 9.3s2.9 9.1 9.1 9.1 9-4.6 9.1-9.2-3-9.2-9.1-9.2zm-29.7 18v-6.5h8.9v-3.1h-8.9v-4.8h9.4V73H22.2v17.6h3.3z&#x27;/%3e%3cpath class=&#x27;st1&#x27; d=&#x27;M269.4 54.4h-22.2v-8.9h21.4v-6.9h-21.4v-9.1h22.2v-7.2h-29.6v39.5h29.6v-7.4zm-40-25.6c-3-6.1-9.4-7.8-15.5-7.8-7.3 0-15.3 3.4-15.3 11.5 0 8.9 7.4 11 15.5 12 5.2.6 9.1 2.1 9.1 5.8 0 4.3-4.4 5.9-9.1 5.9s-9.4-1.9-11.1-6.3l-6.2 3.2c2.9 7.2 9.1 9.7 17.2 9.7 8.8 0 16.6-3.8 16.6-12.6 0-9.4-7.7-11.6-15.9-12.6-4.7-.6-8.8-1.5-8.8-5 0-2.9 2.6-5.2 8.2-5.2 4.3 0 8 2.2 9.4 4.4l5.9-3zM176 22.2c-6.2-.1-12.4 0-18.6 0v39.5h7.4V50.1H176c19.4 0 19.4-27.9 0-27.9zm-11.1 7.1H176c9.5 0 9.5 14 0 14h-11.2l.1-14zm-18 32.5V22.2h-7.4v39.5l7.4.1zm-44-39.6v39.5h27.7v-6.9h-20.3V22.2h-7.4zM90.7 51.7c-2.7 2.5-6.2 4-9.9 4-9.8 0-13.5-6.8-13.6-13.4s4.1-13.7 13.6-13.7c3.5-.1 7 1.3 9.5 3.7l5-4.8c-3.8-3.9-9.1-6-14.5-6-14.3 0-21 10.5-20.9 20.8s6.3 20.3 20.9 20.3c5.6.1 11-2 15-5.9l-5.1-5zm-39 2.7H29.5v-8.9h21.4v-6.9H29.5v-9.1h22.2v-7.2H22.2v39.5h29.6l-.1-7.4z&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;M9.8 18.2C18.8 4.1 36.9-.8 52.1 6l-1-.7C35.7-4.6 15.2-.1 5.3 15.3s-5.4 35.9 10 45.8l1.1.6C3.8 50.8.8 32.3 9.8 18.2z&#x27;/%3e%3cpath class=&#x27;st1&#x27; d=&#x27;M272.2 26.1c0-2.5 2.1-4.6 4.6-4.6 2.5 0 4.6 2.1 4.6 4.6 0 2.5-2.1 4.6-4.6 4.6-2.6 0-4.6-2.1-4.6-4.6zm8.6 0c0-2.2-1.8-4.1-4-4.1s-4.1 1.8-4.1 4.1c0 2.2 1.7 4 3.9 4.1h.1c2.3 0 4.1-1.8 4.1-4.1zm-6-2.5h2.3c1.1 0 1.9.5 1.9 1.6 0 .7-.4 1.3-1.1 1.5l1.2 1.7h-1.4l-1-1.5h-.7v1.5h-1.1l-.1-4.8zm2.2 2.3c.5 0 .8-.3.8-.7s-.3-.7-.8-.7h-1v1.3l1 .1z&#x27;/%3e%3c/g%3e%3c/svg%3e" alt="Eclipse foundation Logo" class="jsx-aeedcf66895f49d7"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"4.1.4/vertx-unit/java","title":"Vertx unit","fallbackGitHubStars":null,"toc":"\u003cdiv id=\"toc\" class=\"toc\"\u003e\n\u003cdiv id=\"toctitle\"\u003eTable of Contents\u003c/div\u003e\n\u003cul class=\"sectlevel1\"\u003e\n\u003cli\u003e\u003ca href=\"#_introduction\"\u003e介绍\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_writing_a_test_suite\"\u003e编写一个测试套件\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_asserting\"\u003e断言\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_assertequals\"\u003eassertEquals\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_assertnotequals\"\u003eassertNotEquals\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_assertnull\"\u003eassertNull\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_assertnotnull\"\u003eassertNotNull\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_assertinrange\"\u003eassertInRange\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_asserttrue_and_assertfalse\"\u003e断言成功以及断言失败\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_failing\"\u003e失败\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_third_party_assertion_framework\"\u003e使用第三方断言框架\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_asynchronous_testing\"\u003e异步测试\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_asynchronous_assertions\"\u003e异步断言\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_repeating_test\"\u003e重复测试\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_sharing_objects\"\u003e共享对象\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_running\"\u003e运行\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_test_suite_completion\"\u003e测试套件执行完毕\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_time_out\"\u003e超时\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_event_loop\"\u003e事件循环（Event loop）\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_reporting\"\u003e测试报告\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_console_reporting\"\u003e控制台报告\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_file_reporting\"\u003e文件报告\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_log_reporting\"\u003e日志报告\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_event_bus_reporting\"\u003e事件总线报告\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_vertx_integration\"\u003eVertx 整合\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_junit_integration\"\u003eJunit 整合\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_running_a_test_on_a_vert_x_context\"\u003e在 Vert.x 上下文中执行一个测试\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_timeout\"\u003e超时\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_parameterized_tests\"\u003e参数化测试\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_repeating_a_test\"\u003e重复测试\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_with_other_assertion_libraries\"\u003e用其他断言库\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_java_language_integration\"\u003eJava 语言整合\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_test_suite_integration\"\u003e测试套件整合\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e","contents":"\u003ch1\u003eVertx unit\u003c/h1\u003e\n\n\u003cdiv id=\"preamble\"\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e异步多语言单元测试。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_introduction\"\u003e\u003ca class=\"anchor\" href=\"#_introduction\"\u003e\u003c/a\u003e介绍\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Unit 用多语言的异步API在JVM上 运行单元测试。\nVert.x Unit 借鉴了已有的测试框架，例如 \u003ca href=\"http://junit.org\"\u003eJUnit\u003c/a\u003e or \u003ca href=\"http://qunitjs.com\"\u003eQUnit\u003c/a\u003e\n并同时遵循了Vert.x的做法。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e所以 Vert.x Unit 自然就成为了测试 Vert.x 应用的选择。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e要使用 Vert.x Unit，\n那么请添加如下依赖：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eMaven （在您的 \u003ccode\u003epom.xml\u003c/code\u003e 文件）：\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-unit\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e4.1.4\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escope\u003c/span\u003e\u0026gt;\u003c/span\u003etest\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escope\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eGradle （在您的 \u003ccode\u003ebuild.gradle\u003c/code\u003e 文件）：\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003etestCompile ${io.vertx}:${vertx-unit}:\u003cspan class=\"hljs-number\"\u003e4.1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e.4\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Unit 能够以各种方式使用并可以在您代码中任何位置运行，它仅以正确的方式报告执行结果。\n以下示例展示了一个最简的测试用例套件。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite suite = TestSuite.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the_test_suite\u0026quot;\u003c/span\u003e);\nsuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  String s = \u003cspan class=\"hljs-string\"\u003e\u0026quot;value\u0026quot;\u003c/span\u003e;\n  context.assertEquals(\u003cspan class=\"hljs-string\"\u003e\u0026quot;value\u0026quot;\u003c/span\u003e, s);\n});\nsuite.run();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003erun\u003c/code\u003e 方法执行了整个套件并且执行套件中所有的测试用例。\n测试用例套件可能失败也可能通过。如果外界不关心测试结果，\n那么测试用例的通过与否便不重要。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite suite = TestSuite.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the_test_suite\u0026quot;\u003c/span\u003e);\nsuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  String s = \u003cspan class=\"hljs-string\"\u003e\u0026quot;value\u0026quot;\u003c/span\u003e;\n  context.assertEquals(\u003cspan class=\"hljs-string\"\u003e\u0026quot;value\u0026quot;\u003c/span\u003e, s);\n});\nsuite.run(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e TestOptions().addReporter(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ReportOptions().setTo(\u003cspan class=\"hljs-string\"\u003e\u0026quot;console\u0026quot;\u003c/span\u003e)));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e执行之时，测试套件会在控制台报告每一步的结果：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003eBegin test suite the_test_suite\nBegin test my_test\nPassed my_test\nEnd test suite the_test_suite , run: 1, Failures: 0, Errors: 0\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003ereporters\u003c/code\u003e 选项配置了套件执行器的reporter，用以报告测试用例执行结果，\n更多信息详见 \u003ca href=\"#reporting\"\u003e[reporting]\u003c/a\u003e 章节\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_writing_a_test_suite\"\u003e\u003ca class=\"anchor\" href=\"#_writing_a_test_suite\"\u003e\u003c/a\u003e编写一个测试套件\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e测试套件是一系列测试用例组成的有名称的集合，测试用例则是一个直接回调。\n套件生命周期中可以设置回调函数，这些函数可以在执行测试用例前后执行，\n也可以在用作初始化/发布服务的套件前后。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite suite = TestSuite.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the_test_suite\u0026quot;\u003c/span\u003e);\nsuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_1\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 1\u003c/span\u003e\n});\nsuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_2\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 2\u003c/span\u003e\n});\nsuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_3\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 3\u003c/span\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e流式API让测试用例可以作链式调用：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite suite = TestSuite.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the_test_suite\u0026quot;\u003c/span\u003e);\nsuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_1\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 1\u003c/span\u003e\n}).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_2\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 2\u003c/span\u003e\n}).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_3\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 3\u003c/span\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e测试用例的声明顺序并不保证其执行顺序，所以测试用例不可以依赖于其他测试用例来运行。\n这不是一个好的做法。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Unit 提供了 \u003cem\u003ebefore\u003c/em\u003e 和 \u003cem\u003eafter\u003c/em\u003e 回调来作总体的启动或清理资源操作：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite suite = TestSuite.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the_test_suite\u0026quot;\u003c/span\u003e);\nsuite.before(context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// 测试套件启动\u003c/span\u003e\n}).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_1\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 1\u003c/span\u003e\n}).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_2\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 2\u003c/span\u003e\n}).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_3\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 3\u003c/span\u003e\n}).after(context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// 测试套件清理资源\u003c/span\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e这些方法的声明顺序并不重要，示例中在用例之前声明 \u003cem\u003ebefore\u003c/em\u003e ，\n在用例之后声明 \u003cem\u003eafter\u003c/em\u003e ，\n然而在运行套件之前，他们可以在任何位置声明，\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003cem\u003ebefore\u003c/em\u003e 回调函数执行于所有测试用例之前，如果其运行失败，\n则整个测试套件将停止运行并报告失败结果。 \u003cem\u003eafter\u003c/em\u003e 回调函数在整个测试套件中最后执行，\n除非 \u003cem\u003ebefore\u003c/em\u003e 回调函数运行失败。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e类似的，Vert.x Unit 提供了 \u003cem\u003ebeforeEach\u003c/em\u003e 和 \u003cem\u003eafterEach\u003c/em\u003e 回调，\n在每一个测试用例前后执行：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite suite = TestSuite.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the_test_suite\u0026quot;\u003c/span\u003e);\nsuite.beforeEach(context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// 测试用例启动\u003c/span\u003e\n}).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_1\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 1\u003c/span\u003e\n}).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_2\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 2\u003c/span\u003e\n}).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case_3\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// Test 3\u003c/span\u003e\n}).afterEach(context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// 测试用例资源清理\u003c/span\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003cem\u003ebeforeEach\u003c/em\u003e 回调函数执行于每一个测试用例之前，一旦其运行失败，那测试用例将不再被执行，\n并报告失败结果。 \u003cem\u003eafterEach\u003c/em\u003e 回调函数仅在测试用例之后被执行，\n除非 \u003cem\u003ebeforeEach\u003c/em\u003e 函数运行失败。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_asserting\"\u003e\u003ca class=\"anchor\" href=\"#_asserting\"\u003e\u003c/a\u003e断言\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Unit 提供了 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html\"\u003eTestContext\u003c/a\u003e\u003c/code\u003e 对象用来在测试用例中作断言操作。\n\u003cem\u003econtext\u003c/em\u003e 对象提供了用于断言的常用方法。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_assertequals\"\u003e\u003ca class=\"anchor\" href=\"#_assertequals\"\u003e\u003c/a\u003eassertEquals\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e断言两个对象相等，适用于 \u003cem\u003e基本类型\u003c/em\u003e 和 \u003cem\u003ejson类型\u003c/em\u003e 。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  context.assertEquals(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, callbackCount);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e有一个重载的方法用于提供测试信息：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  context.assertEquals(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, callbackCount, \u003cspan class=\"hljs-string\"\u003e\u0026quot;Should have been 10 instead of \u0026quot;\u003c/span\u003e + callbackCount);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e通常地，每一个断言函数都提供了重载的版本。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_assertnotequals\"\u003e\u003ca class=\"anchor\" href=\"#_assertnotequals\"\u003e\u003c/a\u003eassertNotEquals\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e与 \u003cem\u003eassertEquals\u003c/em\u003e 相反。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  context.assertNotEquals(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, callbackCount);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_assertnull\"\u003e\u003ca class=\"anchor\" href=\"#_assertnull\"\u003e\u003c/a\u003eassertNull\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e断言一个对象是null，适用于 \u003cem\u003e基本类型\u003c/em\u003e 和 \u003cem\u003ejson类型\u003c/em\u003e 。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  context.assertNull(\u003cspan class=\"hljs-keyword\"\u003enull\u003c/span\u003e);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_assertnotnull\"\u003e\u003ca class=\"anchor\" href=\"#_assertnotnull\"\u003e\u003c/a\u003eassertNotNull\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e与 \u003cem\u003eassertNull\u003c/em\u003e 相反。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  context.assertNotNull(\u003cspan class=\"hljs-string\"\u003e\u0026quot;not null!\u0026quot;\u003c/span\u003e);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_assertinrange\"\u003e\u003ca class=\"anchor\" href=\"#_assertinrange\"\u003e\u003c/a\u003eassertInRange\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html#assertInRange-double-double-double-\"\u003eassertInRange\u003c/a\u003e\u003c/code\u003e 方法作用于实数范围。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003esuite.test(\"my_test_case\", context -\u0026gt; {\n\n  // 断言0.1 在误差范围 +/- 0.5范围内等于0.2\n\n  context.assertInRange(0.1, 0.2, 0.5);\n});\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_asserttrue_and_assertfalse\"\u003e\u003ca class=\"anchor\" href=\"#_asserttrue_and_assertfalse\"\u003e\u003c/a\u003e断言成功以及断言失败\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e对于布尔表达式的断言。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  context.assertTrue(\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e);\n  context.assertFalse(value \u0026gt; \u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_failing\"\u003e\u003ca class=\"anchor\" href=\"#_failing\"\u003e\u003c/a\u003e失败\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e最后但并非最不重要的，\u003cem\u003etest\u003c/em\u003e 提供了一个 \u003cem\u003efail\u003c/em\u003e 方法用来抛出断言错误的异常：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  context.fail(\u003cspan class=\"hljs-string\"\u003e\u0026quot;That should never happen\u0026quot;\u003c/span\u003e);\n  \u003cspan class=\"hljs-comment\"\u003e// 剩下的代码不会执行。\u003c/span\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e失败\u003c/code\u003e 对象本身既可以是 \u003cem\u003estring\u003c/em\u003e 也可以是一个 \u003cem\u003eerror\u003c/em\u003e 。\n\u003cem\u003eerror\u003c/em\u003e 对象取决于所使用的编程语言，对于 Java 或者 Groovy 而言，可以是任何 \u003cem\u003eThrowable\u003c/em\u003e 的子类，\n对于 JavaScript 则是一个 \u003cem\u003eerror\u003c/em\u003e ，对于 Ruby 则是一个 \u003cem\u003eException\u003c/em\u003e。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_using_third_party_assertion_framework\"\u003e\u003ca class=\"anchor\" href=\"#_using_third_party_assertion_framework\"\u003e\u003c/a\u003e使用第三方断言框架\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e您也可以用任何其他的断言框架，例如比较流行的 \u003cem\u003ehamcrest\u003c/em\u003e 和 \u003cem\u003eassertj\u003c/em\u003e 。\n我们建议您用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html#verify-io.vertx.core.Handler-\"\u003everify\u003c/a\u003e\u003c/code\u003e ，\n使用我们提供的 \u003cem\u003e处理器（Handler）\u003c/em\u003e 来执行断言。\n这样的话，我们才能正确的处理异步测试的结束动作。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; context.verify(v -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// 这里 junit中的 Assert 对象可以是 assertj hamcrest或其他库中的Assert对象\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// 甚至可以手动抛出 AssertionError\u003c/span\u003e\n  Assert.assertNotNull(\u003cspan class=\"hljs-string\"\u003e\u0026quot;not null!\u0026quot;\u003c/span\u003e);\n  Assert.assertEquals(\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e, callbackCount);\n}));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_asynchronous_testing\"\u003e\u003ca class=\"anchor\" href=\"#_asynchronous_testing\"\u003e\u003c/a\u003e异步测试\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e前述示例的前提是，假设所有的测试用例在各自回调之后会结束，\n这是测试用例回调函数的默认行为。在测试用例回调函数之后结束测试是可取的，\n例如：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003eAsync 对象异步的完成测试用例\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  Async async = context.async();\n  eventBus.consumer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the-address\u0026quot;\u003c/span\u003e, msg -\u0026gt; {\n    \u003cb class=\"conum\"\u003e(2)\u003c/b\u003e\n    async.complete();\n  });\n  \u003cb class=\"conum\"\u003e(1)\u003c/b\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"colist arabic\"\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e回调函数结束，但是测试用例没结束\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e总线事件的回调函数来终止测试\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html#async--\"\u003easync\u003c/a\u003e\u003c/code\u003e 方法创建一个 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Async.html\"\u003eAsync\u003c/a\u003e\u003c/code\u003e 对象表示测试用例还未结束。\n当执行 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Async.html#complete--\"\u003ecomplete\u003c/a\u003e\u003c/code\u003e 方法时，\n测试用例才算结束。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003e注意\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\n当 \u003ccode\u003ecomplete\u003c/code\u003e 回调函数未被执行时，测试用例会在指定超时时间之后失败。\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e同一个测试用例中可以创建多个 \u003ccode\u003eAsync\u003c/code\u003e 对象，\n必须调用所有Async对象的 \u003cem\u003ecompleted\u003c/em\u003e 方法来终止测试。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e多个Async对象合作\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n\n  HttpClient client = vertx.createHttpClient();\n  client.request(HttpMethod.GET, \u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, context.asyncAssertSuccess(req -\u0026gt; {\n      req.send(context.asyncAssertSuccess(resp -\u0026gt; {\n        context.assertEquals(\u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e, resp.statusCode());\n      }));\n    }));\n\n  Async async = context.async();\n  vertx.eventBus().consumer(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the-address\u0026quot;\u003c/span\u003e, msg -\u0026gt; {\n    async.complete();\n  });\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAsync 对象也可以用在 \u003cem\u003ebefore\u003c/em\u003e 或 \u003cem\u003eafter\u003c/em\u003e 回调中，\n这将很方便的在 \u003cem\u003ebefore\u003c/em\u003e 回调中，实现依赖于多个异步结果的启动操作：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e执行测试用例之前异步启动 http server\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.before(context -\u0026gt; {\n  Async async = context.async();\n  HttpServer server = vertx.createHttpServer();\n  server.requestHandler(requestHandler);\n  server.listen(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, ar -\u0026gt; {\n    context.assertTrue(ar.succeeded());\n    async.complete();\n  });\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e您也可以等待 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Async.html\"\u003eAsync\u003c/a\u003e\u003c/code\u003e 直到其结束，\n类似Java的 count-down latch：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003eWait for completion\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eAsync async = context.async();\nHttpServer server = vertx.createHttpServer();\nserver.requestHandler(requestHandler);\nserver.listen(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, ar -\u0026gt; {\n  context.assertTrue(ar.succeeded());\n  async.complete();\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// Wait until completion\u003c/span\u003e\nasync.awaitSuccess();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock warning\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003e警告\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\n该方法不应该在事件循环（event loop）上执行！\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAsync 可以创建一个初始计数值，\n当用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Async.html#countDown--\"\u003ecountDown\u003c/a\u003e\u003c/code\u003e 方法将 count-down 的值减到0时：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e等待，直到count-down值为0\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eAsync async = context.async(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e);\nHttpServer server = vertx.createHttpServer();\nserver.requestHandler(requestHandler);\nserver.listen(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, ar -\u0026gt; {\n  context.assertTrue(ar.succeeded());\n  async.countDown();\n});\n\nvertx.setTimer(\u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e, id -\u0026gt; {\n  async.complete();\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// Wait until completion of the timer and the http request\u003c/span\u003e\nasync.awaitSuccess();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e调用Async的 \u003ccode\u003ecomplete()\u003c/code\u003e 方法会像往常一样结束，实际上它将count-down值直接设置为 \u003ccode\u003e0\u003c/code\u003e 。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_asynchronous_assertions\"\u003e\u003ca class=\"anchor\" href=\"#_asynchronous_assertions\"\u003e\u003c/a\u003e异步断言\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html\"\u003eTestContext\u003c/a\u003e\u003c/code\u003e 提供了很有用的方法，这些方法提供了强大的异步测试框架：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html#asyncAssertSuccess--\"\u003easyncAssertSuccess\u003c/a\u003e\u003c/code\u003e 方法返回一个类似 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Async.html\"\u003eAsync\u003c/a\u003e\u003c/code\u003e {@literal Handler\u0026lt;AsyncResult\u0026lt;T\u0026gt;\u0026gt;} 对象，\n它在运行成功时执行 \u003ccode\u003eAsync\u003c/code\u003e 对象，并在失败时，\n让整个测试用例失败，并返回失败原因。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eAsync async = context.async();\nvertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.verticle\u0026quot;\u003c/span\u003e, ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    async.complete();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    context.fail(ar.cause());\n  }\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// 可用如下代替\u003c/span\u003e\n\nvertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.verticle\u0026quot;\u003c/span\u003e, context.asyncAssertSuccess());\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html#asyncAssertSuccess-io.vertx.core.Handler-\"\u003easyncAssertSuccess\u003c/a\u003e\u003c/code\u003e 方法返回一个类似于 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Async.html\"\u003eAsync\u003c/a\u003e\u003c/code\u003e 的 {@literal Handler\u0026lt;AsyncResult\u0026lt;T\u0026gt;\u0026gt;} 对象，\n运行成功时它执行了代理 {@literal Handler\u0026lt;T\u0026gt;} ，\n而在运行出错时让整个测试用例失败，并返回错误原因。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eAtomicBoolean started = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e AtomicBoolean();\nAsync async = context.async();\nvertx.deployVerticle(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e AbstractVerticle() {\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003estart\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e()\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ethrows\u003c/span\u003e Exception \u003c/span\u003e{\n    started.set(\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e);\n  }\n}, ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    context.assertTrue(started.get());\n    async.complete();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    context.fail(ar.cause());\n  }\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// Can be replaced by\u003c/span\u003e\n\nvertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.verticle\u0026quot;\u003c/span\u003e, context.asyncAssertSuccess(id -\u0026gt; {\n  context.assertTrue(started.get());\n}));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e当 \u003ccode\u003eHandler\u003c/code\u003e 退出时，Async对象同时也会处于 \u003ccode\u003ecompleted\u003c/code\u003e 状态，除非Async对象在函数调用期间被创建，\n这会在 \u003cem\u003e链式\u003c/em\u003e 异步操作时提供方便：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eAsync async = context.async();\nvertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.verticle\u0026quot;\u003c/span\u003e, ar1 -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar1.succeeded()) {\n    vertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.otherverticle\u0026quot;\u003c/span\u003e, ar2 -\u0026gt; {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar2.succeeded()) {\n        async.complete();\n      } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        context.fail(ar2.cause());\n      }\n    });\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    context.fail(ar1.cause());\n  }\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// Can be replaced by\u003c/span\u003e\n\nvertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.verticle\u0026quot;\u003c/span\u003e, context.asyncAssertSuccess(id -\u0026gt;\n        vertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_otherverticle\u0026quot;\u003c/span\u003e, context.asyncAssertSuccess())\n));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html#asyncAssertFailure--\"\u003easyncAssertFailure\u003c/a\u003e\u003c/code\u003e 方法返回了一个类似 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Async.html\"\u003eAsync\u003c/a\u003e\u003c/code\u003e 的 {@literal Handler\u0026lt;AsyncResult\u0026lt;T\u0026gt;\u0026gt;} 对象,\n它在运行失败时执行 \u003ccode\u003eAsync\u003c/code\u003e ，\n并在成功时让测试用例失败。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eAsync async = context.async();\nvertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.verticle\u0026quot;\u003c/span\u003e, ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    context.fail();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    async.complete();\n  }\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// 可用如下代替\u003c/span\u003e\n\nvertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.verticle\u0026quot;\u003c/span\u003e, context.asyncAssertFailure());\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html#asyncAssertFailure-io.vertx.core.Handler-\"\u003easyncAssertFailure\u003c/a\u003e\u003c/code\u003e 方法返回一个类似 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Async.html\"\u003eAsync\u003c/a\u003e\u003c/code\u003e 的  {@literal Handler\u0026lt;AsyncResult\u0026lt;T\u0026gt;\u0026gt;} 对象，\n它在运行失败时，\n执行代理处理器 {@literal Handler\u0026lt;Throwable\u0026gt;} ，\n并在执行成功时让测试用例失败。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eAsync async = context.async();\nvertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.verticle\u0026quot;\u003c/span\u003e, ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    context.fail();\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    context.assertTrue(ar.cause() \u003cspan class=\"hljs-keyword\"\u003einstanceof\u003c/span\u003e IllegalArgumentException);\n    async.complete();\n  }\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// 可用如下代替\u003c/span\u003e\n\nvertx.deployVerticle(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my.verticle\u0026quot;\u003c/span\u003e, context.asyncAssertFailure(cause -\u0026gt; {\n  context.assertTrue(cause \u003cspan class=\"hljs-keyword\"\u003einstanceof\u003c/span\u003e IllegalArgumentException);\n}));\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003eHandler\u003c/code\u003e 退出时，这个Async也会处于完成状态，除非在执行过程中，创建了新的Async对象\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_repeating_test\"\u003e\u003ca class=\"anchor\" href=\"#_repeating_test\"\u003e\u003c/a\u003e重复测试\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e当测试随机条件或测试不经常失败时，例如在竞争条件下，\n为了增加测试失败的可能性，多次运行同一测试是个方便的方式。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e重复一个测试\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_suite\u0026quot;\u003c/span\u003e).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e, context -\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// 这里会执行1000次\u003c/span\u003e\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果声明了 \u003cem\u003ebeforeEach\u003c/em\u003e 和 \u003cem\u003eafterEach\u003c/em\u003e 回调，那么每当测试用例执行一次，它们也会被执行一次。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003e注意\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\n重复的测试用例是顺序执行的\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_sharing_objects\"\u003e\u003ca class=\"anchor\" href=\"#_sharing_objects\"\u003e\u003c/a\u003e共享对象\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html\"\u003eTestContext\u003c/a\u003e\u003c/code\u003e 对象提供了 \u003ccode\u003eget\u003c/code\u003e/\u003ccode\u003eput\u003c/code\u003e/\u003ccode\u003eremove\u003c/code\u003e 操作，用于在回调函数之间共享状态。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e在 \u003cem\u003ebefore\u003c/em\u003e 回调函数中添加的任何对象都可以在其他回调函数中访问到。\n每一个测试用例都会操作一个共享状态的副本。所以，对于共享状态的更新仅仅在一个测试用例之内有效。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e在回调函数之间共享状态\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_suite\u0026quot;\u003c/span\u003e).before(context -\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// cases host对于所有的测试用例可见\u003c/span\u003e\n  context.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;host\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e);\n\n}).beforeEach(context -\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// 为每一个测试用例生成一个port\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e port = helper.randomPort();\n\n  \u003cspan class=\"hljs-comment\"\u003e// 获取host\u003c/span\u003e\n  String host = context.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;host\u0026quot;\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-comment\"\u003e// 启动服务\u003c/span\u003e\n  Async async = context.async();\n  HttpServer server = vertx.createHttpServer();\n  server.requestHandler(req -\u0026gt; {\n    req.response().setStatusCode(\u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e).end();\n  });\n  server.listen(port, host, ar -\u0026gt; {\n    context.assertTrue(ar.succeeded());\n    context.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;port\u0026quot;\u003c/span\u003e, port);\n    async.complete();\n  });\n\n}).test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// 获取共享状态\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e port = context.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;port\u0026quot;\u003c/span\u003e);\n  String host = context.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;host\u0026quot;\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-comment\"\u003e// 发送请求\u003c/span\u003e\n  HttpClient client = vertx.createHttpClient();\n  client.request(HttpMethod.GET, port, host, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/resource\u0026quot;\u003c/span\u003e, context.asyncAssertSuccess(req -\u0026gt; {\n    req.send(context.asyncAssertSuccess(resp -\u0026gt; {\n      context.assertEquals(\u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e, resp.statusCode());\n    }));\n  }));\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock warning\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003e警告\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\n只有java才能共享所有类型的对象，其他语言只能共享基本类型和json类型。\n其他类型对象的共享操作应该利用当前编程语言的特性来实现。\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_running\"\u003e\u003ca class=\"anchor\" href=\"#_running\"\u003e\u003c/a\u003e运行\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e当创建了一个测试套件，除非调用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestSuite.html#run--\"\u003erun\u003c/a\u003e\u003c/code\u003e 方法，否则测试用例不会执行。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e运行一个测试套件\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.run();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e这个测试套件也可以用指定的 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/Vertx.html\"\u003eVertx\u003c/a\u003e\u003c/code\u003e 来运行：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e提供一个Vertx对象来执行测试用例\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.run(vertx);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e当使用 \u003ccode\u003eVertx\u003c/code\u003e 对象来运行时，测试套件则会使用该Vert.x对象的 eventloop 来运行测试用例，\n更多信息详见 \u003ca href=\"#event_loop\"\u003e[event_loop]\u003c/a\u003e 一章。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e一个测试套件可以用Vert.x命令行接口来执行，即使用 \u003ccode\u003evertx test\u003c/code\u003e 命令：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e用Vert.x CLI 执行测试用例\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u0026gt; vertx test the_test_suite.js\nBegin test suite the_test_suite\nSucceeded in deploying verticle\nBegin test my_test_case\nPassed my_test_case\nEnd test suite my_suite , run: 1, Failures: 0, Errors: 0\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e这种测试套件仅仅需要通过 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestSuite.html#run--\"\u003erun\u003c/a\u003e\u003c/code\u003e 命令来执行，\n\u003ccode\u003evertx test\u003c/code\u003e 命令则负责配置报告和超时等。\n例如：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite suite = TestSuite.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the_test_suite\u0026quot;\u003c/span\u003e);\nsuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, context -\u0026gt; {\n  String s = \u003cspan class=\"hljs-string\"\u003e\u0026quot;value\u0026quot;\u003c/span\u003e;\n  context.assertEquals(\u003cspan class=\"hljs-string\"\u003e\u0026quot;value\u0026quot;\u003c/span\u003e, s);\n});\nsuite.run();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003evertx test\u003c/code\u003e 命令扩展了 \u003ccode\u003evertx run\u003c/code\u003e 命令。它改变了JVM的退出行为，\n当测试套件开始执行，并且返回了测试结果（例如success (0) or failure (1)）的时候，JVM才会退出。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003e注意\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\n同一个Verticle中可以执行多个测试套件，\nVert.x Unit会等待所有的测试套件执行完成。\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_test_suite_completion\"\u003e\u003ca class=\"anchor\" href=\"#_test_suite_completion\"\u003e\u003c/a\u003e测试套件执行完毕\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e我们没办法假设测试套件将何时执行完毕，\n如果有代码需要在测试用例执行完毕之后才执行，\n那么这段代码要声明在 \u003cem\u003eafter\u003c/em\u003e 回调函数中或者让其作为 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Completion.html\"\u003eCompletion\u003c/a\u003e\u003c/code\u003e 的回调。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e测试套件 \u003cem\u003e执行回调函数\u003c/em\u003e\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestCompletion completion = suite.run(vertx);\n\n\u003cspan class=\"hljs-comment\"\u003e// 普通的完成回调函数\u003c/span\u003e\ncompletion.handler(ar -\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ar.succeeded()) {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Test suite passed!\u0026quot;\u003c/span\u003e);\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    System.out.println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Test suite failed:\u0026quot;\u003c/span\u003e);\n    ar.cause().printStackTrace();\n  }\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Completion.html\"\u003eCompletion\u003c/a\u003e\u003c/code\u003e 对象也提供了 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Completion.html#resolve-io.vertx.core.Promise-\"\u003eresolve\u003c/a\u003e\u003c/code\u003e 方法，\n该方法接收 \u003ccode\u003ePromise\u003c/code\u003e 对象参数，这个 \u003ccode\u003ePromise\u003c/code\u003e 会在测试套件执行时被触发通知。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e用测试套件解析初始Promise\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestCompletion completion = suite.run();\n\n\u003cspan class=\"hljs-comment\"\u003e// 当测试套件执行完毕，Promise则被解析\u003c/span\u003e\ncompletion.resolve(startPromise);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e这样可以轻松的创建一个 \u003cem\u003etest\u003c/em\u003e Verticle，这个Verticle是由测试套件部署起来的，\n而部署Verticle的代码中可以很容易的知悉成功或者失败。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ecompletion 对象也可以像 count-down latch 一样使用，他会阻塞直至测试套件执行完。\n这应该用于当前线程与测试套件线程不一样时的场景。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e阻塞至测试套件执行完毕\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eCompletion completion = suite.run();\n\n\u003cspan class=\"hljs-comment\"\u003e//  阻塞至测试套件执行完毕\u003c/span\u003e\ncompletion.await();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003eawait\u003c/code\u003e 方法在线程被interrupt或者超时的时候抛出异常。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/Completion.html#awaitSuccess--\"\u003eawaitSuccess\u003c/a\u003e\u003c/code\u003e 方法是一个变种，\n它在测试套件运行失败时抛出异常\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e阻塞至测试套件执行成功\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eCompletion completion = suite.run();\n\n\u003cspan class=\"hljs-comment\"\u003e// 阻塞至测试套件执行成功 否则抛出异常\u003c/span\u003e\ncompletion.awaitSuccess();\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_time_out\"\u003e\u003ca class=\"anchor\" href=\"#_time_out\"\u003e\u003c/a\u003e超时\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e测试套件中的每一个测试用例都必须在超时时间内执行完毕。默认超时时间是 \u003cem\u003e2分钟\u003c/em\u003e ，\n超时时间可以用 \u003cem\u003etest options\u003c/em\u003e 来设置：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e设置测试套件的超时时间\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestOptions options = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e TestOptions().setTimeout(\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// 10秒超时时间\u003c/span\u003e\nsuite.run(options);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_event_loop\"\u003e\u003ca class=\"anchor\" href=\"#_event_loop\"\u003e\u003c/a\u003e事件循环（Event loop）\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Unit 是一系列task的执行过程，每个task由前一个task的完成动作来触发。\n这些task负责平衡eventloop的调度，\n但是这取决于当前执行上下文（例如，测试套件在 \u003ccode\u003emain\u003c/code\u003e 方法中执行，或者嵌入一个verticle ）\n是否配置了 \u003ccode\u003eVertx\u003c/code\u003e 对象。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestOptions.html#setUseEventLoop-java.lang.Boolean-\"\u003esetUseEventLoop\u003c/a\u003e\u003c/code\u003e\n以配置事件循环（event loop）的使用方式：\u003c/p\u003e\n\u003c/div\u003e\n\u003ctable class=\"tableblock frame-all grid-all stretch\"\u003e\n\u003ccaption class=\"title\"\u003eTable 1. 事件循环（Event loop）的使用\u003c/caption\u003e\n\u003ccolgroup\u003e\n\u003ccol style=\"width: 25%;\"\u003e\n\u003ccol style=\"width: 25%;\"\u003e\n\u003ccol style=\"width: 25%;\"\u003e\n\u003ccol style=\"width: 25%;\"\u003e\n\u003c/colgroup\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth class=\"tableblock halign-left valign-top\"\u003e\u003c/th\u003e\n\u003cth class=\"tableblock halign-left valign-top\"\u003euseEventLoop:null\u003c/th\u003e\n\u003cth class=\"tableblock halign-left valign-top\"\u003euseEventLoop:true\u003c/th\u003e\n\u003cth class=\"tableblock halign-left valign-top\"\u003euseEventLoop:false\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e\u003ccode\u003eVertx\u003c/code\u003e instance\u003c/p\u003e\u003c/td\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e使用 vertx event loop\u003c/p\u003e\u003c/td\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e使用 vertx event loop\u003c/p\u003e\u003c/td\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e强制不使用 event loop\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e在 \u003ccode\u003eVerticle\u003c/code\u003e 中\u003c/p\u003e\u003c/td\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e使用当前 event loop\u003c/p\u003e\u003c/td\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e使用当前 event loop\u003c/p\u003e\u003c/td\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e强制不使用 event loop\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e在 \u003cem\u003emain\u003c/em\u003e 方法中\u003c/p\u003e\u003c/td\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e不使用 event loop\u003c/p\u003e\u003c/td\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e错误\u003c/p\u003e\u003c/td\u003e\n\u003ctd class=\"tableblock halign-left valign-top\"\u003e\u003cp class=\"tableblock\"\u003e不使用 event loop\u003c/p\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003euseEventLoop\u003c/code\u003e 默认为 \u003ccode\u003enull\u003c/code\u003e , 这说明，\n如果条件允许则使用一个event loop，当没有event loop 可用时，不使用event loop。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_reporting\"\u003e\u003ca class=\"anchor\" href=\"#_reporting\"\u003e\u003c/a\u003e测试报告\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e测试报告是测试套件中的重要部分，\nVert.x Unit可以用不同配置来运行不同的 reporter。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e默认情况下，不配置reporter，但是当运行测试套件时，\n可以用 \u003cem\u003etest options\u003c/em\u003e 来配置一个或多个 reporter：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e使用终端reporter并将其用作junit xml文件\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eReportOptions consoleReport = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ReportOptions().\n    setTo(\u003cspan class=\"hljs-string\"\u003e\u0026quot;console\u0026quot;\u003c/span\u003e);\n\n\u003cspan class=\"hljs-comment\"\u003e// 将Junit报告信息文件放在当前目录\u003c/span\u003e\nReportOptions junitReport = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ReportOptions().\n    setTo(\u003cspan class=\"hljs-string\"\u003e\u0026quot;file:.\u0026quot;\u003c/span\u003e).\n    setFormat(\u003cspan class=\"hljs-string\"\u003e\u0026quot;junit\u0026quot;\u003c/span\u003e);\n\nsuite.run(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e TestOptions().\n        addReporter(consoleReport).\n        addReporter(junitReport)\n);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_console_reporting\"\u003e\u003ca class=\"anchor\" href=\"#_console_reporting\"\u003e\u003c/a\u003e控制台报告\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e将信息报告至JVM的 \u003ccode\u003eSystem.out\u003c/code\u003e 和 \u003ccode\u003eSystem.err\u003c/code\u003e ：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003e报告至\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003e\u003cem\u003e终端\u003c/em\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e格式\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003e\u003cem\u003e常规\u003c/em\u003e 或 \u003cem\u003ejunit\u003c/em\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_file_reporting\"\u003e\u003ca class=\"anchor\" href=\"#_file_reporting\"\u003e\u003c/a\u003e文件报告\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果想将报告输出至文件，您必须提供一个 \u003ccode\u003eVertx\u003c/code\u003e 对象：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003eto\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003e\u003cem\u003efile\u003c/em\u003e \u003ccode\u003e:\u003c/code\u003e \u003cem\u003edir name\u003c/em\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e格式\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003e\u003cem\u003esimple\u003c/em\u003e 或 \u003cem\u003ejunit\u003c/em\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e示例\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003e\u003ccode\u003efile:.\u003c/code\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e文件reporter会在配置的目录中创建文件，这些文件会以测试套件的名称和格式来命名\n（例如， \u003cem\u003e常规格式\u003c/em\u003e 创建 \u003cem\u003etxt\u003c/em\u003e 文件，_\njunit格式_ 创建 \u003cem\u003exml\u003c/em\u003e 文件）。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_log_reporting\"\u003e\u003ca class=\"anchor\" href=\"#_log_reporting\"\u003e\u003c/a\u003e日志报告\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果要向logger发送报告，您必须提供一个 \u003ccode\u003eVertx\u003c/code\u003e 对象：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003eto\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003e\u003cem\u003elog\u003c/em\u003e \u003ccode\u003e:\u003c/code\u003e \u003cem\u003elogger name\u003c/em\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e示例\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003e\u003ccode\u003elog:mylogger\u003c/code\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_event_bus_reporting\"\u003e\u003ca class=\"anchor\" href=\"#_event_bus_reporting\"\u003e\u003c/a\u003e事件总线报告\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果要向事件总线报告事件，那么您必须提供一个 \u003ccode\u003eVertx\u003c/code\u003e 对象：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003eto\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003e\u003cem\u003ebus\u003c/em\u003e \u003ccode\u003e:\u003c/code\u003e \u003cem\u003eevent bus address\u003c/em\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e示例\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003e\u003ccode\u003ebus:the-address\u003c/code\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e它将测试套件的执行过程和报告解耦合。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e通过事件总线发送的消息可以通过 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/collect/EventBusCollector.html\"\u003eEventBusCollector\u003c/a\u003e\u003c/code\u003e 来收集起来，\n并实现自定义报告\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eEventBusCollector collector = EventBusCollector.create(\n    vertx,\n    \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ReportingOptions().addReporter(\n        \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e ReportOptions().setTo(\u003cspan class=\"hljs-string\"\u003e\u0026quot;file:report.xml\u0026quot;\u003c/span\u003e).setFormat(\u003cspan class=\"hljs-string\"\u003e\u0026quot;junit\u0026quot;\u003c/span\u003e)));\n\ncollector.register(\u003cspan class=\"hljs-string\"\u003e\u0026quot;the-address\u0026quot;\u003c/span\u003e);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_vertx_integration\"\u003e\u003ca class=\"anchor\" href=\"#_vertx_integration\"\u003e\u003c/a\u003eVertx 整合\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e默认情况下，断言和失败必须在 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html\"\u003eTestContext\u003c/a\u003e\u003c/code\u003e 之内完成，另外 \u003cem\u003e断言失败\u003c/em\u003e 仅仅在Vert.x Unit的调用下才会有效。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my_test_case\u0026quot;\u003c/span\u003e, ctx -\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// \u0026#x27;失败\u0026#x27;会被Vert.x Unit 报告\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ethrow\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e RuntimeException(\u003cspan class=\"hljs-string\"\u003e\u0026quot;it failed!\u0026quot;\u003c/span\u003e);\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e在一个常规的Vert.x回调中，会忽略失败：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;test-server\u0026quot;\u003c/span\u003e, testContext -\u0026gt; {\n  HttpServer server = vertx.createHttpServer().requestHandler(req -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (req.path().equals(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/somepath\u0026quot;\u003c/span\u003e)) {\n      \u003cspan class=\"hljs-keyword\"\u003ethrow\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e AssertionError(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Wrong path!\u0026quot;\u003c/span\u003e);\n    }\n    req.response().end();\n  });\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e从 Vert.x 3.3 版本开始，您可以设置一个全局异常处理器来报告 event loop 没有捕捉到的异常：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003esuite.before(testContext -\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// 报告未被捕捉到到异常，以其作为 Vert.x Unit 失败事件\u003c/span\u003e\n  vertx.exceptionHandler(testContext.exceptionHandler());\n});\n\nsuite.test(\u003cspan class=\"hljs-string\"\u003e\u0026quot;test-server\u0026quot;\u003c/span\u003e, testContext -\u0026gt; {\n  HttpServer server = vertx.createHttpServer().requestHandler(req -\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (req.path().equals(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/somepath\u0026quot;\u003c/span\u003e)) {\n      \u003cspan class=\"hljs-keyword\"\u003ethrow\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e AssertionError(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Wrong path!\u0026quot;\u003c/span\u003e);\n    }\n    req.response().end();\n  });\n});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果异常处理器设置在 \u003cem\u003ebefore\u003c/em\u003e 部分，那么 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html\"\u003eTestContext\u003c/a\u003e\u003c/code\u003e 则会在 \u003cem\u003ebefore\u003c/em\u003e,\n\u003cem\u003etest\u003c/em\u003e 和 \u003cem\u003eafter\u003c/em\u003e 部分之间共享。\n所以将异常处理器置于 \u003cem\u003ebefore\u003c/em\u003e 部分是一个正确到做法\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_junit_integration\"\u003e\u003ca class=\"anchor\" href=\"#_junit_integration\"\u003e\u003c/a\u003eJunit 整合\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e尽管Vertx Unit是多语言的，且不是基于Junit的，但是您依然可以在Junit上运行Vert.x Unit测试套件以及测试用例，\n并允许您将测试用例整合到JUnit，允许整合到您的build system，也可以整合到IDE中。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e将一个Java类作为JUnit测试套件\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-meta\"\u003e@RunWith(VertxUnitRunner.class)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eJUnitTestSuite\u003c/span\u003e \u003c/span\u003e{\n  \u003cspan class=\"hljs-meta\"\u003e@Test\u003c/span\u003e\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003etestSomething\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(TestContext context)\u003c/span\u003e \u003c/span\u003e{\n    context.assertFalse(\u003cspan class=\"hljs-keyword\"\u003efalse\u003c/span\u003e);\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/junit/VertxUnitRunner.html\"\u003eVertxUnitRunner\u003c/a\u003e\u003c/code\u003e 使用Junit注解来对这个类进行解析，\n并创建该类对象之后创建测试套件。\n该类中的方法应该在参数中声明一个 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html\"\u003eTestContext\u003c/a\u003e\u003c/code\u003e 参数\n，不声明该参数也是可以的。\n然而 \u003ccode\u003eTestContext\u003c/code\u003e 是在异步测试过程中能够获取相关Vertx对象的唯一方式。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e在Groovy语言中，\n用 \u003ccode\u003eio.vertx.groovy.ext.unit.junit.VertxUnitRunner\u003c/code\u003e 也可以达到整合Junit的目的。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_running_a_test_on_a_vert_x_context\"\u003e\u003ca class=\"anchor\" href=\"#_running_a_test_on_a_vert_x_context\"\u003e\u003c/a\u003e在 Vert.x 上下文中执行一个测试\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e默认情况下执行测试方法的是Junit线程。\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/junit/RunTestOnContext.html\"\u003eRunTestOnContext\u003c/a\u003e\u003c/code\u003e Junit rule可以改变这个行为，使测试方法都运行于 Vert.x event loop 线程。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e因此，当某状态在测试方法/Vert.x处理器之间共享时，您就需要小心了，因为他们并不是在同一个线程上运行的，\n例如，在Vert.x处理器中累加一个计数器然后在测试方法中断言计数器的值。\n使用恰当地同步机制是解决此问题的一种方式，\n另外还可以在Vert.x context中执行测试方法，这样共享状态则会在处理器之间传播。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e以此目的，\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/junit/RunTestOnContext.html\"\u003eRunTestOnContext\u003c/a\u003e\u003c/code\u003e rule 需要一个 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/Vertx.html\"\u003eVertx\u003c/a\u003e\u003c/code\u003e 对象。\n您可以主动提供这个对象，如果不提供，这个 rule 会隐式创建它。\n这个对象可以在测试执行过程中获取，\n这也使该rule成为管理Vert.x实例的一种方式。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e运行一个Java类作为JUnit测试套件\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-meta\"\u003e@RunWith(VertxUnitRunner.class)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eRunOnContextJUnitTestSuite\u003c/span\u003e \u003c/span\u003e{\n\n  \u003cspan class=\"hljs-meta\"\u003e@Rule\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e RunTestOnContext rule = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e RunTestOnContext();\n\n  \u003cspan class=\"hljs-meta\"\u003e@Test\u003c/span\u003e\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003etestSomething\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(TestContext context)\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e// 使用这个隐式创建的vertx对象\u003c/span\u003e\n    Vertx vertx = rule.vertx();\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003erule可以用 {@literal @Rule} 或 {@literal @ClassRule} 注解修饰，\n前者管理每个测试的Vert.x对象，后者则管理该测试类中所有测试方法相关的那一个Vertx对象。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock warning\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003e警告\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\n切记，用这个rule的时候您不可以阻塞 event loop 。使用像 \u003ccode\u003eCountDownLatch\u003c/code\u003e 类的做法，\n则必须要小心。\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_timeout\"\u003e\u003ca class=\"anchor\" href=\"#_timeout\"\u003e\u003c/a\u003e超时\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Unit 默认超时时间两分钟，这可以用 \u003ccode\u003e@Test\u003c/code\u003e 注解中的 \u003ccode\u003etimeout\u003c/code\u003e 属性来指定：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e在测试方法级别配置超时时间\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eJunitTestWithTimeout\u003c/span\u003e \u003c/span\u003e{\n\n  \u003cspan class=\"hljs-meta\"\u003e@Test(timeout = 1000l)\u003c/span\u003e\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003etestSomething\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(TestContext context)\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e//...\u003c/span\u003e\n  }\n\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e对于更全局的配置，可以用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/junit/Timeout.html\"\u003eTimeout\u003c/a\u003e\u003c/code\u003e rule：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e类级别超时时间配置\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-meta\"\u003e@RunWith(VertxUnitRunner.class)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eTimeoutTestSuite\u003c/span\u003e \u003c/span\u003e{\n\n  \u003cspan class=\"hljs-meta\"\u003e@Rule\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e Timeout rule = Timeout.seconds(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e);\n\n  \u003cspan class=\"hljs-meta\"\u003e@Test\u003c/span\u003e\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003etestSomething\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(TestContext context)\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e//...\u003c/span\u003e\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003e注意\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\n\u003ccode\u003e@Test\u003c/code\u003e 的超时设置会覆盖 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/junit/Timeout.html\"\u003eTimeout\u003c/a\u003e\u003c/code\u003e rule 的配置。\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_parameterized_tests\"\u003e\u003ca class=\"anchor\" href=\"#_parameterized_tests\"\u003e\u003c/a\u003e参数化测试\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eJUnit提供了非常有用的 \u003ccode\u003e参数化\u003c/code\u003e 测试，\nVert.x Unit 测试可以利用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/junit/VertxUnitRunnerWithParametersFactory.html\"\u003eVertxUnitRunnerWithParametersFactory\u003c/a\u003e\u003c/code\u003e 来指定执行器：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e运行参数化的Vert.x Unit测试\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-meta\"\u003e@RunWith(Parameterized.class)\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e@Parameterized\u003c/span\u003e.UseParametersRunnerFactory(VertxUnitRunnerWithParametersFactory.class)\n\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eSimpleParameterizedTest\u003c/span\u003e \u003c/span\u003e{\n\n  \u003cspan class=\"hljs-meta\"\u003e@Parameterized\u003c/span\u003e.\u003cspan class=\"hljs-function\"\u003eParameters\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003estatic\u003c/span\u003e Iterable\u0026lt;Integer\u0026gt; \u003cspan class=\"hljs-title\"\u003edata\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e()\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Arrays.asList(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e);\n  }\n\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eSimpleParameterizedTest\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-keyword\"\u003eint\u003c/span\u003e value)\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e//...\u003c/span\u003e\n  }\n\n  \u003cspan class=\"hljs-meta\"\u003e@Test\u003c/span\u003e\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003etestSomething\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(TestContext context)\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e// 用当前值来执行测试方法\u003c/span\u003e\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eGroovy语言中，您可以用 \u003ccode\u003eio.vertx.groovy.ext.unit.junit.VertxUnitRunnerWithParametersFactory\u003c/code\u003e 来实现参数化测试：\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_repeating_a_test\"\u003e\u003ca class=\"anchor\" href=\"#_repeating_a_test\"\u003e\u003c/a\u003e重复测试\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e当测试随机条件或测试不经常失败时，例如在竞争条件下，\n为了增加测试失败的可能性，多次运行同一测试是个方便的方式。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果用Junit，测试用例必须用 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/junit/Repeat.html\"\u003e@Repeat\u003c/a\u003e\u003c/code\u003e 注解修饰，来指定重复执行。\n测试用例也必须定义根据自身规则定义 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/junit/RepeatRule.html\"\u003eRepeatRule\u003c/a\u003e\u003c/code\u003e 。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e用Junit重复测试\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-meta\"\u003e@RunWith(VertxUnitRunner.class)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eRepeatingTest\u003c/span\u003e \u003c/span\u003e{\n\n  \u003cspan class=\"hljs-meta\"\u003e@Rule\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e RepeatRule rule = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e RepeatRule();\n\n  \u003cspan class=\"hljs-meta\"\u003e@Repeat(1000)\u003c/span\u003e\n  \u003cspan class=\"hljs-meta\"\u003e@Test\u003c/span\u003e\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003etestSomething\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(TestContext context)\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e// 执行1000次\u003c/span\u003e\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e如果声明了RepeatRule，那么 \u003cem\u003ebefore\u003c/em\u003e 和 \u003cem\u003eafter\u003c/em\u003e 方法会在每次执行测试方法时都执行一次。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"admonitionblock note\"\u003e\n\u003ctable\u003e\n\u003ctr\u003e\n\u003ctd class=\"icon\"\u003e\n\u003cdiv class=\"title\"\u003e注意\u003c/div\u003e\n\u003c/td\u003e\n\u003ctd class=\"content\"\u003e\n重复测试是顺序执行\n\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_using_with_other_assertion_libraries\"\u003e\u003ca class=\"anchor\" href=\"#_using_with_other_assertion_libraries\"\u003e\u003c/a\u003e用其他断言库\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Unit 的可用性从 Vert.x 3.3 开始有了巨大的提升。您可以用\n\u003ca href=\"http://hamcrest.org/\"\u003eHamcrest\u003c/a\u003e ，\n\u003ca href=\"http://joel-costigliola.github.io/assertj/\"\u003eAssertJ\u003c/a\u003e ，\n\u003ca href=\"https://github.com/rest-assured/rest-assured/\"\u003eRest Assured\u003c/a\u003e ，甚至其他您想用的断言库来写测试用例。这是由 \u003ca href=\"#vertx_integration\"\u003e[vertx_integration]\u003c/a\u003e 章节里介绍的全局异常处理器的机制实现的。\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e您可以在 \u003ca href=\"https://github.com/vert-x3/vertx-examples/tree/master/unit-examples\"\u003evertx-examples\u003c/a\u003e 工程中，\n找到Vert.x Unit中用 Hamcrest 和 AssertJ 的示例。\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_java_language_integration\"\u003e\u003ca class=\"anchor\" href=\"#_java_language_integration\"\u003e\u003c/a\u003eJava 语言整合\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_test_suite_integration\"\u003e\u003ca class=\"anchor\" href=\"#_test_suite_integration\"\u003e\u003c/a\u003e测试套件整合\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eJava语言提供了class，\n而且可以用如下映射规则来直接利用Java class创建测试套件：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e检查 \u003ccode\u003e测试套件对象\u003c/code\u003e 的参数和方法，保留带有 \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/unit/TestContext.html\"\u003eTestContext\u003c/a\u003e\u003c/code\u003e 参数的public且非静态方法并通过方法名映射到Vert.x Unit测试套件：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ebefore\u003c/code\u003e : before callback\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eafter\u003c/code\u003e : after callback\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ebeforeEach\u003c/code\u003e : beforeEach callback\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eafterEach\u003c/code\u003e : afterEach callback\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e以 \u003cem\u003etest\u003c/em\u003e 开头的名称: 以方法名命名的测试用例\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e用Java类写的测试套件\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eMyTestSuite\u003c/span\u003e \u003c/span\u003e{\n\n  \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003etestSomething\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(TestContext context)\u003c/span\u003e \u003c/span\u003e{\n    context.assertFalse(\u003cspan class=\"hljs-keyword\"\u003efalse\u003c/span\u003e);\n  }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e这个类可以很容易的转化成Vert.x 测试套件：\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"title\"\u003e从Java对象创建测试套件\u003c/div\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003eTestSuite suite = TestSuite.create(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e MyTestSuite());\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e","version":"4.1.4"},"__N_SSG":true},"page":"/docs/[[...slug]]","query":{"slug":["4.1.4","vertx-unit","java"]},"buildId":"sTF7RnW1bBFtb3eCJ3RUK","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>