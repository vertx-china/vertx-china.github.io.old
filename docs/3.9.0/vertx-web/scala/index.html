<!DOCTYPE html><html lang="en"><head><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><link rel="alternate" type="application/rss+xml" href="/feed/rss.xml"/><link rel="alternate" type="application/atom+xml" href="/feed/atom.xml"/><link rel="alternate" type="application/json" href="/feed/feed.json"/><title>Vert.x-Web | Eclipse Vert.x</title><meta name="next-head-count" content="13"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-fb4928a82e023b99.js" defer=""></script><script src="/_next/static/chunks/pages/_app-36ed4044beee7ad1.js" defer=""></script><script src="/_next/static/chunks/615-9401e7d9f9589626.js" defer=""></script><script src="/_next/static/chunks/619-c1e6e35ea386e702.js" defer=""></script><script src="/_next/static/chunks/81-b150334e379339f6.js" defer=""></script><script src="/_next/static/chunks/78-b9ea158b548d1787.js" defer=""></script><script src="/_next/static/chunks/434-02978711e0879a69.js" defer=""></script><script src="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-87406f2eace3b4cc.js" defer=""></script><script src="/_next/static/e44OdkvskwZZNaOOJbJ_B/_buildManifest.js" defer=""></script><script src="/_next/static/e44OdkvskwZZNaOOJbJ_B/_ssgManifest.js" defer=""></script><script src="/_next/static/e44OdkvskwZZNaOOJbJ_B/_middlewareManifest.js" defer=""></script><style id="__jsx-400ec7965926e858">.dropdown-item.jsx-400ec7965926e858{white-space:nowrap;
line-height:2;
width:100%;
padding:0 1.5rem;
cursor:pointer}
.dropdown-item.jsx-400ec7965926e858:hover{background-color:#e9ecef}
.dropdown-item.active.jsx-400ec7965926e858{font-weight:400;
padding-left:.75rem}
.dropdown-item.has-active-siblings.jsx-400ec7965926e858:not(.active){padding-left:calc(0.75rem + 16px + 0.5em)}
.dropdown-item.jsx-400ec7965926e858 .dropdown-check-icon.jsx-400ec7965926e858{width:16px;
margin-right:.5em;
margin-top:1px}</style><style id="__jsx-6650573c8f14945d">.dropdown.jsx-6650573c8f14945d{position:relative;
display:inline-block}
.dropdown.jsx-6650573c8f14945d .dropdown-title.jsx-6650573c8f14945d{margin-right:0;
cursor:pointer;
-webkit-user-select:none;
-moz-user-select:none;
-ms-user-select:none;
user-select:none}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.jsx-6650573c8f14945d{position:absolute;
background-color:#f8f9fa;
box-shadow:0 2px 5px 0 rgba(0, 0, 0, .1);
border-radius:.8rem;
list-style-type:none;
padding:.6666666667rem 0;
margin:.25rem 0 0 0;
z-index:100;
display:none;
-webkit-user-select:none;
-moz-user-select:none;
-ms-user-select:none;
user-select:none}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.jsx-6650573c8f14945d a{color:#4d4d4d;
-webkit-text-decoration:none;
text-decoration:none;
font-weight:300}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.align-right.jsx-6650573c8f14945d{right:0}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.visible.jsx-6650573c8f14945d{display:block}
.dropdown.jsx-6650573c8f14945d .dropdown-menu.jsx-6650573c8f14945d a.jsx-6650573c8f14945d:hover{color:inherit}
.dropdown.jsx-6650573c8f14945d svg{margin-bottom:2px}</style><style id="__jsx-f705e145f931f504">.navbar{position:absolute;
top:2.75rem;
width:100%}
.navbar a{color:#3c3c3b}
.navbar a.navbar-menu-item, .navbar .dropdown-title{text-transform:uppercase}
.navbar a.navbar-menu-item:hover, .navbar .dropdown-title:hover{-webkit-text-decoration:none;
text-decoration:none;
color:#898987;
-webkit-transition:color .15s ease-in-out;
transition:color .15s ease-in-out}
.navbar .navbar-content{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
position:relative}
.navbar .navbar-content .navbar-logo{-webkit-flex:1;
-ms-flex:1;
flex:1}
.navbar .navbar-content .navbar-logo img{width:8.3rem}
.navbar .navbar-content .navbar-collapse-button{display:none;
cursor:pointer}
@media (max-width:1000px) {.navbar .navbar-content .navbar-collapse-button{display:inline-block}}
.navbar .navbar-content .navbar-collapse-button span{display:block;
width:33px;
height:4px;
margin-bottom:5px;
position:relative;
background:#3c3c3b;
border-radius:3px;
z-index:1;
transform-origin:4px 0;
-webkit-transition:-webkit-transform .5s cubic-bezier(0.77, 0.2, 0.05, 1), background .5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity .55s ease;
transition:transform .5s cubic-bezier(0.77, 0.2, 0.05, 1), background .5s cubic-bezier(0.77, 0.2, 0.05, 1), opacity .55s ease}
.navbar .navbar-content .navbar-collapse-button span:first-child{transform-origin:0% 0%}
.navbar .navbar-content .navbar-collapse-button span:nth-last-child(2){transform-origin:0% 100%}
.navbar .navbar-content .navbar-right{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-align-items:baseline;
-webkit-box-align:baseline;
-ms-flex-align:baseline;
align-items:baseline;
margin-bottom:10px}
@media (max-width:1000px) {.navbar .navbar-content .navbar-right{max-height:0;
-webkit-transition:max-height 200ms ease-in-out;
transition:max-height 200ms ease-in-out;
box-shadow:0 2px 5px 0 rgba(0, 0, 0, .1);
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
position:absolute;
top:2.75rem;
left:.8rem;
right:.8rem;
background-color:#f8f9fa;
overflow-x:auto;
overflow-y:hidden}}
.navbar .navbar-content .navbar-menu .navbar-menu-item{font-weight:400;
margin-right:2.5rem}
.navbar .navbar-content .navbar-menu .navbar-menu-item.with-drop-down{margin-right:1.8rem}
@media (max-width:1250px) {.navbar .navbar-content .navbar-menu .navbar-menu-item{margin-right:1.5rem}}
@media (max-width:1000px) {.navbar .navbar-content .navbar-menu .navbar-menu-item{display:block;
margin-bottom:1rem;
font-size:1.2rem}}
.navbar .navbar-content .navbar-menu .navbar-menu-item .external-link-icon{margin-left:.25em}
@media (max-width:1000px) {.navbar .navbar-content .navbar-menu{-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
padding:1rem}}
.navbar .navbar-content .navbar-social{margin-left:1.6rem;
font-size:.875rem}
.navbar .navbar-content .navbar-social svg{height:16px;
margin-bottom:2px}
@media (max-width:1000px) {.navbar .navbar-content .navbar-social svg{height:1rem}}
@media (max-width:1250px) {.navbar .navbar-content .navbar-social{margin-left:1rem}}
@media (max-width:1000px) {.navbar .navbar-content .navbar-social{margin-left:auto;
padding:0 1rem 1rem 0;
font-size:1rem}}
@media (max-width:768px) {.navbar{top:1rem}}
.page .navbar{top:0;
padding-top:1.5rem;
padding-bottom:1rem;
position:fixed;
background-color:#fff;
z-index:2}</style><style id="__jsx-20d862052e50feff">.search input{color:#adb5bd;
border:1px solid #dee2e6;
border-radius:.4rem;
font-size:.875rem;
padding:.25rem 1.8rem .35rem 1.8rem;
width:100%;
-webkit-transition:color .15s ease-in-out, border-color .15s ease-in-out;
transition:color .15s ease-in-out, border-color .15s ease-in-out}
.search input:focus{border-color:#adb5bd;
color:#3c3c3b}
.search .search-icon, .search .search-icon-delete{position:absolute;
top:.55rem;
height:1rem;
stroke:#adb5bd;
-webkit-transition:stroke .15s ease-in-out;
transition:stroke .15s ease-in-out}
.search .search-icon{left:.4rem}
.search input:focus+.search-icon{stroke:#6f6970}
.search .search-icon-delete{stroke:#6f6970;
right:.4rem;
height:.75rem;
top:.7rem;
opacity:0;
-webkit-transition:opacity .15s ease-in-out;
transition:opacity .15s ease-in-out;
cursor:text}
.search.has-content .search-icon-delete{opacity:1;
cursor:pointer}</style><style id="__jsx-117e429f22e394dc">.search-results, .search-results-none{font-size:.875rem;
overflow:auto;
list-style-type:none;
padding-left:0;
display:none}
.search-results.visible, .search-results-none.visible{display:block}
.search-results{list-style-type:none;
padding:0;
margin-bottom:0}
.search-results li{display:block;
padding:.5rem;
margin-bottom:1rem;
border-radius:.4rem;
border:1px solid transparent;
cursor:pointer}
.search-results li.active{background-color:#f8f9fa;
border:1px solid #e9ecef}
.search-results li h5{margin:0 0 .5rem 0;
font-size:1em}
.search-results li .search-results-highlight{background-color:#ff0}
.search-results-none{padding:1rem .5rem;
text-align:center;
width:100%}</style><style id="__jsx-d1843944f2d67b">.search-panel{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column;
position:relative}</style><style id="__jsx-aeedcf66895f49d7">footer{font-size:.875rem;
padding-top:3rem;
padding-bottom:4rem;
background-color:#f8f9fa;
border-top:1px solid #dee2e6;
margin-top:1rem;
color:#6f6970}
footer h5{font-size:1rem;
margin-top:0;
margin-bottom:1rem;
color:#3c3c3b;
text-transform:uppercase}
footer ul{padding:0;
list-style:none;
line-height:2}
footer a{color:#6f6970}
footer .footer-logo img, footer .footer-copyright-eclipse-logo img{-webkit-filter:grayscale(100);
filter:grayscale(100);
opacity:.5;
-webkit-transition:all .15s ease-in-out;
transition:all .15s ease-in-out}
footer .footer-logo img:hover, footer .footer-copyright-eclipse-logo img:hover{-webkit-filter:grayscale(0);
filter:grayscale(0);
opacity:1}
footer .footer-nav-section{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
margin-bottom:6rem}
footer .footer-nav-section .footer-logo{margin-top:.4rem}
footer .footer-nav-section .footer-logo img{width:8.3rem}
footer .footer-nav-section .footer-nav-list{width:20%}
footer .footer-copyright{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:row;
-ms-flex-direction:row;
flex-direction:row;
-webkit-box-pack:justify;
-webkit-justify-content:space-between;
justify-content:space-between;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center}
footer .footer-copyright a{white-space:nowrap}
footer .footer-copyright .footer-copyright-eclipse-logo{width:17%;
margin-bottom:.5rem}
@media (max-width:1250px) {footer .footer-copyright .footer-copyright-break{display:none}
footer .footer-copyright .footer-copyright-eclipse-logo{width:30%}}
@media (max-width:1000px) {footer .footer-nav-section .footer-nav-list{width:25%}
footer .footer-copyright .footer-copyright-break{display:inline-block}
footer .footer-copyright .footer-copyright-eclipse-logo{width:40%}}
@media (max-width:768px) {footer .footer-nav-section{max-width:100%;
margin-left:auto;
margin-right:auto}}
@media (max-width:640px) {footer .footer-nav-section{max-width:80%;
margin-bottom:3rem;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column}
footer .footer-nav-section h5{cursor:pointer}
footer .footer-nav-section h5::after{display:inline-block;
content:"";
border-top:.4em solid;
border-right:.4em solid transparent;
border-bottom:0;
border-left:.4em solid transparent;
position:absolute;
top:.75rem;
right:0}
footer .footer-nav-section .footer-nav-list{width:100%;
position:relative}
footer .footer-nav-section .footer-nav-list ul{overflow-y:hidden;
max-height:0;
-webkit-transition:all 200ms ease-in-out;
transition:all 200ms ease-in-out}
footer .footer-nav-section .footer-nav-list ul.visible{margin-bottom:2rem}
footer .footer-nav-section .footer-logo{margin:0 auto 3rem auto;
width:auto}
footer .footer-copyright{max-width:80%;
text-align:center;
margin-left:auto;
margin-right:auto;
-webkit-flex-direction:column-reverse;
-ms-flex-direction:column-reverse;
flex-direction:column-reverse}
footer .footer-copyright .footer-copyright-eclipse-logo{width:7.6rem;
margin-bottom:1rem}}</style><style id="__jsx-efcc50be384cabc7">.page-content{margin-top:6em;
margin-bottom:8rem}
.docs .docs-content .docs-content-wrapper{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-box-pack:justify;
-webkit-justify-content:space-between;
justify-content:space-between}
.docs .docs-content .docs-content-wrapper aside{-webkit-flex:0 0 17rem;
-ms-flex:0 0 17rem;
flex:0 0 17rem}
.docs .docs-content .docs-content-wrapper aside .docs-content-wrapper-sidebar{position:-webkit-sticky;
position:sticky;
top:7em}
.docs .docs-content .docs-content-wrapper aside .search-panel{margin-top:1rem;
width:100%}
.docs .docs-content .docs-content-wrapper aside .search-panel .search-results{max-height:calc(100vh - 10rem - 1px)}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc{margin-top:1rem;
overflow-y:auto;
max-height:calc(100vh - 10rem - 3px)}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc #toctitle{display:none}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc ul{margin-top:0;
padding-left:0;
list-style-type:none}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc ul.sectlevel2{display:none}
.docs .docs-content .docs-content-wrapper aside .docs-content-toc ul li{padding:.3333333333rem 0}
.docs .docs-content .docs-content-wrapper aside.docs-has-search-results .docs-content-toc{display:none}
@media (max-width:1250px) {.docs .docs-content .docs-content-wrapper aside{-webkit-flex:0 0 15rem;
-ms-flex:0 0 15rem;
flex:0 0 15rem}}
@media (max-width:1000px) {.docs .docs-content .docs-content-wrapper aside{z-index:1;
position:fixed;
top:0;
right:0;
width:25rem;
height:100vh;
max-width:100%;
padding-top:6rem;
padding-left:2rem;
padding-right:2rem;
background-color:#fff;
border-left:1px solid #dee2e6;
-webkit-transform:translateX(100%);
-moz-transform:translateX(100%);
-ms-transform:translateX(100%);
transform:translateX(100%);
-webkit-transition:-webkit-transform 200ms ease-in-out;
transition:transform 200ms ease-in-out;
will-change:transform}
.docs .docs-content .docs-content-wrapper aside.collapse{-webkit-transform:translateX(0%);
-moz-transform:translateX(0%);
-ms-transform:translateX(0%);
transform:translateX(0%)}}
@media (max-width:640px) {.docs .docs-content .docs-content-wrapper aside{min-width:100%;
border-left:none}}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle{z-index:1000;
cursor:pointer;
display:none;
position:fixed;
-webkit-justify-content:center;
justify-content:center;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
right:2rem;
bottom:2rem;
color:#fff;
background-color:#4d4d4d;
padding:.5rem;
border-radius:.8rem;
-webkit-transition:background-color .15s ease-in-out;
transition:background-color .15s ease-in-out}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle .feather-list, .docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle .feather-x{display:block}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle .feather-x{position:absolute;
left:0;
top:0;
opacity:0;
-webkit-transition:opacity .15s ease-in-out;
transition:opacity .15s ease-in-out}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle:hover{background-color:#3c3c3b}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle.collapse .feather-list{opacity:0}
.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle.collapse .feather-x{opacity:1}
@media (max-width:1000px) {.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}}
@media (max-width:640px) {.docs .docs-content .docs-content-wrapper .docs-content-sidebar-toggle{right:1rem;
bottom:1rem}}
.docs .docs-content .docs-content-inner{max-width:calc(100% - 19.5rem);
overflow:hidden}
.docs .docs-content .docs-content-inner .docs-content-metadata{margin-top:1.2rem;
margin-bottom:1.2rem;
display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
flex-wrap:wrap;
-webkit-align-items:baseline;
-webkit-box-align:baseline;
-ms-flex-align:baseline;
align-items:baseline}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata{-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-repo{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
-webkit-flex:1;
-ms-flex:1;
flex:1}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left>*{margin-right:2rem}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left>*:last-child{margin-right:0}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left a{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-align-items:center;
-webkit-box-align:center;
-ms-flex-align:center;
align-items:center;
color:#6f6970;
white-space:nowrap}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left a:hover{color:#782b90}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left a .feather{margin-right:.25em;
height:1rem}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-left{flex-wrap:wrap;
margin-bottom:1rem}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version{-webkit-flex:1;
-ms-flex:1;
flex:1;
display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex}
@media (min-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version{-webkit-box-pack:end;
-ms-flex-pack:end;
-webkit-justify-content:flex-end;
justify-content:flex-end}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version svg{height:16px;
margin-bottom:-2px}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version svg{height:1rem;
margin-bottom:-1px}}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version .dropdown-menu a{-webkit-text-decoration:none;
text-decoration:none}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-version .dropdown-menu a:hover{color:#6f6970}
.docs .docs-content .docs-content-inner .docs-content-metadata .docs-content-metadata-label{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
margin-left:2rem}
.docs .docs-content .docs-content-inner h1{padding-top:0;
margin-top:.6rem;
line-height:1.2}
.docs .docs-content .docs-content-inner h1::after{content:"";
width:30%;
display:block;
border:2px solid #782b90;
border-radius:2px;
margin-top:1.1rem}
.docs .docs-content .docs-content-inner .ulist>ul{padding-left:1.1rem}
.docs .docs-content .docs-content-inner h2{border-top:1px solid #dee2e6;
margin-top:5rem;
padding-top:2rem}
.docs .docs-content .docs-content-inner h3, .docs .docs-content .docs-content-inner h4{margin-top:3rem}
@media (max-width:1250px) {.docs .docs-content .docs-content-inner{max-width:calc(100% - 17.5rem)}}
@media (max-width:1000px) {.docs .docs-content .docs-content-inner{max-width:100%}}
.docs .docs-content .admonitionblock{border-top-right-radius:.8rem;
border-bottom-right-radius:.8rem;
background-color:#f8f9fa;
padding:1rem;
margin:1.5rem 0;
border-left:9px solid transparent}
.docs .docs-content .admonitionblock.note, .docs .docs-content .admonitionblock.tip{border-color:#6cb9f0}
.docs .docs-content .admonitionblock.important, .docs .docs-content .admonitionblock.warning, .docs .docs-content .admonitionblock.caution{border-color:#f0a46c}
.docs .docs-content .admonitionblock tr{display:-webkit-box;
display:-webkit-flex;
display:-ms-flexbox;
display:flex;
-webkit-flex-direction:column;
-ms-flex-direction:column;
flex-direction:column}
.docs .docs-content .admonitionblock .title{font-weight:400}
.docs .docs-content .admonitionblock .title::after{content:":"}
.docs .docs-content dt{font-weight:400}
.docs .docs-content .anchor{opacity:0;
-webkit-align-self:flex-start;
-ms-flex-item-align:flex-start;
align-self:flex-start;
outline:none}
.docs .docs-content .anchor::after{content:"#";
position:absolute;
margin-left:-1.5rem;
color:#ced4da;
padding-right:.45rem}
.docs .docs-content .anchor:hover{opacity:1}
.docs .docs-content h2:hover .anchor, .docs .docs-content h3:hover .anchor, .docs .docs-content h4:hover .anchor, .docs .docs-content h5:hover .anchor, .docs .docs-content h6:hover .anchor{opacity:1}
.docs .docs-content h1 .anchor{display:none}
.docs .docs-content h4 .anchor::after, .docs .docs-content h5 .anchor::after, .docs .docs-content h6 .anchor::after{padding-right:.6rem}</style><style id="__jsx-7824b3ad3820c879">html{line-height:1.15;
-webkit-text-size-adjust:100%}
body{margin:0}
main{display:block}
h1{font-size:2em;
margin:.67em 0}
hr{box-sizing:content-box;
height:0;
overflow:visible}
pre{font-family:monospace, monospace;
font-size:1em}
a{background-color:transparent}
abbr[title]{border-bottom:none;
text-decoration:underline;
text-decoration:underline dotted}
b, strong{font-weight:bolder}
code, kbd, samp{font-family:monospace, monospace;
font-size:1em}
small{font-size:80%}
sub, sup{font-size:75%;
line-height:0;
position:relative;
vertical-align:baseline}
sub{bottom:-0.25em}
sup{top:-0.5em}
img{border-style:none}
button, input, optgroup, select, textarea{font-family:inherit;
font-size:100%;
line-height:1.15;
margin:0}
button, input{overflow:visible}
button, select{text-transform:none}
button, [type=button], [type=reset], [type=submit]{-webkit-appearance:button}
button::-moz-focus-inner, [type=button]::-moz-focus-inner, [type=reset]::-moz-focus-inner, [type=submit]::-moz-focus-inner{border-style:none;
padding:0}
button:-moz-focusring, [type=button]:-moz-focusring, [type=reset]:-moz-focusring, [type=submit]:-moz-focusring{outline:1px dotted ButtonText}
fieldset{padding:.35em .75em .625em}
legend{box-sizing:border-box;
color:inherit;
display:table;
max-width:100%;
padding:0;
white-space:normal}
progress{vertical-align:baseline}
textarea{overflow:auto}
[type=checkbox], [type=radio]{box-sizing:border-box;
padding:0}
[type=number]::-webkit-inner-spin-button, [type=number]::-webkit-outer-spin-button{height:auto}
[type=search]{-webkit-appearance:textfield;
outline-offset:-2px}
[type=search]::-webkit-search-decoration{-webkit-appearance:none}
::-webkit-file-upload-button{-webkit-appearance:button;
font:inherit}
details{display:block}
summary{display:list-item}
template{display:none}
[hidden]{display:none}
.hljs, pre{display:block;
overflow-x:auto;
padding:.5em;
background:#3a2840;
color:#fff}
.hljs.language-shell :not(.bash)+.bash, .hljs.language-better-shell :not(.bash)+.bash, pre.language-shell :not(.bash)+.bash, pre.language-better-shell :not(.bash)+.bash{color:#d2a8e0}
pre{border-radius:.8rem;
padding:1rem;
font-size:.875rem;
margin:1.5rem 0}
.hljs-keyword, .hljs-selector-tag, .hljs-tag{color:#d2a8e0}
.hljs-template-tag{color:red}
.hljs-number{color:#6cb9f0}
.hljs-variable, .hljs-template-variable, .hljs-attribute, .hljs-literal{color:#c9e5f9}
.hljs-subst{color:red}
.hljs-title, .hljs-name, .hljs-selector-id, .hljs-selector-class, .hljs-section, .hljs-type{color:#f0a46c}
.hljs-symbol, .hljs-bullet, .hljs-link{color:#d2a8e0}
.hljs-deletion, .hljs-string, .hljs-built_in, .hljs-builtin-name{color:#6cb9f0}
.hljs-addition, .hljs-comment, .hljs-quote, .hljs-meta{color:#adb5bd}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:bold}
#nprogress{pointer-events:none}
#nprogress .bar{background:#29d;
position:fixed;
z-index:1031;
top:0;
left:0;
width:100%;
height:2px}
#nprogress .peg{display:block;
position:absolute;
right:0px;
width:100px;
height:100%;
box-shadow:0 0 10px #29d, 0 0 5px #29d;
opacity:1;
-webkit-transform:rotate(3deg) translate(0px, -4px);
-ms-transform:rotate(3deg) translate(0px, -4px);
-webkit-transform:rotate(3deg) translate(0px, -4px);
-moz-transform:rotate(3deg) translate(0px, -4px);
-ms-transform:rotate(3deg) translate(0px, -4px);
transform:rotate(3deg) translate(0px, -4px)}
#nprogress .spinner{display:block;
position:fixed;
z-index:1031;
top:15px;
right:15px}
#nprogress .spinner-icon{width:18px;
height:18px;
box-sizing:border-box;
border:solid 2px transparent;
border-top-color:#29d;
border-left-color:#29d;
border-radius:50%;
-webkit-animation:nprogress-spinner 400ms linear infinite;
-webkit-animation:nprogress-spinner 400ms linear infinite;
animation:nprogress-spinner 400ms linear infinite}
.nprogress-custom-parent{overflow:hidden;
position:relative}
.nprogress-custom-parent #nprogress .spinner, .nprogress-custom-parent #nprogress .bar{position:absolute}
@keyframes nprogress-spinner {0% {-webkit-transform:rotate(0deg)}100% {-webkit-transform:rotate(360deg)}}
@keyframes nprogress-spinner {0% {transform:rotate(0deg)}100% {transform:rotate(360deg)}}
#nprogress .bar{background:#782b90}
#nprogress .peg{box-shadow:0 0 10px #782b90, 0 0 5px #782b90}
#nprogress .spinner-icon{border-top-color:#782b90;
border-left-color:#782b90}
html{box-sizing:border-box}
*, *::before, *::after{box-sizing:inherit}
:root{font-size:18px}
@media (max-width:1000px) {:root{font-size:17.1px}}
@media (max-width:768px) {:root{font-size:16.2px}}
@media (max-width:640px) {:root{font-size:15.3px}}
body, input{font-family:Roboto, sans-serif;
font-weight:300;
line-height:1.7;
color:#3c3c3b}
input{outline:none}
h1, h2, h3, h4, h5, h6{font-weight:400}
h1{font-size:2.5rem}
h2{font-size:2rem}
h3{font-size:1.75rem}
h4{font-size:1.5rem}
h5{font-size:1.25rem}
h6{font-size:1.1rem}
.container{width:100%;
padding-right:.8rem;
padding-left:.8rem;
margin-right:auto;
margin-left:auto}
@media (min-width:640px) {.container{max-width:620px}}
@media (min-width:768px) {.container{max-width:738px}}
@media (min-width:1000px) {.container{max-width:950px}}
@media (min-width:1250px) {.container{max-width:1180px}}
@media (min-width:1250px) {.container-narrow{max-width:950px}}
.img-fluid{max-width:100%}
a{-webkit-text-decoration:none;
text-decoration:none;
color:#782b90}
a:hover{text-decoration:underline;
color:#571f69}
img{vertical-align:middle}
svg{overflow:hidden;
vertical-align:middle}
code, pre{font-family:"Roboto Mono", SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
p code{display:-webkit-inline-box;
display:-webkit-inline-flex;
display:-ms-inline-flexbox;
display:inline-flex;
max-width:100%;
overflow:auto}
.heading-anchor{opacity:0;
-webkit-align-self:flex-start;
-ms-flex-item-align:flex-start;
align-self:flex-start;
outline:none}
.heading-anchor::after{content:"#";
position:absolute;
margin-left:-1.5rem;
color:#ced4da;
padding-right:.45rem}
.heading-anchor:hover{opacity:1}
h2:hover .heading-anchor, h3:hover .heading-anchor, h4:hover .heading-anchor, h5:hover .heading-anchor, h6:hover .heading-anchor{opacity:1}
h1 .heading-anchor{display:none}
h4 .heading-anchor::after, h5 .heading-anchor::after, h6 .heading-anchor::after{padding-right:.6rem}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap">@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Me5g.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu72xKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu5mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7GxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300;400&display=swap">@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZKCA.woff) format('woff')}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-59Y.woff) format('woff')}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCkYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCAYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCgYb9lecyVC4A.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCcYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCsYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCoYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCQYb9lecyU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19-7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19a7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-1967DQk6YvNkeg.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19G7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-1927DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19y7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v24/ieVl2ZhZI2eCN5jzbjEETS9weq8-19K7DQk6YvM.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap">@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vqPQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SeW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_QOW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_R-W-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_S-W-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SuW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v13/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW-AJi8SJQt.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body data-build-time="2022-02-21T03:09:17.628Z" data-build-commit-id="35c6f13137992435fd7460c8766d5c80888486c9" data-build-run-id="1874006029"><div id="__next" data-reactroot=""><main class="jsx-efcc50be384cabc7 page docs"><header><div class="jsx-f705e145f931f504 navbar"><div class="jsx-f705e145f931f504 navbar-content container"><div class="jsx-f705e145f931f504 navbar-logo"><a class="jsx-f705e145f931f504" href="/"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 1232.6 315.2&#x27; style=&#x27;enable-background:new 0 0 1232.6 315.2&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23782a91%7d%3c/style%3e%3cpath d=&#x27;M120.9 214.2 190.5 0h52.3l-98.5 273.8H98.2L0 0h52.1l68.8 214.2zm291.2-62.6H299.6v84.2H431v38H252V0h177.7v38.4H299.6V114h112.5v37.6zm83.7-113.2H546c16.5.3 29 4.4 37.3 12.4 8.3 8 12.5 19.4 12.5 34 0 14-4.5 25.1-13.5 33.2-9 8.1-21.6 12.1-37.6 12.1h-27.1v24.2l86.1 119.5h51v-2.4l-77.2-106.7c24.9-5.5 43.3-21.7 52.6-35.9 8.2-12.6 13.3-27.7 13.3-46 0-26.8-8.6-47.4-25.8-61.5C600.5 7.1 576.1 0 544.5 0h-96.3v273.8h47.6&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1052.3 157.7-41.5 62.7 29.7 53.4h85.1z&#x27;/%3e%3ccircle class=&#x27;st0&#x27; cx=&#x27;827.9&#x27; cy=&#x27;274.7&#x27; r=&#x27;40.5&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1037 0-47.6 74.2L949 0h-84l85.3 135.8-67.1 105.7c5.7 9.5 9.1 20.5 9.2 32.4h50.1L1121.3 0H1037z&#x27;/%3e%3cpath d=&#x27;M763.5 273.8c.1-9.9 2.5-19.2 6.6-27.5V38.4h85.4V0H638.2v38.4h84.6v235.4h40.7zm414-266.9h-15.3v42.2h-8.5V6.9h-15.2V0h39v6.9zM1193 0l14.2 37.7L1221.3 0h11v49.1h-8.5V32.9l.8-21.7-14.5 37.9h-6.1l-14.5-37.8.8 21.6v16.2h-8.5V0h11.2z&#x27;/%3e%3c/svg%3e" alt="Vert.x Logo" class="jsx-f705e145f931f504"/></a></div><div class="jsx-f705e145f931f504 navbar-collapse-button"><span class="jsx-f705e145f931f504"></span><span class="jsx-f705e145f931f504"></span><span class="jsx-f705e145f931f504"></span></div><div class="jsx-f705e145f931f504 navbar-right"><div class="jsx-f705e145f931f504 navbar-menu"><span class="jsx-f705e145f931f504 navbar-menu-item with-drop-down"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">开始<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu"><a class="jsx-f705e145f931f504" href="/introduction-to-vertx-and-reactive/"><li class="jsx-400ec7965926e858 dropdown-item">简介</li></a><a class="jsx-f705e145f931f504" href="/get-started/"><li class="jsx-400ec7965926e858 dropdown-item">开始</li></a><a href="https://start.vertx.io/" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">应用生成器 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="jsx-f705e145f931f504 navbar-menu-item" href="/docs/">文档</a><span class="jsx-f705e145f931f504 navbar-menu-item with-drop-down"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">资源<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu"><a class="jsx-f705e145f931f504" href="/faq/"><li class="jsx-400ec7965926e858 dropdown-item">答疑</li></a><a class="jsx-f705e145f931f504" href="/channels/"><li class="jsx-400ec7965926e858 dropdown-item">联系渠道</li></a><a href="https://how-to.vertx.io/" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">操作指南 <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/vertx-eventbus-bridge-clients" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">EventBus Bridge Clients <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/advanced-vertx-guide" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">Advanced Vert.x Guide <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="jsx-f705e145f931f504 navbar-menu-item" href="/blog/">博客</a><a class="jsx-f705e145f931f504 navbar-menu-item" href="/community/">社区</a><a class="jsx-f705e145f931f504 navbar-menu-item" href="/translation/">翻译团队</a></div><div class="jsx-f705e145f931f504 navbar-social"><a href="https://github.com/vert-x3/vertx-awesome" title="Awesome Vert.x" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title>Awesome Vert.x</title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a><a href="https://stackoverflow.com/questions/tagged/vert.x" title="Stack Overflow" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title>stackoverflow</title><path d="M15.725 0l-1.72 1.277 6.39 8.588 1.716-1.277L15.725 0zm-3.94 3.418l-1.369 1.644 8.225 6.85 1.369-1.644-8.225-6.85zm-3.15 4.465l-.905 1.94 9.702 4.517.904-1.94-9.701-4.517zm-1.85 4.86l-.44 2.093 10.473 2.201.44-2.092-10.473-2.203zM1.89 15.47V24h19.19v-8.53h-2.133v6.397H4.021v-6.396H1.89zm4.265 2.133v2.13h10.66v-2.13H6.154Z"></path></svg></a><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" title="YouTube" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title>youtube</title><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path></svg></a><a href="https://discord.gg/KzEMwP2" title="Discord" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title>discord</title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"></path></svg></a><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" title="Vert.x 用户组" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title>Vert.x 用户组</title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a><a href="https://qm.qq.com/cgi-bin/qm/qr?k=QFrKfwIVTuShDdh7puvfJWjqOx4C014c&amp;jump_from=webapi" title="Vert.x中国用户组QQ群" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Vert.x中国用户组QQ群"><title>Vert.x中国用户组QQ群</title><path d="M21.395 15.035a39.548 39.548 0 0 0-.803-2.264l-1.079-2.695c.001-.032.014-.562.014-.836C19.526 4.632 17.351 0 12 0S4.474 4.632 4.474 9.241c0 .274.013.804.014.836l-1.08 2.695a38.97 38.97 0 0 0-.802 2.264c-1.021 3.283-.69 4.643-.438 4.673.54.065 2.103-2.472 2.103-2.472 0 1.469.756 3.387 2.394 4.771-.612.188-1.363.479-1.845.835-.434.32-.379.646-.301.778.343.578 5.883.369 7.482.189 1.6.18 7.14.389 7.483-.189.078-.132.132-.458-.301-.778-.483-.356-1.233-.646-1.846-.836 1.637-1.384 2.393-3.302 2.393-4.771 0 0 1.563 2.537 2.103 2.472.251-.03.581-1.39-.438-4.673zM12.662 4.846c.039-1.052.659-1.878 1.385-1.846s1.281.912 1.242 1.964c-.039 1.051-.659 1.878-1.385 1.846s-1.282-.912-1.242-1.964zM9.954 3c.725-.033 1.345.794 1.384 1.846.04 1.052-.517 1.931-1.242 1.963-.726.033-1.346-.794-1.385-1.845C8.672 3.912 9.228 3.033 9.954 3zM7.421 8.294c.194-.43 2.147-.908 4.566-.908h.026c2.418 0 4.372.479 4.566.908a.14.14 0 0 1 .014.061c0 .031-.01.059-.026.083-.163.238-2.333 1.416-4.553 1.416h-.026c-2.221 0-4.39-1.178-4.553-1.416a.136.136 0 0 1-.014-.144zm10.422 8.622c-.22 3.676-2.403 5.987-5.774 6.021h-.137c-3.37-.033-5.554-2.345-5.773-6.021-.081-1.35.001-2.496.147-3.43.318.063.638.122.958.176v3.506s1.658.334 3.318.103v-3.225c.488.027.96.04 1.406.034h.025c1.678.021 3.714-.204 5.683-.594.146.934.227 2.08.147 3.43zM10.48 5.804c.313-.041.542-.409.508-.825-.033-.415-.314-.72-.629-.679-.313.04-.541.409-.508.824.034.417.315.72.629.68zM14.479 5.156c.078.037.221.042.289-.146.035-.095.025-.165-.009-.214-.023-.033-.133-.118-.371-.176-.904-.22-1.341.384-1.405.499-.04.072-.012.176.056.227.067.051.139.037.179-.006.58-.628 1.21-.208 1.261-.184z"></path></svg></a></div></div></div></div></header><div class="jsx-efcc50be384cabc7 page-content docs-content"><div class="jsx-efcc50be384cabc7 container"><div class="jsx-efcc50be384cabc7 docs-content-wrapper"><aside class="jsx-efcc50be384cabc7 "><div class="jsx-efcc50be384cabc7 docs-content-wrapper-sidebar"><div class="jsx-d1843944f2d67b search-panel"><div class="jsx-20d862052e50feff search"><input type="text" placeholder="Search..." value="" class="jsx-20d862052e50feff"/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon-delete"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></div><ul class="jsx-117e429f22e394dc search-results"></ul><div class="jsx-117e429f22e394dc search-results-none">No results.</div></div><div class="jsx-efcc50be384cabc7 docs-content-toc"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_using_vert_x_web">Using Vert.x Web</a>
<ul class="sectlevel2">
<li><a href="#_development_mode">Development mode</a></li>
</ul>
</li>
<li><a href="#_re_cap_on_vert_x_core_http_servers">Re-cap on Vert.x core HTTP servers</a></li>
<li><a href="#_basic_vert_x_web_concepts">Basic Vert.x-Web concepts</a></li>
<li><a href="#_handling_requests_and_calling_the_next_handler">Handling requests and calling the next handler</a></li>
<li><a href="#_using_blocking_handlers">Using blocking handlers</a></li>
<li><a href="#_routing_by_exact_path">Routing by exact path</a></li>
<li><a href="#_routing_by_paths_that_begin_with_something">Routing by paths that begin with something</a></li>
<li><a href="#_capturing_path_parameters">Capturing path parameters</a></li>
<li><a href="#_routing_with_regular_expressions">Routing with regular expressions</a></li>
<li><a href="#_capturing_path_parameters_with_regular_expressions">Capturing path parameters with regular expressions</a></li>
<li><a href="#_using_named_capture_groups">Using named capture groups</a></li>
<li><a href="#_routing_by_http_method">Routing by HTTP method</a></li>
<li><a href="#_route_order">Route order</a></li>
<li><a href="#_routing_based_on_mime_type_of_request">Routing based on MIME type of request</a></li>
<li><a href="#_routing_based_on_mime_types_acceptable_by_the_client">Routing based on MIME types acceptable by the client</a></li>
<li><a href="#_combining_routing_criteria">Combining routing criteria</a></li>
<li><a href="#_enabling_and_disabling_routes">Enabling and disabling routes</a></li>
<li><a href="#_context_data">Context data</a></li>
<li><a href="#_reroute">Reroute</a></li>
<li><a href="#_sub_routers">Sub-routers</a></li>
<li><a href="#_localization">Localization</a></li>
<li><a href="#_route_match_failures">Route match failures</a></li>
<li><a href="#_error_handling">Error handling</a></li>
<li><a href="#_request_body_handling">Request body handling</a>
<ul class="sectlevel2">
<li><a href="#_getting_the_request_body">Getting the request body</a></li>
<li><a href="#_limiting_body_size">Limiting body size</a></li>
<li><a href="#_merging_form_attributes">Merging form attributes</a></li>
<li><a href="#_handling_file_uploads">Handling file uploads</a></li>
</ul>
</li>
<li><a href="#_handling_cookies">Handling cookies</a>
<ul class="sectlevel2">
<li><a href="#_manipulating_cookies">Manipulating cookies</a></li>
</ul>
</li>
<li><a href="#_handling_sessions">Handling sessions</a>
<ul class="sectlevel2">
<li><a href="#_session_stores">Session stores</a></li>
<li><a href="#_creating_the_session_handler">Creating the session handler</a></li>
<li><a href="#_using_the_session">Using the session</a></li>
<li><a href="#_session_timeout">Session timeout</a></li>
</ul>
</li>
<li><a href="#_authentication_authorisation">Authentication / authorisation</a>
<ul class="sectlevel2">
<li><a href="#_creating_an_auth_handler">Creating an auth handler</a></li>
<li><a href="#_handling_auth_in_your_application">Handling auth in your application</a></li>
<li><a href="#_http_basic_authentication">HTTP Basic Authentication</a></li>
<li><a href="#_redirect_auth_handler">Redirect auth handler</a></li>
<li><a href="#_jwt_authorisation">JWT authorisation</a></li>
<li><a href="#_configuring_required_authorities">Configuring required authorities</a></li>
<li><a href="#_chaining_multiple_auth_handlers">Chaining multiple auth handlers</a></li>
</ul>
</li>
<li><a href="#_serving_static_resources">Serving static resources</a>
<ul class="sectlevel2">
<li><a href="#_configuring_caching">Configuring caching</a></li>
<li><a href="#_configuring_the_index_page">Configuring the index page</a></li>
<li><a href="#_changing_the_web_root">Changing the web root</a></li>
<li><a href="#_serving_hidden_files">Serving hidden files</a></li>
<li><a href="#_directory_listing">Directory listing</a></li>
<li><a href="#_disabling_file_caching_on_disk">Disabling file caching on disk</a></li>
</ul>
</li>
<li><a href="#_cors_handling">CORS handling</a></li>
<li><a href="#_multi_tenant">Multi Tenant</a></li>
<li><a href="#_templates">Templates</a>
<ul class="sectlevel2">
<li><a href="#_mvel_template_engine">MVEL template engine</a></li>
<li><a href="#_jade_template_engine">Jade template engine</a></li>
<li><a href="#_handlebars_template_engine">Handlebars template engine</a></li>
<li><a href="#_thymeleaf_template_engine">Thymeleaf template engine</a></li>
<li><a href="#_apache_freemarker_template_engine">Apache FreeMarker template engine</a></li>
<li><a href="#_pebble_template_engine">Pebble template engine</a></li>
<li><a href="#_rocker_template_engine">Rocker template engine</a></li>
<li><a href="#_disabling_caching">Disabling caching</a></li>
</ul>
</li>
<li><a href="#_error_handler">Error handler</a></li>
<li><a href="#_request_logger">Request logger</a></li>
<li><a href="#_serving_favicons">Serving favicons</a></li>
<li><a href="#_timeout_handler">Timeout handler</a></li>
<li><a href="#_response_time_handler">Response time handler</a></li>
<li><a href="#_content_type_handler">Content type handler</a></li>
<li><a href="#_sockjs">SockJS</a>
<ul class="sectlevel2">
<li><a href="#_sockjs_handler">SockJS handler</a></li>
<li><a href="#_handling_sockjs_sockets">Handling SockJS sockets</a></li>
<li><a href="#_the_client_side">The client side</a></li>
<li><a href="#_configuring_the_sockjs_handler">Configuring the SockJS handler</a></li>
</ul>
</li>
<li><a href="#_sockjs_event_bus_bridge">SockJS event bus bridge</a>
<ul class="sectlevel2">
<li><a href="#_securing_the_bridge">Securing the Bridge</a></li>
<li><a href="#_requiring_authorisation_for_messages">Requiring authorisation for messages</a></li>
<li><a href="#_handling_event_bus_bridge_events">Handling event bus bridge events</a></li>
</ul>
</li>
<li><a href="#_csrf_cross_site_request_forgery">CSRF Cross Site Request Forgery</a>
<ul class="sectlevel2">
<li><a href="#_using_ajax">Using AJAX</a></li>
</ul>
</li>
<li><a href="#_virtualhost_handler">VirtualHost Handler</a></li>
<li><a href="#_oauth2authhandler_handler">OAuth2AuthHandler Handler</a>
<ul class="sectlevel2">
<li><a href="#_a_real_world_example">A real world example</a></li>
<li><a href="#_mixing_oauth2_and_jwt">Mixing OAuth2 and JWT</a></li>
</ul>
</li>
</ul>
</div></div></div></aside><div class="jsx-efcc50be384cabc7 docs-content-sidebar-toggle"><div style="position:relative" class="jsx-efcc50be384cabc7"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div></div><div class="jsx-efcc50be384cabc7 docs-content-inner"><div class="jsx-efcc50be384cabc7 docs-content-metadata"><div class="jsx-efcc50be384cabc7 docs-content-metadata-left"><div class="jsx-efcc50be384cabc7"><a href="https://vertx.io/docs/apidocs" class="jsx-efcc50be384cabc7"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg> API</a></div><span class="jsx-efcc50be384cabc7 docs-content-metadata-version"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">v4.2.5<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu align-right"></ul></div></span></div></div><div class="jsx-efcc50be384cabc7"><h1>Vert.x-Web</h1>

<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web is a set of building blocks for building web applications with Vert.x. Think of it as a Swiss Army Knife for building
modern, scalable, web apps.</p>
</div>
<div class="paragraph">
<p>Vert.x core provides a fairly low level set of functionality for handling HTTP, and for some applications
that will be sufficient.</p>
</div>
<div class="paragraph">
<p>Vert.x-Web builds on Vert.x core to provide a richer set of functionality for building real web applications, more
easily.</p>
</div>
<div class="paragraph">
<p>It&#8217;s the successor to <a href="http://pmlopes.github.io/yoke/">Yoke</a> in Vert.x 2.x, and takes inspiration from projects such
as <a href="http://expressjs.com/">Express</a> in the Node.js world and <a href="http://www.sinatrarb.com/">Sinatra</a> in the Ruby world.</p>
</div>
<div class="paragraph">
<p>Vert.x-Web is designed to be powerful, un-opionated and fully embeddable. You just use the parts you want and nothing more.
Vert.x-Web is not a container.</p>
</div>
<div class="paragraph">
<p>You can use Vert.x-Web to create classic server-side web applications, RESTful web applications, 'real-time' (server push)
web applications, or any other kind of web application you can think of. Vert.x-Web doesn&#8217;t care. It&#8217;s up to you to chose
the type of app you prefer, not Vert.x-Web.</p>
</div>
<div class="paragraph">
<p>Vert.x-Web is a great fit for writingRESTful HTTP micro-services*, but we don&#8217;tforce* you to write apps like that.</p>
</div>
<div class="paragraph">
<p>Some of the key features of Vert.x-Web include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Routing (based on method, path, etc)</p>
</li>
<li>
<p>Regular expression pattern matching for paths</p>
</li>
<li>
<p>Extraction of parameters from paths</p>
</li>
<li>
<p>Content negotiation</p>
</li>
<li>
<p>Request body handling</p>
</li>
<li>
<p>Body size limits</p>
</li>
<li>
<p>Cookie parsing and handling</p>
</li>
<li>
<p>Multipart forms</p>
</li>
<li>
<p>Multipart file uploads</p>
</li>
<li>
<p>Sub routers</p>
</li>
<li>
<p>Session support - both local (for sticky sessions) and clustered (for non sticky)</p>
</li>
<li>
<p>CORS (Cross Origin Resource Sharing) support</p>
</li>
<li>
<p>Error page handler</p>
</li>
<li>
<p>Basic Authentication</p>
</li>
<li>
<p>Redirect based authentication</p>
</li>
<li>
<p>Authorisation handlers</p>
</li>
<li>
<p>JWT based authorization</p>
</li>
<li>
<p>User/role/permission authorisation</p>
</li>
<li>
<p>Favicon handling</p>
</li>
<li>
<p>Template support for server side rendering, including support for the following template engines out of the box:</p>
<div class="ulist">
<ul>
<li>
<p>Handlebars</p>
</li>
<li>
<p>Jade,</p>
</li>
<li>
<p>MVEL</p>
</li>
<li>
<p>Thymeleaf</p>
</li>
<li>
<p>Apache FreeMarker</p>
</li>
<li>
<p>Pebble</p>
</li>
<li>
<p>Rocker</p>
</li>
</ul>
</div>
</li>
<li>
<p>Response time handler</p>
</li>
<li>
<p>Static file serving, including caching logic and directory listing.</p>
</li>
<li>
<p>Request timeout support</p>
</li>
<li>
<p>SockJS support</p>
</li>
<li>
<p>Event-bus bridge</p>
</li>
<li>
<p>CSRF Cross Site Request Forgery</p>
</li>
<li>
<p>VirtualHost</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most features in Vert.x-Web are implemented as handlers so you can always write your own. We envisage many more being written
over time.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll discuss all these features in this manual.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_vert_x_web"><a class="anchor" href="#_using_vert_x_web"></a>Using Vert.x Web</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use vert.x web, add the following dependency to the <em>dependencies</em> section of your build descriptor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven (in your <code>pom.xml</code>):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${maven.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle (in your <code>build.gradle</code> file):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">dependencies {
 compile <span class="hljs-string">&#x27;io.vertx:vertx-web:${maven.version}&#x27;</span>
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_development_mode"><a class="anchor" href="#_development_mode"></a>Development mode</h3>
<div class="paragraph">
<p>Vert.x Web by default operates in production mode.
You can switch the development mode by assigning the <code>dev</code> value to either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>VERTXWEB_ENVIRONMENT</code> environment variable, or</p>
</li>
<li>
<p>the <code>vertxweb.environment</code> system property</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In development mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>template engine caches are disabled</p>
</li>
<li>
<p>the <code>ErrorHandler</code> does not display exception details</p>
</li>
<li>
<p>the <code>StaticHandler</code> does not handle cache headers</p>
</li>
<li>
<p>the GraphiQL development tool is disabled</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_re_cap_on_vert_x_core_http_servers"><a class="anchor" href="#_re_cap_on_vert_x_core_http_servers"></a>Re-cap on Vert.x core HTTP servers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web uses and exposes the API from Vert.x core, so it&#8217;s well worth getting familiar with the basic concepts of writing
HTTP servers using Vert.x core, if you&#8217;re not already.</p>
</div>
<div class="paragraph">
<p>The Vert.x core HTTP documentation goes into a lot of detail on this.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a hello world web server written using Vert.x core. At this point there is no Vert.x-Web involved:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="hljs-keyword">var</span> server = vertx.createHttpServer()

server.requestHandler((request: io.vertx.scala.core.http.HttpServerRequest) =&gt; {

  <span class="hljs-comment">// This handler gets called for each request that arrives on the server</span>
  <span class="hljs-keyword">var</span> response = request.response()
  response.putHeader(<span class="hljs-string">&quot;content-type&quot;</span>, <span class="hljs-string">&quot;text/plain&quot;</span>)

  <span class="hljs-comment">// Write to the response and end it</span>
  response.end(<span class="hljs-string">&quot;Hello World!&quot;</span>)
})

server.listen(<span class="hljs-number">8080</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We create an HTTP server instance, and we set a request handler on it. The request handler will be called whenever
a request arrives on the server.</p>
</div>
<div class="paragraph">
<p>When that happens we are just going to set the content type to <code>text/plain</code>, and write <code>Hello World!</code> and end the
response.</p>
</div>
<div class="paragraph">
<p>We then tell the server to listen at port <code>8080</code> (default host is <code>localhost</code>).</p>
</div>
<div class="paragraph">
<p>You can run this, and point your browser at <code><a href="http://localhost:8080" class="bare">http://localhost:8080</a></code> to verify that it works as expected.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_vert_x_web_concepts"><a class="anchor" href="#_basic_vert_x_web_concepts"></a>Basic Vert.x-Web concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here&#8217;s the 10000 foot view:</p>
</div>
<div class="paragraph">
<p>A <code><a href="../../scaladocs/io/vertx/scala/ext/web/Router.html">Router</a></code> is one of the core concepts of Vert.x-Web. It&#8217;s an object which maintains zero or more
<code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html">Routes</a></code> .</p>
</div>
<div class="paragraph">
<p>A router takes an HTTP request and finds the first matching route for that request, and passes the request to that route.</p>
</div>
<div class="paragraph">
<p>The route can have a <em>handler</em> associated with it, which then receives the request. You then <em>do something</em> with the
request, and then, either end it or pass it to the next matching handler.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a simple router example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> server = vertx.createHttpServer()

<span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

router.route().handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called for every request</span>
  <span class="hljs-keyword">var</span> response = routingContext.response()
  response.putHeader(<span class="hljs-string">&quot;content-type&quot;</span>, <span class="hljs-string">&quot;text/plain&quot;</span>)

  <span class="hljs-comment">// Write to the response and end it</span>
  response.end(<span class="hljs-string">&quot;Hello World from Vert.x-Web!&quot;</span>)
})

server.requestHandler(router).listen(<span class="hljs-number">8080</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>It basically does the same thing as the Vert.x Core HTTP server hello world example from the previous section,
but this time using Vert.x-Web.</p>
</div>
<div class="paragraph">
<p>We create an HTTP server as before, then we create a router. Once we&#8217;ve done that we create a simple route with
no matching criteria so it will match <em>all</em> requests that arrive on the server.</p>
</div>
<div class="paragraph">
<p>We then specify a handler for that route. That handler will be called for all requests that arrive on the server.</p>
</div>
<div class="paragraph">
<p>The object that gets passed into the handler is a <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html">RoutingContext</a></code> - this contains
the standard Vert.x <code><a href="../../scaladocs/io/vertx/scala/core/http/HttpServerRequest.html">HttpServerRequest</a></code> and <code><a href="../../scaladocs/io/vertx/scala/core/http/HttpServerResponse.html">HttpServerResponse</a></code>
but also various other useful stuff that makes working with Vert.x-Web simpler.</p>
</div>
<div class="paragraph">
<p>For every request that is routed there is a unique routing context instance, and the same instance is passed to
all handlers for that request.</p>
</div>
<div class="paragraph">
<p>Once we&#8217;ve set up the handler, we set the request handler of the HTTP server to pass all incoming requests
to <code>handle</code>.</p>
</div>
<div class="paragraph">
<p>So, that&#8217;s the basics. Now we&#8217;ll look at things in more detail:</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handling_requests_and_calling_the_next_handler"><a class="anchor" href="#_handling_requests_and_calling_the_next_handler"></a>Handling requests and calling the next handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When Vert.x-Web decides to route a request to a matching route, it calls the handler of the route passing in an instance
of <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html">RoutingContext</a></code>. A route can have different handlers, that you can append using
<code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#handler()">handler</a></code></p>
</div>
<div class="paragraph">
<p>If you don&#8217;t end the response in your handler, you should call <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#next()">next</a></code> so another
matching route can handle the request (if any).</p>
</div>
<div class="paragraph">
<p>You don&#8217;t have to call <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#next()">next</a></code> before the handler has finished executing.
You can do this some time later, if you want:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.route(<span class="hljs-string">&quot;/some/path/&quot;</span>)
route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  <span class="hljs-comment">// enable chunked responses because we will be adding data as</span>
  <span class="hljs-comment">// we execute over other handlers. This is only required once and</span>
  <span class="hljs-comment">// only if several handlers do output.</span>
  response.setChunked(<span class="hljs-literal">true</span>)

  response.write(<span class="hljs-string">&quot;route1\n&quot;</span>)

  <span class="hljs-comment">// Call the next matching route after a 5 second delay</span>
  routingContext.vertx().setTimer(<span class="hljs-number">5000</span>, (tid: java.lang.<span class="hljs-type">Long</span>) =&gt; {
    routingContext.next()
  })
})

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  response.write(<span class="hljs-string">&quot;route2\n&quot;</span>)

  <span class="hljs-comment">// Call the next matching route after a 5 second delay</span>
  routingContext.vertx().setTimer(<span class="hljs-number">5000</span>, (tid: java.lang.<span class="hljs-type">Long</span>) =&gt; {
    routingContext.next()
  })
})

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  response.write(<span class="hljs-string">&quot;route3&quot;</span>)

  <span class="hljs-comment">// Now end the response</span>
  routingContext.response().end()
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example <code>route1</code> is written to the response, then 5 seconds later <code>route2</code> is written to the response,
then 5 seconds later <code>route3</code> is written to the response and the response is ended.</p>
</div>
<div class="paragraph">
<p>Note, all this happens without any thread blocking.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_blocking_handlers"><a class="anchor" href="#_using_blocking_handlers"></a>Using blocking handlers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes, you might have to do something in a handler that might block the event loop for some time, e.g. call
a legacy blocking API or do some intensive calculation.</p>
</div>
<div class="paragraph">
<p>You can&#8217;t do that in a normal handler, so we provide the ability to set blocking handlers on a route.</p>
</div>
<div class="paragraph">
<p>A blocking handler looks just like a normal handler but it&#8217;s called by Vert.x using a thread from the worker pool
not using an event loop.</p>
</div>
<div class="paragraph">
<p>You set a blocking handler on a route with <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#blockingHandler()">blockingHandler</a></code>.
Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().blockingHandler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// Do something that might take some time synchronously</span>
  service.doSomethingThatBlocks()

  <span class="hljs-comment">// Now call the next handler</span>
  routingContext.next()

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, any blocking handlers executed on the same context (e.g. the same verticle instance) are <em>ordered</em> - this
means the next one won&#8217;t be executed until the previous one has completed. If you don&#8217;t care about orderering and
don&#8217;t mind your blocking handlers executing in parallel you can set the blocking handler specifying <code>ordered</code> as
false using <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#blockingHandler(io.vertx.core.Handler)">blockingHandler</a></code>.</p>
</div>
<div class="paragraph">
<p>Note, if you need to process multipart form data from a blocking handler, you MUST use a non-blocking handler
     FIRST in order to call <code>setExpectMultipart(true)</code>. Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.post(<span class="hljs-string">&quot;/some/endpoint&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  ctx.request().setExpectMultipart(<span class="hljs-literal">true</span>)
  ctx.next()
}).blockingHandler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// ... Do some blocking operation</span>
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_routing_by_exact_path"><a class="anchor" href="#_routing_by_exact_path"></a>Routing by exact path</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A route can be set-up to match the path from the request URI. In this case it will match any request which has a path
that&#8217;s the same as the specified path.</p>
</div>
<div class="paragraph">
<p>In the following example the handler will be called for a request <code>/some/path/</code>. We also ignore trailing slashes
so it will be called for paths <code>/some/path</code> and <code>/some/path//</code> too:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.route().path(<span class="hljs-string">&quot;/some/path/&quot;</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// This handler will be called for the following request paths:</span>

  <span class="hljs-comment">// `/some/path`</span>
  <span class="hljs-comment">// `/some/path/`</span>
  <span class="hljs-comment">// `/some/path//`</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// but not:</span>
  <span class="hljs-comment">// `/some/path/subdir`</span>
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_routing_by_paths_that_begin_with_something"><a class="anchor" href="#_routing_by_paths_that_begin_with_something"></a>Routing by paths that begin with something</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Often you want to route all requests that begin with a certain path. You could use a regex to do this, but a simply
way is to use an asterisk <code>*</code> at the end of the path when declaring the route path.</p>
</div>
<div class="paragraph">
<p>In the following example the handler will be called for any request with a URI path that starts with
<code>/some/path/</code>.</p>
</div>
<div class="paragraph">
<p>For example <code>/some/path/foo.html</code> and <code>/some/path/otherdir/blah.css</code> would both match.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.route().path(<span class="hljs-string">&quot;/some/path/*&quot;</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// This handler will be called for any path that starts with</span>
  <span class="hljs-comment">// `/some/path/`, e.g.</span>

  <span class="hljs-comment">// `/some/path`</span>
  <span class="hljs-comment">// `/some/path/`</span>
  <span class="hljs-comment">// `/some/path/subdir`</span>
  <span class="hljs-comment">// `/some/path/subdir/blah.html`</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// but not:</span>
  <span class="hljs-comment">// `/some/bath`</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>With any path it can also be specified when creating the route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.route(<span class="hljs-string">&quot;/some/path/*&quot;</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// This handler will be called same as previous example</span>
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_capturing_path_parameters"><a class="anchor" href="#_capturing_path_parameters"></a>Capturing path parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It&#8217;s possible to match paths using placeholders for parameters which are then available in the request
<code><a href="../../scaladocs/io/vertx/scala/core/http/HttpServerRequest.html#params()">params</a></code>.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.route(<span class="hljs-type">HttpMethod</span>.<span class="hljs-type">POST</span>, <span class="hljs-string">&quot;/catalogue/products/:producttype/:productid/&quot;</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> productType = routingContext.request().getParam(<span class="hljs-string">&quot;producttype&quot;</span>)
  <span class="hljs-keyword">var</span> productID = routingContext.request().getParam(<span class="hljs-string">&quot;productid&quot;</span>)

  <span class="hljs-comment">// Do something with them...</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The placeholders consist of <code>:</code> followed by the parameter name. Parameter names consist of any alphabetic character,
numeric character or underscore.</p>
</div>
<div class="paragraph">
<p>In the above example, if a POST request is made to path: <code>/catalogue/products/tools/drill123/</code> then the route will match
and <code>productType</code> will receive the value <code>tools</code> and productID will receive the value <code>drill123</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_routing_with_regular_expressions"><a class="anchor" href="#_routing_with_regular_expressions"></a>Routing with regular expressions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Regular expressions can also be used to match URI paths in routes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// Matches any path ending with &#x27;foo&#x27;</span>
<span class="hljs-keyword">var</span> route = router.route().pathRegex(<span class="hljs-string">&quot;.*foo&quot;</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called for:</span>

  <span class="hljs-comment">// /some/path/foo</span>
  <span class="hljs-comment">// /foo</span>
  <span class="hljs-comment">// /foo/bar/wibble/foo</span>
  <span class="hljs-comment">// /bar/foo</span>

  <span class="hljs-comment">// But not:</span>
  <span class="hljs-comment">// /bar/wibble</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively the regex can be specified when creating the route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.routeWithRegex(<span class="hljs-string">&quot;.*foo&quot;</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called same as previous example</span>

})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_capturing_path_parameters_with_regular_expressions"><a class="anchor" href="#_capturing_path_parameters_with_regular_expressions"></a>Capturing path parameters with regular expressions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can also capture path parameters when using regular expressions, here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.routeWithRegex(<span class="hljs-string">&quot;.*foo&quot;</span>)

<span class="hljs-comment">// This regular expression matches paths that start with something like:</span>
<span class="hljs-comment">// &quot;/foo/bar&quot; - where the &quot;foo&quot; is captured into param0 and the &quot;bar&quot; is captured into</span>
<span class="hljs-comment">// param1</span>
route.pathRegex(<span class="hljs-string">&quot;\\/([^\\/]+)\\/([^\\/]+)&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> productType = routingContext.request().getParam(<span class="hljs-string">&quot;param0&quot;</span>)
  <span class="hljs-keyword">var</span> productID = routingContext.request().getParam(<span class="hljs-string">&quot;param1&quot;</span>)

  <span class="hljs-comment">// Do something with them...</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, if a request is made to path: <code>/tools/drill123/</code> then the route will match
and <code>productType</code> will receive the value <code>tools</code> and productID will receive the value <code>drill123</code>.</p>
</div>
<div class="paragraph">
<p>Captures are denoted in regular expressions with capture groups (i.e. surrounding the capture with round brackets)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_named_capture_groups"><a class="anchor" href="#_using_named_capture_groups"></a>Using named capture groups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Using int index param names might be troublesome in some cases.
It&#8217;s possible to use named capture groups in the regex path.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// This regular expression matches paths that start with something like: &quot;/foo/bar&quot;</span>
<span class="hljs-comment">// It uses named regex groups to capture path params</span>
<span class="hljs-keyword">var</span> route = router.routeWithRegex(<span class="hljs-string">&quot;\\/(?&lt;productType&gt;[^\\/]+)\\/(?&lt;productId&gt;[^\\/]+)&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> productType = routingContext.request().getParam(<span class="hljs-string">&quot;productType&quot;</span>)
  <span class="hljs-keyword">var</span> productID = routingContext.request().getParam(<span class="hljs-string">&quot;productId&quot;</span>)

  <span class="hljs-comment">// Do something with them...</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, named capture groups are mapped to path parameters of the same name as the group.</p>
</div>
<div class="paragraph">
<p>Additionally, you can still access group parameters as you would with normal groups (i.e. <code>params0, params1&#8230;&#8203;</code>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_routing_by_http_method"><a class="anchor" href="#_routing_by_http_method"></a>Routing by HTTP method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default a route will match all HTTP methods.</p>
</div>
<div class="paragraph">
<p>If you want a route to only match for a specific HTTP method you can use <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#method()">method</a></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.route().method(<span class="hljs-type">HttpMethod</span>.<span class="hljs-type">POST</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called for any POST request</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you can specify this with a path when creating the route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.route(<span class="hljs-type">HttpMethod</span>.<span class="hljs-type">POST</span>, <span class="hljs-string">&quot;/some/path/&quot;</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called for any POST request to a URI path starting with /some/path/</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to route for a specific HTTP method you can also use the methods such as <code><a href="../../scaladocs/io/vertx/scala/ext/web/Router.html#get()">get</a></code>,
<code><a href="../../scaladocs/io/vertx/scala/ext/web/Router.html#post()">post</a></code> and <code><a href="../../scaladocs/io/vertx/scala/ext/web/Router.html#put()">put</a></code> named after the HTTP
method name. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.get().handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// Will be called for any GET request</span>

})

router.get(<span class="hljs-string">&quot;/some/path/&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// Will be called for any GET request to a path</span>
  <span class="hljs-comment">// starting with /some/path</span>

})

router.getWithRegex(<span class="hljs-string">&quot;.*foo&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// Will be called for any GET request to a path</span>
  <span class="hljs-comment">// ending with `foo`</span>

})

<span class="hljs-comment">// There are also equivalents to the above for PUT, POST, DELETE, HEAD and OPTIONS</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to specify a route will match for more than HTTP method you can call <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#method()">method</a></code>
multiple times:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.route().method(<span class="hljs-type">HttpMethod</span>.<span class="hljs-type">POST</span>).method(<span class="hljs-type">HttpMethod</span>.<span class="hljs-type">PUT</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called for any POST or PUT request</span>

})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_route_order"><a class="anchor" href="#_route_order"></a>Route order</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default routes are matched in the order they are added to the router.</p>
</div>
<div class="paragraph">
<p>When a request arrives the router will step through each route and check if it matches, if it matches then
the handler for that route will be called.</p>
</div>
<div class="paragraph">
<p>If the handler subsequently calls <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#next()">next</a></code> the handler for the next
matching route (if any) will be called. And so on.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example to illustrate this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route1 = router.route(<span class="hljs-string">&quot;/some/path/&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  <span class="hljs-comment">// enable chunked responses because we will be adding data as</span>
  <span class="hljs-comment">// we execute over other handlers. This is only required once and</span>
  <span class="hljs-comment">// only if several handlers do output.</span>
  response.setChunked(<span class="hljs-literal">true</span>)

  response.write(<span class="hljs-string">&quot;route1\n&quot;</span>)

  <span class="hljs-comment">// Now call the next matching route</span>
  routingContext.next()
})

<span class="hljs-keyword">var</span> route2 = router.route(<span class="hljs-string">&quot;/some/path/&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  response.write(<span class="hljs-string">&quot;route2\n&quot;</span>)

  <span class="hljs-comment">// Now call the next matching route</span>
  routingContext.next()
})

<span class="hljs-keyword">var</span> route3 = router.route(<span class="hljs-string">&quot;/some/path/&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  response.write(<span class="hljs-string">&quot;route3&quot;</span>)

  <span class="hljs-comment">// Now end the response</span>
  routingContext.response().end()
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example the response will contain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>route1
route2
route3</pre>
</div>
</div>
<div class="paragraph">
<p>As the routes have been called in that order for any request that starts with <code>/some/path</code>.</p>
</div>
<div class="paragraph">
<p>If you want to override the default ordering for routes, you can do so using <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#order()">order</a></code>,
specifying an integer value.</p>
</div>
<div class="paragraph">
<p>Routes are assigned an order at creation time corresponding to the order in which they were added to the router, with
the first route numbered <code>0</code>, the second route numbered <code>1</code>, and so on.</p>
</div>
<div class="paragraph">
<p>By specifying an order for the route you can override the default ordering. Order can also be negative, e.g. if you
want to ensure a route is evaluated before route number <code>0</code>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s change the ordering of route2 so it runs before route1:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route1 = router.route(<span class="hljs-string">&quot;/some/path/&quot;</span>).order(<span class="hljs-number">1</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  response.write(<span class="hljs-string">&quot;route1\n&quot;</span>)

  <span class="hljs-comment">// Now call the next matching route</span>
  routingContext.next()
})

<span class="hljs-keyword">var</span> route2 = router.route(<span class="hljs-string">&quot;/some/path/&quot;</span>).order(<span class="hljs-number">0</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  <span class="hljs-comment">// enable chunked responses because we will be adding data as</span>
  <span class="hljs-comment">// we execute over other handlers. This is only required once and</span>
  <span class="hljs-comment">// only if several handlers do output.</span>
  response.setChunked(<span class="hljs-literal">true</span>)

  response.write(<span class="hljs-string">&quot;route2\n&quot;</span>)

  <span class="hljs-comment">// Now call the next matching route</span>
  routingContext.next()
})

<span class="hljs-keyword">var</span> route3 = router.route(<span class="hljs-string">&quot;/some/path/&quot;</span>).order(<span class="hljs-number">2</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  response.write(<span class="hljs-string">&quot;route3&quot;</span>)

  <span class="hljs-comment">// Now end the response</span>
  routingContext.response().end()
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>then the response will now contain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>route2
route1
route3</pre>
</div>
</div>
<div class="paragraph">
<p>If two matching routes have the same value of order, then they will be called in the order they were added.</p>
</div>
<div class="paragraph">
<p>You can also specify that a route is handled last, with <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#last()">last</a></code></p>
</div>
<div class="paragraph">
<p>Note: Route order can be specified only before you configure an handler!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_routing_based_on_mime_type_of_request"><a class="anchor" href="#_routing_based_on_mime_type_of_request"></a>Routing based on MIME type of request</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can specify that a route will match against matching request MIME types using <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#consumes()">consumes</a></code>.</p>
</div>
<div class="paragraph">
<p>In this case, the request will contain a <code>content-type</code> header specifying the MIME type of the request body.
This will be matched against the value specified in <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#consumes()">consumes</a></code>.</p>
</div>
<div class="paragraph">
<p>Basically, <code>consumes</code> is describing which MIME types the handler can <em>consume</em>.</p>
</div>
<div class="paragraph">
<p>Matching can be done on exact MIME type matches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// Exact match</span>
router.route().consumes(<span class="hljs-string">&quot;text/html&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called for any request with</span>
  <span class="hljs-comment">// content-type header set to `text/html`</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Multiple exact matches can also be specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// Multiple exact matches</span>
router.route().consumes(<span class="hljs-string">&quot;text/html&quot;</span>).consumes(<span class="hljs-string">&quot;text/plain&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called for any request with</span>
  <span class="hljs-comment">// content-type header set to `text/html` or `text/plain`.</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Matching on wildcards for the sub-type is supported:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// Sub-type wildcard match</span>
router.route().consumes(<span class="hljs-string">&quot;text/*&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called for any request with top level type `text`</span>
  <span class="hljs-comment">// e.g. content-type header set to `text/html` or `text/plain` will both match</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>And you can also match on the top level type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// Top level type wildcard match</span>
router.route().consumes(<span class="hljs-string">&quot;*/json&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This handler will be called for any request with sub-type json</span>
  <span class="hljs-comment">// e.g. content-type header set to `text/json` or `application/json` will both match</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you don&#8217;t specify a <code>/</code> in the consumers, it will assume you meant the sub-type.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_routing_based_on_mime_types_acceptable_by_the_client"><a class="anchor" href="#_routing_based_on_mime_types_acceptable_by_the_client"></a>Routing based on MIME types acceptable by the client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The HTTP <code>accept</code> header is used to signify which MIME types of the response are acceptable to the client.</p>
</div>
<div class="paragraph">
<p>An <code>accept</code> header can have multiple MIME types separated by &#8216;,&#8217;.</p>
</div>
<div class="paragraph">
<p>MIME types can also have a <code>q</code> value appended to them* which signifies a weighting to apply if more than one
response MIME type is available matching the accept header. The q value is a number between 0 and 1.0.
If omitted it defaults to 1.0.</p>
</div>
<div class="paragraph">
<p>For example, the following <code>accept</code> header signifies the client will accept a MIME type of only <code>text/plain</code>:</p>
</div>
<div class="paragraph">
<p>Accept: text/plain</p>
</div>
<div class="paragraph">
<p>With the following the client will accept <code>text/plain</code> or <code>text/html</code> with no preference.</p>
</div>
<div class="paragraph">
<p>Accept: text/plain, text/html</p>
</div>
<div class="paragraph">
<p>With the following the client will accept <code>text/plain</code> or <code>text/html</code> but prefers <code>text/html</code> as it has a higher
<code>q</code> value (the default value is q=1.0)</p>
</div>
<div class="paragraph">
<p>Accept: text/plain; q=0.9, text/html</p>
</div>
<div class="paragraph">
<p>If the server can provide both text/plain and text/html it should provide the text/html in this case.</p>
</div>
<div class="paragraph">
<p>By using <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#produces()">produces</a></code> you define which MIME type(s) the route produces, e.g. the
following handler produces a response with MIME type <code>application/json</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">router.route().produces(<span class="hljs-string">&quot;application/json&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.RoutingContext) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()
  response.putHeader(<span class="hljs-string">&quot;content-type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>)
  response.write(someJSON).end()

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case the route will match with any request with an <code>accept</code> header that matches <code>application/json</code>.</p>
</div>
<div class="paragraph">
<p>Here are some examples of <code>accept</code> headers that will match:</p>
</div>
<div class="paragraph">
<p>Accept: application/json
Accept: application/*
Accept: application/json, text/html
Accept: application/json;q=0.7, text/html;q=0.8, text/plain</p>
</div>
<div class="paragraph">
<p>You can also mark your route as producing more than one MIME type. If this is the case, then you use
<code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getAcceptableContentType()">getAcceptableContentType</a></code> to find out the actual MIME type that
was accepted.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// This route can produce two different MIME types</span>
router.route().produces(<span class="hljs-string">&quot;application/json&quot;</span>).produces(<span class="hljs-string">&quot;text/html&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> response = routingContext.response()

  <span class="hljs-comment">// Get the actual MIME type acceptable</span>
  <span class="hljs-keyword">var</span> acceptableContentType = routingContext.getAcceptableContentType()

  response.putHeader(<span class="hljs-string">&quot;content-type&quot;</span>, acceptableContentType)
  response.write(whatever).end()
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, if you sent a request with the following <code>accept</code> header:</p>
</div>
<div class="paragraph">
<p>Accept: application/json; q=0.7, text/html</p>
</div>
<div class="paragraph">
<p>Then the route would match and <code>acceptableContentType</code> would contain <code>text/html</code> as both are
acceptable but that has a higher <code>q</code> value.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_combining_routing_criteria"><a class="anchor" href="#_combining_routing_criteria"></a>Combining routing criteria</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can combine all the above routing criteria in many different ways, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.route(<span class="hljs-type">HttpMethod</span>.<span class="hljs-type">PUT</span>, <span class="hljs-string">&quot;myapi/orders&quot;</span>).consumes(<span class="hljs-string">&quot;application/json&quot;</span>).produces(<span class="hljs-string">&quot;application/json&quot;</span>)

route.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This would be match for any PUT method to paths starting with &quot;myapi/orders&quot; with a</span>
  <span class="hljs-comment">// content-type of &quot;application/json&quot;</span>
  <span class="hljs-comment">// and an accept header matching &quot;application/json&quot;</span>

})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_enabling_and_disabling_routes"><a class="anchor" href="#_enabling_and_disabling_routes"></a>Enabling and disabling routes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can disable a route with <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#disable()">disable</a></code>. A disabled route will be ignored when matching.</p>
</div>
<div class="paragraph">
<p>You can re-enable a disabled route with <code><a href="../../scaladocs/io/vertx/scala/ext/web/Route.html#enable()">enable</a></code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_context_data"><a class="anchor" href="#_context_data"></a>Context data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use the context data in the <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html">RoutingContext</a></code> to maintain any data that you
want to share between handlers for the lifetime of the request.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example where one handler sets some data in the context data and a subsequent handler retrieves it:</p>
</div>
<div class="paragraph">
<p>You can use the <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#put(java.lang.String)">put</a></code> to put any object, and
<code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#get()">get</a></code> to retrieve any object from the context data.</p>
</div>
<div class="paragraph">
<p>A request sent to path <code>/some/path/other</code> will match both routes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.get(<span class="hljs-string">&quot;/some/path&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  routingContext.put(<span class="hljs-string">&quot;foo&quot;</span>, <span class="hljs-string">&quot;bar&quot;</span>)
  routingContext.next()

})

router.get(<span class="hljs-string">&quot;/some/path/other&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> bar = routingContext.get(<span class="hljs-string">&quot;foo&quot;</span>)
  <span class="hljs-comment">// Do something with bar</span>
  routingContext.response().end()

})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reroute"><a class="anchor" href="#_reroute"></a>Reroute</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Until now all routing mechanism allow you to handle your requests in a sequential way, however there might be times
where you will want to go back. Since the context does not expose any information about the previous or next handler,
mostly because this information is dynamic there is a way to restart the whole routing from the start of the current
Router.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.get(<span class="hljs-string">&quot;/some/path&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  routingContext.put(<span class="hljs-string">&quot;foo&quot;</span>, <span class="hljs-string">&quot;bar&quot;</span>)
  routingContext.next()

})

router.get(<span class="hljs-string">&quot;/some/path/B&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  routingContext.response().end()
})

router.get(<span class="hljs-string">&quot;/some/path&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  routingContext.reroute(<span class="hljs-string">&quot;/some/path/B&quot;</span>)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>So from the code you can see that if a request arrives at <code>/some/path</code> if first add a value to the context, then
moves to the next handler that re routes the request to <code>/some/path/B</code> which terminates the request.</p>
</div>
<div class="paragraph">
<p>You can reroute based on a new path or based on a new path and method. Note however that rerouting based on method
might introduce security issues since for example a usually safe GET request can become a DELETE.</p>
</div>
<div class="paragraph">
<p>Reroute is also allowed on the failure handler, however due to the nature of re router when called the current status
code and failure reason are reset. In order the rerouted handler should generate the correct status code if needed,
for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.get(<span class="hljs-string">&quot;/my-pretty-notfound-handler&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  ctx.response().setStatusCode(<span class="hljs-number">404</span>).end(<span class="hljs-string">&quot;NOT FOUND fancy html here!!!&quot;</span>)
})

router.get().failureHandler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-keyword">if</span> (ctx.statusCode() == <span class="hljs-number">404</span>) {
    ctx.reroute(<span class="hljs-string">&quot;/my-pretty-notfound-handler&quot;</span>)
  } <span class="hljs-keyword">else</span> {
    ctx.next()
  }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>It should be clear that reroute works on <code>paths</code>, so if you need to preserve and or add state across reroutes, one
should use the <code>RoutingContext</code> object. For example you want to reroute to a new path with a extra parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.get(<span class="hljs-string">&quot;/final-target&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// continue from here...</span>
})

<span class="hljs-comment">// THE WRONG WAY! (Will reroute to /final-target excluding the query string)</span>
router.get().handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  ctx.reroute(<span class="hljs-string">&quot;/final-target?variable=value&quot;</span>)
})

<span class="hljs-comment">// THE CORRECT WAY!</span>
router.get().handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  ctx.put(<span class="hljs-string">&quot;variable&quot;</span>, <span class="hljs-string">&quot;value&quot;</span>).reroute(<span class="hljs-string">&quot;/final-target&quot;</span>)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Even though the wrong reroute path will warn you that the query string is ignored, the reroute will happen since the
implementation will strip any query string or html fragment from the path.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sub_routers"><a class="anchor" href="#_sub_routers"></a>Sub-routers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes if you have a lot of handlers it can make sense to split them up into multiple routers. This is also useful
if you want to reuse a set of handlers in a different application, rooted at a different path root.</p>
</div>
<div class="paragraph">
<p>To do this you can mount a router at a <em>mount point</em> in another router. The router that is mounted is called a
<em>sub-router</em>. Sub routers can mount other sub routers so you can have several levels of sub-routers if you like.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s look at a simple example of a sub-router mounted with another router.</p>
</div>
<div class="paragraph">
<p>This sub-router will maintain the set of handlers that corresponds to a simple fictional REST API. We will mount that on another
router. The full implementation of the REST API is not shown.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s the sub-router:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> restAPI = <span class="hljs-type">Router</span>.router(vertx)

restAPI.get(<span class="hljs-string">&quot;/products/:productID&quot;</span>).handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// TODO Handle the lookup of the product....</span>
  rc.response().write(productJSON)

})

restAPI.put(<span class="hljs-string">&quot;/products/:productID&quot;</span>).handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// TODO Add a new product...</span>
  rc.response().end()

})

restAPI.delete(<span class="hljs-string">&quot;/products/:productID&quot;</span>).handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// TODO delete the product...</span>
  rc.response().end()

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>If this router was used as a top level router, then GET/PUT/DELETE requests to urls like <code>/products/product1234</code>
would invoke the  API.</p>
</div>
<div class="paragraph">
<p>However, let&#8217;s say we already have a web-site as described by another router:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> mainRouter = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-comment">// Handle static resources</span>
mainRouter.route(<span class="hljs-string">&quot;/static/*&quot;</span>).handler(myStaticHandler)

mainRouter.route(<span class="hljs-string">&quot;.*\\.templ&quot;</span>).handler(myTemplateHandler)</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can now mount the sub router on the main router, against a mount point, in this case <code>/productsAPI</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">mainRouter.mountSubRouter(<span class="hljs-string">&quot;/productsAPI&quot;</span>, restAPI)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This means the REST API is now accessible via paths like: <code>/productsAPI/products/product1234</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_localization"><a class="anchor" href="#_localization"></a>Localization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x Web parses the <code>Accept-Language</code> header and provides some helper methods to identify which is the preferred
locale for a client or the sorted list of preferred locales by quality.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.get(<span class="hljs-string">&quot;/localized&quot;</span>).handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// although it might seem strange by running a loop with a switch we</span>
  <span class="hljs-comment">// make sure that the locale order of preference is preserved when</span>
  <span class="hljs-comment">// replying in the users language.</span>
  rc.acceptableLanguages().foreach(language =&gt; {
    <span class="hljs-keyword">return</span>
  })

  <span class="hljs-comment">// we do not know the user language so lets just inform that back:</span>
  rc.response().end(<span class="hljs-string">s&quot;Sorry we don&#x27;t speak: <span class="hljs-subst">${rc.preferredLanguage()}</span>&quot;</span>)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main method <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#acceptableLocales()">acceptableLocales</a></code> will return the ordered list of locales the
user understands, if you&#8217;re only interested in the user prefered locale then the helper:
<code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#preferredLocale()">preferredLocale</a></code> will return the 1st element of the list or <code>null</code> if no
locale was provided by the user.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_route_match_failures"><a class="anchor" href="#_route_match_failures"></a>Route match failures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If no routes match for any particular request, Vert.x-Web will signal an error depending on match failure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>404 If no route matches the path</p>
</li>
<li>
<p>405 If a route matches the path but don&#8217;t match the HTTP Method</p>
</li>
<li>
<p>406 If a route matches the path and the method but It can&#8217;t provide a response with a content type matching <code>Accept</code> header</p>
</li>
<li>
<p>415 If a route matches the path and the method but It can&#8217;t accept the <code>Content-type</code></p>
</li>
<li>
<p>400 If a route matches the path and the method but It can&#8217;t accept an empty body</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can manually manage those failures using <code><a href="../../scaladocs/io/vertx/scala/ext/web/Router.html#errorHandler(int)">errorHandler</a></code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_error_handling"><a class="anchor" href="#_error_handling"></a>Error handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As well as setting handlers to handle requests you can also set handlers to handle failures in routing.</p>
</div>
<div class="paragraph">
<p>Failure handlers are used with the exact same route matching criteria that you use with normal handlers.</p>
</div>
<div class="paragraph">
<p>For example you can provide a failure handler that will only handle failures on certain paths, or for certain HTTP methods.</p>
</div>
<div class="paragraph">
<p>This allows you to set different failure handlers for different parts of your application.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example failure handler that will only be called for failure that occur when routing to GET requests
to paths that start with <code>/somepath/</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route = router.get(<span class="hljs-string">&quot;/somepath/*&quot;</span>)

route.failureHandler((frc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This will be called for failures that occur</span>
  <span class="hljs-comment">// when routing requests to paths starting with</span>
  <span class="hljs-comment">// &#x27;/somepath/&#x27;</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Failure routing will occur if a handler throws an exception, or if a handler calls
<code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#fail()">fail</a></code> specifying an HTTP status code to deliberately signal a failure.</p>
</div>
<div class="paragraph">
<p>If an exception is caught from a handler this will result in a failure with status code <code>500</code> being signalled.</p>
</div>
<div class="paragraph">
<p>When handling the failure, the failure handler is passed the routing context which also allows the failure or failure code
to be retrieved so the failure handler can use that to generate a failure response.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> route1 = router.get(<span class="hljs-string">&quot;/somepath/path1/&quot;</span>)

route1.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// Let&#x27;s say this throws a RuntimeException</span>
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> java.lang.<span class="hljs-type">RuntimeException</span>(<span class="hljs-string">&quot;something happened!&quot;</span>)

})

<span class="hljs-keyword">var</span> route2 = router.get(<span class="hljs-string">&quot;/somepath/path2&quot;</span>)

route2.handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This one deliberately fails the request passing in the status code</span>
  <span class="hljs-comment">// E.g. 403 - Forbidden</span>
  routingContext.fail(<span class="hljs-number">403</span>)

})

<span class="hljs-comment">// Define a failure handler</span>
<span class="hljs-comment">// This will get called for any failures in the above handlers</span>
<span class="hljs-keyword">var</span> route3 = router.get(<span class="hljs-string">&quot;/somepath/*&quot;</span>)

route3.failureHandler((failureRoutingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> statusCode = failureRoutingContext.statusCode()

  <span class="hljs-comment">// Status code will be 500 for the RuntimeException or 403 for the other failure</span>
  <span class="hljs-keyword">var</span> response = failureRoutingContext.response()
  response.setStatusCode(statusCode).end(<span class="hljs-string">&quot;Sorry! Not today&quot;</span>)

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the eventuality that an error occurs when running the error handler related usage of not allowed characters in
status message header, then the original status message will be changed to the default message from the error code.
This is a tradeoff to keep the semantics of the HTTP protocol working instead of abruptly creash and close the socket
without properly completing the protocol.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_request_body_handling"><a class="anchor" href="#_request_body_handling"></a>Request body handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/BodyHandler.html">BodyHandler</a></code> allows you to retrieve request bodies, limit body sizes and handle
file uploads.</p>
</div>
<div class="paragraph">
<p>You should make sure a body handler is on a matching route for any requests that require this functionality.</p>
</div>
<div class="paragraph">
<p>The usage of this handler requires that it is installed as soon as possible in the router since it needs
to install handlers to consume the HTTP request body and this must be done before executing any async call.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// This body handler will be called for all routes</span>
router.route().handler(<span class="hljs-type">BodyHandler</span>.create())</code></pre>
</div>
</div>
<div class="paragraph">
<p>If an async call is required before, the <code>HttpServerRequest</code> should be paused and then resumed so that the request
events are not delivered until the body handler is ready to process them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> request = routingContext.request()

  <span class="hljs-comment">// Pause the request</span>
  request.pause()

  someAsyncCall((result: java.lang.<span class="hljs-type">Void</span>) =&gt; {

    <span class="hljs-comment">// Resume the request</span>
    request.resume()

    <span class="hljs-comment">// And continue processing</span>
    routingContext.next()
  })
})

<span class="hljs-comment">// This body handler will be called for all routes</span>
router.route().handler(<span class="hljs-type">BodyHandler</span>.create())</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_getting_the_request_body"><a class="anchor" href="#_getting_the_request_body"></a>Getting the request body</h3>
<div class="paragraph">
<p>If you know the request body is JSON, then you can use <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getBodyAsJson()">getBodyAsJson</a></code>,
if you know it&#8217;s a string you can use <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getBodyAsString()">getBodyAsString</a></code>, or to
retrieve it as a buffer use <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getBody()">getBody</a></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_limiting_body_size"><a class="anchor" href="#_limiting_body_size"></a>Limiting body size</h3>
<div class="paragraph">
<p>To limit the size of a request body, create the body handler then use <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/BodyHandler.html#setBodyLimit()">setBodyLimit</a></code>
to specifying the maximum body size, in bytes. This is useful to avoid running out of memory with very large bodies.</p>
</div>
<div class="paragraph">
<p>If an attempt to send a body greater than the maximum size is made, an HTTP status code of 413 - <code>Request Entity Too Large</code>,
will be sent.</p>
</div>
<div class="paragraph">
<p>There is no body limit by default.</p>
</div>
</div>
<div class="sect2">
<h3 id="_merging_form_attributes"><a class="anchor" href="#_merging_form_attributes"></a>Merging form attributes</h3>
<div class="paragraph">
<p>By default, the body handler will merge any form attributes into the request parameters. If you don&#8217;t want this behaviour
you can use disable it with <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/BodyHandler.html#setMergeFormAttributes()">setMergeFormAttributes</a></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_handling_file_uploads"><a class="anchor" href="#_handling_file_uploads"></a>Handling file uploads</h3>
<div class="paragraph">
<p>Body handler is also used to handle multi-part file uploads.</p>
</div>
<div class="paragraph">
<p>If a body handler is on a matching route for the request, any file uploads will be automatically streamed to the
uploads directory, which is <code>file-uploads</code> by default.</p>
</div>
<div class="paragraph">
<p>Each file will be given an automatically generated file name, and the file uploads will be available on the routing
context with <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#fileUploads()">fileUploads</a></code>.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().handler(<span class="hljs-type">BodyHandler</span>.create())

router.post(<span class="hljs-string">&quot;/some/path/uploads&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> uploads = routingContext.fileUploads()
  <span class="hljs-comment">// Do something with uploads....</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each file upload is described by a <code><a href="../../scaladocs/io/vertx/scala/ext/web/FileUpload.html">FileUpload</a></code> instance, which allows various properties
such as the name, file-name and size to be accessed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handling_cookies"><a class="anchor" href="#_handling_cookies"></a>Handling cookies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web has out of the box cookies support.</p>
</div>
<div class="paragraph">
<p>Before 3.8.1, cookie required to use the <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/CookieHandler.html">CookieHandler</a></code> to active this functionality.</p>
</div>
<div class="paragraph">
<p>Since 3.8.1, the <code>CookieHandler</code> has been deprecated and should not be used anymore.</p>
</div>
<div class="sect2">
<h3 id="_manipulating_cookies"><a class="anchor" href="#_manipulating_cookies"></a>Manipulating cookies</h3>
<div class="paragraph">
<p>You use <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getCookie()">getCookie</a></code> to retrieve
a cookie by name, or use <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#cookieMap()">cookieMap</a></code> to retrieve the entire set.</p>
</div>
<div class="paragraph">
<p>To remove a cookie, use <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#removeCookie()">removeCookie</a></code>.</p>
</div>
<div class="paragraph">
<p>To add a cookie use <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#addCookie()">addCookie</a></code>.</p>
</div>
<div class="paragraph">
<p>The set of cookies will be written back in the response automatically when the response headers are written so the
browser can store them.</p>
</div>
<div class="paragraph">
<p>Cookies are described by instances of <code><a href="../../scaladocs/io/vertx/scala/core/http/Cookie.html">Cookie</a></code>. This allows you to retrieve the name,
value, domain, path and other normal cookie properties.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of querying and adding cookies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> someCookie = routingContext.getCookie(<span class="hljs-string">&quot;mycookie&quot;</span>)
<span class="hljs-keyword">var</span> cookieValue = someCookie.getValue()

<span class="hljs-comment">// Do something with cookie...</span>

<span class="hljs-comment">// Add a cookie - this will get written back in the response automatically</span>
routingContext.addCookie(<span class="hljs-type">Cookie</span>.cookie(<span class="hljs-string">&quot;othercookie&quot;</span>, <span class="hljs-string">&quot;somevalue&quot;</span>))</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handling_sessions"><a class="anchor" href="#_handling_sessions"></a>Handling sessions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web provides out of the box support for sessions.</p>
</div>
<div class="paragraph">
<p>Sessions last between HTTP requests for the length of a browser session and give you a place where you can add
session-scope information, such as a shopping basket.</p>
</div>
<div class="paragraph">
<p>Vert.x-Web uses session cookies to identify a session. The session cookie is temporary and will be deleted by your browser
when it&#8217;s closed.</p>
</div>
<div class="paragraph">
<p>We don&#8217;t put the actual data of your session in the session cookie - the cookie simply uses an identifier to look-up
the actual session on the server. The identifier is a random UUID generated using a secure random, so it should
be effectively unguessable.</p>
</div>
<div class="paragraph">
<p>Cookies are passed across the wire in HTTP requests and responses so it&#8217;s always wise to make sure you are using
HTTPS when sessions are being used. Vert.x will warn you if you attempt to use sessions over straight HTTP.</p>
</div>
<div class="paragraph">
<p>To enable sessions in your application you must have a <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/SessionHandler.html">SessionHandler</a></code>
on a matching route before your application logic.</p>
</div>
<div class="paragraph">
<p>The session handler handles the creation of session cookies and the lookup of the session so you don&#8217;t have to do
that yourself.</p>
</div>
<div class="sect2">
<h3 id="_session_stores"><a class="anchor" href="#_session_stores"></a>Session stores</h3>
<div class="paragraph">
<p>To create a session handler you need to have a session store instance. The session store is the object that
holds the actual sessions for your application.</p>
</div>
<div class="paragraph">
<p>The session store is responsible for holding a secure pseudo random number generator in order to guarantee secure session
ids. This PRNG is independent of the store which means that given a session id from store A one cannot derive the
session id of store B since they have different seeds and states.</p>
</div>
<div class="paragraph">
<p>By default this PRNG uses a mixed mode, blocking for seeding, non blocking for generating. The PRNG will also reseed
every 5 minutes with 64bits of new entropy. However this can all be configured using the system properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>io.vertx.ext.auth.prng.algorithm e.g.: SHA1PRNG</p>
</li>
<li>
<p>io.vertx.ext.auth.prng.seed.interval e.g.: 1000 (every second)</p>
</li>
<li>
<p>io.vertx.ext.auth.prng.seed.bits e.g.: 128</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most users should not need to configure these values unless if you notice that the performance of your application is
being affected by the PRNG algorithm.</p>
</div>
<div class="paragraph">
<p>Vert.x-Web comes with two session store implementations out of the box, and you can also write your own if you prefer.</p>
</div>
<div class="paragraph">
<p>The implementations are expected to follow the <code>ServiceLoader</code> conventions and all stores that are available at runtime
from the classpath will be exposed. When more than 1 implementations are available the first one that can be
instantiated and configured with success becomes the default. If none is available, then the default depends on the mode
Vert.x was created. If cluster mode is available the the clustered session store is the default otherwise the local
storage is the default.</p>
</div>
<div class="sect3">
<h4 id="_local_session_store"><a class="anchor" href="#_local_session_store"></a>Local session store</h4>
<div class="paragraph">
<p>With this store, sessions are stored locally in memory and only available in this instance.</p>
</div>
<div class="paragraph">
<p>This store is appropriate if you have just a single Vert.x instance of you are using sticky sessions in your application
and have configured your load balancer to always route HTTP requests to the same Vert.x instance.</p>
</div>
<div class="paragraph">
<p>If you can&#8217;t ensure your requests will all terminate on the same server then don&#8217;t use this store as your
requests might end up on a server which doesn&#8217;t know about your session.</p>
</div>
<div class="paragraph">
<p>Local session stores are implemented by using a shared local map, and have a reaper which clears out expired sessions.</p>
</div>
<div class="paragraph">
<p>The reaper interval can be configured with a json message with the key: <code>reaperInterval</code>.</p>
</div>
<div class="paragraph">
<p>Here are some examples of creating a local <code><a href="../../scaladocs/io/vertx/scala/ext/web/sstore/SessionStore.html">SessionStore</a></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// Create a local session store using defaults</span>
<span class="hljs-keyword">var</span> store1 = <span class="hljs-type">LocalSessionStore</span>.create(vertx)

<span class="hljs-comment">// Create a local session store specifying the local shared map name to use</span>
<span class="hljs-comment">// This might be useful if you have more than one application in the same</span>
<span class="hljs-comment">// Vert.x instance and want to use different maps for different applications</span>
<span class="hljs-keyword">var</span> store2 = <span class="hljs-type">LocalSessionStore</span>.create(vertx, <span class="hljs-string">&quot;myapp3.sessionmap&quot;</span>)

<span class="hljs-comment">// Create a local session store specifying the local shared map name to use and</span>
<span class="hljs-comment">// setting the reaper interval for expired sessions to 10 seconds</span>
<span class="hljs-keyword">var</span> store3 = <span class="hljs-type">LocalSessionStore</span>.create(vertx, <span class="hljs-string">&quot;myapp3.sessionmap&quot;</span>, <span class="hljs-number">10000</span>)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_clustered_session_store"><a class="anchor" href="#_clustered_session_store"></a>Clustered session store</h4>
<div class="paragraph">
<p>With this store, sessions are stored in a distributed map which is accessible across the Vert.x cluster.</p>
</div>
<div class="paragraph">
<p>This store is appropriate if you&#8217;re <em>not</em> using sticky sessions, i.e. your load balancer is distributing different
requests from the same browser to different servers.</p>
</div>
<div class="paragraph">
<p>Your session is accessible from any node in the cluster using this store.</p>
</div>
<div class="paragraph">
<p>To you use a clustered session store you should make sure your Vert.x instance is clustered.</p>
</div>
<div class="paragraph">
<p>Here are some examples of creating a clustered <code><a href="../../scaladocs/io/vertx/scala/ext/web/sstore/SessionStore.html">SessionStore</a></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// a clustered Vert.x</span>
<span class="hljs-type">Vertx</span>.clusteredVertx(<span class="hljs-type">VertxOptions</span>()
  .setClustered(<span class="hljs-literal">true</span>)
, {
  <span class="hljs-keyword">case</span> <span class="hljs-type">Success</span>(result) =&gt; println(<span class="hljs-string">&quot;Success&quot;</span>)
  <span class="hljs-keyword">case</span> <span class="hljs-type">Failure</span>(cause) =&gt; println(<span class="hljs-string">&quot;Failure&quot;</span>)
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_creating_the_session_handler"><a class="anchor" href="#_creating_the_session_handler"></a>Creating the session handler</h3>
<div class="paragraph">
<p>Once you&#8217;ve created a session store you can create a session handler, and add it to a route. You should make sure
your session handler is routed to before your application handlers.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-comment">// Create a clustered session store using defaults</span>
<span class="hljs-keyword">var</span> store = <span class="hljs-type">ClusteredSessionStore</span>.create(vertx)

<span class="hljs-keyword">var</span> sessionHandler = <span class="hljs-type">SessionHandler</span>.create(store)

<span class="hljs-comment">// the session handler controls the cookie used for the session</span>
<span class="hljs-comment">// this includes configuring, for example, the same site policy</span>
<span class="hljs-comment">// like this, for strict same site policy.</span>
sessionHandler.setCookieSameSite(<span class="hljs-type">CookieSameSite</span>.<span class="hljs-type">STRICT</span>)

<span class="hljs-comment">// Make sure all requests are routed through the session handler too</span>
router.route().handler(sessionHandler)

<span class="hljs-comment">// Now your application handlers</span>
router.route(<span class="hljs-string">&quot;/somepath/blah/&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> session = routingContext.session()
  session.put(<span class="hljs-string">&quot;foo&quot;</span>, <span class="hljs-string">&quot;bar&quot;</span>)
  <span class="hljs-comment">// etc</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The session handler will ensure that your session is automatically looked up (or created if no session exists)
from the session store and set on the routing context before it gets to your application handlers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_session"><a class="anchor" href="#_using_the_session"></a>Using the session</h3>
<div class="paragraph">
<p>In your handlers you can access the session instance with <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#session()">session</a></code>.</p>
</div>
<div class="paragraph">
<p>You put data into the session with <code><a href="../../scaladocs/io/vertx/scala/ext/web/Session.html#put(java.lang.String)">put</a></code>,
you get data from the session with <code><a href="../../scaladocs/io/vertx/scala/ext/web/Session.html#get()">get</a></code>, and you remove
data from the session with <code><a href="../../scaladocs/io/vertx/scala/ext/web/Session.html#remove()">remove</a></code>.</p>
</div>
<div class="paragraph">
<p>The keys for items in the session are always strings. The values can be any type for a local session store, and for
a clustered session store they can be any basic type, or <code><a href="../../scaladocs/io/vertx/scala/core/buffer/Buffer.html">Buffer</a></code>, <code>JsonObject</code>,
<code>JsonArray</code> or a serializable object, as the values have to serialized across the cluster.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of manipulating session data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().handler(sessionHandler)

<span class="hljs-comment">// Now your application handlers</span>
router.route(<span class="hljs-string">&quot;/somepath/blah&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-keyword">var</span> session = routingContext.session()

  <span class="hljs-comment">// Put some data from the session</span>
  session.put(<span class="hljs-string">&quot;foo&quot;</span>, <span class="hljs-string">&quot;bar&quot;</span>)

  <span class="hljs-comment">// Retrieve some data from a session</span>
  <span class="hljs-keyword">var</span> age = session.get(<span class="hljs-string">&quot;age&quot;</span>)

  <span class="hljs-comment">// Remove some data from a session</span>
  <span class="hljs-keyword">var</span> obj = session.remove(<span class="hljs-string">&quot;myobj&quot;</span>)

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sessions are automatically written back to the store after after responses are complete.</p>
</div>
<div class="paragraph">
<p>You can manually destroy a session using <code><a href="../../scaladocs/io/vertx/scala/ext/web/Session.html#destroy()">destroy</a></code>. This will remove the session
from the context and the session store. Note that if there is no session a new one will be automatically created
for the next request from the browser that&#8217;s routed through the session handler.</p>
</div>
</div>
<div class="sect2">
<h3 id="_session_timeout"><a class="anchor" href="#_session_timeout"></a>Session timeout</h3>
<div class="paragraph">
<p>Sessions will be automatically timed out if they are not accessed for a time greater than the timeout period. When
a session is timed out, it is removed from the store.</p>
</div>
<div class="paragraph">
<p>Sessions are automatically marked as accessed when a request arrives and the session is looked up and and when the
response is complete and the session is stored back in the store.</p>
</div>
<div class="paragraph">
<p>You can also use <code><a href="../../scaladocs/io/vertx/scala/ext/web/Session.html#setAccessed()">setAccessed</a></code> to manually mark a session as accessed.</p>
</div>
<div class="paragraph">
<p>The session timeout can be configured when creating the session handler. Default timeout is 30 minutes.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authentication_authorisation"><a class="anchor" href="#_authentication_authorisation"></a>Authentication / authorisation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x comes with some out-of-the-box handlers for handling both authentication and authorisation.</p>
</div>
<div class="sect2">
<h3 id="_creating_an_auth_handler"><a class="anchor" href="#_creating_an_auth_handler"></a>Creating an auth handler</h3>
<div class="paragraph">
<p>To create an auth handler you need an instance of <code><a href="../../scaladocs/io/vertx/scala/ext/auth/AuthProvider.html">AuthProvider</a></code>. Auth provider is
used for authentication and authorisation of users. Vert.x provides several auth provider instances out of the box
in the vertx-auth project. For full information on auth providers and how to use and configure them
please consult the auth documentation.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s a simple example of creating a basic auth handler given an auth provider.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().handler(<span class="hljs-type">SessionHandler</span>.create(<span class="hljs-type">LocalSessionStore</span>.create(vertx)))

<span class="hljs-keyword">var</span> basicAuthHandler = <span class="hljs-type">BasicAuthHandler</span>.create(authProvider)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handling_auth_in_your_application"><a class="anchor" href="#_handling_auth_in_your_application"></a>Handling auth in your application</h3>
<div class="paragraph">
<p>Let&#8217;s say you want all requests to paths that start with <code>/private/</code> to be subject to auth. To do that you make sure
your auth handler is before your application handlers on those paths:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().handler(<span class="hljs-type">SessionHandler</span>.create(<span class="hljs-type">LocalSessionStore</span>.create(vertx)).setAuthProvider(authProvider))

<span class="hljs-keyword">var</span> basicAuthHandler = <span class="hljs-type">BasicAuthHandler</span>.create(authProvider)

<span class="hljs-comment">// All requests to paths starting with &#x27;/private/&#x27; will be protected</span>
router.route(<span class="hljs-string">&quot;/private/*&quot;</span>).handler(basicAuthHandler)

router.route(<span class="hljs-string">&quot;/someotherpath&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This will be public access - no login required</span>

})

router.route(<span class="hljs-string">&quot;/private/somepath&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This will require a login</span>

  <span class="hljs-comment">// This will have the value true</span>
  <span class="hljs-keyword">var</span> isAuthenticated = routingContext.user() != <span class="hljs-literal">null</span>

})</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the auth handler has successfully authenticated and authorised the user it will inject a <code><a href="../../scaladocs/io/vertx/scala/ext/auth/User.html">User</a></code>
object into the <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html">RoutingContext</a></code> so it&#8217;s available in your handlers with:
<code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#user()">user</a></code>.</p>
</div>
<div class="paragraph">
<p>If you want your User object to be stored in the session so it&#8217;s available between requests so you don&#8217;t have to
authenticate on each request, then you should make sure you have a session handler and a user session handler on matching
routes before the auth handler.</p>
</div>
<div class="paragraph">
<p>Once you have your user object you can also programmatically use the methods on it to authorise the user.</p>
</div>
<div class="paragraph">
<p>If you want to cause the user to be logged out you can call <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#clearUser()">clearUser</a></code>
on the routing context.</p>
</div>
</div>
<div class="sect2">
<h3 id="_http_basic_authentication"><a class="anchor" href="#_http_basic_authentication"></a>HTTP Basic Authentication</h3>
<div class="paragraph">
<p><a href="http://en.wikipedia.org/wiki/Basic_access_authentication">HTTP Basic Authentication</a> is a simple means of authentication
that can be appropriate for simple applications.</p>
</div>
<div class="paragraph">
<p>With basic auth, credentials are sent unencrypted across the wire in HTTP headers so it&#8217;s essential that you serve
your application using HTTPS not HTTP.</p>
</div>
<div class="paragraph">
<p>With basic auth, if a user requests a resource that requires authorisation, the basic auth handler will send back
a <code>401</code> response with the header <code>WWW-Authenticate</code> set. This prompts the browser to show a log-in dialogue and
prompt the user to enter their username and password.</p>
</div>
<div class="paragraph">
<p>The request is made to the resource again, this time with the <code>Authorization</code> header set, containing the username
and password encoded in Base64.</p>
</div>
<div class="paragraph">
<p>When the basic auth handler receives this information, it calls the configured <code><a href="../../scaladocs/io/vertx/scala/ext/auth/AuthProvider.html">AuthProvider</a></code>
with the username and password to authenticate the user. If the authentication is successful the handler attempts
to authorise the user. If that is successful then the routing of the request is allowed to continue to the application
handlers, otherwise a <code>403</code> response is returned to signify that access is denied.</p>
</div>
<div class="paragraph">
<p>The auth handler can be set-up with a set of authorities that are required for access to the resources to
be granted.</p>
</div>
</div>
<div class="sect2">
<h3 id="_redirect_auth_handler"><a class="anchor" href="#_redirect_auth_handler"></a>Redirect auth handler</h3>
<div class="paragraph">
<p>With redirect auth handling the user is redirected to towards a login page in the case they are trying to access
a protected resource and they are not logged in.</p>
</div>
<div class="paragraph">
<p>The user then fills in the login form and submits it. This is handled by the server which authenticates
the user and, if authenticated redirects the user back to the original resource.</p>
</div>
<div class="paragraph">
<p>To use redirect auth you configure an instance of <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/RedirectAuthHandler.html">RedirectAuthHandler</a></code> instead of a
basic auth handler.</p>
</div>
<div class="paragraph">
<p>You will also need to setup handlers to serve your actual login page, and a handler to handle the actual login itself.
To handle the login we provide a prebuilt handler <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/FormLoginHandler.html">FormLoginHandler</a></code> for the purpose.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of a simple app, using a redirect auth handler on the default redirect url <code>/loginpage</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().handler(<span class="hljs-type">SessionHandler</span>.create(<span class="hljs-type">LocalSessionStore</span>.create(vertx)).setAuthProvider(authProvider))

<span class="hljs-keyword">var</span> redirectAuthHandler = <span class="hljs-type">RedirectAuthHandler</span>.create(authProvider)

<span class="hljs-comment">// All requests to paths starting with &#x27;/private/&#x27; will be protected</span>
router.route(<span class="hljs-string">&quot;/private/*&quot;</span>).handler(redirectAuthHandler)

<span class="hljs-comment">// Handle the actual login</span>
<span class="hljs-comment">// One of your pages must POST form login data</span>
router.post(<span class="hljs-string">&quot;/login&quot;</span>).handler(<span class="hljs-type">FormLoginHandler</span>.create(authProvider))

<span class="hljs-comment">// Set a static server to serve static resources, e.g. the login page</span>
router.route().handler(<span class="hljs-type">StaticHandler</span>.create())

router.route(<span class="hljs-string">&quot;/someotherpath&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// This will be public access - no login required</span>
})

router.route(<span class="hljs-string">&quot;/private/somepath&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// This will require a login</span>

  <span class="hljs-comment">// This will have the value true</span>
  <span class="hljs-keyword">var</span> isAuthenticated = routingContext.user() != <span class="hljs-literal">null</span>

})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jwt_authorisation"><a class="anchor" href="#_jwt_authorisation"></a>JWT authorisation</h3>
<div class="paragraph">
<p>With JWT authorisation resources can be protected by means of permissions and users without enough rights are denied
access. You need to add the <code>io.vertx:vertx-auth-jwt:${maven.version}</code> dependency to use <code>JWTAuthProvider</code></p>
</div>
<div class="paragraph">
<p>To use this handler there are 2 steps involved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setup an handler to issue tokens (or rely on a 3rd party)</p>
</li>
<li>
<p>Setup the handler to filter the requests</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please note that these 2 handlers should be only available on HTTPS, not doing so allows sniffing the tokens in
transit which leads to session hijacking attacks.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example on how to issue tokens:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-keyword">var</span> authConfig = <span class="hljs-type">JWTAuthOptions</span>()
  .setKeyStore(<span class="hljs-type">KeyStoreOptions</span>()
    .setType(<span class="hljs-string">&quot;jceks&quot;</span>)
    .setPath(<span class="hljs-string">&quot;keystore.jceks&quot;</span>)
    .setPassword(<span class="hljs-string">&quot;secret&quot;</span>)
  )


<span class="hljs-keyword">var</span> authProvider = <span class="hljs-type">JWTAuth</span>.create(vertx, authConfig)

router.route(<span class="hljs-string">&quot;/login&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// this is an example, authentication should be done with another provider...</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;paulo&quot;</span> == ctx.request().getParam(<span class="hljs-string">&quot;username&quot;</span>) &amp;&amp; <span class="hljs-string">&quot;secret&quot;</span> == ctx.request().getParam(<span class="hljs-string">&quot;password&quot;</span>)) {
    ctx.response().end(authProvider.generateToken(<span class="hljs-keyword">new</span> io.vertx.core.json.<span class="hljs-type">JsonObject</span>().put(<span class="hljs-string">&quot;sub&quot;</span>, <span class="hljs-string">&quot;paulo&quot;</span>), <span class="hljs-type">JWTOptions</span>()))
  } <span class="hljs-keyword">else</span> {
    ctx.fail(<span class="hljs-number">401</span>)
  }
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now that your client has a token all it is required is that forall* consequent request the HTTP header
<code>Authorization</code> is filled with: <code>Bearer &lt;token&gt;</code> e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-keyword">var</span> authConfig = <span class="hljs-type">JWTAuthOptions</span>()
  .setKeyStore(<span class="hljs-type">KeyStoreOptions</span>()
    .setType(<span class="hljs-string">&quot;jceks&quot;</span>)
    .setPath(<span class="hljs-string">&quot;keystore.jceks&quot;</span>)
    .setPassword(<span class="hljs-string">&quot;secret&quot;</span>)
  )


<span class="hljs-keyword">var</span> authProvider = <span class="hljs-type">JWTAuth</span>.create(vertx, authConfig)

router.route(<span class="hljs-string">&quot;/protected/*&quot;</span>).handler(<span class="hljs-type">JWTAuthHandler</span>.create(authProvider))

router.route(<span class="hljs-string">&quot;/protected/somepage&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// some handle code...</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>JWT allows you to add any information you like to the token itself. By doing this there is no state in the server
which allows you to scale your applications without need for clustered session data. In order to add data to the
token, during the creation of the token just add data to the JsonObject parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> authConfig = <span class="hljs-type">JWTAuthOptions</span>()
  .setKeyStore(<span class="hljs-type">KeyStoreOptions</span>()
    .setType(<span class="hljs-string">&quot;jceks&quot;</span>)
    .setPath(<span class="hljs-string">&quot;keystore.jceks&quot;</span>)
    .setPassword(<span class="hljs-string">&quot;secret&quot;</span>)
  )


<span class="hljs-keyword">var</span> authProvider = <span class="hljs-type">JWTAuth</span>.create(vertx, authConfig)

authProvider.generateToken(<span class="hljs-keyword">new</span> io.vertx.core.json.<span class="hljs-type">JsonObject</span>().put(<span class="hljs-string">&quot;sub&quot;</span>, <span class="hljs-string">&quot;paulo&quot;</span>).put(<span class="hljs-string">&quot;someKey&quot;</span>, <span class="hljs-string">&quot;some value&quot;</span>), <span class="hljs-type">JWTOptions</span>())</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the same when consuming:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> handler = (rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-keyword">var</span> theSubject = rc.user().principal().getValue(<span class="hljs-string">&quot;sub&quot;</span>)
  <span class="hljs-keyword">var</span> someKey = rc.user().principal().getValue(<span class="hljs-string">&quot;someKey&quot;</span>)
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_required_authorities"><a class="anchor" href="#_configuring_required_authorities"></a>Configuring required authorities</h3>
<div class="paragraph">
<p>With any auth handler you can also configure required authorities to access the resource.</p>
</div>
<div class="paragraph">
<p>By default, if no authorities are configured then it is sufficient to be logged in to access the resource, otherwise
the user must be both logged in (authenticated) and have the required authorities.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of configuring an app so that different authorities are required for different parts of the
app. Note that the meaning of the authorities is determined by the underlying auth provider that you use. E.g. some
may support a role/permission based model but others might use another model.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> listProductsAuthHandler = <span class="hljs-type">RedirectAuthHandler</span>.create(authProvider)
listProductsAuthHandler.addAuthority(<span class="hljs-string">&quot;list_products&quot;</span>)

<span class="hljs-comment">// Need &quot;list_products&quot; authority to list products</span>
router.route(<span class="hljs-string">&quot;/listproducts/*&quot;</span>).handler(listProductsAuthHandler)

<span class="hljs-keyword">var</span> settingsAuthHandler = <span class="hljs-type">RedirectAuthHandler</span>.create(authProvider)
settingsAuthHandler.addAuthority(<span class="hljs-string">&quot;role:admin&quot;</span>)

<span class="hljs-comment">// Only &quot;admin&quot; has access to /private/settings</span>
router.route(<span class="hljs-string">&quot;/private/settings/*&quot;</span>).handler(settingsAuthHandler)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_chaining_multiple_auth_handlers"><a class="anchor" href="#_chaining_multiple_auth_handlers"></a>Chaining multiple auth handlers</h3>
<div class="paragraph">
<p>There are times when you want to support multiple authN/authZ mechanisms in a single application. For this you can
use the <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/ChainAuthHandler.html">ChainAuthHandler</a></code>. The chain auth handler will attempt to perform
authentication on a chain of handlers. The chain works both for AuthN and AuthZ, so if the authentication is valid
at a given handler of the chain, then that same handler will be used to perform authorization (if requested).</p>
</div>
<div class="paragraph">
<p>It is important to know that some handlers require specific providers, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/JWTAuthHandler.html">JWTAuthHandler</a></code> requires <code><a href="../../scaladocs/io/vertx/scala/ext/auth/jwt/JWTAuth.html">JWTAuth</a></code>.</p>
</li>
<li>
<p>The <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/DigestAuthHandler.html">DigestAuthHandler</a></code> requires <code><a href="../../scaladocs/io/vertx/scala/ext/auth/htdigest/HtdigestAuth.html">HtdigestAuth</a></code>.</p>
</li>
<li>
<p>The <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/OAuth2AuthHandler.html">OAuth2AuthHandler</a></code> requires <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/OAuth2Auth.html">OAuth2Auth</a></code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So it is not expected that the providers will be shared across all handlers. There are cases where one can share the
provider across handlers, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/BasicAuthHandler.html">BasicAuthHandler</a></code> can take any provider.</p>
</li>
<li>
<p>The <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/RedirectAuthHandler.html">RedirectAuthHandler</a></code> can take any provider.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So say that you want to create an application that accepts both <code>HTTP Basic Authentication</code> and <code>Form Redirect</code>. You
would start configuring your chain as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> chain = <span class="hljs-type">ChainAuthHandler</span>.create()

<span class="hljs-comment">// add http basic auth handler to the chain</span>
chain.append(<span class="hljs-type">BasicAuthHandler</span>.create(provider))
<span class="hljs-comment">// add form redirect auth handler to the chain</span>
chain.append(<span class="hljs-type">RedirectAuthHandler</span>.create(provider))

<span class="hljs-comment">// secure your route</span>
router.route(<span class="hljs-string">&quot;/secure/resource&quot;</span>).handler(chain)
<span class="hljs-comment">// your app</span>
router.route(<span class="hljs-string">&quot;/secure/resource&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// do something...</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>So when a user makes a request without a <code>Authorization</code> header, this means that the chain will fail to authenticate
with the basic auth handler and will attempt to authenticate with the redirect handler. Since the redirect handler
always redirects you will be sent to the login form that you configured in that handler.</p>
</div>
<div class="paragraph">
<p>Like the normal routing in vertx-web, auth chaning is a sequence, so if you would prefer to fallback to your browser
asking for the user credentials using HTTP Basic authentication instead of the redirect all you need to to is reverse
the order of appending to the chain.</p>
</div>
<div class="paragraph">
<p>Now assume that you make a request where you provide the header <code>Authorization</code> with the value <code>Basic [token]</code>. In
this case the basic auth handler will attempt to authenticate and if it is sucessful the chain will stop and
vertx-web will continue to process your handlers. If the token is not valid, for example bad username/password, then
the chain will continue to the following entry. In this specific case the redirect auth handler.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_serving_static_resources"><a class="anchor" href="#_serving_static_resources"></a>Serving static resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web comes with an out of the box handler for serving static web resources so you can write static web servers
very easily.</p>
</div>
<div class="paragraph">
<p>To serve static resources such as <code>.html</code>, <code>.css</code>, <code>.js</code> or any other static resource, you use an instance of
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html">StaticHandler</a></code>.</p>
</div>
<div class="paragraph">
<p>Any requests to paths handled by the static handler will result in files being served from a directory on the file system
or from the classpath. The default static file directory is <code>webroot</code> but this can be configured.</p>
</div>
<div class="paragraph">
<p>In the following example all requests to paths starting with <code>/static/</code> will get served from the directory <code>webroot</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route(<span class="hljs-string">&quot;/static/*&quot;</span>).handler(<span class="hljs-type">StaticHandler</span>.create())</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, if there was a request with path <code>/static/css/mystyles.css</code> the static serve will look for a file in the
directory <code>webroot/css/mystyle.css</code>.</p>
</div>
<div class="paragraph">
<p>It will also look for a file on the classpath called <code>webroot/css/mystyle.css</code>. This means you can package up all your
static resources into a jar file (or fatjar) and distribute them like that.</p>
</div>
<div class="paragraph">
<p>When Vert.x finds a resource on the classpath for the first time it extracts it and caches it in a temporary directory
on disk so it doesn&#8217;t have to do this each time.</p>
</div>
<div class="paragraph">
<p>The handler will handle range aware requests. When a client makes a request to a static resource, the handler will
notify that it can handle range aware request by stating the unit on the <code>Accept-Ranges</code> header. Further requests
that contain the <code>Range</code> header with the correct unit and start and end indexes will then receive partial responses
with the correct <code>Content-Range</code> header.</p>
</div>
<div class="sect2">
<h3 id="_configuring_caching"><a class="anchor" href="#_configuring_caching"></a>Configuring caching</h3>
<div class="paragraph">
<p>By default the static handler will set cache headers to enable browsers to effectively cache files.</p>
</div>
<div class="paragraph">
<p>Vert.x-Web sets the headers <code>cache-control</code>,<code>last-modified</code>, and <code>date</code>.</p>
</div>
<div class="paragraph">
<p><code>cache-control</code> is set to <code>max-age=86400</code> by default. This corresponds to one day. This can be configured with
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setMaxAgeSeconds()">setMaxAgeSeconds</a></code> if required.</p>
</div>
<div class="paragraph">
<p>If a browser sends a GET or a HEAD request with an <code>if-modified-since</code> header and the resource has not been modified
since that date, a <code>304</code> status is returned which tells the browser to use its locally cached resource.</p>
</div>
<div class="paragraph">
<p>If handling of cache headers is not required, it can be disabled with <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setCachingEnabled()">setCachingEnabled</a></code>.</p>
</div>
<div class="paragraph">
<p>When cache handling is enabled Vert.x-Web will cache the last modified date of resources in memory, this avoids a disk hit
to check the actual last modified date every time.</p>
</div>
<div class="paragraph">
<p>Entries in the cache have an expiry time, and after that time, the file on disk will be checked again and the cache
entry updated.</p>
</div>
<div class="paragraph">
<p>If you know that your files never change on disk, then the cache entry will effectively never expire. This is the
default.</p>
</div>
<div class="paragraph">
<p>If you know that your files might change on disk when the server is running then you can set files read only to false with
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setFilesReadOnly()">setFilesReadOnly</a></code>.</p>
</div>
<div class="paragraph">
<p>To enable the maximum number of entries that can be cached in memory at any one time you can use
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setMaxCacheSize()">setMaxCacheSize</a></code>.</p>
</div>
<div class="paragraph">
<p>To configure the expiry time of cache entries you can use <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setCacheEntryTimeout()">setCacheEntryTimeout</a></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_the_index_page"><a class="anchor" href="#_configuring_the_index_page"></a>Configuring the index page</h3>
<div class="paragraph">
<p>Any requests to the root path <code>/</code> will cause the index page to be served. By default the index page is <code>index.html</code>.
This can be configured with <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setIndexPage()">setIndexPage</a></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_changing_the_web_root"><a class="anchor" href="#_changing_the_web_root"></a>Changing the web root</h3>
<div class="paragraph">
<p>By default static resources will be served from the directory <code>webroot</code>. To configure this use
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setWebRoot()">setWebRoot</a></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_serving_hidden_files"><a class="anchor" href="#_serving_hidden_files"></a>Serving hidden files</h3>
<div class="paragraph">
<p>By default the serve will serve hidden files (files starting with <code>.</code>).</p>
</div>
<div class="paragraph">
<p>If you do not want hidden files to be served you can configure it with <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setIncludeHidden()">setIncludeHidden</a></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_directory_listing"><a class="anchor" href="#_directory_listing"></a>Directory listing</h3>
<div class="paragraph">
<p>The server can also perform directory listing. By default directory listing is disabled. To enabled it use
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setDirectoryListing()">setDirectoryListing</a></code>.</p>
</div>
<div class="paragraph">
<p>When directory listing is enabled the content returned depends on the content type in the <code>accept</code> header.</p>
</div>
<div class="paragraph">
<p>For <code>text/html</code> directory listing, the template used to render the directory listing page can be configured with
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setDirectoryTemplate()">setDirectoryTemplate</a></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_disabling_file_caching_on_disk"><a class="anchor" href="#_disabling_file_caching_on_disk"></a>Disabling file caching on disk</h3>
<div class="paragraph">
<p>By default, Vert.x will cache files that are served from the classpath into a file on disk in a sub-directory of a
directory called <code>.vertx</code> in the current working directory. This is mainly useful when deploying services as
fatjars in production where serving a file from the classpath every time can be slow.</p>
</div>
<div class="paragraph">
<p>In development this can cause a problem, as if you update your static content while the server is running, the
cached file will be served not the updated file.</p>
</div>
<div class="paragraph">
<p>To disable file caching you can provide your vert.x options the property <code>fileResolverCachingEnabled</code> to <code>false</code>. For
backwards compatibility it will also default that value to the system property <code>vertx.disableFileCaching</code>. E.g. you
could set up a run configuration in your IDE to set this when running your main class.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cors_handling"><a class="anchor" href="#_cors_handling"></a>CORS handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="http://en.wikipedia.org/wiki/Cross-origin_resource_sharing">Cross Origin Resource Sharing</a> is a safe mechanism for
allowing resources to be requested from one domain and served from another.</p>
</div>
<div class="paragraph">
<p>Vert.x-Web includes a handler <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/CorsHandler.html">CorsHandler</a></code> that handles the CORS protocol for you.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// Will only accept GET requests from origin &quot;vertx.io&quot;</span>
router.route().handler(<span class="hljs-type">CorsHandler</span>.create(<span class="hljs-string">&quot;vertx\\.io&quot;</span>).allowedMethod(<span class="hljs-type">HttpMethod</span>.<span class="hljs-type">GET</span>))

router.route().handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  <span class="hljs-comment">// Your app handlers</span>

})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multi_tenant"><a class="anchor" href="#_multi_tenant"></a>Multi Tenant</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are cases where your application needs to handle more than just 1 tenant. In this case a helper handler is
provided that simplifies setting up the application.</p>
</div>
<div class="paragraph">
<p>In the case the tenant is identified by a HTTP header, say for example <code>X-Tenant</code>, then creating the handler is as
simple as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().handler(<span class="hljs-type">MultiTenantHandler</span>.create(<span class="hljs-string">&quot;X-Tenant&quot;</span>))</code></pre>
</div>
</div>
<div class="paragraph">
<p>You now should register what handler should be executed for the given tenant:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-type">MultiTenantHandler</span>.create(<span class="hljs-string">&quot;X-Tenant&quot;</span>).addTenantHandler(<span class="hljs-string">&quot;tenant-A&quot;</span>, (ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// do something for tenant A...</span>
}).addTenantHandler(<span class="hljs-string">&quot;tenant-B&quot;</span>, (ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// do something for tenant B...</span>
}).addDefaultHandler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// do something when no tenant matches...</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is useful for security situations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// create an OAuth2 provider, clientID and clientSecret should be requested to github</span>
<span class="hljs-keyword">var</span> gitHubAuthProvider = <span class="hljs-type">GithubAuth</span>.create(vertx, <span class="hljs-string">&quot;CLIENT_ID&quot;</span>, <span class="hljs-string">&quot;CLIENT_SECRET&quot;</span>)
<span class="hljs-comment">// create a oauth2 handler on our running server</span>
<span class="hljs-comment">// the second argument is the full url to the callback as you entered in your provider management console.</span>
<span class="hljs-keyword">var</span> githubOAuth2 = <span class="hljs-type">OAuth2AuthHandler</span>.create(gitHubAuthProvider, <span class="hljs-string">&quot;https://myserver.com/github-callback&quot;</span>)
<span class="hljs-comment">// setup the callback handler for receiving the GitHub callback</span>
githubOAuth2.setupCallback(router.route())

<span class="hljs-comment">// create an OAuth2 provider, clientID and clientSecret should be requested to Google</span>
<span class="hljs-keyword">var</span> googleAuthProvider = <span class="hljs-type">OAuth2Auth</span>.create(vertx, <span class="hljs-type">OAuth2ClientOptions</span>()
  .setClientID(<span class="hljs-string">&quot;CLIENT_ID&quot;</span>)
  .setClientSecret(<span class="hljs-string">&quot;CLIENT_SECRET&quot;</span>)
  .setFlow(<span class="hljs-type">OAuth2FlowType</span>.<span class="hljs-type">AUTH_CODE</span>)
  .setSite(<span class="hljs-string">&quot;https://accounts.google.com&quot;</span>)
  .setTokenPath(<span class="hljs-string">&quot;https://www.googleapis.com/oauth2/v3/token&quot;</span>)
  .setAuthorizationPath(<span class="hljs-string">&quot;/o/oauth2/auth&quot;</span>)
)

<span class="hljs-comment">// create a oauth2 handler on our domain: &quot;http://localhost:8080&quot;</span>
<span class="hljs-keyword">var</span> googleOAuth2 = <span class="hljs-type">OAuth2AuthHandler</span>.create(googleAuthProvider, <span class="hljs-string">&quot;http://localhost:8080&quot;</span>)


<span class="hljs-type">MultiTenantHandler</span>.create(<span class="hljs-string">&quot;X-Tenant&quot;</span>).addTenantHandler(<span class="hljs-string">&quot;tenant-github&quot;</span>, githubOAuth2).addTenantHandler(<span class="hljs-string">&quot;tenant-google&quot;</span>, googleOAuth2).addDefaultHandler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  ctx.fail(<span class="hljs-number">401</span>)
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_templates"><a class="anchor" href="#_templates"></a>Templates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web includes dynamic page generation capabilities by including out of the box support for several popular template
engines. You can also easily add your own.</p>
</div>
<div class="paragraph">
<p>Template engines are described by <code><a href="../../scaladocs/io/vertx/scala/ext/web/templ/TemplateEngine.html">TemplateEngine</a></code>. In order to render a template
<code><a href="../../scaladocs/io/vertx/scala/ext/web/common/template/TemplateEngine.html#render(io.vertx.core.json.JsonObject,%20java.lang.String)">render</a></code> is used.</p>
</div>
<div class="paragraph">
<p>The simplest way to use templates is not to call the template engine directly but to use the
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/TemplateHandler.html">TemplateHandler</a></code>.
This handler calls the template engine for you based on the path in the HTTP request.</p>
</div>
<div class="paragraph">
<p>By default the template handler will look for templates in a directory called <code>templates</code>. This can be configured.</p>
</div>
<div class="paragraph">
<p>The handler will return the results of rendering with a content type of <code>text/html</code> by default. This can also be configured.</p>
</div>
<div class="paragraph">
<p>When you create the template handler you pass in an instance of the template engine you want. Template engines are
not embedded in vertx-web so, you need to configure your project to access them. Configuration is provided for
each template engine.</p>
</div>
<div class="paragraph">
<p>Here are some examples:</p>
</div>
<div class="sect2">
<h3 id="_mvel_template_engine"><a class="anchor" href="#_mvel_template_engine"></a>MVEL template engine</h3>
<div class="paragraph">
<p>To use MVEL, you need to add the following <em>dependency</em> to your project:
<code>${maven.groupId}:vertx-web-templ-mvel:${maven.version}</code>. Create an instance of the MVEL template engine using:
<code>io.vertx.ext.web.templ.MVELTemplateEngine#create()</code></p>
</div>
<div class="paragraph">
<p>When using the MVEL template engine, it will by default look for
templates with the <code>.templ</code> extension if no extension is specified in the file name.</p>
</div>
<div class="paragraph">
<p>The routing context <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html">RoutingContext</a></code> is available
in the MVEL template as the <code>context</code> variable, this means you can render the template based on anything in the context
including the request, response, session or context data.</p>
</div>
<div class="paragraph">
<p>Here are some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The request path is @{context.request().path()}

The variable 'foo' from the session is @{context.session().get('foo')}

The value 'bar' from the context data is @{context.get('bar')}</pre>
</div>
</div>
<div class="paragraph">
<p>Please consult the <a href="http://mvel.codehaus.org/MVEL+2.0+Templating+Guide">MVEL templates documentation</a> for how to write
MVEL templates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_jade_template_engine"><a class="anchor" href="#_jade_template_engine"></a>Jade template engine</h3>
<div class="paragraph">
<p>To use the Jade template engine, you need to add the following <em>dependency</em> to your project:
<code>${maven.groupId}:vertx-web-templ-jade:${maven.version}</code>. Create an instance of the Jade template engine using:
<code>io.vertx.ext.web.templ.JadeTemplateEngine#create()</code>.</p>
</div>
<div class="paragraph">
<p>When using the Jade template engine, it will by default look for
templates with the <code>.jade</code> extension if no extension is specified in the file name.</p>
</div>
<div class="paragraph">
<p>The routing context <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html">RoutingContext</a></code> is available
in the Jade template as the <code>context</code> variable, this means you can render the template based on anything in the context
including the request, response, session or context data.</p>
</div>
<div class="paragraph">
<p>Here are some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>!!! 5
html
 head
   title= context.get('foo') + context.request().path()
 body</pre>
</div>
</div>
<div class="paragraph">
<p>Please consult the <a href="https://github.com/neuland/jade4j">Jade4j documentation</a> for how to write
Jade templates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_handlebars_template_engine"><a class="anchor" href="#_handlebars_template_engine"></a>Handlebars template engine</h3>
<div class="paragraph">
<p>To use Handlebars, you need to add the following <em>dependency</em> to your project:
<code>${maven.groupId}:vertx-web-templ-handlebars:${maven.version}</code>. Create an instance of the Handlebars template engine
using: <code>io.vertx.ext.web.templ.HandlebarsTemplateEngine#create()</code>.</p>
</div>
<div class="paragraph">
<p>When using the Handlebars template engine, it will by default look for
templates with the <code>.hbs</code> extension if no extension is specified in the file name.</p>
</div>
<div class="paragraph">
<p>Handlebars templates are not able to call arbitrary methods in objects so we can&#8217;t just pass the routing context
into the template and let the template introspect it like we can with other template engines.</p>
</div>
<div class="paragraph">
<p>Instead, the context <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#data()">data</a></code> is available in the template.</p>
</div>
<div class="paragraph">
<p>If you want to have access to other data like the request path, request params or session data you should
add it the context data in a handler before the template handler. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> handler = <span class="hljs-type">TemplateHandler</span>.create(engine)

router.get(<span class="hljs-string">&quot;/dynamic&quot;</span>).handler((routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

  routingContext.put(<span class="hljs-string">&quot;request_path&quot;</span>, routingContext.request().path())
  routingContext.put(<span class="hljs-string">&quot;session_data&quot;</span>, routingContext.session().data())

  routingContext.next()
})

router.get(<span class="hljs-string">&quot;/dynamic/&quot;</span>).handler(handler)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please consult the <a href="https://github.com/jknack/handlebars.java">Handlebars Java port documentation</a> for how to write
handlebars templates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_thymeleaf_template_engine"><a class="anchor" href="#_thymeleaf_template_engine"></a>Thymeleaf template engine</h3>
<div class="paragraph">
<p>To use Thymeleaf, you need to add the following <em>dependency</em> to your project:
<code>${maven.groupId}:vertx-web-templ-thymeleaf:${maven.version}</code>. Create an instance of the Thymeleaf template engine
using: <code>io.vertx.ext.web.templ.ThymeleafTemplateEngine#create()</code>.</p>
</div>
<div class="paragraph">
<p>When using the Thymeleaf template engine, it will by default look for
templates with the <code>.html</code> extension if no extension is specified in the file name.</p>
</div>
<div class="paragraph">
<p>The routing context <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html">RoutingContext</a></code> is available
in the Thymeleaf template as the <code>context</code> variable, this means you can render the template based on anything in the context
including the request, response, session or context data.</p>
</div>
<div class="paragraph">
<p>Here are some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[snip]
&lt;p th:text="${context.get('foo')}"&gt;&lt;/p&gt;
&lt;p th:text="${context.get('bar')}"&gt;&lt;/p&gt;
&lt;p th:text="${context.normalisedPath()}"&gt;&lt;/p&gt;
&lt;p th:text="${context.request().params().get('param1')}"&gt;&lt;/p&gt;
&lt;p th:text="${context.request().params().get('param2')}"&gt;&lt;/p&gt;
[snip]</pre>
</div>
</div>
<div class="paragraph">
<p>Please consult the <a href="http://www.thymeleaf.org/">Thymeleaf documentation</a> for how to write
Thymeleaf templates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_apache_freemarker_template_engine"><a class="anchor" href="#_apache_freemarker_template_engine"></a>Apache FreeMarker template engine</h3>
<div class="paragraph">
<p>To use Apache FreeMarker, you need to add the following <em>dependency</em> to your project:
<code>${maven.groupId}:vertx-web-templ-freemarker:${maven.version}</code>. Create an instance of the Apache FreeMarker template engine
using: <code>io.vertx.ext.web.templ.Engine#create()</code>.</p>
</div>
<div class="paragraph">
<p>When using the Apache FreeMarker template engine, it will by default look for
templates with the <code>.ftl</code> extension if no extension is specified in the file name.</p>
</div>
<div class="paragraph">
<p>The routing context <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html">RoutingContext</a></code> is available
in the Apache FreeMarker template as the <code>context</code> variable, this means you can render the template based on anything in the context
including the request, response, session or context data.</p>
</div>
<div class="paragraph">
<p>Here are some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[snip]
&lt;p th:text="${context.foo}"&gt;&lt;/p&gt;
&lt;p th:text="${context.bar}"&gt;&lt;/p&gt;
&lt;p th:text="${context.normalisedPath()}"&gt;&lt;/p&gt;
&lt;p th:text="${context.request().params().param1}"&gt;&lt;/p&gt;
&lt;p th:text="${context.request().params().param2}"&gt;&lt;/p&gt;
[snip]</pre>
</div>
</div>
<div class="paragraph">
<p>Please consult the <a href="http://www.freemarker.org/">Apache FreeMarker documentation</a> for how to write
Apache FreeMarker templates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pebble_template_engine"><a class="anchor" href="#_pebble_template_engine"></a>Pebble template engine</h3>
<div class="paragraph">
<p>To use Pebble, you need to add the following <em>dependency</em> to your project:
<code>io.vertx:vertx-web-templ-pebble:${maven.version}</code>. Create an instance of the Pebble template engine
using: <code>io.vertx.ext.web.templ.PebbleTemplateEngine#create(vertx)</code>.</p>
</div>
<div class="paragraph">
<p>When using the Pebble template engine, it will by default look for
templates with the <code>.peb</code> extension if no extension is specified in the file name.</p>
</div>
<div class="paragraph">
<p>The routing context <code><a href="../../apidocs/io/vertx/ext/web/RoutingContext.html">RoutingContext</a></code> is available
in the Pebble template as the <code>context</code> variable, this means you can render the template based on anything in the context
including the request, response, session or context data.</p>
</div>
<div class="paragraph">
<p>Here are some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[snip]
&lt;p th:text="{{context.foo}}"&gt;&lt;/p&gt;
&lt;p th:text="{{context.bar}}"&gt;&lt;/p&gt;
&lt;p th:text="{{context.normalisedPath()}}"&gt;&lt;/p&gt;
&lt;p th:text="{{context.request().params().param1}}"&gt;&lt;/p&gt;
&lt;p th:text="{{context.request().params().param2}}"&gt;&lt;/p&gt;
[snip]</pre>
</div>
</div>
<div class="paragraph">
<p>Please consult the <a href="http://www.mitchellbosecke.com/pebble/home/">Pebble documentation</a> for how to write
Pebble templates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_rocker_template_engine"><a class="anchor" href="#_rocker_template_engine"></a>Rocker template engine</h3>
<div class="paragraph">
<p>To use Rocker, then add <code>io.vertx:vertx-web-templ-rocker:${maven.version}</code> as a dependency to your project.
You can then create a Rocker template engine instance with <code>io.vertx.ext.web.templ.rocker#create()</code>.</p>
</div>
<div class="paragraph">
<p>The values of the JSON context object passed to the <code>render</code> method are then exposed as template parameters.
Given:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[snip]
final JsonObject context = new JsonObject()
 .put("foo", "badger")
 .put("bar", "fox")
 .put("context", new JsonObject().put("path", "/foo/bar"));

engine.render(context, "somedir/TestRockerTemplate2", render -&gt; {
 // (...)
});
[snip]</pre>
</div>
</div>
<div class="paragraph">
<p>then the template can be as the following <code>somedir/TestRockerTemplate2.rocker.html</code> resource file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@import io.vertx.core.json.JsonObject
@args (JsonObject context, String foo, String bar)
Hello @foo and @bar
Request path is @context.getString("path")</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_disabling_caching"><a class="anchor" href="#_disabling_caching"></a>Disabling caching</h3>
<div class="paragraph">
<p>During development you might want to disable template caching so that the template gets reevaluated on each request.
In order to do this you need to set the system property: <code>io.vertx.ext.web.TemplateEngine.disableCache</code> to <code>true</code>.</p>
</div>
<div class="paragraph">
<p>By default it will be false. So caching is always enabled.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_error_handler"><a class="anchor" href="#_error_handler"></a>Error handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can render your own errors using a template handler or otherwise but Vert.x-Web also includes an out of the boxy
"pretty" error handler that can render error pages for you.</p>
</div>
<div class="paragraph">
<p>The handler is <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/ErrorHandler.html">ErrorHandler</a></code>. To use the error handler just set it as a
failure handler for any paths that you want covered.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_request_logger"><a class="anchor" href="#_request_logger"></a>Request logger</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web includes a handler <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/LoggerHandler.html">LoggerHandler</a></code> that you can use to log HTTP requests.
You should mount this handler before any handler that could fail the <code>RoutingContext</code></p>
</div>
<div class="paragraph">
<p>By default requests are logged to the Vert.x logger which can be configured to use JUL logging, log4j or SLF4J.</p>
</div>
<div class="paragraph">
<p>See <code><a href="../enums.html#LoggerFormat">LoggerFormat</a></code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_serving_favicons"><a class="anchor" href="#_serving_favicons"></a>Serving favicons</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web includes the handler <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/FaviconHandler.html">FaviconHandler</a></code> especially for serving favicons.</p>
</div>
<div class="paragraph">
<p>Favicons can be specified using a path to the filesystem, or by default Vert.x-Web will look for a file on the classpath
with the name <code>favicon.ico</code>. This means you bundle the favicon in the jar of your application.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_timeout_handler"><a class="anchor" href="#_timeout_handler"></a>Timeout handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web includes a timeout handler that you can use to timeout requests if they take too long to process.</p>
</div>
<div class="paragraph">
<p>This is configured using an instance of <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/TimeoutHandler.html">TimeoutHandler</a></code>.</p>
</div>
<div class="paragraph">
<p>If a request times out before the response is written a <code>503</code> response will be returned to the client.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of using a timeout handler which will timeout all requests to paths starting with <code>/foo</code> after 5
seconds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route(<span class="hljs-string">&quot;/foo/&quot;</span>).handler(<span class="hljs-type">TimeoutHandler</span>.create(<span class="hljs-number">5000</span>))</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_response_time_handler"><a class="anchor" href="#_response_time_handler"></a>Response time handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This handler sets the header <code>x-response-time</code> response header containing the time from when the request was received
to when the response headers were written, in ms., e.g.:</p>
</div>
<div class="paragraph">
<p>x-response-time: 1456ms</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_content_type_handler"><a class="anchor" href="#_content_type_handler"></a>Content type handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>ResponseContentTypeHandler</code> can set the <code>Content-Type</code> header automatically.
Suppose we are building a RESTful web application. We need to set the content type in all our handlers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.get(<span class="hljs-string">&quot;/api/books&quot;</span>).produces(<span class="hljs-string">&quot;application/json&quot;</span>).handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  findBooks({
    <span class="hljs-keyword">case</span> <span class="hljs-type">Success</span>(result) =&gt; {
      rc.response().putHeader(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>).end(toJson(result))
    }
    <span class="hljs-keyword">case</span> <span class="hljs-type">Failure</span>(cause) =&gt; {
      println(<span class="hljs-string">s&quot;<span class="hljs-subst">$cause</span>&quot;</span>)
    }
  })
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the API surface becomes pretty large, setting the content type can become cumbersome.
To avoid this situation, add the <code>ResponseContentTypeHandler</code> to the corresponding routes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route(<span class="hljs-string">&quot;/api/*&quot;</span>).handler(<span class="hljs-type">ResponseContentTypeHandler</span>.create())
router.get(<span class="hljs-string">&quot;/api/books&quot;</span>).produces(<span class="hljs-string">&quot;application/json&quot;</span>).handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  findBooks({
    <span class="hljs-keyword">case</span> <span class="hljs-type">Success</span>(result) =&gt; {
      rc.response().end(toJson(result))
    }
    <span class="hljs-keyword">case</span> <span class="hljs-type">Failure</span>(cause) =&gt; {
      println(<span class="hljs-string">s&quot;<span class="hljs-subst">$cause</span>&quot;</span>)
    }
  })
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The handler gets the approriate content type from <code><a href="../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getAcceptableContentType()">getAcceptableContentType</a></code>.
As a consequence, you can easily share the same handler to produce data of different types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route(<span class="hljs-string">&quot;/api/*&quot;</span>).handler(<span class="hljs-type">ResponseContentTypeHandler</span>.create())
router.get(<span class="hljs-string">&quot;/api/books&quot;</span>).produces(<span class="hljs-string">&quot;text/xml&quot;</span>).produces(<span class="hljs-string">&quot;application/json&quot;</span>).handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  findBooks({
    <span class="hljs-keyword">case</span> <span class="hljs-type">Success</span>(result) =&gt; {
      <span class="hljs-keyword">if</span> (rc.getAcceptableContentType() == <span class="hljs-string">&quot;text/xml&quot;</span>) {
        rc.response().end(toXML(result))
      } <span class="hljs-keyword">else</span> {
        rc.response().end(toJson(result))
      }
    }
    <span class="hljs-keyword">case</span> <span class="hljs-type">Failure</span>(cause) =&gt; {
      println(<span class="hljs-string">s&quot;<span class="hljs-subst">$cause</span>&quot;</span>)
    }
  })
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sockjs"><a class="anchor" href="#_sockjs"></a>SockJS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SockJS is a client side JavaScript library and protocol which provides a simple WebSocket-like interface allowing you
to make connections to SockJS servers irrespective of whether the actual browser or network will allow real WebSockets.</p>
</div>
<div class="paragraph">
<p>It does this by supporting various different transports between browser and server, and choosing one at run-time
according to browser and network capabilities.</p>
</div>
<div class="paragraph">
<p>All this is transparent to you - you are simply presented with the WebSocket-like interface which <em>just works</em>.</p>
</div>
<div class="paragraph">
<p>Please see the <a href="https://github.com/sockjs/sockjs-client">SockJS website</a> for more information on SockJS.</p>
</div>
<div class="sect2">
<h3 id="_sockjs_handler"><a class="anchor" href="#_sockjs_handler"></a>SockJS handler</h3>
<div class="paragraph">
<p>Vert.x provides an out of the box handler called <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html">SockJSHandler</a></code> for
using SockJS in your Vert.x-Web applications.</p>
</div>
<div class="paragraph">
<p>You should create one handler per SockJS application using <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html#create()">SockJSHandler.create</a></code>.
You can also specify configuration options when creating the instance. The configuration options are described with
an instance of <code><a href="../dataobjects.html#SockJSHandlerOptions">SockJSHandlerOptions</a></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-keyword">var</span> options = <span class="hljs-type">SockJSHandlerOptions</span>()
  .setHeartbeatInterval(<span class="hljs-number">2000</span>)


<span class="hljs-keyword">var</span> sockJSHandler = <span class="hljs-type">SockJSHandler</span>.create(vertx, options)

router.route(<span class="hljs-string">&quot;/myapp/*&quot;</span>).handler(sockJSHandler)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handling_sockjs_sockets"><a class="anchor" href="#_handling_sockjs_sockets"></a>Handling SockJS sockets</h3>
<div class="paragraph">
<p>On the server-side you set a handler on the SockJS handler, and
this will be called every time a SockJS connection is made from a client:</p>
</div>
<div class="paragraph">
<p>The object passed into the handler is a <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSSocket.html">SockJSSocket</a></code>. This has a familiar
socket-like interface which you can read and write to similarly to a <code><a href="../../scaladocs/io/vertx/scala/core/net/NetSocket.html">NetSocket</a></code> or
a <code><a href="../../scaladocs/io/vertx/scala/core/http/WebSocket.html">WebSocket</a></code>. It also implements <code><a href="../../scaladocs/io/vertx/scala/core/streams/ReadStream.html">ReadStream</a></code> and
<code><a href="../../scaladocs/io/vertx/scala/core/streams/WriteStream.html">WriteStream</a></code> so you can pump it to and from other read and write streams.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of a simple SockJS handler that simply echoes back any back any data that it reads:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-keyword">var</span> options = <span class="hljs-type">SockJSHandlerOptions</span>()
  .setHeartbeatInterval(<span class="hljs-number">2000</span>)


<span class="hljs-keyword">var</span> sockJSHandler = <span class="hljs-type">SockJSHandler</span>.create(vertx, options)

sockJSHandler.socketHandler((sockJSSocket: io.vertx.scala.ext.web.handler.sockjs.<span class="hljs-type">SockJSSocket</span>) =&gt; {

  <span class="hljs-comment">// Just echo the data back</span>
  sockJSSocket.handler(sockJSSocket.write _)
})

router.route(<span class="hljs-string">&quot;/myapp/*&quot;</span>).handler(sockJSHandler)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_client_side"><a class="anchor" href="#_the_client_side"></a>The client side</h3>
<div class="paragraph">
<p>In client side JavaScript you use the SockJS client side library to make connections.</p>
</div>
<div class="paragraph">
<p>You can find that <a href="http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js">here</a>.</p>
</div>
<div class="paragraph">
<p>Full details for using the SockJS JavaScript client are on the <a href="https://github.com/sockjs/sockjs-client">SockJS website</a>,
but in summary you use it something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>var sock = new SockJS('http://mydomain.com/myapp');

sock.onopen = function() {
 console.log('open');
};

sock.onmessage = function(e) {
 console.log('message', e.data);
};

sock.onclose = function() {
 console.log('close');
};

sock.send('test');

sock.close();</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_the_sockjs_handler"><a class="anchor" href="#_configuring_the_sockjs_handler"></a>Configuring the SockJS handler</h3>
<div class="paragraph">
<p>The handler can be configured with various options using <code><a href="../dataobjects.html#SockJSHandlerOptions">SockJSHandlerOptions</a></code>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>insertJSESSIONID</code></dt>
<dd>
<p>Insert a JSESSIONID cookie so load-balancers ensure requests for a specific SockJS session
are always routed to the correct server. Default is <code>true</code>.</p>
</dd>
<dt class="hdlist1"><code>sessionTimeout</code></dt>
<dd>
<p>The server sends a <code>close</code> event when a client receiving connection have not been seen for a while.
This delay is configured by this setting. By default the <code>close</code> event will be emitted when a receiving
connection wasn&#8217;t seen for 5 seconds.</p>
</dd>
<dt class="hdlist1"><code>heartbeatInterval</code></dt>
<dd>
<p>In order to keep proxies and load balancers from closing long running http
requests we need to pretend that the connection is active and send a heartbeat packet once in a while.
This setting controls how often this is done. By default a heartbeat packet is sent every 25 seconds.</p>
</dd>
<dt class="hdlist1"><code>maxBytesStreaming</code></dt>
<dd>
<p>Most streaming transports save responses on the client side and don&#8217;t free memory used
by delivered messages. Such transports need to be garbage-collected once in a while. <code>max_bytes_streaming</code> sets a
minimum number of bytes that can be send over a single http streaming request before it will be closed. After that
client needs to open new request. Setting this value to one effectively disables streaming and will make streaming
transports to behave like polling transports. The default value is 128K.</p>
</dd>
<dt class="hdlist1"><code>libraryURL</code></dt>
<dd>
<p>Transports which don&#8217;t support cross-domain communication natively ('eventsource' to name one)
use an iframe trick. A simple page is served from the SockJS server (using its foreign domain) and is placed in an
invisible iframe. Code run from this iframe doesn&#8217;t need to worry about cross-domain issues, as it&#8217;s being run from
domain local to the SockJS server. This iframe also does need to load SockJS javascript client library, and this option
lets you specify its url (if you&#8217;re unsure, point it to the latest minified SockJS client release, this is the default).
The default value is <code><a href="http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js" class="bare">http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js</a></code></p>
</dd>
<dt class="hdlist1"><code>disabledTransports</code></dt>
<dd>
<p>This is a list of transports that you want to disable. Possible values are
WEBSOCKET, EVENT_SOURCE, HTML_FILE, JSON_P, XHR.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sockjs_event_bus_bridge"><a class="anchor" href="#_sockjs_event_bus_bridge"></a>SockJS event bus bridge</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x-Web comes with a built-in SockJS socket handler called the event bus bridge which effectively extends the server-side
Vert.x event bus into client side JavaScript.</p>
</div>
<div class="paragraph">
<p>This creates a distributed event bus which not only spans multiple Vert.x instances on the server side, but includes
client side JavaScript running in browsers.</p>
</div>
<div class="paragraph">
<p>We can therefore create a huge distributed bus encompassing many browsers and servers. The browsers don&#8217;t have to
be connected to the same server as long as the servers are connected.</p>
</div>
<div class="paragraph">
<p>This is done by providing a simple client side JavaScript library called <code>vertx-eventbus.js</code> which provides an API
very similar to the server-side Vert.x event-bus API, which allows you to send and publish messages to the event bus
and register handlers to receive messages.</p>
</div>
<div class="paragraph">
<p>This JavaScript library uses the JavaScript SockJS client to tunnel the event bus traffic over SockJS connections
terminating at at a <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html">SockJSHandler</a></code> on the server-side.</p>
</div>
<div class="paragraph">
<p>A special SockJS socket handler is then installed on the <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html">SockJSHandler</a></code> which
handles the SockJS data and bridges it to and from the server side event bus.</p>
</div>
<div class="paragraph">
<p>To activate the bridge you simply call
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html#bridge()">bridge</a></code> on the
SockJS handler.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-keyword">var</span> sockJSHandler = <span class="hljs-type">SockJSHandler</span>.create(vertx)
<span class="hljs-keyword">var</span> options = <span class="hljs-type">BridgeOptions</span>()
<span class="hljs-comment">// mount the bridge on the router</span>
router.mountSubRouter(<span class="hljs-string">&quot;/eventbus&quot;</span>, sockJSHandler.bridge(options))</code></pre>
</div>
</div>
<div class="paragraph">
<p>In client side JavaScript you use the 'vertx-eventbus.js` library to create connections to the event bus and to send
and receive messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;vertx-eventbus.js&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">

<span class="hljs-keyword">var</span> eb = <span class="hljs-keyword">new</span> EventBus(<span class="hljs-string">&#x27;http://localhost:8080/eventbus&#x27;</span>);

eb.onopen = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

 <span class="hljs-comment">// set a handler to receive a message</span>
 eb.registerHandler(<span class="hljs-string">&#x27;some-address&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, message</span>) </span>{
   <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;received a message: &#x27;</span> + <span class="hljs-built_in">JSON</span>.stringify(message));
 });

 <span class="hljs-comment">// send a message</span>
 eb.send(<span class="hljs-string">&#x27;some-address&#x27;</span>, {<span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;tim&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">587</span>});

}

</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first thing the example does is to create a instance of the event bus</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript"><span class="hljs-keyword">var</span> eb = <span class="hljs-keyword">new</span> EventBus(<span class="hljs-string">&#x27;http://localhost:8080/eventbus&#x27;</span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameter to the constructor is the URI where to connect to the event bus. Since we create our bridge with
the prefix <code>eventbus</code> we will connect there.</p>
</div>
<div class="paragraph">
<p>You can&#8217;t actually do anything with the connection until it is opened. When it is open the <code>onopen</code> handler will be called.</p>
</div>
<div class="paragraph">
<p>The bridge supports automatic reconnection, with configurable delay and backoff options.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript"><span class="hljs-keyword">var</span> eb = <span class="hljs-keyword">new</span> EventBus(<span class="hljs-string">&#x27;http://localhost:8080/eventbus&#x27;</span>);
eb.enableReconnect(<span class="hljs-literal">true</span>);
eb.onopen = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{}; <span class="hljs-comment">// Set up handlers here, will be called on initial connection and all reconnections</span>
eb.onreconnect = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{}; <span class="hljs-comment">// Optional, will only be called on reconnections</span>

<span class="hljs-comment">// Alternatively, pass in an options object</span>
<span class="hljs-keyword">var</span> options = {
   <span class="hljs-attr">vertxbus_reconnect_attempts_max</span>: <span class="hljs-literal">Infinity</span>, <span class="hljs-comment">// Max reconnect attempts</span>
   <span class="hljs-attr">vertxbus_reconnect_delay_min</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// Initial delay (in ms) before first reconnect attempt</span>
   <span class="hljs-attr">vertxbus_reconnect_delay_max</span>: <span class="hljs-number">5000</span>, <span class="hljs-comment">// Max delay (in ms) between reconnect attempts</span>
   <span class="hljs-attr">vertxbus_reconnect_exponent</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// Exponential backoff factor</span>
   <span class="hljs-attr">vertxbus_randomization_factor</span>: <span class="hljs-number">0.5</span> <span class="hljs-comment">// Randomization factor between 0 and 1</span>
};

<span class="hljs-keyword">var</span> eb2 = <span class="hljs-keyword">new</span> EventBus(<span class="hljs-string">&#x27;http://localhost:8080/eventbus&#x27;</span>, options);
eb2.enableReconnect(<span class="hljs-literal">true</span>);
<span class="hljs-comment">// Set up handlers...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can retrieve the client library using a dependency manager:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven (in your <code>pom.xml</code>):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>${maven.groupId}<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>${maven.artifactId}<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${maven.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>client<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>js<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle (in your <code>build.gradle</code> file):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">compile <span class="hljs-string">&#x27;${maven.groupId}:${maven.artifactId}:${maven.version}:client&#x27;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The library is also available on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.npmjs.com/package/vertx3-eventbus-client">NPM</a></p>
</li>
<li>
<p><a href="https://github.com/vert-x3/vertx-bus-bower">Bower</a></p>
</li>
<li>
<p><a href="https://cdnjs.com/libraries/vertx">cdnjs</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Notice that the API has changed between the 3.0.0 and 3.1.0 version. Please check the changelog. The previous client
is still compatible and can still be used, but the new client offers more feature and is closer to the vert.x
event bus API.</p>
</div>
<div class="sect2">
<h3 id="_securing_the_bridge"><a class="anchor" href="#_securing_the_bridge"></a>Securing the Bridge</h3>
<div class="paragraph">
<p>If you started a bridge like in the above example without securing it, and attempted to send messages through
it you&#8217;d find that the messages mysteriously disappeared. What happened to them?</p>
</div>
<div class="paragraph">
<p>For most applications you probably don&#8217;t want client side JavaScript being able to send just any message to any
handlers on the server side or to all other browsers.</p>
</div>
<div class="paragraph">
<p>For example, you may have a service on the event bus which allows data to be accessed or deleted. We don&#8217;t want
badly behaved or malicious clients being able to delete all the data in your database!</p>
</div>
<div class="paragraph">
<p>Also, we don&#8217;t necessarily want any client to be able to listen in on any event bus address.</p>
</div>
<div class="paragraph">
<p>To deal with this, a SockJS bridge will by default refuse to let through any messages. It&#8217;s up to you to tell the
bridge what messages are ok for it to pass through. (There is an exception for reply messages which are always allowed through).</p>
</div>
<div class="paragraph">
<p>In other words the bridge acts like a kind of firewall which has a default <em>deny-all</em> policy.</p>
</div>
<div class="paragraph">
<p>Configuring the bridge to tell it what messages it should pass through is easy.</p>
</div>
<div class="paragraph">
<p>You can specify which <em>matches</em> you want to allow for inbound and outbound traffic using the
<code><a href="../dataobjects.html#BridgeOptions">BridgeOptions</a></code> that you pass in when calling bridge.</p>
</div>
<div class="paragraph">
<p>Each match is a <code><a href="../dataobjects.html#PermittedOptions">PermittedOptions</a></code> object:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><a href="../../vertx-bridge-common/dataobjects.html#PermittedOptions#setAddress()">address</a></code></dt>
<dd>
<p>This represents the exact address the message is being sent to. If you want to allow messages based on
an exact address you use this field.</p>
</dd>
<dt class="hdlist1"><code><a href="../../vertx-bridge-common/dataobjects.html#PermittedOptions#setAddressRegex()">addressRegex</a></code></dt>
<dd>
<p>This is a regular expression that will be matched against the address. If you want to allow messages
based on a regular expression you use this field. If the <code>address</code> field is specified this field will be ignored.</p>
</dd>
<dt class="hdlist1"><code><a href="../../vertx-bridge-common/dataobjects.html#PermittedOptions#setMatch()">match</a></code></dt>
<dd>
<p>This allows you to allow messages based on their structure. Any fields in the match must exist in the
message with the same values for them to be allowed. This currently only works with JSON messages.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If a message is <em>in-bound</em> (i.e. being sent from client side JavaScript to the server) when it is received Vert.x-Web
will look through any inbound permitted matches. If any match, it will be allowed through.</p>
</div>
<div class="paragraph">
<p>If a message is <em>out-bound</em> (i.e. being sent from the server to client side JavaScript) before it is sent to the client
Vert.x-Web will look through any outbound permitted matches. If any match, it will be allowed through.</p>
</div>
<div class="paragraph">
<p>The actual matching works as follows:</p>
</div>
<div class="paragraph">
<p>If an <code>address</code> field has been specified then the <code>address</code> must match <em>exactly</em> with the address of the message
for it to be considered matched.</p>
</div>
<div class="paragraph">
<p>If an <code>address</code> field has not been specified and an <code>addressRegex</code> field has been specified then the regular expression
in <code>address_re</code> must match with the address of the message for it to be considered matched.</p>
</div>
<div class="paragraph">
<p>If a <code>match</code> field has been specified, then also the structure of the message must match. Structuring matching works
by looking at all the fields and values in the match object and checking they all exist in the actual message body.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-keyword">var</span> sockJSHandler = <span class="hljs-type">SockJSHandler</span>.create(vertx)


<span class="hljs-comment">// Let through any messages sent to &#x27;demo.orderMgr&#x27; from the client</span>
<span class="hljs-keyword">var</span> inboundPermitted1 = <span class="hljs-type">PermittedOptions</span>()
  .setAddress(<span class="hljs-string">&quot;demo.orderMgr&quot;</span>)


<span class="hljs-comment">// Allow calls to the address &#x27;demo.persistor&#x27; from the client as long as the messages</span>
<span class="hljs-comment">// have an action field with value &#x27;find&#x27; and a collection field with value</span>
<span class="hljs-comment">// &#x27;albums&#x27;</span>
<span class="hljs-keyword">var</span> inboundPermitted2 = <span class="hljs-type">PermittedOptions</span>()
  .setAddress(<span class="hljs-string">&quot;demo.persistor&quot;</span>)
  .setMatch(<span class="hljs-keyword">new</span> io.vertx.core.json.<span class="hljs-type">JsonObject</span>().put(<span class="hljs-string">&quot;action&quot;</span>, <span class="hljs-string">&quot;find&quot;</span>).put(<span class="hljs-string">&quot;collection&quot;</span>, <span class="hljs-string">&quot;albums&quot;</span>))


<span class="hljs-comment">// Allow through any message with a field `wibble` with value `foo`.</span>
<span class="hljs-keyword">var</span> inboundPermitted3 = <span class="hljs-type">PermittedOptions</span>()
  .setMatch(<span class="hljs-keyword">new</span> io.vertx.core.json.<span class="hljs-type">JsonObject</span>().put(<span class="hljs-string">&quot;wibble&quot;</span>, <span class="hljs-string">&quot;foo&quot;</span>))


<span class="hljs-comment">// First let&#x27;s define what we&#x27;re going to allow from server -&gt; client</span>

<span class="hljs-comment">// Let through any messages coming from address &#x27;ticker.mystock&#x27;</span>
<span class="hljs-keyword">var</span> outboundPermitted1 = <span class="hljs-type">PermittedOptions</span>()
  .setAddress(<span class="hljs-string">&quot;ticker.mystock&quot;</span>)


<span class="hljs-comment">// Let through any messages from addresses starting with &quot;news.&quot; (e.g. news.europe, news.usa, etc)</span>
<span class="hljs-keyword">var</span> outboundPermitted2 = <span class="hljs-type">PermittedOptions</span>()
  .setAddressRegex(<span class="hljs-string">&quot;news\\..+&quot;</span>)


<span class="hljs-comment">// Let&#x27;s define what we&#x27;re going to allow from client -&gt; server</span>
<span class="hljs-keyword">var</span> options = <span class="hljs-type">BridgeOptions</span>()
  .setInboundPermitteds(<span class="hljs-type">Set</span>(inboundPermitted1, inboundPermitted1, inboundPermitted3))
  .setOutboundPermitteds(<span class="hljs-type">Set</span>(outboundPermitted1, outboundPermitted2))


<span class="hljs-comment">// mount the bridge on the router</span>
router.mountSubRouter(<span class="hljs-string">&quot;/eventbus&quot;</span>, sockJSHandler.bridge(options))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_requiring_authorisation_for_messages"><a class="anchor" href="#_requiring_authorisation_for_messages"></a>Requiring authorisation for messages</h3>
<div class="paragraph">
<p>The event bus bridge can also be configured to use the Vert.x-Web authorisation functionality to require
authorisation for messages, either in-bound or out-bound on the bridge.</p>
</div>
<div class="paragraph">
<p>To do this, you can add extra fields to the match described in the previous section that determine what authority is
required for the match.</p>
</div>
<div class="paragraph">
<p>To declare that a specific authority for the logged-in user is required in order to access allow the messages you use the
<code><a href="../../vertx-bridge-common/dataobjects.html#PermittedOptions#setRequiredAuthority()">requiredAuthority</a></code> field.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// Let through any messages sent to &#x27;demo.orderService&#x27; from the client</span>
<span class="hljs-keyword">var</span> inboundPermitted = <span class="hljs-type">PermittedOptions</span>()
  .setAddress(<span class="hljs-string">&quot;demo.orderService&quot;</span>)


<span class="hljs-comment">// But only if the user is logged in and has the authority &quot;place_orders&quot;</span>
inboundPermitted.setRequiredAuthority(<span class="hljs-string">&quot;place_orders&quot;</span>)

<span class="hljs-keyword">var</span> options = <span class="hljs-type">BridgeOptions</span>()
  .setInboundPermitteds(<span class="hljs-type">Set</span>(inboundPermitted))</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the user to be authorised they must be first logged in and secondly have the required authority.</p>
</div>
<div class="paragraph">
<p>To handle the login and actually auth you can configure the normal Vert.x auth handlers. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-comment">// Let through any messages sent to &#x27;demo.orderService&#x27; from the client</span>
<span class="hljs-keyword">var</span> inboundPermitted = <span class="hljs-type">PermittedOptions</span>()
  .setAddress(<span class="hljs-string">&quot;demo.orderService&quot;</span>)


<span class="hljs-comment">// But only if the user is logged in and has the authority &quot;place_orders&quot;</span>
inboundPermitted.setRequiredAuthority(<span class="hljs-string">&quot;place_orders&quot;</span>)

<span class="hljs-keyword">var</span> sockJSHandler = <span class="hljs-type">SockJSHandler</span>.create(vertx)

<span class="hljs-comment">// Now set up some basic auth handling:</span>

router.route().handler(<span class="hljs-type">SessionHandler</span>.create(<span class="hljs-type">LocalSessionStore</span>.create(vertx)))

<span class="hljs-keyword">var</span> basicAuthHandler = <span class="hljs-type">BasicAuthHandler</span>.create(authProvider)

router.route(<span class="hljs-string">&quot;/eventbus/*&quot;</span>).handler(basicAuthHandler)

<span class="hljs-comment">// mount the bridge on the router</span>
router.mountSubRouter(<span class="hljs-string">&quot;/eventbus&quot;</span>, sockJSHandler.bridge(<span class="hljs-type">BridgeOptions</span>()
  .setInboundPermitteds(<span class="hljs-type">Set</span>(inboundPermitted))
))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_handling_event_bus_bridge_events"><a class="anchor" href="#_handling_event_bus_bridge_events"></a>Handling event bus bridge events</h3>
<div class="paragraph">
<p>If you want to be notified when an event occurs on the bridge you can provide a handler when calling
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html#bridge(io.vertx.ext.web.handler.sockjs.BridgeOptions)">bridge</a></code>.</p>
</div>
<div class="paragraph">
<p>Whenever an event occurs on the bridge it will be passed to the handler. The event is described by an instance of
<code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/BridgeEvent.html">BridgeEvent</a></code>.</p>
</div>
<div class="paragraph">
<p>The event can be one of the following types:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">SOCKET_CREATED</dt>
<dd>
<p>This event will occur when a new SockJS socket is created.</p>
</dd>
<dt class="hdlist1">SOCKET_IDLE</dt>
<dd>
<p>This event will occur when SockJS socket is on idle for longer period of time than initially configured.</p>
</dd>
<dt class="hdlist1">SOCKET_PING</dt>
<dd>
<p>This event will occur when the last ping timestamp is updated for the SockJS socket.</p>
</dd>
<dt class="hdlist1">SOCKET_CLOSED</dt>
<dd>
<p>This event will occur when a SockJS socket is closed.</p>
</dd>
<dt class="hdlist1">SEND</dt>
<dd>
<p>This event will occur when a message is attempted to be sent from the client to the server.</p>
</dd>
<dt class="hdlist1">PUBLISH</dt>
<dd>
<p>This event will occur when a message is attempted to be published from the client to the server.</p>
</dd>
<dt class="hdlist1">RECEIVE</dt>
<dd>
<p>This event will occur when a message is attempted to be delivered from the server to the client.</p>
</dd>
<dt class="hdlist1">REGISTER</dt>
<dd>
<p>This event will occur when a client attempts to register a handler.</p>
</dd>
<dt class="hdlist1">UNREGISTER</dt>
<dd>
<p>This event will occur when a client attempts to unregister a handler.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The event enables you to retrieve the type using <code><a href="../../scaladocs/io/vertx/scala/ext/bridge/BaseBridgeEvent.html#type()">type</a></code> and
inspect the raw message of the event using <code><a href="../../scaladocs/io/vertx/scala/ext/bridge/BaseBridgeEvent.html#getRawMessage()">getRawMessage</a></code>.</p>
</div>
<div class="paragraph">
<p>The raw message is a JSON object with the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
 "type": "send"|"publish"|"receive"|"register"|"unregister",
 "address": the event bus address being sent/published/registered/unregistered
 "body": the body of the message
}</pre>
</div>
</div>
<div class="paragraph">
<p>The event is also an instance of <code><a href="../../scaladocs/io/vertx/scala/core/Future.html">Future</a></code>. When you are finished handling the event you can
complete the future with <code>true</code> to enable further processing.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t want the event to be processed you can complete the future with <code>false</code>. This is a useful feature that
enables you to do your own filtering on messages passing through the bridge, or perhaps apply some fine grained
authorisation or metrics.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s an example where we reject all messages flowing through the bridge if they contain the word "Armadillos".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-comment">// Let through any messages sent to &#x27;demo.orderMgr&#x27; from the client</span>
<span class="hljs-keyword">var</span> inboundPermitted = <span class="hljs-type">PermittedOptions</span>()
  .setAddress(<span class="hljs-string">&quot;demo.someService&quot;</span>)


<span class="hljs-keyword">var</span> sockJSHandler = <span class="hljs-type">SockJSHandler</span>.create(vertx)
<span class="hljs-keyword">var</span> options = <span class="hljs-type">BridgeOptions</span>()
  .setInboundPermitteds(<span class="hljs-type">Set</span>(inboundPermitted))


<span class="hljs-comment">// mount the bridge on the router</span>
router.mountSubRouter(<span class="hljs-string">&quot;/eventbus&quot;</span>, sockJSHandler.bridge(options, (be: io.vertx.scala.ext.web.handler.sockjs.<span class="hljs-type">BridgeEvent</span>) =&gt; {
  <span class="hljs-keyword">if</span> (be.<span class="hljs-keyword">type</span>() == <span class="hljs-type">BridgeEventType</span>.<span class="hljs-type">PUBLISH</span> || be.<span class="hljs-keyword">type</span>() == <span class="hljs-type">BridgeEventType</span>.<span class="hljs-type">RECEIVE</span>) {
    <span class="hljs-keyword">if</span> (be.getRawMessage().getValue(<span class="hljs-string">&quot;body&quot;</span>) == <span class="hljs-string">&quot;armadillos&quot;</span>) {
      <span class="hljs-comment">// Reject it</span>
      be.complete(<span class="hljs-literal">false</span>)
      <span class="hljs-keyword">return</span>
    }
  }
  be.complete(<span class="hljs-literal">true</span>)
}))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here&#8217;s an example how to configure and handle SOCKET_IDLE bridge event type.
Notice <code>setPingTimeout(5000)</code> which says that if ping message doesn&#8217;t arrive from client within 5 seconds
then the SOCKET_IDLE bridge event would be triggered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-comment">// Initialize SockJS handler</span>
<span class="hljs-keyword">var</span> sockJSHandler = <span class="hljs-type">SockJSHandler</span>.create(vertx)
<span class="hljs-keyword">var</span> options = <span class="hljs-type">BridgeOptions</span>()
  .setInboundPermitteds(<span class="hljs-type">Set</span>(inboundPermitted))
  .setPingTimeout(<span class="hljs-number">5000</span>)


<span class="hljs-comment">// mount the bridge on the router</span>
router.mountSubRouter(<span class="hljs-string">&quot;/eventbus&quot;</span>, sockJSHandler.bridge(options, (be: io.vertx.scala.ext.web.handler.sockjs.<span class="hljs-type">BridgeEvent</span>) =&gt; {
  <span class="hljs-keyword">if</span> (be.<span class="hljs-keyword">type</span>() == <span class="hljs-type">BridgeEventType</span>.<span class="hljs-type">SOCKET_IDLE</span>) {
    <span class="hljs-comment">// Do some custom handling...</span>
  }

  be.complete(<span class="hljs-literal">true</span>)
}))</code></pre>
</div>
</div>
<div class="paragraph">
<p>In client side JavaScript you use the 'vertx-eventbus.js` library to create connections to the event bus and to send and receive messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;vertx-eventbus.js&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">

<span class="hljs-keyword">var</span> eb = <span class="hljs-keyword">new</span> EventBus(<span class="hljs-string">&#x27;http://localhost:8080/eventbus&#x27;</span>, {<span class="hljs-string">&quot;vertxbus_ping_interval&quot;</span>: <span class="hljs-number">300000</span>}); <span class="hljs-comment">// sends ping every 5 minutes.</span>

eb.onopen = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

<span class="hljs-comment">// set a handler to receive a message</span>
eb.registerHandler(<span class="hljs-string">&#x27;some-address&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error, message</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;received a message: &#x27;</span> + <span class="hljs-built_in">JSON</span>.stringify(message));
});

<span class="hljs-comment">// send a message</span>
eb.send(<span class="hljs-string">&#x27;some-address&#x27;</span>, {<span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;tim&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">587</span>});
}

</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first thing the example does is to create a instance of the event bus</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript"><span class="hljs-keyword">var</span> eb = <span class="hljs-keyword">new</span> EventBus(<span class="hljs-string">&#x27;http://localhost:8080/eventbus&#x27;</span>, {<span class="hljs-string">&quot;vertxbus_ping_interval&quot;</span>: <span class="hljs-number">300000</span>});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The 2nd parameter to the constructor tells the sockjs library to send ping message every 5 minutes. since the server
was configured to expect ping every 5 seconds &#8594; <code>SOCKET_IDLE</code> would be triggered on the server.</p>
</div>
<div class="paragraph">
<p>You can also amend the raw message, e.g. change the body. For messages that are flowing in from the client you can
also add headers to the message, here&#8217;s an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-keyword">var</span> router = <span class="hljs-type">Router</span>.router(vertx)

<span class="hljs-comment">// Let through any messages sent to &#x27;demo.orderService&#x27; from the client</span>
<span class="hljs-keyword">var</span> inboundPermitted = <span class="hljs-type">PermittedOptions</span>()
  .setAddress(<span class="hljs-string">&quot;demo.orderService&quot;</span>)


<span class="hljs-keyword">var</span> sockJSHandler = <span class="hljs-type">SockJSHandler</span>.create(vertx)
<span class="hljs-keyword">var</span> options = <span class="hljs-type">BridgeOptions</span>()
  .setInboundPermitteds(<span class="hljs-type">Set</span>(inboundPermitted))


<span class="hljs-comment">// mount the bridge on the router</span>
router.mountSubRouter(<span class="hljs-string">&quot;/eventbus&quot;</span>, sockJSHandler.bridge(options, (be: io.vertx.scala.ext.web.handler.sockjs.<span class="hljs-type">BridgeEvent</span>) =&gt; {
  <span class="hljs-keyword">if</span> (be.<span class="hljs-keyword">type</span>() == <span class="hljs-type">BridgeEventType</span>.<span class="hljs-type">PUBLISH</span> || be.<span class="hljs-keyword">type</span>() == <span class="hljs-type">BridgeEventType</span>.<span class="hljs-type">SEND</span>) {
    <span class="hljs-comment">// Add some headers</span>
    <span class="hljs-keyword">var</span> headers = <span class="hljs-keyword">new</span> io.vertx.core.json.<span class="hljs-type">JsonObject</span>().put(<span class="hljs-string">&quot;header1&quot;</span>, <span class="hljs-string">&quot;val&quot;</span>).put(<span class="hljs-string">&quot;header2&quot;</span>, <span class="hljs-string">&quot;val2&quot;</span>)
    <span class="hljs-keyword">var</span> rawMessage = be.getRawMessage()
    rawMessage.put(<span class="hljs-string">&quot;headers&quot;</span>, headers)
    be.setRawMessage(rawMessage)
  }
  be.complete(<span class="hljs-literal">true</span>)
}))</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_csrf_cross_site_request_forgery"><a class="anchor" href="#_csrf_cross_site_request_forgery"></a>CSRF Cross Site Request Forgery</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CSRF or sometimes also known as XSRF is a technique by which an unauthorized site can gain your user&#8217;s private data.
Vert.x-Web includes a handler <code><a href="../../scaladocs/io/vertx/scala/ext/web/handler/CSRFHandler.html">CSRFHandler</a></code> that you can use to prevent cross site
request forgery requests.</p>
</div>
<div class="paragraph">
<p>On each get request under this handler a cookie is added to the response with a unique token. Clients are then
expected to return this token back in a header. Since cookies are sent it is required that the cookie handler is also
present on the router.</p>
</div>
<div class="paragraph">
<p>When developing non single page applications that rely on the User-Agent to perform the <code>POST</code> action, Headers cannot
be specified on HTML Forms. In order to solve this problem the header value will also be checked if and only if no
header was present in the Form attributes under the same name as the header, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">---
<span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/submit&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;X-XSRF-TOKEN&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;abracadabra&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
---</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is the responsibility of the user to fill in the right value for the form field. Users who prefer to use an HTML
only solution can fill this value by fetching the the token value from the routing context under the key <code>X-XSRF-TOKEN</code>
or the header name they have chosen during the instantiation of the <code>CSRFHandler</code> object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().handler(<span class="hljs-type">CSRFHandler</span>.create(<span class="hljs-string">&quot;abracadabra&quot;</span>))
router.route().handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {

})</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_using_ajax"><a class="anchor" href="#_using_ajax"></a>Using AJAX</h3>
<div class="paragraph">
<p>When accessing protected routes via ajax both the csrf token will need to be passed in the request. Typically this is
done using a request header, as adding a request header can typically be done at a central location easily without
payload modification.</p>
</div>
<div class="paragraph">
<p>The CSRF token is obtained from the server side context under the key <code>X-XSRF-TOKEN</code> (unless you specified a different
name). This token needs to be exposed to the client-side, typically by including it in the initial page content. One
possibility is to store it in an HTML &lt;meta&gt; tag, where value can then be retrieved at the time of the request by
JavaScript.</p>
</div>
<div class="paragraph">
<p>The following can be included in your view (handlebar example below):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;csrf-token&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;${X-XSRF-TOKEN}&quot;</span>&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following is an example of using the Fetch API to post to the /process route with the CSRF token from the &lt;meta&gt;
tag on the page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js"><span class="hljs-comment">// Read the CSRF token from the &lt;meta&gt; tag</span>
<span class="hljs-keyword">var</span> token = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;meta[name=&quot;csrf-token&quot;]&#x27;</span>).getAttribute(<span class="hljs-string">&#x27;content&#x27;</span>)

<span class="hljs-comment">// Make a request using the Fetch API</span>
fetch(<span class="hljs-string">&#x27;/process&#x27;</span>, {
 <span class="hljs-attr">credentials</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>, <span class="hljs-comment">// &lt;-- includes cookies in the request</span>
 <span class="hljs-attr">headers</span>: {
   <span class="hljs-string">&#x27;X-XSRF-TOKEN&#x27;</span>: token <span class="hljs-comment">// &lt;-- is the csrf token as a header</span>
 },
 <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,
 <span class="hljs-attr">body</span>: {
   <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;value&#x27;</span>
 }
})</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_virtualhost_handler"><a class="anchor" href="#_virtualhost_handler"></a>VirtualHost Handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Virtual Host Handler will verify the request hostname and if it matches it will send the request to the
registered handler, otherwise will continue inside the normal handlers chain.</p>
</div>
<div class="paragraph">
<p>Request are checked against the <code>Host</code> header to a match and patterns allow the usage of <code><strong></code> wildcards, as for
example <code></strong>.vertx.io</code> or fully domain names as <code>www.vertx.io</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala">router.route().handler(<span class="hljs-type">VirtualHostHandler</span>.create(<span class="hljs-string">&quot;*.vertx.io&quot;</span>, (routingContext: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// do something if the request is for *.vertx.io</span>
}))</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_oauth2authhandler_handler"><a class="anchor" href="#_oauth2authhandler_handler"></a>OAuth2AuthHandler Handler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>OAuth2AuthHandler</code> allows quick setup of secure routes using the OAuth2 protocol. This handler simplifies the
authCode flow. An example of using it to protect some resource and authenticate with GitHub can be implemented as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// create an OAuth2 provider, clientID and clientSecret should be requested to github</span>
<span class="hljs-keyword">var</span> authProvider = <span class="hljs-type">GithubAuth</span>.create(vertx, <span class="hljs-string">&quot;CLIENT_ID&quot;</span>, <span class="hljs-string">&quot;CLIENT_SECRET&quot;</span>)

<span class="hljs-comment">// create a oauth2 handler on our running server</span>
<span class="hljs-comment">// the second argument is the full url to the callback as you entered in your provider management console.</span>
<span class="hljs-keyword">var</span> oauth2 = <span class="hljs-type">OAuth2AuthHandler</span>.create(authProvider, <span class="hljs-string">&quot;https://myserver.com/callback&quot;</span>)

<span class="hljs-comment">// setup the callback handler for receiving the GitHub callback</span>
oauth2.setupCallback(router.route())

<span class="hljs-comment">// protect everything under /protected</span>
router.route(<span class="hljs-string">&quot;/protected/*&quot;</span>).handler(oauth2)
<span class="hljs-comment">// mount some handler under the protected zone</span>
router.route(<span class="hljs-string">&quot;/protected/somepage&quot;</span>).handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  rc.response().end(<span class="hljs-string">&quot;Welcome to the protected resource!&quot;</span>)
})

<span class="hljs-comment">// welcome page</span>
router.get(<span class="hljs-string">&quot;/&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  ctx.response().putHeader(<span class="hljs-string">&quot;content-type&quot;</span>, <span class="hljs-string">&quot;text/html&quot;</span>).end(<span class="hljs-string">&quot;Hello&lt;br&gt;&lt;a href=\&quot;/protected/somepage\&quot;&gt;Protected by Github&lt;/a&gt;&quot;</span>)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The OAuth2AuthHandler will setup a proper callback OAuth2 handler so the user does not need to deal with validation
of the authority server response. It is quite important to know that authority server responses are only valid once,
this means that if a client issues a reload of the callback URL it will be asserted as a invalid request since the
validation will fail.</p>
</div>
<div class="paragraph">
<p>A rule of thumb is once a valid callback is executed issue a client side redirect to a protected resource. This
redirect should also create a session cookie (or other session mechanism) so the user is not required to authenticate
for every request.</p>
</div>
<div class="paragraph">
<p>Due to the nature of OAuth2 spec there are slight changes required in order to use other OAuth2 providers but
vertx-auth provides you with many out of the box implementations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Azure Active Directory <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/AzureADAuth.html">AzureADAuth</a></code></p>
</li>
<li>
<p>Box.com <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/BoxAuth.html">BoxAuth</a></code></p>
</li>
<li>
<p>Dropbox <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/DropboxAuth.html">DropboxAuth</a></code></p>
</li>
<li>
<p>Facebook <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/FacebookAuth.html">FacebookAuth</a></code></p>
</li>
<li>
<p>Foursquare <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/FoursquareAuth.html">FoursquareAuth</a></code></p>
</li>
<li>
<p>Github <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/GithubAuth.html">GithubAuth</a></code></p>
</li>
<li>
<p>Google <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/GoogleAuth.html">GoogleAuth</a></code></p>
</li>
<li>
<p>Instagram <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/InstagramAuth.html">InstagramAuth</a></code></p>
</li>
<li>
<p>Keycloak <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/KeycloakAuth.html">KeycloakAuth</a></code></p>
</li>
<li>
<p>LinkedIn <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/LinkedInAuth.html">LinkedInAuth</a></code></p>
</li>
<li>
<p>Mailchimp <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/MailchimpAuth.html">MailchimpAuth</a></code></p>
</li>
<li>
<p>Salesforce <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/SalesforceAuth.html">SalesforceAuth</a></code></p>
</li>
<li>
<p>Shopify <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/ShopifyAuth.html">ShopifyAuth</a></code></p>
</li>
<li>
<p>Soundcloud <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/SoundcloudAuth.html">SoundcloudAuth</a></code></p>
</li>
<li>
<p>Stripe <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/StripeAuth.html">StripeAuth</a></code></p>
</li>
<li>
<p>Twitter <code><a href="../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/TwitterAuth.html">TwitterAuth</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However if you&#8217;re using an unlisted provider you can still do it using the base API like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// create an OAuth2 provider, clientID and clientSecret should be requested to Google</span>
<span class="hljs-keyword">var</span> authProvider = <span class="hljs-type">OAuth2Auth</span>.create(vertx, <span class="hljs-type">OAuth2FlowType</span>.<span class="hljs-type">AUTH_CODE</span>, <span class="hljs-type">OAuth2ClientOptions</span>()
  .setClientID(<span class="hljs-string">&quot;CLIENT_ID&quot;</span>)
  .setClientSecret(<span class="hljs-string">&quot;CLIENT_SECRET&quot;</span>)
  .setSite(<span class="hljs-string">&quot;https://accounts.google.com&quot;</span>)
  .setTokenPath(<span class="hljs-string">&quot;https://www.googleapis.com/oauth2/v3/token&quot;</span>)
  .setAuthorizationPath(<span class="hljs-string">&quot;/o/oauth2/auth&quot;</span>)
)

<span class="hljs-comment">// create a oauth2 handler on our domain: &quot;http://localhost:8080&quot;</span>
<span class="hljs-keyword">var</span> oauth2 = <span class="hljs-type">OAuth2AuthHandler</span>.create(authProvider, <span class="hljs-string">&quot;http://localhost:8080&quot;</span>)

<span class="hljs-comment">// these are the scopes</span>
oauth2.addAuthority(<span class="hljs-string">&quot;profile&quot;</span>)

<span class="hljs-comment">// setup the callback handler for receiving the Google callback</span>
oauth2.setupCallback(router.get(<span class="hljs-string">&quot;/callback&quot;</span>))

<span class="hljs-comment">// protect everything under /protected</span>
router.route(<span class="hljs-string">&quot;/protected/*&quot;</span>).handler(oauth2)
<span class="hljs-comment">// mount some handler under the protected zone</span>
router.route(<span class="hljs-string">&quot;/protected/somepage&quot;</span>).handler((rc: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  rc.response().end(<span class="hljs-string">&quot;Welcome to the protected resource!&quot;</span>)
})

<span class="hljs-comment">// welcome page</span>
router.get(<span class="hljs-string">&quot;/&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  ctx.response().putHeader(<span class="hljs-string">&quot;content-type&quot;</span>, <span class="hljs-string">&quot;text/html&quot;</span>).end(<span class="hljs-string">&quot;Hello&lt;br&gt;&lt;a href=\&quot;/protected/somepage\&quot;&gt;Protected by Google&lt;/a&gt;&quot;</span>)
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will need to provide all the details of your provider manually but the end result is the same.</p>
</div>
<div class="paragraph">
<p>The handler will pin your application the the configured callback url. The usage is simple as providing the handler
a route instance and all setup will be done for you. In a typical use case your provider will ask you what is the
callback url to your application, your then enter a url like: <code><a href="https://myserver.com/callback" class="bare">https://myserver.com/callback</a></code>. This is the second
argument to the handler now you just need to set it up. To make it easier to the end user all you need to do is call
the setupCallback method.</p>
</div>
<div class="paragraph">
<p>This is how you pin your handler to the server <code><a href="https://myserver.com:8447/callback" class="bare">https://myserver.com:8447/callback</a></code>. Note that the port number is not
mandatory for the default values, 80 for http, 443 for https.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// create a oauth2 handler pinned to myserver.com: &quot;https://myserver.com:8447/callback&quot;</span>
<span class="hljs-keyword">var</span> oauth2 = <span class="hljs-type">OAuth2AuthHandler</span>.create(provider, <span class="hljs-string">&quot;https://myserver.com:8447/callback&quot;</span>)
<span class="hljs-comment">// now allow the handler to setup the callback url for you</span>
oauth2.setupCallback(router.route())</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example the route object is created inline by <code>Router.route()</code> however if you want to have full control of the
order the handler is called (for example you want it to be called as soon as possible in the chain) you can always
create the route object before and pass it as a reference to this method.</p>
</div>
<div class="sect2">
<h3 id="_a_real_world_example"><a class="anchor" href="#_a_real_world_example"></a>A real world example</h3>
<div class="paragraph">
<p>Up to now you have learned how to use the Oauth2 Handler however you will notice that for each request you will need
to authenticate. This is because the handler has no state and there was no state management applied in the examples.</p>
</div>
<div class="paragraph">
<p>Although having no state is recommended for API facing endpoints, for example, using JWT (we will cover those later)
for user facing endpoinst we can keep the authentication result stored in the session. For this to work we would
need an application like the following snippet:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-scala" data-lang="scala"><span class="hljs-comment">// To simplify the development of the web components</span>
<span class="hljs-comment">// we use a Router to route all HTTP requests</span>
<span class="hljs-comment">// to organize our code in a reusable way.</span>

<span class="hljs-comment">// Simple auth service which uses a GitHub to</span>
<span class="hljs-comment">// authenticate the user</span>
<span class="hljs-keyword">var</span> authProvider = <span class="hljs-type">GithubAuth</span>.create(vertx, <span class="hljs-string">&quot;YOUR PROVIDER CLIENTID&quot;</span>, <span class="hljs-string">&quot;YOUR PROVIDER CLIENT SECRET&quot;</span>)
<span class="hljs-comment">// We need a user session handler too to make sure</span>
<span class="hljs-comment">// the user is stored in the session between requests</span>
router.route().handler(<span class="hljs-type">SessionHandler</span>.create(<span class="hljs-type">LocalSessionStore</span>.create(vertx)).setAuthProvider(authProvider))
<span class="hljs-comment">// we now protect the resource under the path &quot;/protected&quot;</span>
router.route(<span class="hljs-string">&quot;/protected&quot;</span>).handler(<span class="hljs-type">OAuth2AuthHandler</span>.create(authProvider).setupCallback(router.route(<span class="hljs-string">&quot;/callback&quot;</span>)).addAuthority(<span class="hljs-string">&quot;user:email&quot;</span>))
<span class="hljs-comment">// Entry point to the application, this will render</span>
<span class="hljs-comment">// a custom template.</span>
router.get(<span class="hljs-string">&quot;/&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  ctx.response().putHeader(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;text/html&quot;</span>).end(<span class="hljs-string">&quot;&lt;html&gt;\n  &lt;body&gt;\n    &lt;p&gt;\n      Well, hello there!\n    &lt;/p&gt;\n    &lt;p&gt;\n      We&#x27;re going to the protected resource, if there is no\n      user in the session we will talk to the GitHub API. Ready?\n      &lt;a href=\&quot;/protected\&quot;&gt;Click here&lt;/a&gt; to begin!&lt;/a&gt;\n    &lt;/p&gt;\n    &lt;p&gt;\n      &lt;b&gt;If that link doesn&#x27;t work&lt;/b&gt;, remember to provide\n      your own &lt;a href=\&quot;https://github.com/settings/applications/new\&quot;&gt;\n      Client ID&lt;/a&gt;!\n    &lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;&quot;</span>)
})
<span class="hljs-comment">// The protected resource</span>
router.get(<span class="hljs-string">&quot;/protected&quot;</span>).handler((ctx: io.vertx.scala.ext.web.<span class="hljs-type">RoutingContext</span>) =&gt; {
  <span class="hljs-comment">// at this moment your user object should contain the info</span>
  <span class="hljs-comment">// from the Oauth2 response, since this is a protected resource</span>
  <span class="hljs-comment">// as specified above in the handler config the user object is never null</span>
  <span class="hljs-keyword">var</span> user = ctx.user()
  <span class="hljs-comment">// just dump it to the client for demo purposes</span>
  ctx.response().end(user.toString())
})</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mixing_oauth2_and_jwt"><a class="anchor" href="#_mixing_oauth2_and_jwt"></a>Mixing OAuth2 and JWT</h3>
<div class="paragraph">
<p>Some providers use JWT tokens as access tokens, this is a feature of <a href="https://tools.ietf.org/html/rfc6750">RFC6750</a>
and can be quite useful when one wants to mix client based authentication and API authorization. For example say that
you have a application that provides some protected HTML documents but you also want it to be available for API&#8217;s to
consume. In this case an API cannot easily perform the redirect handshake required by OAuth2 but can use a Token
provided before hand.</p>
</div>
<div class="paragraph">
<p>This is handled automatically by the handler as long as the provider is configured to support JWTs.</p>
</div>
<div class="paragraph">
<p>In real life this means that your API&#8217;s can access your protected resources using the header <code>Authorization</code> with the
value <code>Bearer BASE64_ACCESS_TOKEN</code>.</p>
</div>
</div>
</div>
</div></div></div></div></div></div><footer class="jsx-aeedcf66895f49d7"><div class="jsx-aeedcf66895f49d7 container"><div class="jsx-aeedcf66895f49d7 footer-nav-section"><div class="jsx-aeedcf66895f49d7 footer-nav-list footer-logo"><a class="jsx-aeedcf66895f49d7" href="/"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 1232.6 315.2&#x27; style=&#x27;enable-background:new 0 0 1232.6 315.2&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23782a91%7d%3c/style%3e%3cpath d=&#x27;M120.9 214.2 190.5 0h52.3l-98.5 273.8H98.2L0 0h52.1l68.8 214.2zm291.2-62.6H299.6v84.2H431v38H252V0h177.7v38.4H299.6V114h112.5v37.6zm83.7-113.2H546c16.5.3 29 4.4 37.3 12.4 8.3 8 12.5 19.4 12.5 34 0 14-4.5 25.1-13.5 33.2-9 8.1-21.6 12.1-37.6 12.1h-27.1v24.2l86.1 119.5h51v-2.4l-77.2-106.7c24.9-5.5 43.3-21.7 52.6-35.9 8.2-12.6 13.3-27.7 13.3-46 0-26.8-8.6-47.4-25.8-61.5C600.5 7.1 576.1 0 544.5 0h-96.3v273.8h47.6&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1052.3 157.7-41.5 62.7 29.7 53.4h85.1z&#x27;/%3e%3ccircle class=&#x27;st0&#x27; cx=&#x27;827.9&#x27; cy=&#x27;274.7&#x27; r=&#x27;40.5&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1037 0-47.6 74.2L949 0h-84l85.3 135.8-67.1 105.7c5.7 9.5 9.1 20.5 9.2 32.4h50.1L1121.3 0H1037z&#x27;/%3e%3cpath d=&#x27;M763.5 273.8c.1-9.9 2.5-19.2 6.6-27.5V38.4h85.4V0H638.2v38.4h84.6v235.4h40.7zm414-266.9h-15.3v42.2h-8.5V6.9h-15.2V0h39v6.9zM1193 0l14.2 37.7L1221.3 0h11v49.1h-8.5V32.9l.8-21.7-14.5 37.9h-6.1l-14.5-37.8.8 21.6v16.2h-8.5V0h11.2z&#x27;/%3e%3c/svg%3e" alt="Vert.x Logo" class="jsx-aeedcf66895f49d7"/></a></div><div class="jsx-aeedcf66895f49d7 footer-nav-list"><h5 class="jsx-aeedcf66895f49d7">Eclipse Vert.x</h5><ul class="jsx-aeedcf66895f49d7 "><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7 navbar-menu-item" href="/docs/">文档</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/download/">下载</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/blog/">博客</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/community/">社区</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/translation/">翻译团队</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://github.com/eclipse-vertx/vert.x" class="jsx-aeedcf66895f49d7">GitHub</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://github.com/vertx-china/vertx-web-site" class="jsx-aeedcf66895f49d7">翻译GitHub</a></li></ul></div><div class="jsx-aeedcf66895f49d7 footer-nav-list"><h5 class="jsx-aeedcf66895f49d7">资源</h5><ul class="jsx-aeedcf66895f49d7 "><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/faq/">答疑</a></li><li class="jsx-aeedcf66895f49d7"><a class="jsx-aeedcf66895f49d7" href="/channels/">联系渠道</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://how-to.vertx.io/" class="jsx-aeedcf66895f49d7">操作指南</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://start.vertx.io/" class="jsx-aeedcf66895f49d7">应用生成器</a></li><li class="jsx-aeedcf66895f49d7"><a href="/.well-known/security.txt" class="jsx-aeedcf66895f49d7">security.txt</a></li></ul></div><div class="jsx-aeedcf66895f49d7 footer-nav-list"><h5 class="jsx-aeedcf66895f49d7">Eclipse</h5><ul class="jsx-aeedcf66895f49d7 "><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/" class="jsx-aeedcf66895f49d7">Eclipse 基金会</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/privacy.php" class="jsx-aeedcf66895f49d7">隐私政策</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/termsofuse.php" class="jsx-aeedcf66895f49d7">使用条款</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/copyright.php" class="jsx-aeedcf66895f49d7">版权代理</a></li><li class="jsx-aeedcf66895f49d7"><a href="https://www.eclipse.org/legal/" class="jsx-aeedcf66895f49d7">法律资源</a></li></ul></div></div><div class="jsx-aeedcf66895f49d7 footer-copyright"><div class="jsx-aeedcf66895f49d7 footer-copyright-remarks">© <!-- -->2022<!-- --> Eclipse Vert.x™<br class="jsx-aeedcf66895f49d7"/>Eclipse Vert.x™ 是开源的，并在<a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7">Eclipse Public License 2.0</a>和<a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7">Apache License 2.0</a>协议下获得了双重许可。<br class="jsx-aeedcf66895f49d7 footer-copyright-break"/>网站由 <a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7">Michel Krämer</a> 设计。</div><div class="jsx-aeedcf66895f49d7 footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer" class="jsx-aeedcf66895f49d7"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 281.3 91.1&#x27; style=&#x27;enable-background:new 0 0 281.3 91.1&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23f79422%7d.st1%7bfill:%233d3c3b%7d%3c/style%3e%3cg id=&#x27;Layer_1_1_&#x27;%3e%3cpath class=&#x27;st0&#x27; d=&#x27;M265.7 84 257 73h-2.7v17.7h3.3v-12l9.3 12h2.1V73h-3.3v11zm-32.4-8.3c4.2 0 5.8 3.3 5.8 6.3s-1.6 6-5.8 6-5.7-3.1-5.8-6 1.7-6.3 5.8-6.3zm0-3c-6.1 0-9.1 4.7-9.1 9.3 0 4.7 2.9 9.1 9.1 9.1s9-4.6 9.1-9.2-3-9.2-9.1-9.2zm-21.2 18V73h-3.3v17.7h3.3zm-23.6 0h3.3V76h5.6v-3h-14.6v3h5.6l.1 14.7zm-18.9-6.5H163l3.3-7.6 3.3 7.6zm2.8 6.5h3.6L168.2 73h-3.6l-8 17.7h3.6l1.5-3.3h9.3l1.4 3.3zm-38-14.6h3.6c3.9 0 5.5 2.8 5.5 5.5.1 2.8-1.5 5.8-5.5 5.8h-3.6V76.1zm3.7-3.1h-6.9v17.7h6.9c6.2 0 8.9-4.5 8.9-9s-2.8-8.7-8.9-8.7zm-22.4 11L107 73h-2.7v17.7h3.3v-12l9.3 12h2.1V73h-3.3v11zM88.2 73v10.2c0 3-1.6 4.9-4.3 4.9s-4.6-1.7-4.6-4.9V73H76v10.1c0 5.3 3.6 7.9 7.9 7.9 4.4 0 7.7-2.7 7.7-7.9V73h-3.4zm-33 2.7c4.2 0 5.8 3.3 5.8 6.3s-1.6 6-5.8 6-5.7-3.1-5.8-6 1.7-6.3 5.8-6.3zm0-3c-6.1 0-9.1 4.7-9.1 9.3s2.9 9.1 9.1 9.1 9-4.6 9.1-9.2-3-9.2-9.1-9.2zm-29.7 18v-6.5h8.9v-3.1h-8.9v-4.8h9.4V73H22.2v17.6h3.3z&#x27;/%3e%3cpath class=&#x27;st1&#x27; d=&#x27;M269.4 54.4h-22.2v-8.9h21.4v-6.9h-21.4v-9.1h22.2v-7.2h-29.6v39.5h29.6v-7.4zm-40-25.6c-3-6.1-9.4-7.8-15.5-7.8-7.3 0-15.3 3.4-15.3 11.5 0 8.9 7.4 11 15.5 12 5.2.6 9.1 2.1 9.1 5.8 0 4.3-4.4 5.9-9.1 5.9s-9.4-1.9-11.1-6.3l-6.2 3.2c2.9 7.2 9.1 9.7 17.2 9.7 8.8 0 16.6-3.8 16.6-12.6 0-9.4-7.7-11.6-15.9-12.6-4.7-.6-8.8-1.5-8.8-5 0-2.9 2.6-5.2 8.2-5.2 4.3 0 8 2.2 9.4 4.4l5.9-3zM176 22.2c-6.2-.1-12.4 0-18.6 0v39.5h7.4V50.1H176c19.4 0 19.4-27.9 0-27.9zm-11.1 7.1H176c9.5 0 9.5 14 0 14h-11.2l.1-14zm-18 32.5V22.2h-7.4v39.5l7.4.1zm-44-39.6v39.5h27.7v-6.9h-20.3V22.2h-7.4zM90.7 51.7c-2.7 2.5-6.2 4-9.9 4-9.8 0-13.5-6.8-13.6-13.4s4.1-13.7 13.6-13.7c3.5-.1 7 1.3 9.5 3.7l5-4.8c-3.8-3.9-9.1-6-14.5-6-14.3 0-21 10.5-20.9 20.8s6.3 20.3 20.9 20.3c5.6.1 11-2 15-5.9l-5.1-5zm-39 2.7H29.5v-8.9h21.4v-6.9H29.5v-9.1h22.2v-7.2H22.2v39.5h29.6l-.1-7.4z&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;M9.8 18.2C18.8 4.1 36.9-.8 52.1 6l-1-.7C35.7-4.6 15.2-.1 5.3 15.3s-5.4 35.9 10 45.8l1.1.6C3.8 50.8.8 32.3 9.8 18.2z&#x27;/%3e%3cpath class=&#x27;st1&#x27; d=&#x27;M272.2 26.1c0-2.5 2.1-4.6 4.6-4.6 2.5 0 4.6 2.1 4.6 4.6 0 2.5-2.1 4.6-4.6 4.6-2.6 0-4.6-2.1-4.6-4.6zm8.6 0c0-2.2-1.8-4.1-4-4.1s-4.1 1.8-4.1 4.1c0 2.2 1.7 4 3.9 4.1h.1c2.3 0 4.1-1.8 4.1-4.1zm-6-2.5h2.3c1.1 0 1.9.5 1.9 1.6 0 .7-.4 1.3-1.1 1.5l1.2 1.7h-1.4l-1-1.5h-.7v1.5h-1.1l-.1-4.8zm2.2 2.3c.5 0 .8-.3.8-.7s-.3-.7-.8-.7h-1v1.3l1 .1z&#x27;/%3e%3c/g%3e%3c/svg%3e" alt="Eclipse foundation Logo" class="jsx-aeedcf66895f49d7"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"3.9.0/vertx-web/scala","title":"Vert.x-Web","fallbackGitHubStars":null,"toc":"\u003cdiv id=\"toc\" class=\"toc\"\u003e\n\u003cdiv id=\"toctitle\"\u003eTable of Contents\u003c/div\u003e\n\u003cul class=\"sectlevel1\"\u003e\n\u003cli\u003e\u003ca href=\"#_using_vert_x_web\"\u003eUsing Vert.x Web\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_development_mode\"\u003eDevelopment mode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_re_cap_on_vert_x_core_http_servers\"\u003eRe-cap on Vert.x core HTTP servers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_basic_vert_x_web_concepts\"\u003eBasic Vert.x-Web concepts\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handling_requests_and_calling_the_next_handler\"\u003eHandling requests and calling the next handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_blocking_handlers\"\u003eUsing blocking handlers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_routing_by_exact_path\"\u003eRouting by exact path\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_routing_by_paths_that_begin_with_something\"\u003eRouting by paths that begin with something\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_capturing_path_parameters\"\u003eCapturing path parameters\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_routing_with_regular_expressions\"\u003eRouting with regular expressions\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_capturing_path_parameters_with_regular_expressions\"\u003eCapturing path parameters with regular expressions\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_named_capture_groups\"\u003eUsing named capture groups\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_routing_by_http_method\"\u003eRouting by HTTP method\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_route_order\"\u003eRoute order\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_routing_based_on_mime_type_of_request\"\u003eRouting based on MIME type of request\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_routing_based_on_mime_types_acceptable_by_the_client\"\u003eRouting based on MIME types acceptable by the client\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_combining_routing_criteria\"\u003eCombining routing criteria\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_enabling_and_disabling_routes\"\u003eEnabling and disabling routes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_context_data\"\u003eContext data\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_reroute\"\u003eReroute\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_sub_routers\"\u003eSub-routers\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_localization\"\u003eLocalization\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_route_match_failures\"\u003eRoute match failures\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_error_handling\"\u003eError handling\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_request_body_handling\"\u003eRequest body handling\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_getting_the_request_body\"\u003eGetting the request body\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_limiting_body_size\"\u003eLimiting body size\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_merging_form_attributes\"\u003eMerging form attributes\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handling_file_uploads\"\u003eHandling file uploads\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handling_cookies\"\u003eHandling cookies\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_manipulating_cookies\"\u003eManipulating cookies\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handling_sessions\"\u003eHandling sessions\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_session_stores\"\u003eSession stores\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_creating_the_session_handler\"\u003eCreating the session handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_the_session\"\u003eUsing the session\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_session_timeout\"\u003eSession timeout\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_authentication_authorisation\"\u003eAuthentication / authorisation\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_creating_an_auth_handler\"\u003eCreating an auth handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handling_auth_in_your_application\"\u003eHandling auth in your application\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_http_basic_authentication\"\u003eHTTP Basic Authentication\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_redirect_auth_handler\"\u003eRedirect auth handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_jwt_authorisation\"\u003eJWT authorisation\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_configuring_required_authorities\"\u003eConfiguring required authorities\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_chaining_multiple_auth_handlers\"\u003eChaining multiple auth handlers\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_serving_static_resources\"\u003eServing static resources\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_configuring_caching\"\u003eConfiguring caching\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_configuring_the_index_page\"\u003eConfiguring the index page\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_changing_the_web_root\"\u003eChanging the web root\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_serving_hidden_files\"\u003eServing hidden files\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_directory_listing\"\u003eDirectory listing\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_disabling_file_caching_on_disk\"\u003eDisabling file caching on disk\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_cors_handling\"\u003eCORS handling\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_multi_tenant\"\u003eMulti Tenant\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_templates\"\u003eTemplates\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_mvel_template_engine\"\u003eMVEL template engine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_jade_template_engine\"\u003eJade template engine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handlebars_template_engine\"\u003eHandlebars template engine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_thymeleaf_template_engine\"\u003eThymeleaf template engine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_apache_freemarker_template_engine\"\u003eApache FreeMarker template engine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_pebble_template_engine\"\u003ePebble template engine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_rocker_template_engine\"\u003eRocker template engine\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_disabling_caching\"\u003eDisabling caching\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_error_handler\"\u003eError handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_request_logger\"\u003eRequest logger\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_serving_favicons\"\u003eServing favicons\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_timeout_handler\"\u003eTimeout handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_response_time_handler\"\u003eResponse time handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_content_type_handler\"\u003eContent type handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_sockjs\"\u003eSockJS\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_sockjs_handler\"\u003eSockJS handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handling_sockjs_sockets\"\u003eHandling SockJS sockets\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_the_client_side\"\u003eThe client side\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_configuring_the_sockjs_handler\"\u003eConfiguring the SockJS handler\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_sockjs_event_bus_bridge\"\u003eSockJS event bus bridge\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_securing_the_bridge\"\u003eSecuring the Bridge\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_requiring_authorisation_for_messages\"\u003eRequiring authorisation for messages\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_handling_event_bus_bridge_events\"\u003eHandling event bus bridge events\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_csrf_cross_site_request_forgery\"\u003eCSRF Cross Site Request Forgery\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_using_ajax\"\u003eUsing AJAX\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_virtualhost_handler\"\u003eVirtualHost Handler\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_oauth2authhandler_handler\"\u003eOAuth2AuthHandler Handler\u003c/a\u003e\n\u003cul class=\"sectlevel2\"\u003e\n\u003cli\u003e\u003ca href=\"#_a_real_world_example\"\u003eA real world example\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_mixing_oauth2_and_jwt\"\u003eMixing OAuth2 and JWT\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e","contents":"\u003ch1\u003eVert.x-Web\u003c/h1\u003e\n\n\u003cdiv id=\"preamble\"\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web is a set of building blocks for building web applications with Vert.x. Think of it as a Swiss Army Knife for building\nmodern, scalable, web apps.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x core provides a fairly low level set of functionality for handling HTTP, and for some applications\nthat will be sufficient.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web builds on Vert.x core to provide a richer set of functionality for building real web applications, more\neasily.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt\u0026#8217;s the successor to \u003ca href=\"http://pmlopes.github.io/yoke/\"\u003eYoke\u003c/a\u003e in Vert.x 2.x, and takes inspiration from projects such\nas \u003ca href=\"http://expressjs.com/\"\u003eExpress\u003c/a\u003e in the Node.js world and \u003ca href=\"http://www.sinatrarb.com/\"\u003eSinatra\u003c/a\u003e in the Ruby world.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web is designed to be powerful, un-opionated and fully embeddable. You just use the parts you want and nothing more.\nVert.x-Web is not a container.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can use Vert.x-Web to create classic server-side web applications, RESTful web applications, 'real-time' (server push)\nweb applications, or any other kind of web application you can think of. Vert.x-Web doesn\u0026#8217;t care. It\u0026#8217;s up to you to chose\nthe type of app you prefer, not Vert.x-Web.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web is a great fit for writingRESTful HTTP micro-services*, but we don\u0026#8217;tforce* you to write apps like that.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSome of the key features of Vert.x-Web include:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eRouting (based on method, path, etc)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRegular expression pattern matching for paths\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eExtraction of parameters from paths\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eContent negotiation\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRequest body handling\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBody size limits\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCookie parsing and handling\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMultipart forms\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMultipart file uploads\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSub routers\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSession support - both local (for sticky sessions) and clustered (for non sticky)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCORS (Cross Origin Resource Sharing) support\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eError page handler\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBasic Authentication\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRedirect based authentication\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAuthorisation handlers\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eJWT based authorization\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eUser/role/permission authorisation\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFavicon handling\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTemplate support for server side rendering, including support for the following template engines out of the box:\u003c/p\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eHandlebars\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eJade,\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMVEL\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThymeleaf\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eApache FreeMarker\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePebble\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRocker\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eResponse time handler\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eStatic file serving, including caching logic and directory listing.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eRequest timeout support\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSockJS support\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eEvent-bus bridge\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eCSRF Cross Site Request Forgery\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eVirtualHost\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMost features in Vert.x-Web are implemented as handlers so you can always write your own. We envisage many more being written\nover time.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe\u0026#8217;ll discuss all these features in this manual.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_vert_x_web\"\u003e\u003ca class=\"anchor\" href=\"#_using_vert_x_web\"\u003e\u003c/a\u003eUsing Vert.x Web\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use vert.x web, add the following dependency to the \u003cem\u003edependencies\u003c/em\u003e section of your build descriptor:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eMaven (in your \u003ccode\u003epom.xml\u003c/code\u003e):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-web\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e${maven.version}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eGradle (in your \u003ccode\u003ebuild.gradle\u003c/code\u003e file):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003edependencies {\n compile \u003cspan class=\"hljs-string\"\u003e\u0026#x27;io.vertx:vertx-web:${maven.version}\u0026#x27;\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_development_mode\"\u003e\u003ca class=\"anchor\" href=\"#_development_mode\"\u003e\u003c/a\u003eDevelopment mode\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Web by default operates in production mode.\nYou can switch the development mode by assigning the \u003ccode\u003edev\u003c/code\u003e value to either:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ethe \u003ccode\u003eVERTXWEB_ENVIRONMENT\u003c/code\u003e environment variable, or\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethe \u003ccode\u003evertxweb.environment\u003c/code\u003e system property\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn development mode:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003etemplate engine caches are disabled\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethe \u003ccode\u003eErrorHandler\u003c/code\u003e does not display exception details\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethe \u003ccode\u003eStaticHandler\u003c/code\u003e does not handle cache headers\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ethe GraphiQL development tool is disabled\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_re_cap_on_vert_x_core_http_servers\"\u003e\u003ca class=\"anchor\" href=\"#_re_cap_on_vert_x_core_http_servers\"\u003e\u003c/a\u003eRe-cap on Vert.x core HTTP servers\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web uses and exposes the API from Vert.x core, so it\u0026#8217;s well worth getting familiar with the basic concepts of writing\nHTTP servers using Vert.x core, if you\u0026#8217;re not already.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe Vert.x core HTTP documentation goes into a lot of detail on this.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s a hello world web server written using Vert.x core. At this point there is no Vert.x-Web involved:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e server = vertx.createHttpServer()\n\nserver.requestHandler((request: io.vertx.scala.core.http.HttpServerRequest) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler gets called for each request that arrives on the server\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = request.response()\n  response.putHeader(\u003cspan class=\"hljs-string\"\u003e\u0026quot;content-type\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;text/plain\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Write to the response and end it\u003c/span\u003e\n  response.end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello World!\u0026quot;\u003c/span\u003e)\n})\n\nserver.listen(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe create an HTTP server instance, and we set a request handler on it. The request handler will be called whenever\na request arrives on the server.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen that happens we are just going to set the content type to \u003ccode\u003etext/plain\u003c/code\u003e, and write \u003ccode\u003eHello World!\u003c/code\u003e and end the\nresponse.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe then tell the server to listen at port \u003ccode\u003e8080\u003c/code\u003e (default host is \u003ccode\u003elocalhost\u003c/code\u003e).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can run this, and point your browser at \u003ccode\u003e\u003ca href=\"http://localhost:8080\" class=\"bare\"\u003ehttp://localhost:8080\u003c/a\u003e\u003c/code\u003e to verify that it works as expected.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_basic_vert_x_web_concepts\"\u003e\u003ca class=\"anchor\" href=\"#_basic_vert_x_web_concepts\"\u003e\u003c/a\u003eBasic Vert.x-Web concepts\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s the 10000 foot view:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Router.html\"\u003eRouter\u003c/a\u003e\u003c/code\u003e is one of the core concepts of Vert.x-Web. It\u0026#8217;s an object which maintains zero or more\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html\"\u003eRoutes\u003c/a\u003e\u003c/code\u003e .\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA router takes an HTTP request and finds the first matching route for that request, and passes the request to that route.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe route can have a \u003cem\u003ehandler\u003c/em\u003e associated with it, which then receives the request. You then \u003cem\u003edo something\u003c/em\u003e with the\nrequest, and then, either end it or pass it to the next matching handler.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s a simple router example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e server = vertx.createHttpServer()\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\nrouter.route().handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for every request\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  response.putHeader(\u003cspan class=\"hljs-string\"\u003e\u0026quot;content-type\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;text/plain\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Write to the response and end it\u003c/span\u003e\n  response.end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello World from Vert.x-Web!\u0026quot;\u003c/span\u003e)\n})\n\nserver.requestHandler(router).listen(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt basically does the same thing as the Vert.x Core HTTP server hello world example from the previous section,\nbut this time using Vert.x-Web.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe create an HTTP server as before, then we create a router. Once we\u0026#8217;ve done that we create a simple route with\nno matching criteria so it will match \u003cem\u003eall\u003c/em\u003e requests that arrive on the server.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe then specify a handler for that route. That handler will be called for all requests that arrive on the server.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe object that gets passed into the handler is a \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html\"\u003eRoutingContext\u003c/a\u003e\u003c/code\u003e - this contains\nthe standard Vert.x \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/http/HttpServerRequest.html\"\u003eHttpServerRequest\u003c/a\u003e\u003c/code\u003e and \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/http/HttpServerResponse.html\"\u003eHttpServerResponse\u003c/a\u003e\u003c/code\u003e\nbut also various other useful stuff that makes working with Vert.x-Web simpler.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor every request that is routed there is a unique routing context instance, and the same instance is passed to\nall handlers for that request.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOnce we\u0026#8217;ve set up the handler, we set the request handler of the HTTP server to pass all incoming requests\nto \u003ccode\u003ehandle\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSo, that\u0026#8217;s the basics. Now we\u0026#8217;ll look at things in more detail:\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_handling_requests_and_calling_the_next_handler\"\u003e\u003ca class=\"anchor\" href=\"#_handling_requests_and_calling_the_next_handler\"\u003e\u003c/a\u003eHandling requests and calling the next handler\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen Vert.x-Web decides to route a request to a matching route, it calls the handler of the route passing in an instance\nof \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html\"\u003eRoutingContext\u003c/a\u003e\u003c/code\u003e. A route can have different handlers, that you can append using\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#handler()\"\u003ehandler\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you don\u0026#8217;t end the response in your handler, you should call \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#next()\"\u003enext\u003c/a\u003e\u003c/code\u003e so another\nmatching route can handle the request (if any).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou don\u0026#8217;t have to call \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#next()\"\u003enext\u003c/a\u003e\u003c/code\u003e before the handler has finished executing.\nYou can do this some time later, if you want:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e)\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  \u003cspan class=\"hljs-comment\"\u003e// enable chunked responses because we will be adding data as\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// we execute over other handlers. This is only required once and\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// only if several handlers do output.\u003c/span\u003e\n  response.setChunked(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n\n  response.write(\u003cspan class=\"hljs-string\"\u003e\u0026quot;route1\\n\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Call the next matching route after a 5 second delay\u003c/span\u003e\n  routingContext.vertx().setTimer(\u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e, (tid: java.lang.\u003cspan class=\"hljs-type\"\u003eLong\u003c/span\u003e) =\u0026gt; {\n    routingContext.next()\n  })\n})\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  response.write(\u003cspan class=\"hljs-string\"\u003e\u0026quot;route2\\n\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Call the next matching route after a 5 second delay\u003c/span\u003e\n  routingContext.vertx().setTimer(\u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e, (tid: java.lang.\u003cspan class=\"hljs-type\"\u003eLong\u003c/span\u003e) =\u0026gt; {\n    routingContext.next()\n  })\n})\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  response.write(\u003cspan class=\"hljs-string\"\u003e\u0026quot;route3\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Now end the response\u003c/span\u003e\n  routingContext.response().end()\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the above example \u003ccode\u003eroute1\u003c/code\u003e is written to the response, then 5 seconds later \u003ccode\u003eroute2\u003c/code\u003e is written to the response,\nthen 5 seconds later \u003ccode\u003eroute3\u003c/code\u003e is written to the response and the response is ended.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNote, all this happens without any thread blocking.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_blocking_handlers\"\u003e\u003ca class=\"anchor\" href=\"#_using_blocking_handlers\"\u003e\u003c/a\u003eUsing blocking handlers\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSometimes, you might have to do something in a handler that might block the event loop for some time, e.g. call\na legacy blocking API or do some intensive calculation.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can\u0026#8217;t do that in a normal handler, so we provide the ability to set blocking handlers on a route.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA blocking handler looks just like a normal handler but it\u0026#8217;s called by Vert.x using a thread from the worker pool\nnot using an event loop.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou set a blocking handler on a route with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#blockingHandler()\"\u003eblockingHandler\u003c/a\u003e\u003c/code\u003e.\nHere\u0026#8217;s an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().blockingHandler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// Do something that might take some time synchronously\u003c/span\u003e\n  service.doSomethingThatBlocks()\n\n  \u003cspan class=\"hljs-comment\"\u003e// Now call the next handler\u003c/span\u003e\n  routingContext.next()\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default, any blocking handlers executed on the same context (e.g. the same verticle instance) are \u003cem\u003eordered\u003c/em\u003e - this\nmeans the next one won\u0026#8217;t be executed until the previous one has completed. If you don\u0026#8217;t care about orderering and\ndon\u0026#8217;t mind your blocking handlers executing in parallel you can set the blocking handler specifying \u003ccode\u003eordered\u003c/code\u003e as\nfalse using \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#blockingHandler(io.vertx.core.Handler)\"\u003eblockingHandler\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNote, if you need to process multipart form data from a blocking handler, you MUST use a non-blocking handler\n     FIRST in order to call \u003ccode\u003esetExpectMultipart(true)\u003c/code\u003e. Here is an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.post(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/endpoint\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  ctx.request().setExpectMultipart(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n  ctx.next()\n}).blockingHandler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// ... Do some blocking operation\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_routing_by_exact_path\"\u003e\u003ca class=\"anchor\" href=\"#_routing_by_exact_path\"\u003e\u003c/a\u003eRouting by exact path\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA route can be set-up to match the path from the request URI. In this case it will match any request which has a path\nthat\u0026#8217;s the same as the specified path.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the following example the handler will be called for a request \u003ccode\u003e/some/path/\u003c/code\u003e. We also ignore trailing slashes\nso it will be called for paths \u003ccode\u003e/some/path\u003c/code\u003e and \u003ccode\u003e/some/path//\u003c/code\u003e too:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route().path(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for the following request paths:\u003c/span\u003e\n\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/path`\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/path/`\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/path//`\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e//\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// but not:\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/path/subdir`\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_routing_by_paths_that_begin_with_something\"\u003e\u003ca class=\"anchor\" href=\"#_routing_by_paths_that_begin_with_something\"\u003e\u003c/a\u003eRouting by paths that begin with something\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOften you want to route all requests that begin with a certain path. You could use a regex to do this, but a simply\nway is to use an asterisk \u003ccode\u003e*\u003c/code\u003e at the end of the path when declaring the route path.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the following example the handler will be called for any request with a URI path that starts with\n\u003ccode\u003e/some/path/\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor example \u003ccode\u003e/some/path/foo.html\u003c/code\u003e and \u003ccode\u003e/some/path/otherdir/blah.css\u003c/code\u003e would both match.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route().path(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/*\u0026quot;\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for any path that starts with\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/path/`, e.g.\u003c/span\u003e\n\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/path`\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/path/`\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/path/subdir`\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/path/subdir/blah.html`\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e//\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// but not:\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// `/some/bath`\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith any path it can also be specified when creating the route:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/*\u0026quot;\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called same as previous example\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_capturing_path_parameters\"\u003e\u003ca class=\"anchor\" href=\"#_capturing_path_parameters\"\u003e\u003c/a\u003eCapturing path parameters\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt\u0026#8217;s possible to match paths using placeholders for parameters which are then available in the request\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/http/HttpServerRequest.html#params()\"\u003eparams\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route(\u003cspan class=\"hljs-type\"\u003eHttpMethod\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003ePOST\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/catalogue/products/:producttype/:productid/\u0026quot;\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e productType = routingContext.request().getParam(\u003cspan class=\"hljs-string\"\u003e\u0026quot;producttype\u0026quot;\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e productID = routingContext.request().getParam(\u003cspan class=\"hljs-string\"\u003e\u0026quot;productid\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Do something with them...\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe placeholders consist of \u003ccode\u003e:\u003c/code\u003e followed by the parameter name. Parameter names consist of any alphabetic character,\nnumeric character or underscore.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the above example, if a POST request is made to path: \u003ccode\u003e/catalogue/products/tools/drill123/\u003c/code\u003e then the route will match\nand \u003ccode\u003eproductType\u003c/code\u003e will receive the value \u003ccode\u003etools\u003c/code\u003e and productID will receive the value \u003ccode\u003edrill123\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_routing_with_regular_expressions\"\u003e\u003ca class=\"anchor\" href=\"#_routing_with_regular_expressions\"\u003e\u003c/a\u003eRouting with regular expressions\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRegular expressions can also be used to match URI paths in routes.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Matches any path ending with \u0026#x27;foo\u0026#x27;\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route().pathRegex(\u003cspan class=\"hljs-string\"\u003e\u0026quot;.*foo\u0026quot;\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for:\u003c/span\u003e\n\n  \u003cspan class=\"hljs-comment\"\u003e// /some/path/foo\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// /foo\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// /foo/bar/wibble/foo\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// /bar/foo\u003c/span\u003e\n\n  \u003cspan class=\"hljs-comment\"\u003e// But not:\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// /bar/wibble\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAlternatively the regex can be specified when creating the route:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.routeWithRegex(\u003cspan class=\"hljs-string\"\u003e\u0026quot;.*foo\u0026quot;\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called same as previous example\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_capturing_path_parameters_with_regular_expressions\"\u003e\u003ca class=\"anchor\" href=\"#_capturing_path_parameters_with_regular_expressions\"\u003e\u003c/a\u003eCapturing path parameters with regular expressions\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also capture path parameters when using regular expressions, here\u0026#8217;s an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.routeWithRegex(\u003cspan class=\"hljs-string\"\u003e\u0026quot;.*foo\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// This regular expression matches paths that start with something like:\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// \u0026quot;/foo/bar\u0026quot; - where the \u0026quot;foo\u0026quot; is captured into param0 and the \u0026quot;bar\u0026quot; is captured into\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// param1\u003c/span\u003e\nroute.pathRegex(\u003cspan class=\"hljs-string\"\u003e\u0026quot;\\\\/([^\\\\/]+)\\\\/([^\\\\/]+)\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e productType = routingContext.request().getParam(\u003cspan class=\"hljs-string\"\u003e\u0026quot;param0\u0026quot;\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e productID = routingContext.request().getParam(\u003cspan class=\"hljs-string\"\u003e\u0026quot;param1\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Do something with them...\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the above example, if a request is made to path: \u003ccode\u003e/tools/drill123/\u003c/code\u003e then the route will match\nand \u003ccode\u003eproductType\u003c/code\u003e will receive the value \u003ccode\u003etools\u003c/code\u003e and productID will receive the value \u003ccode\u003edrill123\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCaptures are denoted in regular expressions with capture groups (i.e. surrounding the capture with round brackets)\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_named_capture_groups\"\u003e\u003ca class=\"anchor\" href=\"#_using_named_capture_groups\"\u003e\u003c/a\u003eUsing named capture groups\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUsing int index param names might be troublesome in some cases.\nIt\u0026#8217;s possible to use named capture groups in the regex path.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// This regular expression matches paths that start with something like: \u0026quot;/foo/bar\u0026quot;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// It uses named regex groups to capture path params\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.routeWithRegex(\u003cspan class=\"hljs-string\"\u003e\u0026quot;\\\\/(?\u0026lt;productType\u0026gt;[^\\\\/]+)\\\\/(?\u0026lt;productId\u0026gt;[^\\\\/]+)\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e productType = routingContext.request().getParam(\u003cspan class=\"hljs-string\"\u003e\u0026quot;productType\u0026quot;\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e productID = routingContext.request().getParam(\u003cspan class=\"hljs-string\"\u003e\u0026quot;productId\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Do something with them...\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the example above, named capture groups are mapped to path parameters of the same name as the group.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAdditionally, you can still access group parameters as you would with normal groups (i.e. \u003ccode\u003eparams0, params1\u0026#8230;\u0026#8203;\u003c/code\u003e)\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_routing_by_http_method\"\u003e\u003ca class=\"anchor\" href=\"#_routing_by_http_method\"\u003e\u003c/a\u003eRouting by HTTP method\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default a route will match all HTTP methods.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want a route to only match for a specific HTTP method you can use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#method()\"\u003emethod\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route().method(\u003cspan class=\"hljs-type\"\u003eHttpMethod\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003ePOST\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for any POST request\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOr you can specify this with a path when creating the route:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route(\u003cspan class=\"hljs-type\"\u003eHttpMethod\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003ePOST\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for any POST request to a URI path starting with /some/path/\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to route for a specific HTTP method you can also use the methods such as \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Router.html#get()\"\u003eget\u003c/a\u003e\u003c/code\u003e,\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Router.html#post()\"\u003epost\u003c/a\u003e\u003c/code\u003e and \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Router.html#put()\"\u003eput\u003c/a\u003e\u003c/code\u003e named after the HTTP\nmethod name. For example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.get().handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// Will be called for any GET request\u003c/span\u003e\n\n})\n\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// Will be called for any GET request to a path\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// starting with /some/path\u003c/span\u003e\n\n})\n\nrouter.getWithRegex(\u003cspan class=\"hljs-string\"\u003e\u0026quot;.*foo\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// Will be called for any GET request to a path\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// ending with `foo`\u003c/span\u003e\n\n})\n\n\u003cspan class=\"hljs-comment\"\u003e// There are also equivalents to the above for PUT, POST, DELETE, HEAD and OPTIONS\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to specify a route will match for more than HTTP method you can call \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#method()\"\u003emethod\u003c/a\u003e\u003c/code\u003e\nmultiple times:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route().method(\u003cspan class=\"hljs-type\"\u003eHttpMethod\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003ePOST\u003c/span\u003e).method(\u003cspan class=\"hljs-type\"\u003eHttpMethod\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003ePUT\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for any POST or PUT request\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_route_order\"\u003e\u003ca class=\"anchor\" href=\"#_route_order\"\u003e\u003c/a\u003eRoute order\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default routes are matched in the order they are added to the router.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen a request arrives the router will step through each route and check if it matches, if it matches then\nthe handler for that route will be called.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf the handler subsequently calls \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#next()\"\u003enext\u003c/a\u003e\u003c/code\u003e the handler for the next\nmatching route (if any) will be called. And so on.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example to illustrate this:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route1 = router.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  \u003cspan class=\"hljs-comment\"\u003e// enable chunked responses because we will be adding data as\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// we execute over other handlers. This is only required once and\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// only if several handlers do output.\u003c/span\u003e\n  response.setChunked(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n\n  response.write(\u003cspan class=\"hljs-string\"\u003e\u0026quot;route1\\n\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Now call the next matching route\u003c/span\u003e\n  routingContext.next()\n})\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route2 = router.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  response.write(\u003cspan class=\"hljs-string\"\u003e\u0026quot;route2\\n\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Now call the next matching route\u003c/span\u003e\n  routingContext.next()\n})\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route3 = router.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  response.write(\u003cspan class=\"hljs-string\"\u003e\u0026quot;route3\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Now end the response\u003c/span\u003e\n  routingContext.response().end()\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the above example the response will contain:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003eroute1\nroute2\nroute3\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAs the routes have been called in that order for any request that starts with \u003ccode\u003e/some/path\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to override the default ordering for routes, you can do so using \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#order()\"\u003eorder\u003c/a\u003e\u003c/code\u003e,\nspecifying an integer value.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRoutes are assigned an order at creation time corresponding to the order in which they were added to the router, with\nthe first route numbered \u003ccode\u003e0\u003c/code\u003e, the second route numbered \u003ccode\u003e1\u003c/code\u003e, and so on.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy specifying an order for the route you can override the default ordering. Order can also be negative, e.g. if you\nwant to ensure a route is evaluated before route number \u003ccode\u003e0\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eLet\u0026#8217;s change the ordering of route2 so it runs before route1:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route1 = router.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e).order(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  response.write(\u003cspan class=\"hljs-string\"\u003e\u0026quot;route1\\n\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Now call the next matching route\u003c/span\u003e\n  routingContext.next()\n})\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route2 = router.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e).order(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  \u003cspan class=\"hljs-comment\"\u003e// enable chunked responses because we will be adding data as\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// we execute over other handlers. This is only required once and\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// only if several handlers do output.\u003c/span\u003e\n  response.setChunked(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n\n  response.write(\u003cspan class=\"hljs-string\"\u003e\u0026quot;route2\\n\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Now call the next matching route\u003c/span\u003e\n  routingContext.next()\n})\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route3 = router.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/\u0026quot;\u003c/span\u003e).order(\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  response.write(\u003cspan class=\"hljs-string\"\u003e\u0026quot;route3\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Now end the response\u003c/span\u003e\n  routingContext.response().end()\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ethen the response will now contain:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003eroute2\nroute1\nroute3\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf two matching routes have the same value of order, then they will be called in the order they were added.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also specify that a route is handled last, with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#last()\"\u003elast\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNote: Route order can be specified only before you configure an handler!\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_routing_based_on_mime_type_of_request\"\u003e\u003ca class=\"anchor\" href=\"#_routing_based_on_mime_type_of_request\"\u003e\u003c/a\u003eRouting based on MIME type of request\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can specify that a route will match against matching request MIME types using \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#consumes()\"\u003econsumes\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn this case, the request will contain a \u003ccode\u003econtent-type\u003c/code\u003e header specifying the MIME type of the request body.\nThis will be matched against the value specified in \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#consumes()\"\u003econsumes\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBasically, \u003ccode\u003econsumes\u003c/code\u003e is describing which MIME types the handler can \u003cem\u003econsume\u003c/em\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMatching can be done on exact MIME type matches:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Exact match\u003c/span\u003e\nrouter.route().consumes(\u003cspan class=\"hljs-string\"\u003e\u0026quot;text/html\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for any request with\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// content-type header set to `text/html`\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMultiple exact matches can also be specified:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Multiple exact matches\u003c/span\u003e\nrouter.route().consumes(\u003cspan class=\"hljs-string\"\u003e\u0026quot;text/html\u0026quot;\u003c/span\u003e).consumes(\u003cspan class=\"hljs-string\"\u003e\u0026quot;text/plain\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for any request with\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// content-type header set to `text/html` or `text/plain`.\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMatching on wildcards for the sub-type is supported:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Sub-type wildcard match\u003c/span\u003e\nrouter.route().consumes(\u003cspan class=\"hljs-string\"\u003e\u0026quot;text/*\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for any request with top level type `text`\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// e.g. content-type header set to `text/html` or `text/plain` will both match\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAnd you can also match on the top level type\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Top level type wildcard match\u003c/span\u003e\nrouter.route().consumes(\u003cspan class=\"hljs-string\"\u003e\u0026quot;*/json\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This handler will be called for any request with sub-type json\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// e.g. content-type header set to `text/json` or `application/json` will both match\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you don\u0026#8217;t specify a \u003ccode\u003e/\u003c/code\u003e in the consumers, it will assume you meant the sub-type.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_routing_based_on_mime_types_acceptable_by_the_client\"\u003e\u003ca class=\"anchor\" href=\"#_routing_based_on_mime_types_acceptable_by_the_client\"\u003e\u003c/a\u003eRouting based on MIME types acceptable by the client\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe HTTP \u003ccode\u003eaccept\u003c/code\u003e header is used to signify which MIME types of the response are acceptable to the client.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAn \u003ccode\u003eaccept\u003c/code\u003e header can have multiple MIME types separated by \u0026#8216;,\u0026#8217;.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMIME types can also have a \u003ccode\u003eq\u003c/code\u003e value appended to them* which signifies a weighting to apply if more than one\nresponse MIME type is available matching the accept header. The q value is a number between 0 and 1.0.\nIf omitted it defaults to 1.0.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor example, the following \u003ccode\u003eaccept\u003c/code\u003e header signifies the client will accept a MIME type of only \u003ccode\u003etext/plain\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAccept: text/plain\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith the following the client will accept \u003ccode\u003etext/plain\u003c/code\u003e or \u003ccode\u003etext/html\u003c/code\u003e with no preference.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAccept: text/plain, text/html\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith the following the client will accept \u003ccode\u003etext/plain\u003c/code\u003e or \u003ccode\u003etext/html\u003c/code\u003e but prefers \u003ccode\u003etext/html\u003c/code\u003e as it has a higher\n\u003ccode\u003eq\u003c/code\u003e value (the default value is q=1.0)\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAccept: text/plain; q=0.9, text/html\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf the server can provide both text/plain and text/html it should provide the text/html in this case.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy using \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#produces()\"\u003eproduces\u003c/a\u003e\u003c/code\u003e you define which MIME type(s) the route produces, e.g. the\nfollowing handler produces a response with MIME type \u003ccode\u003eapplication/json\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-java\" data-lang=\"java\"\u003erouter.route().produces(\u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.RoutingContext) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n  response.putHeader(\u003cspan class=\"hljs-string\"\u003e\u0026quot;content-type\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e)\n  response.write(someJSON).end()\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn this case the route will match with any request with an \u003ccode\u003eaccept\u003c/code\u003e header that matches \u003ccode\u003eapplication/json\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some examples of \u003ccode\u003eaccept\u003c/code\u003e headers that will match:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAccept: application/json\nAccept: application/*\nAccept: application/json, text/html\nAccept: application/json;q=0.7, text/html;q=0.8, text/plain\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also mark your route as producing more than one MIME type. If this is the case, then you use\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getAcceptableContentType()\"\u003egetAcceptableContentType\u003c/a\u003e\u003c/code\u003e to find out the actual MIME type that\nwas accepted.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// This route can produce two different MIME types\u003c/span\u003e\nrouter.route().produces(\u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e).produces(\u003cspan class=\"hljs-string\"\u003e\u0026quot;text/html\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = routingContext.response()\n\n  \u003cspan class=\"hljs-comment\"\u003e// Get the actual MIME type acceptable\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e acceptableContentType = routingContext.getAcceptableContentType()\n\n  response.putHeader(\u003cspan class=\"hljs-string\"\u003e\u0026quot;content-type\u0026quot;\u003c/span\u003e, acceptableContentType)\n  response.write(whatever).end()\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the above example, if you sent a request with the following \u003ccode\u003eaccept\u003c/code\u003e header:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAccept: application/json; q=0.7, text/html\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThen the route would match and \u003ccode\u003eacceptableContentType\u003c/code\u003e would contain \u003ccode\u003etext/html\u003c/code\u003e as both are\nacceptable but that has a higher \u003ccode\u003eq\u003c/code\u003e value.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_combining_routing_criteria\"\u003e\u003ca class=\"anchor\" href=\"#_combining_routing_criteria\"\u003e\u003c/a\u003eCombining routing criteria\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can combine all the above routing criteria in many different ways, for example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.route(\u003cspan class=\"hljs-type\"\u003eHttpMethod\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003ePUT\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;myapi/orders\u0026quot;\u003c/span\u003e).consumes(\u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e).produces(\u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e)\n\nroute.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This would be match for any PUT method to paths starting with \u0026quot;myapi/orders\u0026quot; with a\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// content-type of \u0026quot;application/json\u0026quot;\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// and an accept header matching \u0026quot;application/json\u0026quot;\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_enabling_and_disabling_routes\"\u003e\u003ca class=\"anchor\" href=\"#_enabling_and_disabling_routes\"\u003e\u003c/a\u003eEnabling and disabling routes\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can disable a route with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#disable()\"\u003edisable\u003c/a\u003e\u003c/code\u003e. A disabled route will be ignored when matching.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can re-enable a disabled route with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Route.html#enable()\"\u003eenable\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_context_data\"\u003e\u003ca class=\"anchor\" href=\"#_context_data\"\u003e\u003c/a\u003eContext data\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can use the context data in the \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html\"\u003eRoutingContext\u003c/a\u003e\u003c/code\u003e to maintain any data that you\nwant to share between handlers for the lifetime of the request.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example where one handler sets some data in the context data and a subsequent handler retrieves it:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can use the \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#put(java.lang.String)\"\u003eput\u003c/a\u003e\u003c/code\u003e to put any object, and\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#get()\"\u003eget\u003c/a\u003e\u003c/code\u003e to retrieve any object from the context data.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA request sent to path \u003ccode\u003e/some/path/other\u003c/code\u003e will match both routes.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  routingContext.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;foo\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;bar\u0026quot;\u003c/span\u003e)\n  routingContext.next()\n\n})\n\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/other\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e bar = routingContext.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;foo\u0026quot;\u003c/span\u003e)\n  \u003cspan class=\"hljs-comment\"\u003e// Do something with bar\u003c/span\u003e\n  routingContext.response().end()\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_reroute\"\u003e\u003ca class=\"anchor\" href=\"#_reroute\"\u003e\u003c/a\u003eReroute\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUntil now all routing mechanism allow you to handle your requests in a sequential way, however there might be times\nwhere you will want to go back. Since the context does not expose any information about the previous or next handler,\nmostly because this information is dynamic there is a way to restart the whole routing from the start of the current\nRouter.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  routingContext.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;foo\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;bar\u0026quot;\u003c/span\u003e)\n  routingContext.next()\n\n})\n\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/B\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  routingContext.response().end()\n})\n\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  routingContext.reroute(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/B\u0026quot;\u003c/span\u003e)\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSo from the code you can see that if a request arrives at \u003ccode\u003e/some/path\u003c/code\u003e if first add a value to the context, then\nmoves to the next handler that re routes the request to \u003ccode\u003e/some/path/B\u003c/code\u003e which terminates the request.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can reroute based on a new path or based on a new path and method. Note however that rerouting based on method\nmight introduce security issues since for example a usually safe GET request can become a DELETE.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eReroute is also allowed on the failure handler, however due to the nature of re router when called the current status\ncode and failure reason are reset. In order the rerouted handler should generate the correct status code if needed,\nfor example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/my-pretty-notfound-handler\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  ctx.response().setStatusCode(\u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e).end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;NOT FOUND fancy html here!!!\u0026quot;\u003c/span\u003e)\n})\n\nrouter.get().failureHandler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (ctx.statusCode() == \u003cspan class=\"hljs-number\"\u003e404\u003c/span\u003e) {\n    ctx.reroute(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/my-pretty-notfound-handler\u0026quot;\u003c/span\u003e)\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    ctx.next()\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt should be clear that reroute works on \u003ccode\u003epaths\u003c/code\u003e, so if you need to preserve and or add state across reroutes, one\nshould use the \u003ccode\u003eRoutingContext\u003c/code\u003e object. For example you want to reroute to a new path with a extra parameter:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/final-target\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// continue from here...\u003c/span\u003e\n})\n\n\u003cspan class=\"hljs-comment\"\u003e// THE WRONG WAY! (Will reroute to /final-target excluding the query string)\u003c/span\u003e\nrouter.get().handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  ctx.reroute(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/final-target?variable=value\u0026quot;\u003c/span\u003e)\n})\n\n\u003cspan class=\"hljs-comment\"\u003e// THE CORRECT WAY!\u003c/span\u003e\nrouter.get().handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  ctx.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;variable\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;value\u0026quot;\u003c/span\u003e).reroute(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/final-target\u0026quot;\u003c/span\u003e)\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eEven though the wrong reroute path will warn you that the query string is ignored, the reroute will happen since the\nimplementation will strip any query string or html fragment from the path.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_sub_routers\"\u003e\u003ca class=\"anchor\" href=\"#_sub_routers\"\u003e\u003c/a\u003eSub-routers\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSometimes if you have a lot of handlers it can make sense to split them up into multiple routers. This is also useful\nif you want to reuse a set of handlers in a different application, rooted at a different path root.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo do this you can mount a router at a \u003cem\u003emount point\u003c/em\u003e in another router. The router that is mounted is called a\n\u003cem\u003esub-router\u003c/em\u003e. Sub routers can mount other sub routers so you can have several levels of sub-routers if you like.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eLet\u0026#8217;s look at a simple example of a sub-router mounted with another router.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis sub-router will maintain the set of handlers that corresponds to a simple fictional REST API. We will mount that on another\nrouter. The full implementation of the REST API is not shown.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s the sub-router:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e restAPI = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\nrestAPI.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/products/:productID\u0026quot;\u003c/span\u003e).handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// TODO Handle the lookup of the product....\u003c/span\u003e\n  rc.response().write(productJSON)\n\n})\n\nrestAPI.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/products/:productID\u0026quot;\u003c/span\u003e).handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// TODO Add a new product...\u003c/span\u003e\n  rc.response().end()\n\n})\n\nrestAPI.delete(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/products/:productID\u0026quot;\u003c/span\u003e).handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// TODO delete the product...\u003c/span\u003e\n  rc.response().end()\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf this router was used as a top level router, then GET/PUT/DELETE requests to urls like \u003ccode\u003e/products/product1234\u003c/code\u003e\nwould invoke the  API.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHowever, let\u0026#8217;s say we already have a web-site as described by another router:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e mainRouter = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-comment\"\u003e// Handle static resources\u003c/span\u003e\nmainRouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/static/*\u0026quot;\u003c/span\u003e).handler(myStaticHandler)\n\nmainRouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;.*\\\\.templ\u0026quot;\u003c/span\u003e).handler(myTemplateHandler)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe can now mount the sub router on the main router, against a mount point, in this case \u003ccode\u003e/productsAPI\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003emainRouter.mountSubRouter(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/productsAPI\u0026quot;\u003c/span\u003e, restAPI)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis means the REST API is now accessible via paths like: \u003ccode\u003e/productsAPI/products/product1234\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_localization\"\u003e\u003ca class=\"anchor\" href=\"#_localization\"\u003e\u003c/a\u003eLocalization\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Web parses the \u003ccode\u003eAccept-Language\u003c/code\u003e header and provides some helper methods to identify which is the preferred\nlocale for a client or the sorted list of preferred locales by quality.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/localized\u0026quot;\u003c/span\u003e).handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// although it might seem strange by running a loop with a switch we\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// make sure that the locale order of preference is preserved when\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// replying in the users language.\u003c/span\u003e\n  rc.acceptableLanguages().foreach(language =\u0026gt; {\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n  })\n\n  \u003cspan class=\"hljs-comment\"\u003e// we do not know the user language so lets just inform that back:\u003c/span\u003e\n  rc.response().end(\u003cspan class=\"hljs-string\"\u003es\u0026quot;Sorry we don\u0026#x27;t speak: \u003cspan class=\"hljs-subst\"\u003e${rc.preferredLanguage()}\u003c/span\u003e\u0026quot;\u003c/span\u003e)\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe main method \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#acceptableLocales()\"\u003eacceptableLocales\u003c/a\u003e\u003c/code\u003e will return the ordered list of locales the\nuser understands, if you\u0026#8217;re only interested in the user prefered locale then the helper:\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#preferredLocale()\"\u003epreferredLocale\u003c/a\u003e\u003c/code\u003e will return the 1st element of the list or \u003ccode\u003enull\u003c/code\u003e if no\nlocale was provided by the user.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_route_match_failures\"\u003e\u003ca class=\"anchor\" href=\"#_route_match_failures\"\u003e\u003c/a\u003eRoute match failures\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf no routes match for any particular request, Vert.x-Web will signal an error depending on match failure:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e404 If no route matches the path\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e405 If a route matches the path but don\u0026#8217;t match the HTTP Method\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e406 If a route matches the path and the method but It can\u0026#8217;t provide a response with a content type matching \u003ccode\u003eAccept\u003c/code\u003e header\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e415 If a route matches the path and the method but It can\u0026#8217;t accept the \u003ccode\u003eContent-type\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e400 If a route matches the path and the method but It can\u0026#8217;t accept an empty body\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can manually manage those failures using \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Router.html#errorHandler(int)\"\u003eerrorHandler\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_error_handling\"\u003e\u003ca class=\"anchor\" href=\"#_error_handling\"\u003e\u003c/a\u003eError handling\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAs well as setting handlers to handle requests you can also set handlers to handle failures in routing.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFailure handlers are used with the exact same route matching criteria that you use with normal handlers.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor example you can provide a failure handler that will only handle failures on certain paths, or for certain HTTP methods.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis allows you to set different failure handlers for different parts of your application.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example failure handler that will only be called for failure that occur when routing to GET requests\nto paths that start with \u003ccode\u003e/somepath/\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route = router.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/somepath/*\u0026quot;\u003c/span\u003e)\n\nroute.failureHandler((frc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This will be called for failures that occur\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// when routing requests to paths starting with\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// \u0026#x27;/somepath/\u0026#x27;\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFailure routing will occur if a handler throws an exception, or if a handler calls\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#fail()\"\u003efail\u003c/a\u003e\u003c/code\u003e specifying an HTTP status code to deliberately signal a failure.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf an exception is caught from a handler this will result in a failure with status code \u003ccode\u003e500\u003c/code\u003e being signalled.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen handling the failure, the failure handler is passed the routing context which also allows the failure or failure code\nto be retrieved so the failure handler can use that to generate a failure response.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route1 = router.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/somepath/path1/\u0026quot;\u003c/span\u003e)\n\nroute1.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// Let\u0026#x27;s say this throws a RuntimeException\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ethrow\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e java.lang.\u003cspan class=\"hljs-type\"\u003eRuntimeException\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;something happened!\u0026quot;\u003c/span\u003e)\n\n})\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route2 = router.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/somepath/path2\u0026quot;\u003c/span\u003e)\n\nroute2.handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This one deliberately fails the request passing in the status code\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// E.g. 403 - Forbidden\u003c/span\u003e\n  routingContext.fail(\u003cspan class=\"hljs-number\"\u003e403\u003c/span\u003e)\n\n})\n\n\u003cspan class=\"hljs-comment\"\u003e// Define a failure handler\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// This will get called for any failures in the above handlers\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e route3 = router.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/somepath/*\u0026quot;\u003c/span\u003e)\n\nroute3.failureHandler((failureRoutingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e statusCode = failureRoutingContext.statusCode()\n\n  \u003cspan class=\"hljs-comment\"\u003e// Status code will be 500 for the RuntimeException or 403 for the other failure\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e response = failureRoutingContext.response()\n  response.setStatusCode(statusCode).end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Sorry! Not today\u0026quot;\u003c/span\u003e)\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor the eventuality that an error occurs when running the error handler related usage of not allowed characters in\nstatus message header, then the original status message will be changed to the default message from the error code.\nThis is a tradeoff to keep the semantics of the HTTP protocol working instead of abruptly creash and close the socket\nwithout properly completing the protocol.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_request_body_handling\"\u003e\u003ca class=\"anchor\" href=\"#_request_body_handling\"\u003e\u003c/a\u003eRequest body handling\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/BodyHandler.html\"\u003eBodyHandler\u003c/a\u003e\u003c/code\u003e allows you to retrieve request bodies, limit body sizes and handle\nfile uploads.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou should make sure a body handler is on a matching route for any requests that require this functionality.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe usage of this handler requires that it is installed as soon as possible in the router since it needs\nto install handlers to consume the HTTP request body and this must be done before executing any async call.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// This body handler will be called for all routes\u003c/span\u003e\nrouter.route().handler(\u003cspan class=\"hljs-type\"\u003eBodyHandler\u003c/span\u003e.create())\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf an async call is required before, the \u003ccode\u003eHttpServerRequest\u003c/code\u003e should be paused and then resumed so that the request\nevents are not delivered until the body handler is ready to process them.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e request = routingContext.request()\n\n  \u003cspan class=\"hljs-comment\"\u003e// Pause the request\u003c/span\u003e\n  request.pause()\n\n  someAsyncCall((result: java.lang.\u003cspan class=\"hljs-type\"\u003eVoid\u003c/span\u003e) =\u0026gt; {\n\n    \u003cspan class=\"hljs-comment\"\u003e// Resume the request\u003c/span\u003e\n    request.resume()\n\n    \u003cspan class=\"hljs-comment\"\u003e// And continue processing\u003c/span\u003e\n    routingContext.next()\n  })\n})\n\n\u003cspan class=\"hljs-comment\"\u003e// This body handler will be called for all routes\u003c/span\u003e\nrouter.route().handler(\u003cspan class=\"hljs-type\"\u003eBodyHandler\u003c/span\u003e.create())\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_getting_the_request_body\"\u003e\u003ca class=\"anchor\" href=\"#_getting_the_request_body\"\u003e\u003c/a\u003eGetting the request body\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you know the request body is JSON, then you can use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getBodyAsJson()\"\u003egetBodyAsJson\u003c/a\u003e\u003c/code\u003e,\nif you know it\u0026#8217;s a string you can use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getBodyAsString()\"\u003egetBodyAsString\u003c/a\u003e\u003c/code\u003e, or to\nretrieve it as a buffer use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getBody()\"\u003egetBody\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_limiting_body_size\"\u003e\u003ca class=\"anchor\" href=\"#_limiting_body_size\"\u003e\u003c/a\u003eLimiting body size\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo limit the size of a request body, create the body handler then use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/BodyHandler.html#setBodyLimit()\"\u003esetBodyLimit\u003c/a\u003e\u003c/code\u003e\nto specifying the maximum body size, in bytes. This is useful to avoid running out of memory with very large bodies.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf an attempt to send a body greater than the maximum size is made, an HTTP status code of 413 - \u003ccode\u003eRequest Entity Too Large\u003c/code\u003e,\nwill be sent.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere is no body limit by default.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_merging_form_attributes\"\u003e\u003ca class=\"anchor\" href=\"#_merging_form_attributes\"\u003e\u003c/a\u003eMerging form attributes\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default, the body handler will merge any form attributes into the request parameters. If you don\u0026#8217;t want this behaviour\nyou can use disable it with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/BodyHandler.html#setMergeFormAttributes()\"\u003esetMergeFormAttributes\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_handling_file_uploads\"\u003e\u003ca class=\"anchor\" href=\"#_handling_file_uploads\"\u003e\u003c/a\u003eHandling file uploads\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBody handler is also used to handle multi-part file uploads.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf a body handler is on a matching route for the request, any file uploads will be automatically streamed to the\nuploads directory, which is \u003ccode\u003efile-uploads\u003c/code\u003e by default.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eEach file will be given an automatically generated file name, and the file uploads will be available on the routing\ncontext with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#fileUploads()\"\u003efileUploads\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().handler(\u003cspan class=\"hljs-type\"\u003eBodyHandler\u003c/span\u003e.create())\n\nrouter.post(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/some/path/uploads\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e uploads = routingContext.fileUploads()\n  \u003cspan class=\"hljs-comment\"\u003e// Do something with uploads....\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eEach file upload is described by a \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/FileUpload.html\"\u003eFileUpload\u003c/a\u003e\u003c/code\u003e instance, which allows various properties\nsuch as the name, file-name and size to be accessed.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_handling_cookies\"\u003e\u003ca class=\"anchor\" href=\"#_handling_cookies\"\u003e\u003c/a\u003eHandling cookies\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web has out of the box cookies support.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBefore 3.8.1, cookie required to use the \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/CookieHandler.html\"\u003eCookieHandler\u003c/a\u003e\u003c/code\u003e to active this functionality.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSince 3.8.1, the \u003ccode\u003eCookieHandler\u003c/code\u003e has been deprecated and should not be used anymore.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_manipulating_cookies\"\u003e\u003ca class=\"anchor\" href=\"#_manipulating_cookies\"\u003e\u003c/a\u003eManipulating cookies\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getCookie()\"\u003egetCookie\u003c/a\u003e\u003c/code\u003e to retrieve\na cookie by name, or use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#cookieMap()\"\u003ecookieMap\u003c/a\u003e\u003c/code\u003e to retrieve the entire set.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo remove a cookie, use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#removeCookie()\"\u003eremoveCookie\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo add a cookie use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#addCookie()\"\u003eaddCookie\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe set of cookies will be written back in the response automatically when the response headers are written so the\nbrowser can store them.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCookies are described by instances of \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/http/Cookie.html\"\u003eCookie\u003c/a\u003e\u003c/code\u003e. This allows you to retrieve the name,\nvalue, domain, path and other normal cookie properties.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of querying and adding cookies:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e someCookie = routingContext.getCookie(\u003cspan class=\"hljs-string\"\u003e\u0026quot;mycookie\u0026quot;\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e cookieValue = someCookie.getValue()\n\n\u003cspan class=\"hljs-comment\"\u003e// Do something with cookie...\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// Add a cookie - this will get written back in the response automatically\u003c/span\u003e\nroutingContext.addCookie(\u003cspan class=\"hljs-type\"\u003eCookie\u003c/span\u003e.cookie(\u003cspan class=\"hljs-string\"\u003e\u0026quot;othercookie\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;somevalue\u0026quot;\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_handling_sessions\"\u003e\u003ca class=\"anchor\" href=\"#_handling_sessions\"\u003e\u003c/a\u003eHandling sessions\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web provides out of the box support for sessions.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSessions last between HTTP requests for the length of a browser session and give you a place where you can add\nsession-scope information, such as a shopping basket.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web uses session cookies to identify a session. The session cookie is temporary and will be deleted by your browser\nwhen it\u0026#8217;s closed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe don\u0026#8217;t put the actual data of your session in the session cookie - the cookie simply uses an identifier to look-up\nthe actual session on the server. The identifier is a random UUID generated using a secure random, so it should\nbe effectively unguessable.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCookies are passed across the wire in HTTP requests and responses so it\u0026#8217;s always wise to make sure you are using\nHTTPS when sessions are being used. Vert.x will warn you if you attempt to use sessions over straight HTTP.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo enable sessions in your application you must have a \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/SessionHandler.html\"\u003eSessionHandler\u003c/a\u003e\u003c/code\u003e\non a matching route before your application logic.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe session handler handles the creation of session cookies and the lookup of the session so you don\u0026#8217;t have to do\nthat yourself.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_session_stores\"\u003e\u003ca class=\"anchor\" href=\"#_session_stores\"\u003e\u003c/a\u003eSession stores\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo create a session handler you need to have a session store instance. The session store is the object that\nholds the actual sessions for your application.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe session store is responsible for holding a secure pseudo random number generator in order to guarantee secure session\nids. This PRNG is independent of the store which means that given a session id from store A one cannot derive the\nsession id of store B since they have different seeds and states.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default this PRNG uses a mixed mode, blocking for seeding, non blocking for generating. The PRNG will also reseed\nevery 5 minutes with 64bits of new entropy. However this can all be configured using the system properties:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eio.vertx.ext.auth.prng.algorithm e.g.: SHA1PRNG\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eio.vertx.ext.auth.prng.seed.interval e.g.: 1000 (every second)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eio.vertx.ext.auth.prng.seed.bits e.g.: 128\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eMost users should not need to configure these values unless if you notice that the performance of your application is\nbeing affected by the PRNG algorithm.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web comes with two session store implementations out of the box, and you can also write your own if you prefer.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe implementations are expected to follow the \u003ccode\u003eServiceLoader\u003c/code\u003e conventions and all stores that are available at runtime\nfrom the classpath will be exposed. When more than 1 implementations are available the first one that can be\ninstantiated and configured with success becomes the default. If none is available, then the default depends on the mode\nVert.x was created. If cluster mode is available the the clustered session store is the default otherwise the local\nstorage is the default.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_local_session_store\"\u003e\u003ca class=\"anchor\" href=\"#_local_session_store\"\u003e\u003c/a\u003eLocal session store\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith this store, sessions are stored locally in memory and only available in this instance.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis store is appropriate if you have just a single Vert.x instance of you are using sticky sessions in your application\nand have configured your load balancer to always route HTTP requests to the same Vert.x instance.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you can\u0026#8217;t ensure your requests will all terminate on the same server then don\u0026#8217;t use this store as your\nrequests might end up on a server which doesn\u0026#8217;t know about your session.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eLocal session stores are implemented by using a shared local map, and have a reaper which clears out expired sessions.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe reaper interval can be configured with a json message with the key: \u003ccode\u003ereaperInterval\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some examples of creating a local \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/sstore/SessionStore.html\"\u003eSessionStore\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Create a local session store using defaults\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e store1 = \u003cspan class=\"hljs-type\"\u003eLocalSessionStore\u003c/span\u003e.create(vertx)\n\n\u003cspan class=\"hljs-comment\"\u003e// Create a local session store specifying the local shared map name to use\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// This might be useful if you have more than one application in the same\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// Vert.x instance and want to use different maps for different applications\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e store2 = \u003cspan class=\"hljs-type\"\u003eLocalSessionStore\u003c/span\u003e.create(vertx, \u003cspan class=\"hljs-string\"\u003e\u0026quot;myapp3.sessionmap\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// Create a local session store specifying the local shared map name to use and\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// setting the reaper interval for expired sessions to 10 seconds\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e store3 = \u003cspan class=\"hljs-type\"\u003eLocalSessionStore\u003c/span\u003e.create(vertx, \u003cspan class=\"hljs-string\"\u003e\u0026quot;myapp3.sessionmap\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect3\"\u003e\n\u003ch4 id=\"_clustered_session_store\"\u003e\u003ca class=\"anchor\" href=\"#_clustered_session_store\"\u003e\u003c/a\u003eClustered session store\u003c/h4\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith this store, sessions are stored in a distributed map which is accessible across the Vert.x cluster.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis store is appropriate if you\u0026#8217;re \u003cem\u003enot\u003c/em\u003e using sticky sessions, i.e. your load balancer is distributing different\nrequests from the same browser to different servers.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYour session is accessible from any node in the cluster using this store.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo you use a clustered session store you should make sure your Vert.x instance is clustered.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some examples of creating a clustered \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/sstore/SessionStore.html\"\u003eSessionStore\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// a clustered Vert.x\u003c/span\u003e\n\u003cspan class=\"hljs-type\"\u003eVertx\u003c/span\u003e.clusteredVertx(\u003cspan class=\"hljs-type\"\u003eVertxOptions\u003c/span\u003e()\n  .setClustered(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n, {\n  \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eSuccess\u003c/span\u003e(result) =\u0026gt; println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Success\u0026quot;\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eFailure\u003c/span\u003e(cause) =\u0026gt; println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Failure\u0026quot;\u003c/span\u003e)\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_creating_the_session_handler\"\u003e\u003ca class=\"anchor\" href=\"#_creating_the_session_handler\"\u003e\u003c/a\u003eCreating the session handler\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOnce you\u0026#8217;ve created a session store you can create a session handler, and add it to a route. You should make sure\nyour session handler is routed to before your application handlers.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-comment\"\u003e// Create a clustered session store using defaults\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e store = \u003cspan class=\"hljs-type\"\u003eClusteredSessionStore\u003c/span\u003e.create(vertx)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e sessionHandler = \u003cspan class=\"hljs-type\"\u003eSessionHandler\u003c/span\u003e.create(store)\n\n\u003cspan class=\"hljs-comment\"\u003e// the session handler controls the cookie used for the session\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// this includes configuring, for example, the same site policy\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// like this, for strict same site policy.\u003c/span\u003e\nsessionHandler.setCookieSameSite(\u003cspan class=\"hljs-type\"\u003eCookieSameSite\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003eSTRICT\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// Make sure all requests are routed through the session handler too\u003c/span\u003e\nrouter.route().handler(sessionHandler)\n\n\u003cspan class=\"hljs-comment\"\u003e// Now your application handlers\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/somepath/blah/\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e session = routingContext.session()\n  session.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;foo\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;bar\u0026quot;\u003c/span\u003e)\n  \u003cspan class=\"hljs-comment\"\u003e// etc\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe session handler will ensure that your session is automatically looked up (or created if no session exists)\nfrom the session store and set on the routing context before it gets to your application handlers.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_using_the_session\"\u003e\u003ca class=\"anchor\" href=\"#_using_the_session\"\u003e\u003c/a\u003eUsing the session\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn your handlers you can access the session instance with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#session()\"\u003esession\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou put data into the session with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Session.html#put(java.lang.String)\"\u003eput\u003c/a\u003e\u003c/code\u003e,\nyou get data from the session with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Session.html#get()\"\u003eget\u003c/a\u003e\u003c/code\u003e, and you remove\ndata from the session with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Session.html#remove()\"\u003eremove\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe keys for items in the session are always strings. The values can be any type for a local session store, and for\na clustered session store they can be any basic type, or \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/buffer/Buffer.html\"\u003eBuffer\u003c/a\u003e\u003c/code\u003e, \u003ccode\u003eJsonObject\u003c/code\u003e,\n\u003ccode\u003eJsonArray\u003c/code\u003e or a serializable object, as the values have to serialized across the cluster.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of manipulating session data:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().handler(sessionHandler)\n\n\u003cspan class=\"hljs-comment\"\u003e// Now your application handlers\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/somepath/blah\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e session = routingContext.session()\n\n  \u003cspan class=\"hljs-comment\"\u003e// Put some data from the session\u003c/span\u003e\n  session.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;foo\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;bar\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Retrieve some data from a session\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e age = session.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;age\u0026quot;\u003c/span\u003e)\n\n  \u003cspan class=\"hljs-comment\"\u003e// Remove some data from a session\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e obj = session.remove(\u003cspan class=\"hljs-string\"\u003e\u0026quot;myobj\u0026quot;\u003c/span\u003e)\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSessions are automatically written back to the store after after responses are complete.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can manually destroy a session using \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Session.html#destroy()\"\u003edestroy\u003c/a\u003e\u003c/code\u003e. This will remove the session\nfrom the context and the session store. Note that if there is no session a new one will be automatically created\nfor the next request from the browser that\u0026#8217;s routed through the session handler.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_session_timeout\"\u003e\u003ca class=\"anchor\" href=\"#_session_timeout\"\u003e\u003c/a\u003eSession timeout\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSessions will be automatically timed out if they are not accessed for a time greater than the timeout period. When\na session is timed out, it is removed from the store.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSessions are automatically marked as accessed when a request arrives and the session is looked up and and when the\nresponse is complete and the session is stored back in the store.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/Session.html#setAccessed()\"\u003esetAccessed\u003c/a\u003e\u003c/code\u003e to manually mark a session as accessed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe session timeout can be configured when creating the session handler. Default timeout is 30 minutes.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_authentication_authorisation\"\u003e\u003ca class=\"anchor\" href=\"#_authentication_authorisation\"\u003e\u003c/a\u003eAuthentication / authorisation\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x comes with some out-of-the-box handlers for handling both authentication and authorisation.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_creating_an_auth_handler\"\u003e\u003ca class=\"anchor\" href=\"#_creating_an_auth_handler\"\u003e\u003c/a\u003eCreating an auth handler\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo create an auth handler you need an instance of \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/AuthProvider.html\"\u003eAuthProvider\u003c/a\u003e\u003c/code\u003e. Auth provider is\nused for authentication and authorisation of users. Vert.x provides several auth provider instances out of the box\nin the vertx-auth project. For full information on auth providers and how to use and configure them\nplease consult the auth documentation.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s a simple example of creating a basic auth handler given an auth provider.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().handler(\u003cspan class=\"hljs-type\"\u003eSessionHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-type\"\u003eLocalSessionStore\u003c/span\u003e.create(vertx)))\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e basicAuthHandler = \u003cspan class=\"hljs-type\"\u003eBasicAuthHandler\u003c/span\u003e.create(authProvider)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_handling_auth_in_your_application\"\u003e\u003ca class=\"anchor\" href=\"#_handling_auth_in_your_application\"\u003e\u003c/a\u003eHandling auth in your application\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eLet\u0026#8217;s say you want all requests to paths that start with \u003ccode\u003e/private/\u003c/code\u003e to be subject to auth. To do that you make sure\nyour auth handler is before your application handlers on those paths:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().handler(\u003cspan class=\"hljs-type\"\u003eSessionHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-type\"\u003eLocalSessionStore\u003c/span\u003e.create(vertx)).setAuthProvider(authProvider))\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e basicAuthHandler = \u003cspan class=\"hljs-type\"\u003eBasicAuthHandler\u003c/span\u003e.create(authProvider)\n\n\u003cspan class=\"hljs-comment\"\u003e// All requests to paths starting with \u0026#x27;/private/\u0026#x27; will be protected\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/private/*\u0026quot;\u003c/span\u003e).handler(basicAuthHandler)\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/someotherpath\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This will be public access - no login required\u003c/span\u003e\n\n})\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/private/somepath\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This will require a login\u003c/span\u003e\n\n  \u003cspan class=\"hljs-comment\"\u003e// This will have the value true\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e isAuthenticated = routingContext.user() != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf the auth handler has successfully authenticated and authorised the user it will inject a \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/User.html\"\u003eUser\u003c/a\u003e\u003c/code\u003e\nobject into the \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html\"\u003eRoutingContext\u003c/a\u003e\u003c/code\u003e so it\u0026#8217;s available in your handlers with:\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#user()\"\u003euser\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want your User object to be stored in the session so it\u0026#8217;s available between requests so you don\u0026#8217;t have to\nauthenticate on each request, then you should make sure you have a session handler and a user session handler on matching\nroutes before the auth handler.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOnce you have your user object you can also programmatically use the methods on it to authorise the user.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to cause the user to be logged out you can call \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#clearUser()\"\u003eclearUser\u003c/a\u003e\u003c/code\u003e\non the routing context.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_http_basic_authentication\"\u003e\u003ca class=\"anchor\" href=\"#_http_basic_authentication\"\u003e\u003c/a\u003eHTTP Basic Authentication\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ca href=\"http://en.wikipedia.org/wiki/Basic_access_authentication\"\u003eHTTP Basic Authentication\u003c/a\u003e is a simple means of authentication\nthat can be appropriate for simple applications.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith basic auth, credentials are sent unencrypted across the wire in HTTP headers so it\u0026#8217;s essential that you serve\nyour application using HTTPS not HTTP.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith basic auth, if a user requests a resource that requires authorisation, the basic auth handler will send back\na \u003ccode\u003e401\u003c/code\u003e response with the header \u003ccode\u003eWWW-Authenticate\u003c/code\u003e set. This prompts the browser to show a log-in dialogue and\nprompt the user to enter their username and password.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe request is made to the resource again, this time with the \u003ccode\u003eAuthorization\u003c/code\u003e header set, containing the username\nand password encoded in Base64.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen the basic auth handler receives this information, it calls the configured \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/AuthProvider.html\"\u003eAuthProvider\u003c/a\u003e\u003c/code\u003e\nwith the username and password to authenticate the user. If the authentication is successful the handler attempts\nto authorise the user. If that is successful then the routing of the request is allowed to continue to the application\nhandlers, otherwise a \u003ccode\u003e403\u003c/code\u003e response is returned to signify that access is denied.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe auth handler can be set-up with a set of authorities that are required for access to the resources to\nbe granted.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_redirect_auth_handler\"\u003e\u003ca class=\"anchor\" href=\"#_redirect_auth_handler\"\u003e\u003c/a\u003eRedirect auth handler\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith redirect auth handling the user is redirected to towards a login page in the case they are trying to access\na protected resource and they are not logged in.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe user then fills in the login form and submits it. This is handled by the server which authenticates\nthe user and, if authenticated redirects the user back to the original resource.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use redirect auth you configure an instance of \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/RedirectAuthHandler.html\"\u003eRedirectAuthHandler\u003c/a\u003e\u003c/code\u003e instead of a\nbasic auth handler.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou will also need to setup handlers to serve your actual login page, and a handler to handle the actual login itself.\nTo handle the login we provide a prebuilt handler \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/FormLoginHandler.html\"\u003eFormLoginHandler\u003c/a\u003e\u003c/code\u003e for the purpose.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of a simple app, using a redirect auth handler on the default redirect url \u003ccode\u003e/loginpage\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().handler(\u003cspan class=\"hljs-type\"\u003eSessionHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-type\"\u003eLocalSessionStore\u003c/span\u003e.create(vertx)).setAuthProvider(authProvider))\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e redirectAuthHandler = \u003cspan class=\"hljs-type\"\u003eRedirectAuthHandler\u003c/span\u003e.create(authProvider)\n\n\u003cspan class=\"hljs-comment\"\u003e// All requests to paths starting with \u0026#x27;/private/\u0026#x27; will be protected\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/private/*\u0026quot;\u003c/span\u003e).handler(redirectAuthHandler)\n\n\u003cspan class=\"hljs-comment\"\u003e// Handle the actual login\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// One of your pages must POST form login data\u003c/span\u003e\nrouter.post(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/login\u0026quot;\u003c/span\u003e).handler(\u003cspan class=\"hljs-type\"\u003eFormLoginHandler\u003c/span\u003e.create(authProvider))\n\n\u003cspan class=\"hljs-comment\"\u003e// Set a static server to serve static resources, e.g. the login page\u003c/span\u003e\nrouter.route().handler(\u003cspan class=\"hljs-type\"\u003eStaticHandler\u003c/span\u003e.create())\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/someotherpath\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// This will be public access - no login required\u003c/span\u003e\n})\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/private/somepath\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// This will require a login\u003c/span\u003e\n\n  \u003cspan class=\"hljs-comment\"\u003e// This will have the value true\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e isAuthenticated = routingContext.user() != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_jwt_authorisation\"\u003e\u003ca class=\"anchor\" href=\"#_jwt_authorisation\"\u003e\u003c/a\u003eJWT authorisation\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith JWT authorisation resources can be protected by means of permissions and users without enough rights are denied\naccess. You need to add the \u003ccode\u003eio.vertx:vertx-auth-jwt:${maven.version}\u003c/code\u003e dependency to use \u003ccode\u003eJWTAuthProvider\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use this handler there are 2 steps involved:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eSetup an handler to issue tokens (or rely on a 3rd party)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSetup the handler to filter the requests\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePlease note that these 2 handlers should be only available on HTTPS, not doing so allows sniffing the tokens in\ntransit which leads to session hijacking attacks.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example on how to issue tokens:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e authConfig = \u003cspan class=\"hljs-type\"\u003eJWTAuthOptions\u003c/span\u003e()\n  .setKeyStore(\u003cspan class=\"hljs-type\"\u003eKeyStoreOptions\u003c/span\u003e()\n    .setType(\u003cspan class=\"hljs-string\"\u003e\u0026quot;jceks\u0026quot;\u003c/span\u003e)\n    .setPath(\u003cspan class=\"hljs-string\"\u003e\u0026quot;keystore.jceks\u0026quot;\u003c/span\u003e)\n    .setPassword(\u003cspan class=\"hljs-string\"\u003e\u0026quot;secret\u0026quot;\u003c/span\u003e)\n  )\n\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e authProvider = \u003cspan class=\"hljs-type\"\u003eJWTAuth\u003c/span\u003e.create(vertx, authConfig)\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/login\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// this is an example, authentication should be done with another provider...\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-string\"\u003e\u0026quot;paulo\u0026quot;\u003c/span\u003e == ctx.request().getParam(\u003cspan class=\"hljs-string\"\u003e\u0026quot;username\u0026quot;\u003c/span\u003e) \u0026amp;\u0026amp; \u003cspan class=\"hljs-string\"\u003e\u0026quot;secret\u0026quot;\u003c/span\u003e == ctx.request().getParam(\u003cspan class=\"hljs-string\"\u003e\u0026quot;password\u0026quot;\u003c/span\u003e)) {\n    ctx.response().end(authProvider.generateToken(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e io.vertx.core.json.\u003cspan class=\"hljs-type\"\u003eJsonObject\u003c/span\u003e().put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;sub\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;paulo\u0026quot;\u003c/span\u003e), \u003cspan class=\"hljs-type\"\u003eJWTOptions\u003c/span\u003e()))\n  } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n    ctx.fail(\u003cspan class=\"hljs-number\"\u003e401\u003c/span\u003e)\n  }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNow that your client has a token all it is required is that forall* consequent request the HTTP header\n\u003ccode\u003eAuthorization\u003c/code\u003e is filled with: \u003ccode\u003eBearer \u0026lt;token\u0026gt;\u003c/code\u003e e.g.:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e authConfig = \u003cspan class=\"hljs-type\"\u003eJWTAuthOptions\u003c/span\u003e()\n  .setKeyStore(\u003cspan class=\"hljs-type\"\u003eKeyStoreOptions\u003c/span\u003e()\n    .setType(\u003cspan class=\"hljs-string\"\u003e\u0026quot;jceks\u0026quot;\u003c/span\u003e)\n    .setPath(\u003cspan class=\"hljs-string\"\u003e\u0026quot;keystore.jceks\u0026quot;\u003c/span\u003e)\n    .setPassword(\u003cspan class=\"hljs-string\"\u003e\u0026quot;secret\u0026quot;\u003c/span\u003e)\n  )\n\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e authProvider = \u003cspan class=\"hljs-type\"\u003eJWTAuth\u003c/span\u003e.create(vertx, authConfig)\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/protected/*\u0026quot;\u003c/span\u003e).handler(\u003cspan class=\"hljs-type\"\u003eJWTAuthHandler\u003c/span\u003e.create(authProvider))\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/protected/somepage\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// some handle code...\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eJWT allows you to add any information you like to the token itself. By doing this there is no state in the server\nwhich allows you to scale your applications without need for clustered session data. In order to add data to the\ntoken, during the creation of the token just add data to the JsonObject parameter:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e authConfig = \u003cspan class=\"hljs-type\"\u003eJWTAuthOptions\u003c/span\u003e()\n  .setKeyStore(\u003cspan class=\"hljs-type\"\u003eKeyStoreOptions\u003c/span\u003e()\n    .setType(\u003cspan class=\"hljs-string\"\u003e\u0026quot;jceks\u0026quot;\u003c/span\u003e)\n    .setPath(\u003cspan class=\"hljs-string\"\u003e\u0026quot;keystore.jceks\u0026quot;\u003c/span\u003e)\n    .setPassword(\u003cspan class=\"hljs-string\"\u003e\u0026quot;secret\u0026quot;\u003c/span\u003e)\n  )\n\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e authProvider = \u003cspan class=\"hljs-type\"\u003eJWTAuth\u003c/span\u003e.create(vertx, authConfig)\n\nauthProvider.generateToken(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e io.vertx.core.json.\u003cspan class=\"hljs-type\"\u003eJsonObject\u003c/span\u003e().put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;sub\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;paulo\u0026quot;\u003c/span\u003e).put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;someKey\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;some value\u0026quot;\u003c/span\u003e), \u003cspan class=\"hljs-type\"\u003eJWTOptions\u003c/span\u003e())\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAnd the same when consuming:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e handler = (rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e theSubject = rc.user().principal().getValue(\u003cspan class=\"hljs-string\"\u003e\u0026quot;sub\u0026quot;\u003c/span\u003e)\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e someKey = rc.user().principal().getValue(\u003cspan class=\"hljs-string\"\u003e\u0026quot;someKey\u0026quot;\u003c/span\u003e)\n}\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_configuring_required_authorities\"\u003e\u003ca class=\"anchor\" href=\"#_configuring_required_authorities\"\u003e\u003c/a\u003eConfiguring required authorities\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWith any auth handler you can also configure required authorities to access the resource.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default, if no authorities are configured then it is sufficient to be logged in to access the resource, otherwise\nthe user must be both logged in (authenticated) and have the required authorities.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of configuring an app so that different authorities are required for different parts of the\napp. Note that the meaning of the authorities is determined by the underlying auth provider that you use. E.g. some\nmay support a role/permission based model but others might use another model.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e listProductsAuthHandler = \u003cspan class=\"hljs-type\"\u003eRedirectAuthHandler\u003c/span\u003e.create(authProvider)\nlistProductsAuthHandler.addAuthority(\u003cspan class=\"hljs-string\"\u003e\u0026quot;list_products\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// Need \u0026quot;list_products\u0026quot; authority to list products\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/listproducts/*\u0026quot;\u003c/span\u003e).handler(listProductsAuthHandler)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e settingsAuthHandler = \u003cspan class=\"hljs-type\"\u003eRedirectAuthHandler\u003c/span\u003e.create(authProvider)\nsettingsAuthHandler.addAuthority(\u003cspan class=\"hljs-string\"\u003e\u0026quot;role:admin\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// Only \u0026quot;admin\u0026quot; has access to /private/settings\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/private/settings/*\u0026quot;\u003c/span\u003e).handler(settingsAuthHandler)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_chaining_multiple_auth_handlers\"\u003e\u003ca class=\"anchor\" href=\"#_chaining_multiple_auth_handlers\"\u003e\u003c/a\u003eChaining multiple auth handlers\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere are times when you want to support multiple authN/authZ mechanisms in a single application. For this you can\nuse the \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/ChainAuthHandler.html\"\u003eChainAuthHandler\u003c/a\u003e\u003c/code\u003e. The chain auth handler will attempt to perform\nauthentication on a chain of handlers. The chain works both for AuthN and AuthZ, so if the authentication is valid\nat a given handler of the chain, then that same handler will be used to perform authorization (if requested).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt is important to know that some handlers require specific providers, for example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eThe \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/JWTAuthHandler.html\"\u003eJWTAuthHandler\u003c/a\u003e\u003c/code\u003e requires \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/jwt/JWTAuth.html\"\u003eJWTAuth\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/DigestAuthHandler.html\"\u003eDigestAuthHandler\u003c/a\u003e\u003c/code\u003e requires \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/htdigest/HtdigestAuth.html\"\u003eHtdigestAuth\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/OAuth2AuthHandler.html\"\u003eOAuth2AuthHandler\u003c/a\u003e\u003c/code\u003e requires \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/OAuth2Auth.html\"\u003eOAuth2Auth\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSo it is not expected that the providers will be shared across all handlers. There are cases where one can share the\nprovider across handlers, for example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eThe \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/BasicAuthHandler.html\"\u003eBasicAuthHandler\u003c/a\u003e\u003c/code\u003e can take any provider.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eThe \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/RedirectAuthHandler.html\"\u003eRedirectAuthHandler\u003c/a\u003e\u003c/code\u003e can take any provider.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSo say that you want to create an application that accepts both \u003ccode\u003eHTTP Basic Authentication\u003c/code\u003e and \u003ccode\u003eForm Redirect\u003c/code\u003e. You\nwould start configuring your chain as:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e chain = \u003cspan class=\"hljs-type\"\u003eChainAuthHandler\u003c/span\u003e.create()\n\n\u003cspan class=\"hljs-comment\"\u003e// add http basic auth handler to the chain\u003c/span\u003e\nchain.append(\u003cspan class=\"hljs-type\"\u003eBasicAuthHandler\u003c/span\u003e.create(provider))\n\u003cspan class=\"hljs-comment\"\u003e// add form redirect auth handler to the chain\u003c/span\u003e\nchain.append(\u003cspan class=\"hljs-type\"\u003eRedirectAuthHandler\u003c/span\u003e.create(provider))\n\n\u003cspan class=\"hljs-comment\"\u003e// secure your route\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/secure/resource\u0026quot;\u003c/span\u003e).handler(chain)\n\u003cspan class=\"hljs-comment\"\u003e// your app\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/secure/resource\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// do something...\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSo when a user makes a request without a \u003ccode\u003eAuthorization\u003c/code\u003e header, this means that the chain will fail to authenticate\nwith the basic auth handler and will attempt to authenticate with the redirect handler. Since the redirect handler\nalways redirects you will be sent to the login form that you configured in that handler.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eLike the normal routing in vertx-web, auth chaning is a sequence, so if you would prefer to fallback to your browser\nasking for the user credentials using HTTP Basic authentication instead of the redirect all you need to to is reverse\nthe order of appending to the chain.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNow assume that you make a request where you provide the header \u003ccode\u003eAuthorization\u003c/code\u003e with the value \u003ccode\u003eBasic [token]\u003c/code\u003e. In\nthis case the basic auth handler will attempt to authenticate and if it is sucessful the chain will stop and\nvertx-web will continue to process your handlers. If the token is not valid, for example bad username/password, then\nthe chain will continue to the following entry. In this specific case the redirect auth handler.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_serving_static_resources\"\u003e\u003ca class=\"anchor\" href=\"#_serving_static_resources\"\u003e\u003c/a\u003eServing static resources\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web comes with an out of the box handler for serving static web resources so you can write static web servers\nvery easily.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo serve static resources such as \u003ccode\u003e.html\u003c/code\u003e, \u003ccode\u003e.css\u003c/code\u003e, \u003ccode\u003e.js\u003c/code\u003e or any other static resource, you use an instance of\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html\"\u003eStaticHandler\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAny requests to paths handled by the static handler will result in files being served from a directory on the file system\nor from the classpath. The default static file directory is \u003ccode\u003ewebroot\u003c/code\u003e but this can be configured.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the following example all requests to paths starting with \u003ccode\u003e/static/\u003c/code\u003e will get served from the directory \u003ccode\u003ewebroot\u003c/code\u003e:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/static/*\u0026quot;\u003c/span\u003e).handler(\u003cspan class=\"hljs-type\"\u003eStaticHandler\u003c/span\u003e.create())\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor example, if there was a request with path \u003ccode\u003e/static/css/mystyles.css\u003c/code\u003e the static serve will look for a file in the\ndirectory \u003ccode\u003ewebroot/css/mystyle.css\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt will also look for a file on the classpath called \u003ccode\u003ewebroot/css/mystyle.css\u003c/code\u003e. This means you can package up all your\nstatic resources into a jar file (or fatjar) and distribute them like that.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen Vert.x finds a resource on the classpath for the first time it extracts it and caches it in a temporary directory\non disk so it doesn\u0026#8217;t have to do this each time.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe handler will handle range aware requests. When a client makes a request to a static resource, the handler will\nnotify that it can handle range aware request by stating the unit on the \u003ccode\u003eAccept-Ranges\u003c/code\u003e header. Further requests\nthat contain the \u003ccode\u003eRange\u003c/code\u003e header with the correct unit and start and end indexes will then receive partial responses\nwith the correct \u003ccode\u003eContent-Range\u003c/code\u003e header.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_configuring_caching\"\u003e\u003ca class=\"anchor\" href=\"#_configuring_caching\"\u003e\u003c/a\u003eConfiguring caching\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default the static handler will set cache headers to enable browsers to effectively cache files.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web sets the headers \u003ccode\u003ecache-control\u003c/code\u003e,\u003ccode\u003elast-modified\u003c/code\u003e, and \u003ccode\u003edate\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ccode\u003ecache-control\u003c/code\u003e is set to \u003ccode\u003emax-age=86400\u003c/code\u003e by default. This corresponds to one day. This can be configured with\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setMaxAgeSeconds()\"\u003esetMaxAgeSeconds\u003c/a\u003e\u003c/code\u003e if required.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf a browser sends a GET or a HEAD request with an \u003ccode\u003eif-modified-since\u003c/code\u003e header and the resource has not been modified\nsince that date, a \u003ccode\u003e304\u003c/code\u003e status is returned which tells the browser to use its locally cached resource.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf handling of cache headers is not required, it can be disabled with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setCachingEnabled()\"\u003esetCachingEnabled\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen cache handling is enabled Vert.x-Web will cache the last modified date of resources in memory, this avoids a disk hit\nto check the actual last modified date every time.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eEntries in the cache have an expiry time, and after that time, the file on disk will be checked again and the cache\nentry updated.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you know that your files never change on disk, then the cache entry will effectively never expire. This is the\ndefault.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you know that your files might change on disk when the server is running then you can set files read only to false with\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setFilesReadOnly()\"\u003esetFilesReadOnly\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo enable the maximum number of entries that can be cached in memory at any one time you can use\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setMaxCacheSize()\"\u003esetMaxCacheSize\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo configure the expiry time of cache entries you can use \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setCacheEntryTimeout()\"\u003esetCacheEntryTimeout\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_configuring_the_index_page\"\u003e\u003ca class=\"anchor\" href=\"#_configuring_the_index_page\"\u003e\u003c/a\u003eConfiguring the index page\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAny requests to the root path \u003ccode\u003e/\u003c/code\u003e will cause the index page to be served. By default the index page is \u003ccode\u003eindex.html\u003c/code\u003e.\nThis can be configured with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setIndexPage()\"\u003esetIndexPage\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_changing_the_web_root\"\u003e\u003ca class=\"anchor\" href=\"#_changing_the_web_root\"\u003e\u003c/a\u003eChanging the web root\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default static resources will be served from the directory \u003ccode\u003ewebroot\u003c/code\u003e. To configure this use\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setWebRoot()\"\u003esetWebRoot\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_serving_hidden_files\"\u003e\u003ca class=\"anchor\" href=\"#_serving_hidden_files\"\u003e\u003c/a\u003eServing hidden files\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default the serve will serve hidden files (files starting with \u003ccode\u003e.\u003c/code\u003e).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you do not want hidden files to be served you can configure it with \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setIncludeHidden()\"\u003esetIncludeHidden\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_directory_listing\"\u003e\u003ca class=\"anchor\" href=\"#_directory_listing\"\u003e\u003c/a\u003eDirectory listing\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe server can also perform directory listing. By default directory listing is disabled. To enabled it use\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setDirectoryListing()\"\u003esetDirectoryListing\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen directory listing is enabled the content returned depends on the content type in the \u003ccode\u003eaccept\u003c/code\u003e header.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor \u003ccode\u003etext/html\u003c/code\u003e directory listing, the template used to render the directory listing page can be configured with\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/StaticHandler.html#setDirectoryTemplate()\"\u003esetDirectoryTemplate\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_disabling_file_caching_on_disk\"\u003e\u003ca class=\"anchor\" href=\"#_disabling_file_caching_on_disk\"\u003e\u003c/a\u003eDisabling file caching on disk\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default, Vert.x will cache files that are served from the classpath into a file on disk in a sub-directory of a\ndirectory called \u003ccode\u003e.vertx\u003c/code\u003e in the current working directory. This is mainly useful when deploying services as\nfatjars in production where serving a file from the classpath every time can be slow.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn development this can cause a problem, as if you update your static content while the server is running, the\ncached file will be served not the updated file.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo disable file caching you can provide your vert.x options the property \u003ccode\u003efileResolverCachingEnabled\u003c/code\u003e to \u003ccode\u003efalse\u003c/code\u003e. For\nbackwards compatibility it will also default that value to the system property \u003ccode\u003evertx.disableFileCaching\u003c/code\u003e. E.g. you\ncould set up a run configuration in your IDE to set this when running your main class.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_cors_handling\"\u003e\u003ca class=\"anchor\" href=\"#_cors_handling\"\u003e\u003c/a\u003eCORS handling\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003ca href=\"http://en.wikipedia.org/wiki/Cross-origin_resource_sharing\"\u003eCross Origin Resource Sharing\u003c/a\u003e is a safe mechanism for\nallowing resources to be requested from one domain and served from another.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web includes a handler \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/CorsHandler.html\"\u003eCorsHandler\u003c/a\u003e\u003c/code\u003e that handles the CORS protocol for you.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Will only accept GET requests from origin \u0026quot;vertx.io\u0026quot;\u003c/span\u003e\nrouter.route().handler(\u003cspan class=\"hljs-type\"\u003eCorsHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;vertx\\\\.io\u0026quot;\u003c/span\u003e).allowedMethod(\u003cspan class=\"hljs-type\"\u003eHttpMethod\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003eGET\u003c/span\u003e))\n\nrouter.route().handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// Your app handlers\u003c/span\u003e\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_multi_tenant\"\u003e\u003ca class=\"anchor\" href=\"#_multi_tenant\"\u003e\u003c/a\u003eMulti Tenant\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThere are cases where your application needs to handle more than just 1 tenant. In this case a helper handler is\nprovided that simplifies setting up the application.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the case the tenant is identified by a HTTP header, say for example \u003ccode\u003eX-Tenant\u003c/code\u003e, then creating the handler is as\nsimple as:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().handler(\u003cspan class=\"hljs-type\"\u003eMultiTenantHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;X-Tenant\u0026quot;\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou now should register what handler should be executed for the given tenant:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-type\"\u003eMultiTenantHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;X-Tenant\u0026quot;\u003c/span\u003e).addTenantHandler(\u003cspan class=\"hljs-string\"\u003e\u0026quot;tenant-A\u0026quot;\u003c/span\u003e, (ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// do something for tenant A...\u003c/span\u003e\n}).addTenantHandler(\u003cspan class=\"hljs-string\"\u003e\u0026quot;tenant-B\u0026quot;\u003c/span\u003e, (ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// do something for tenant B...\u003c/span\u003e\n}).addDefaultHandler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// do something when no tenant matches...\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis is useful for security situations:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// create an OAuth2 provider, clientID and clientSecret should be requested to github\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e gitHubAuthProvider = \u003cspan class=\"hljs-type\"\u003eGithubAuth\u003c/span\u003e.create(vertx, \u003cspan class=\"hljs-string\"\u003e\u0026quot;CLIENT_ID\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;CLIENT_SECRET\u0026quot;\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e// create a oauth2 handler on our running server\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// the second argument is the full url to the callback as you entered in your provider management console.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e githubOAuth2 = \u003cspan class=\"hljs-type\"\u003eOAuth2AuthHandler\u003c/span\u003e.create(gitHubAuthProvider, \u003cspan class=\"hljs-string\"\u003e\u0026quot;https://myserver.com/github-callback\u0026quot;\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e// setup the callback handler for receiving the GitHub callback\u003c/span\u003e\ngithubOAuth2.setupCallback(router.route())\n\n\u003cspan class=\"hljs-comment\"\u003e// create an OAuth2 provider, clientID and clientSecret should be requested to Google\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e googleAuthProvider = \u003cspan class=\"hljs-type\"\u003eOAuth2Auth\u003c/span\u003e.create(vertx, \u003cspan class=\"hljs-type\"\u003eOAuth2ClientOptions\u003c/span\u003e()\n  .setClientID(\u003cspan class=\"hljs-string\"\u003e\u0026quot;CLIENT_ID\u0026quot;\u003c/span\u003e)\n  .setClientSecret(\u003cspan class=\"hljs-string\"\u003e\u0026quot;CLIENT_SECRET\u0026quot;\u003c/span\u003e)\n  .setFlow(\u003cspan class=\"hljs-type\"\u003eOAuth2FlowType\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003eAUTH_CODE\u003c/span\u003e)\n  .setSite(\u003cspan class=\"hljs-string\"\u003e\u0026quot;https://accounts.google.com\u0026quot;\u003c/span\u003e)\n  .setTokenPath(\u003cspan class=\"hljs-string\"\u003e\u0026quot;https://www.googleapis.com/oauth2/v3/token\u0026quot;\u003c/span\u003e)\n  .setAuthorizationPath(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/o/oauth2/auth\u0026quot;\u003c/span\u003e)\n)\n\n\u003cspan class=\"hljs-comment\"\u003e// create a oauth2 handler on our domain: \u0026quot;http://localhost:8080\u0026quot;\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e googleOAuth2 = \u003cspan class=\"hljs-type\"\u003eOAuth2AuthHandler\u003c/span\u003e.create(googleAuthProvider, \u003cspan class=\"hljs-string\"\u003e\u0026quot;http://localhost:8080\u0026quot;\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-type\"\u003eMultiTenantHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;X-Tenant\u0026quot;\u003c/span\u003e).addTenantHandler(\u003cspan class=\"hljs-string\"\u003e\u0026quot;tenant-github\u0026quot;\u003c/span\u003e, githubOAuth2).addTenantHandler(\u003cspan class=\"hljs-string\"\u003e\u0026quot;tenant-google\u0026quot;\u003c/span\u003e, googleOAuth2).addDefaultHandler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  ctx.fail(\u003cspan class=\"hljs-number\"\u003e401\u003c/span\u003e)\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_templates\"\u003e\u003ca class=\"anchor\" href=\"#_templates\"\u003e\u003c/a\u003eTemplates\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web includes dynamic page generation capabilities by including out of the box support for several popular template\nengines. You can also easily add your own.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTemplate engines are described by \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/templ/TemplateEngine.html\"\u003eTemplateEngine\u003c/a\u003e\u003c/code\u003e. In order to render a template\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/common/template/TemplateEngine.html#render(io.vertx.core.json.JsonObject,%20java.lang.String)\"\u003erender\u003c/a\u003e\u003c/code\u003e is used.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe simplest way to use templates is not to call the template engine directly but to use the\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/TemplateHandler.html\"\u003eTemplateHandler\u003c/a\u003e\u003c/code\u003e.\nThis handler calls the template engine for you based on the path in the HTTP request.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default the template handler will look for templates in a directory called \u003ccode\u003etemplates\u003c/code\u003e. This can be configured.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe handler will return the results of rendering with a content type of \u003ccode\u003etext/html\u003c/code\u003e by default. This can also be configured.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen you create the template handler you pass in an instance of the template engine you want. Template engines are\nnot embedded in vertx-web so, you need to configure your project to access them. Configuration is provided for\neach template engine.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some examples:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_mvel_template_engine\"\u003e\u003ca class=\"anchor\" href=\"#_mvel_template_engine\"\u003e\u003c/a\u003eMVEL template engine\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use MVEL, you need to add the following \u003cem\u003edependency\u003c/em\u003e to your project:\n\u003ccode\u003e${maven.groupId}:vertx-web-templ-mvel:${maven.version}\u003c/code\u003e. Create an instance of the MVEL template engine using:\n\u003ccode\u003eio.vertx.ext.web.templ.MVELTemplateEngine#create()\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen using the MVEL template engine, it will by default look for\ntemplates with the \u003ccode\u003e.templ\u003c/code\u003e extension if no extension is specified in the file name.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe routing context \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html\"\u003eRoutingContext\u003c/a\u003e\u003c/code\u003e is available\nin the MVEL template as the \u003ccode\u003econtext\u003c/code\u003e variable, this means you can render the template based on anything in the context\nincluding the request, response, session or context data.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some examples:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003eThe request path is @{context.request().path()}\n\nThe variable 'foo' from the session is @{context.session().get('foo')}\n\nThe value 'bar' from the context data is @{context.get('bar')}\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePlease consult the \u003ca href=\"http://mvel.codehaus.org/MVEL+2.0+Templating+Guide\"\u003eMVEL templates documentation\u003c/a\u003e for how to write\nMVEL templates.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_jade_template_engine\"\u003e\u003ca class=\"anchor\" href=\"#_jade_template_engine\"\u003e\u003c/a\u003eJade template engine\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use the Jade template engine, you need to add the following \u003cem\u003edependency\u003c/em\u003e to your project:\n\u003ccode\u003e${maven.groupId}:vertx-web-templ-jade:${maven.version}\u003c/code\u003e. Create an instance of the Jade template engine using:\n\u003ccode\u003eio.vertx.ext.web.templ.JadeTemplateEngine#create()\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen using the Jade template engine, it will by default look for\ntemplates with the \u003ccode\u003e.jade\u003c/code\u003e extension if no extension is specified in the file name.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe routing context \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html\"\u003eRoutingContext\u003c/a\u003e\u003c/code\u003e is available\nin the Jade template as the \u003ccode\u003econtext\u003c/code\u003e variable, this means you can render the template based on anything in the context\nincluding the request, response, session or context data.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some examples:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003e!!! 5\nhtml\n head\n   title= context.get('foo') + context.request().path()\n body\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePlease consult the \u003ca href=\"https://github.com/neuland/jade4j\"\u003eJade4j documentation\u003c/a\u003e for how to write\nJade templates.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_handlebars_template_engine\"\u003e\u003ca class=\"anchor\" href=\"#_handlebars_template_engine\"\u003e\u003c/a\u003eHandlebars template engine\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use Handlebars, you need to add the following \u003cem\u003edependency\u003c/em\u003e to your project:\n\u003ccode\u003e${maven.groupId}:vertx-web-templ-handlebars:${maven.version}\u003c/code\u003e. Create an instance of the Handlebars template engine\nusing: \u003ccode\u003eio.vertx.ext.web.templ.HandlebarsTemplateEngine#create()\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen using the Handlebars template engine, it will by default look for\ntemplates with the \u003ccode\u003e.hbs\u003c/code\u003e extension if no extension is specified in the file name.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHandlebars templates are not able to call arbitrary methods in objects so we can\u0026#8217;t just pass the routing context\ninto the template and let the template introspect it like we can with other template engines.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eInstead, the context \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#data()\"\u003edata\u003c/a\u003e\u003c/code\u003e is available in the template.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to have access to other data like the request path, request params or session data you should\nadd it the context data in a handler before the template handler. For example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e handler = \u003cspan class=\"hljs-type\"\u003eTemplateHandler\u003c/span\u003e.create(engine)\n\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/dynamic\u0026quot;\u003c/span\u003e).handler((routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n  routingContext.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;request_path\u0026quot;\u003c/span\u003e, routingContext.request().path())\n  routingContext.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;session_data\u0026quot;\u003c/span\u003e, routingContext.session().data())\n\n  routingContext.next()\n})\n\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/dynamic/\u0026quot;\u003c/span\u003e).handler(handler)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePlease consult the \u003ca href=\"https://github.com/jknack/handlebars.java\"\u003eHandlebars Java port documentation\u003c/a\u003e for how to write\nhandlebars templates.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_thymeleaf_template_engine\"\u003e\u003ca class=\"anchor\" href=\"#_thymeleaf_template_engine\"\u003e\u003c/a\u003eThymeleaf template engine\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use Thymeleaf, you need to add the following \u003cem\u003edependency\u003c/em\u003e to your project:\n\u003ccode\u003e${maven.groupId}:vertx-web-templ-thymeleaf:${maven.version}\u003c/code\u003e. Create an instance of the Thymeleaf template engine\nusing: \u003ccode\u003eio.vertx.ext.web.templ.ThymeleafTemplateEngine#create()\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen using the Thymeleaf template engine, it will by default look for\ntemplates with the \u003ccode\u003e.html\u003c/code\u003e extension if no extension is specified in the file name.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe routing context \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html\"\u003eRoutingContext\u003c/a\u003e\u003c/code\u003e is available\nin the Thymeleaf template as the \u003ccode\u003econtext\u003c/code\u003e variable, this means you can render the template based on anything in the context\nincluding the request, response, session or context data.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some examples:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003e[snip]\n\u0026lt;p th:text=\"${context.get('foo')}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"${context.get('bar')}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"${context.normalisedPath()}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"${context.request().params().get('param1')}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"${context.request().params().get('param2')}\"\u0026gt;\u0026lt;/p\u0026gt;\n[snip]\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePlease consult the \u003ca href=\"http://www.thymeleaf.org/\"\u003eThymeleaf documentation\u003c/a\u003e for how to write\nThymeleaf templates.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_apache_freemarker_template_engine\"\u003e\u003ca class=\"anchor\" href=\"#_apache_freemarker_template_engine\"\u003e\u003c/a\u003eApache FreeMarker template engine\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use Apache FreeMarker, you need to add the following \u003cem\u003edependency\u003c/em\u003e to your project:\n\u003ccode\u003e${maven.groupId}:vertx-web-templ-freemarker:${maven.version}\u003c/code\u003e. Create an instance of the Apache FreeMarker template engine\nusing: \u003ccode\u003eio.vertx.ext.web.templ.Engine#create()\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen using the Apache FreeMarker template engine, it will by default look for\ntemplates with the \u003ccode\u003e.ftl\u003c/code\u003e extension if no extension is specified in the file name.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe routing context \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html\"\u003eRoutingContext\u003c/a\u003e\u003c/code\u003e is available\nin the Apache FreeMarker template as the \u003ccode\u003econtext\u003c/code\u003e variable, this means you can render the template based on anything in the context\nincluding the request, response, session or context data.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some examples:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003e[snip]\n\u0026lt;p th:text=\"${context.foo}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"${context.bar}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"${context.normalisedPath()}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"${context.request().params().param1}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"${context.request().params().param2}\"\u0026gt;\u0026lt;/p\u0026gt;\n[snip]\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePlease consult the \u003ca href=\"http://www.freemarker.org/\"\u003eApache FreeMarker documentation\u003c/a\u003e for how to write\nApache FreeMarker templates.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_pebble_template_engine\"\u003e\u003ca class=\"anchor\" href=\"#_pebble_template_engine\"\u003e\u003c/a\u003ePebble template engine\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use Pebble, you need to add the following \u003cem\u003edependency\u003c/em\u003e to your project:\n\u003ccode\u003eio.vertx:vertx-web-templ-pebble:${maven.version}\u003c/code\u003e. Create an instance of the Pebble template engine\nusing: \u003ccode\u003eio.vertx.ext.web.templ.PebbleTemplateEngine#create(vertx)\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen using the Pebble template engine, it will by default look for\ntemplates with the \u003ccode\u003e.peb\u003c/code\u003e extension if no extension is specified in the file name.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe routing context \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/ext/web/RoutingContext.html\"\u003eRoutingContext\u003c/a\u003e\u003c/code\u003e is available\nin the Pebble template as the \u003ccode\u003econtext\u003c/code\u003e variable, this means you can render the template based on anything in the context\nincluding the request, response, session or context data.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere are some examples:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003e[snip]\n\u0026lt;p th:text=\"{{context.foo}}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"{{context.bar}}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"{{context.normalisedPath()}}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"{{context.request().params().param1}}\"\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p th:text=\"{{context.request().params().param2}}\"\u0026gt;\u0026lt;/p\u0026gt;\n[snip]\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePlease consult the \u003ca href=\"http://www.mitchellbosecke.com/pebble/home/\"\u003ePebble documentation\u003c/a\u003e for how to write\nPebble templates.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_rocker_template_engine\"\u003e\u003ca class=\"anchor\" href=\"#_rocker_template_engine\"\u003e\u003c/a\u003eRocker template engine\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use Rocker, then add \u003ccode\u003eio.vertx:vertx-web-templ-rocker:${maven.version}\u003c/code\u003e as a dependency to your project.\nYou can then create a Rocker template engine instance with \u003ccode\u003eio.vertx.ext.web.templ.rocker#create()\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe values of the JSON context object passed to the \u003ccode\u003erender\u003c/code\u003e method are then exposed as template parameters.\nGiven:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003e[snip]\nfinal JsonObject context = new JsonObject()\n .put(\"foo\", \"badger\")\n .put(\"bar\", \"fox\")\n .put(\"context\", new JsonObject().put(\"path\", \"/foo/bar\"));\n\nengine.render(context, \"somedir/TestRockerTemplate2\", render -\u0026gt; {\n // (...)\n});\n[snip]\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ethen the template can be as the following \u003ccode\u003esomedir/TestRockerTemplate2.rocker.html\u003c/code\u003e resource file:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003e@import io.vertx.core.json.JsonObject\n@args (JsonObject context, String foo, String bar)\nHello @foo and @bar\nRequest path is @context.getString(\"path\")\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_disabling_caching\"\u003e\u003ca class=\"anchor\" href=\"#_disabling_caching\"\u003e\u003c/a\u003eDisabling caching\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eDuring development you might want to disable template caching so that the template gets reevaluated on each request.\nIn order to do this you need to set the system property: \u003ccode\u003eio.vertx.ext.web.TemplateEngine.disableCache\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default it will be false. So caching is always enabled.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_error_handler\"\u003e\u003ca class=\"anchor\" href=\"#_error_handler\"\u003e\u003c/a\u003eError handler\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can render your own errors using a template handler or otherwise but Vert.x-Web also includes an out of the boxy\n\"pretty\" error handler that can render error pages for you.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe handler is \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/ErrorHandler.html\"\u003eErrorHandler\u003c/a\u003e\u003c/code\u003e. To use the error handler just set it as a\nfailure handler for any paths that you want covered.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_request_logger\"\u003e\u003ca class=\"anchor\" href=\"#_request_logger\"\u003e\u003c/a\u003eRequest logger\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web includes a handler \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/LoggerHandler.html\"\u003eLoggerHandler\u003c/a\u003e\u003c/code\u003e that you can use to log HTTP requests.\nYou should mount this handler before any handler that could fail the \u003ccode\u003eRoutingContext\u003c/code\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default requests are logged to the Vert.x logger which can be configured to use JUL logging, log4j or SLF4J.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSee \u003ccode\u003e\u003ca href=\"../enums.html#LoggerFormat\"\u003eLoggerFormat\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_serving_favicons\"\u003e\u003ca class=\"anchor\" href=\"#_serving_favicons\"\u003e\u003c/a\u003eServing favicons\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web includes the handler \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/FaviconHandler.html\"\u003eFaviconHandler\u003c/a\u003e\u003c/code\u003e especially for serving favicons.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFavicons can be specified using a path to the filesystem, or by default Vert.x-Web will look for a file on the classpath\nwith the name \u003ccode\u003efavicon.ico\u003c/code\u003e. This means you bundle the favicon in the jar of your application.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_timeout_handler\"\u003e\u003ca class=\"anchor\" href=\"#_timeout_handler\"\u003e\u003c/a\u003eTimeout handler\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web includes a timeout handler that you can use to timeout requests if they take too long to process.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis is configured using an instance of \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/TimeoutHandler.html\"\u003eTimeoutHandler\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf a request times out before the response is written a \u003ccode\u003e503\u003c/code\u003e response will be returned to the client.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of using a timeout handler which will timeout all requests to paths starting with \u003ccode\u003e/foo\u003c/code\u003e after 5\nseconds:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/foo/\u0026quot;\u003c/span\u003e).handler(\u003cspan class=\"hljs-type\"\u003eTimeoutHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_response_time_handler\"\u003e\u003ca class=\"anchor\" href=\"#_response_time_handler\"\u003e\u003c/a\u003eResponse time handler\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis handler sets the header \u003ccode\u003ex-response-time\u003c/code\u003e response header containing the time from when the request was received\nto when the response headers were written, in ms., e.g.:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ex-response-time: 1456ms\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_content_type_handler\"\u003e\u003ca class=\"anchor\" href=\"#_content_type_handler\"\u003e\u003c/a\u003eContent type handler\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003eResponseContentTypeHandler\u003c/code\u003e can set the \u003ccode\u003eContent-Type\u003c/code\u003e header automatically.\nSuppose we are building a RESTful web application. We need to set the content type in all our handlers:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/api/books\u0026quot;\u003c/span\u003e).produces(\u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e).handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  findBooks({\n    \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eSuccess\u003c/span\u003e(result) =\u0026gt; {\n      rc.response().putHeader(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Content-Type\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e).end(toJson(result))\n    }\n    \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eFailure\u003c/span\u003e(cause) =\u0026gt; {\n      println(\u003cspan class=\"hljs-string\"\u003es\u0026quot;\u003cspan class=\"hljs-subst\"\u003e$cause\u003c/span\u003e\u0026quot;\u003c/span\u003e)\n    }\n  })\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf the API surface becomes pretty large, setting the content type can become cumbersome.\nTo avoid this situation, add the \u003ccode\u003eResponseContentTypeHandler\u003c/code\u003e to the corresponding routes:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/api/*\u0026quot;\u003c/span\u003e).handler(\u003cspan class=\"hljs-type\"\u003eResponseContentTypeHandler\u003c/span\u003e.create())\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/api/books\u0026quot;\u003c/span\u003e).produces(\u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e).handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  findBooks({\n    \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eSuccess\u003c/span\u003e(result) =\u0026gt; {\n      rc.response().end(toJson(result))\n    }\n    \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eFailure\u003c/span\u003e(cause) =\u0026gt; {\n      println(\u003cspan class=\"hljs-string\"\u003es\u0026quot;\u003cspan class=\"hljs-subst\"\u003e$cause\u003c/span\u003e\u0026quot;\u003c/span\u003e)\n    }\n  })\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe handler gets the approriate content type from \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/RoutingContext.html#getAcceptableContentType()\"\u003egetAcceptableContentType\u003c/a\u003e\u003c/code\u003e.\nAs a consequence, you can easily share the same handler to produce data of different types:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/api/*\u0026quot;\u003c/span\u003e).handler(\u003cspan class=\"hljs-type\"\u003eResponseContentTypeHandler\u003c/span\u003e.create())\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/api/books\u0026quot;\u003c/span\u003e).produces(\u003cspan class=\"hljs-string\"\u003e\u0026quot;text/xml\u0026quot;\u003c/span\u003e).produces(\u003cspan class=\"hljs-string\"\u003e\u0026quot;application/json\u0026quot;\u003c/span\u003e).handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  findBooks({\n    \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eSuccess\u003c/span\u003e(result) =\u0026gt; {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (rc.getAcceptableContentType() == \u003cspan class=\"hljs-string\"\u003e\u0026quot;text/xml\u0026quot;\u003c/span\u003e) {\n        rc.response().end(toXML(result))\n      } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n        rc.response().end(toJson(result))\n      }\n    }\n    \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003eFailure\u003c/span\u003e(cause) =\u0026gt; {\n      println(\u003cspan class=\"hljs-string\"\u003es\u0026quot;\u003cspan class=\"hljs-subst\"\u003e$cause\u003c/span\u003e\u0026quot;\u003c/span\u003e)\n    }\n  })\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_sockjs\"\u003e\u003ca class=\"anchor\" href=\"#_sockjs\"\u003e\u003c/a\u003eSockJS\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSockJS is a client side JavaScript library and protocol which provides a simple WebSocket-like interface allowing you\nto make connections to SockJS servers irrespective of whether the actual browser or network will allow real WebSockets.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt does this by supporting various different transports between browser and server, and choosing one at run-time\naccording to browser and network capabilities.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAll this is transparent to you - you are simply presented with the WebSocket-like interface which \u003cem\u003ejust works\u003c/em\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003ePlease see the \u003ca href=\"https://github.com/sockjs/sockjs-client\"\u003eSockJS website\u003c/a\u003e for more information on SockJS.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_sockjs_handler\"\u003e\u003ca class=\"anchor\" href=\"#_sockjs_handler\"\u003e\u003c/a\u003eSockJS handler\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x provides an out of the box handler called \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html\"\u003eSockJSHandler\u003c/a\u003e\u003c/code\u003e for\nusing SockJS in your Vert.x-Web applications.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou should create one handler per SockJS application using \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html#create()\"\u003eSockJSHandler.create\u003c/a\u003e\u003c/code\u003e.\nYou can also specify configuration options when creating the instance. The configuration options are described with\nan instance of \u003ccode\u003e\u003ca href=\"../dataobjects.html#SockJSHandlerOptions\"\u003eSockJSHandlerOptions\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = \u003cspan class=\"hljs-type\"\u003eSockJSHandlerOptions\u003c/span\u003e()\n  .setHeartbeatInterval(\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e sockJSHandler = \u003cspan class=\"hljs-type\"\u003eSockJSHandler\u003c/span\u003e.create(vertx, options)\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/myapp/*\u0026quot;\u003c/span\u003e).handler(sockJSHandler)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_handling_sockjs_sockets\"\u003e\u003ca class=\"anchor\" href=\"#_handling_sockjs_sockets\"\u003e\u003c/a\u003eHandling SockJS sockets\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOn the server-side you set a handler on the SockJS handler, and\nthis will be called every time a SockJS connection is made from a client:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe object passed into the handler is a \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSSocket.html\"\u003eSockJSSocket\u003c/a\u003e\u003c/code\u003e. This has a familiar\nsocket-like interface which you can read and write to similarly to a \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/net/NetSocket.html\"\u003eNetSocket\u003c/a\u003e\u003c/code\u003e or\na \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/http/WebSocket.html\"\u003eWebSocket\u003c/a\u003e\u003c/code\u003e. It also implements \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/streams/ReadStream.html\"\u003eReadStream\u003c/a\u003e\u003c/code\u003e and\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/streams/WriteStream.html\"\u003eWriteStream\u003c/a\u003e\u003c/code\u003e so you can pump it to and from other read and write streams.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example of a simple SockJS handler that simply echoes back any back any data that it reads:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = \u003cspan class=\"hljs-type\"\u003eSockJSHandlerOptions\u003c/span\u003e()\n  .setHeartbeatInterval(\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e sockJSHandler = \u003cspan class=\"hljs-type\"\u003eSockJSHandler\u003c/span\u003e.create(vertx, options)\n\nsockJSHandler.socketHandler((sockJSSocket: io.vertx.scala.ext.web.handler.sockjs.\u003cspan class=\"hljs-type\"\u003eSockJSSocket\u003c/span\u003e) =\u0026gt; {\n\n  \u003cspan class=\"hljs-comment\"\u003e// Just echo the data back\u003c/span\u003e\n  sockJSSocket.handler(sockJSSocket.write _)\n})\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/myapp/*\u0026quot;\u003c/span\u003e).handler(sockJSHandler)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_the_client_side\"\u003e\u003ca class=\"anchor\" href=\"#_the_client_side\"\u003e\u003c/a\u003eThe client side\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn client side JavaScript you use the SockJS client side library to make connections.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can find that \u003ca href=\"http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFull details for using the SockJS JavaScript client are on the \u003ca href=\"https://github.com/sockjs/sockjs-client\"\u003eSockJS website\u003c/a\u003e,\nbut in summary you use it something like this:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003evar sock = new SockJS('http://mydomain.com/myapp');\n\nsock.onopen = function() {\n console.log('open');\n};\n\nsock.onmessage = function(e) {\n console.log('message', e.data);\n};\n\nsock.onclose = function() {\n console.log('close');\n};\n\nsock.send('test');\n\nsock.close();\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_configuring_the_sockjs_handler\"\u003e\u003ca class=\"anchor\" href=\"#_configuring_the_sockjs_handler\"\u003e\u003c/a\u003eConfiguring the SockJS handler\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe handler can be configured with various options using \u003ccode\u003e\u003ca href=\"../dataobjects.html#SockJSHandlerOptions\"\u003eSockJSHandlerOptions\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003einsertJSESSIONID\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eInsert a JSESSIONID cookie so load-balancers ensure requests for a specific SockJS session\nare always routed to the correct server. Default is \u003ccode\u003etrue\u003c/code\u003e.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003esessionTimeout\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThe server sends a \u003ccode\u003eclose\u003c/code\u003e event when a client receiving connection have not been seen for a while.\nThis delay is configured by this setting. By default the \u003ccode\u003eclose\u003c/code\u003e event will be emitted when a receiving\nconnection wasn\u0026#8217;t seen for 5 seconds.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003eheartbeatInterval\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eIn order to keep proxies and load balancers from closing long running http\nrequests we need to pretend that the connection is active and send a heartbeat packet once in a while.\nThis setting controls how often this is done. By default a heartbeat packet is sent every 25 seconds.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003emaxBytesStreaming\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eMost streaming transports save responses on the client side and don\u0026#8217;t free memory used\nby delivered messages. Such transports need to be garbage-collected once in a while. \u003ccode\u003emax_bytes_streaming\u003c/code\u003e sets a\nminimum number of bytes that can be send over a single http streaming request before it will be closed. After that\nclient needs to open new request. Setting this value to one effectively disables streaming and will make streaming\ntransports to behave like polling transports. The default value is 128K.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003elibraryURL\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eTransports which don\u0026#8217;t support cross-domain communication natively ('eventsource' to name one)\nuse an iframe trick. A simple page is served from the SockJS server (using its foreign domain) and is placed in an\ninvisible iframe. Code run from this iframe doesn\u0026#8217;t need to worry about cross-domain issues, as it\u0026#8217;s being run from\ndomain local to the SockJS server. This iframe also does need to load SockJS javascript client library, and this option\nlets you specify its url (if you\u0026#8217;re unsure, point it to the latest minified SockJS client release, this is the default).\nThe default value is \u003ccode\u003e\u003ca href=\"http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js\" class=\"bare\"\u003ehttp://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003edisabledTransports\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis is a list of transports that you want to disable. Possible values are\nWEBSOCKET, EVENT_SOURCE, HTML_FILE, JSON_P, XHR.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_sockjs_event_bus_bridge\"\u003e\u003ca class=\"anchor\" href=\"#_sockjs_event_bus_bridge\"\u003e\u003c/a\u003eSockJS event bus bridge\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x-Web comes with a built-in SockJS socket handler called the event bus bridge which effectively extends the server-side\nVert.x event bus into client side JavaScript.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis creates a distributed event bus which not only spans multiple Vert.x instances on the server side, but includes\nclient side JavaScript running in browsers.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWe can therefore create a huge distributed bus encompassing many browsers and servers. The browsers don\u0026#8217;t have to\nbe connected to the same server as long as the servers are connected.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis is done by providing a simple client side JavaScript library called \u003ccode\u003evertx-eventbus.js\u003c/code\u003e which provides an API\nvery similar to the server-side Vert.x event-bus API, which allows you to send and publish messages to the event bus\nand register handlers to receive messages.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis JavaScript library uses the JavaScript SockJS client to tunnel the event bus traffic over SockJS connections\nterminating at at a \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html\"\u003eSockJSHandler\u003c/a\u003e\u003c/code\u003e on the server-side.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA special SockJS socket handler is then installed on the \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html\"\u003eSockJSHandler\u003c/a\u003e\u003c/code\u003e which\nhandles the SockJS data and bridges it to and from the server side event bus.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo activate the bridge you simply call\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html#bridge()\"\u003ebridge\u003c/a\u003e\u003c/code\u003e on the\nSockJS handler.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e sockJSHandler = \u003cspan class=\"hljs-type\"\u003eSockJSHandler\u003c/span\u003e.create(vertx)\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = \u003cspan class=\"hljs-type\"\u003eBridgeOptions\u003c/span\u003e()\n\u003cspan class=\"hljs-comment\"\u003e// mount the bridge on the router\u003c/span\u003e\nrouter.mountSubRouter(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/eventbus\u0026quot;\u003c/span\u003e, sockJSHandler.bridge(options))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn client side JavaScript you use the 'vertx-eventbus.js` library to create connections to the event bus and to send\nand receive messages:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026#x27;vertx-eventbus.js\u0026#x27;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"javascript\"\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e eb = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e EventBus(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;http://localhost:8080/eventbus\u0026#x27;\u003c/span\u003e);\n\neb.onopen = \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n\n \u003cspan class=\"hljs-comment\"\u003e// set a handler to receive a message\u003c/span\u003e\n eb.registerHandler(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;some-address\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eerror, message\u003c/span\u003e) \u003c/span\u003e{\n   \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;received a message: \u0026#x27;\u003c/span\u003e + \u003cspan class=\"hljs-built_in\"\u003eJSON\u003c/span\u003e.stringify(message));\n });\n\n \u003cspan class=\"hljs-comment\"\u003e// send a message\u003c/span\u003e\n eb.send(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;some-address\u0026#x27;\u003c/span\u003e, {\u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;tim\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eage\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e587\u003c/span\u003e});\n\n}\n\n\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe first thing the example does is to create a instance of the event bus\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e eb = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e EventBus(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;http://localhost:8080/eventbus\u0026#x27;\u003c/span\u003e);\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe parameter to the constructor is the URI where to connect to the event bus. Since we create our bridge with\nthe prefix \u003ccode\u003eeventbus\u003c/code\u003e we will connect there.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can\u0026#8217;t actually do anything with the connection until it is opened. When it is open the \u003ccode\u003eonopen\u003c/code\u003e handler will be called.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe bridge supports automatic reconnection, with configurable delay and backoff options.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e eb = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e EventBus(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;http://localhost:8080/eventbus\u0026#x27;\u003c/span\u003e);\neb.enableReconnect(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e);\neb.onopen = \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{}; \u003cspan class=\"hljs-comment\"\u003e// Set up handlers here, will be called on initial connection and all reconnections\u003c/span\u003e\neb.onreconnect = \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{}; \u003cspan class=\"hljs-comment\"\u003e// Optional, will only be called on reconnections\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// Alternatively, pass in an options object\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = {\n   \u003cspan class=\"hljs-attr\"\u003evertxbus_reconnect_attempts_max\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003eInfinity\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// Max reconnect attempts\u003c/span\u003e\n   \u003cspan class=\"hljs-attr\"\u003evertxbus_reconnect_delay_min\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1000\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// Initial delay (in ms) before first reconnect attempt\u003c/span\u003e\n   \u003cspan class=\"hljs-attr\"\u003evertxbus_reconnect_delay_max\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// Max delay (in ms) between reconnect attempts\u003c/span\u003e\n   \u003cspan class=\"hljs-attr\"\u003evertxbus_reconnect_exponent\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// Exponential backoff factor\u003c/span\u003e\n   \u003cspan class=\"hljs-attr\"\u003evertxbus_randomization_factor\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0.5\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e// Randomization factor between 0 and 1\u003c/span\u003e\n};\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e eb2 = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e EventBus(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;http://localhost:8080/eventbus\u0026#x27;\u003c/span\u003e, options);\neb2.enableReconnect(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e);\n\u003cspan class=\"hljs-comment\"\u003e// Set up handlers...\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can retrieve the client library using a dependency manager:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eMaven (in your \u003ccode\u003epom.xml\u003c/code\u003e):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e${maven.groupId}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e${maven.artifactId}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e${maven.version}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eclassifier\u003c/span\u003e\u0026gt;\u003c/span\u003eclient\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eclassifier\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etype\u003c/span\u003e\u0026gt;\u003c/span\u003ejs\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etype\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eGradle (in your \u003ccode\u003ebuild.gradle\u003c/code\u003e file):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003ecompile \u003cspan class=\"hljs-string\"\u003e\u0026#x27;${maven.groupId}:${maven.artifactId}:${maven.version}:client\u0026#x27;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe library is also available on:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://www.npmjs.com/package/vertx3-eventbus-client\"\u003eNPM\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/vert-x3/vertx-bus-bower\"\u003eBower\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ca href=\"https://cdnjs.com/libraries/vertx\"\u003ecdnjs\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNotice that the API has changed between the 3.0.0 and 3.1.0 version. Please check the changelog. The previous client\nis still compatible and can still be used, but the new client offers more feature and is closer to the vert.x\nevent bus API.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_securing_the_bridge\"\u003e\u003ca class=\"anchor\" href=\"#_securing_the_bridge\"\u003e\u003c/a\u003eSecuring the Bridge\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you started a bridge like in the above example without securing it, and attempted to send messages through\nit you\u0026#8217;d find that the messages mysteriously disappeared. What happened to them?\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor most applications you probably don\u0026#8217;t want client side JavaScript being able to send just any message to any\nhandlers on the server side or to all other browsers.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor example, you may have a service on the event bus which allows data to be accessed or deleted. We don\u0026#8217;t want\nbadly behaved or malicious clients being able to delete all the data in your database!\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAlso, we don\u0026#8217;t necessarily want any client to be able to listen in on any event bus address.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo deal with this, a SockJS bridge will by default refuse to let through any messages. It\u0026#8217;s up to you to tell the\nbridge what messages are ok for it to pass through. (There is an exception for reply messages which are always allowed through).\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn other words the bridge acts like a kind of firewall which has a default \u003cem\u003edeny-all\u003c/em\u003e policy.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eConfiguring the bridge to tell it what messages it should pass through is easy.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can specify which \u003cem\u003ematches\u003c/em\u003e you want to allow for inbound and outbound traffic using the\n\u003ccode\u003e\u003ca href=\"../dataobjects.html#BridgeOptions\"\u003eBridgeOptions\u003c/a\u003e\u003c/code\u003e that you pass in when calling bridge.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eEach match is a \u003ccode\u003e\u003ca href=\"../dataobjects.html#PermittedOptions\"\u003ePermittedOptions\u003c/a\u003e\u003c/code\u003e object:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003e\u003ca href=\"../../vertx-bridge-common/dataobjects.html#PermittedOptions#setAddress()\"\u003eaddress\u003c/a\u003e\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis represents the exact address the message is being sent to. If you want to allow messages based on\nan exact address you use this field.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003e\u003ca href=\"../../vertx-bridge-common/dataobjects.html#PermittedOptions#setAddressRegex()\"\u003eaddressRegex\u003c/a\u003e\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis is a regular expression that will be matched against the address. If you want to allow messages\nbased on a regular expression you use this field. If the \u003ccode\u003eaddress\u003c/code\u003e field is specified this field will be ignored.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003e\u003ccode\u003e\u003ca href=\"../../vertx-bridge-common/dataobjects.html#PermittedOptions#setMatch()\"\u003ematch\u003c/a\u003e\u003c/code\u003e\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis allows you to allow messages based on their structure. Any fields in the match must exist in the\nmessage with the same values for them to be allowed. This currently only works with JSON messages.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf a message is \u003cem\u003ein-bound\u003c/em\u003e (i.e. being sent from client side JavaScript to the server) when it is received Vert.x-Web\nwill look through any inbound permitted matches. If any match, it will be allowed through.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf a message is \u003cem\u003eout-bound\u003c/em\u003e (i.e. being sent from the server to client side JavaScript) before it is sent to the client\nVert.x-Web will look through any outbound permitted matches. If any match, it will be allowed through.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe actual matching works as follows:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf an \u003ccode\u003eaddress\u003c/code\u003e field has been specified then the \u003ccode\u003eaddress\u003c/code\u003e must match \u003cem\u003eexactly\u003c/em\u003e with the address of the message\nfor it to be considered matched.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf an \u003ccode\u003eaddress\u003c/code\u003e field has not been specified and an \u003ccode\u003eaddressRegex\u003c/code\u003e field has been specified then the regular expression\nin \u003ccode\u003eaddress_re\u003c/code\u003e must match with the address of the message for it to be considered matched.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf a \u003ccode\u003ematch\u003c/code\u003e field has been specified, then also the structure of the message must match. Structuring matching works\nby looking at all the fields and values in the match object and checking they all exist in the actual message body.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e sockJSHandler = \u003cspan class=\"hljs-type\"\u003eSockJSHandler\u003c/span\u003e.create(vertx)\n\n\n\u003cspan class=\"hljs-comment\"\u003e// Let through any messages sent to \u0026#x27;demo.orderMgr\u0026#x27; from the client\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e inboundPermitted1 = \u003cspan class=\"hljs-type\"\u003ePermittedOptions\u003c/span\u003e()\n  .setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;demo.orderMgr\u0026quot;\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-comment\"\u003e// Allow calls to the address \u0026#x27;demo.persistor\u0026#x27; from the client as long as the messages\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// have an action field with value \u0026#x27;find\u0026#x27; and a collection field with value\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// \u0026#x27;albums\u0026#x27;\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e inboundPermitted2 = \u003cspan class=\"hljs-type\"\u003ePermittedOptions\u003c/span\u003e()\n  .setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;demo.persistor\u0026quot;\u003c/span\u003e)\n  .setMatch(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e io.vertx.core.json.\u003cspan class=\"hljs-type\"\u003eJsonObject\u003c/span\u003e().put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;action\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;find\u0026quot;\u003c/span\u003e).put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;collection\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;albums\u0026quot;\u003c/span\u003e))\n\n\n\u003cspan class=\"hljs-comment\"\u003e// Allow through any message with a field `wibble` with value `foo`.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e inboundPermitted3 = \u003cspan class=\"hljs-type\"\u003ePermittedOptions\u003c/span\u003e()\n  .setMatch(\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e io.vertx.core.json.\u003cspan class=\"hljs-type\"\u003eJsonObject\u003c/span\u003e().put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;wibble\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;foo\u0026quot;\u003c/span\u003e))\n\n\n\u003cspan class=\"hljs-comment\"\u003e// First let\u0026#x27;s define what we\u0026#x27;re going to allow from server -\u0026gt; client\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// Let through any messages coming from address \u0026#x27;ticker.mystock\u0026#x27;\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e outboundPermitted1 = \u003cspan class=\"hljs-type\"\u003ePermittedOptions\u003c/span\u003e()\n  .setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;ticker.mystock\u0026quot;\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-comment\"\u003e// Let through any messages from addresses starting with \u0026quot;news.\u0026quot; (e.g. news.europe, news.usa, etc)\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e outboundPermitted2 = \u003cspan class=\"hljs-type\"\u003ePermittedOptions\u003c/span\u003e()\n  .setAddressRegex(\u003cspan class=\"hljs-string\"\u003e\u0026quot;news\\\\..+\u0026quot;\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-comment\"\u003e// Let\u0026#x27;s define what we\u0026#x27;re going to allow from client -\u0026gt; server\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = \u003cspan class=\"hljs-type\"\u003eBridgeOptions\u003c/span\u003e()\n  .setInboundPermitteds(\u003cspan class=\"hljs-type\"\u003eSet\u003c/span\u003e(inboundPermitted1, inboundPermitted1, inboundPermitted3))\n  .setOutboundPermitteds(\u003cspan class=\"hljs-type\"\u003eSet\u003c/span\u003e(outboundPermitted1, outboundPermitted2))\n\n\n\u003cspan class=\"hljs-comment\"\u003e// mount the bridge on the router\u003c/span\u003e\nrouter.mountSubRouter(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/eventbus\u0026quot;\u003c/span\u003e, sockJSHandler.bridge(options))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_requiring_authorisation_for_messages\"\u003e\u003ca class=\"anchor\" href=\"#_requiring_authorisation_for_messages\"\u003e\u003c/a\u003eRequiring authorisation for messages\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe event bus bridge can also be configured to use the Vert.x-Web authorisation functionality to require\nauthorisation for messages, either in-bound or out-bound on the bridge.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo do this, you can add extra fields to the match described in the previous section that determine what authority is\nrequired for the match.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo declare that a specific authority for the logged-in user is required in order to access allow the messages you use the\n\u003ccode\u003e\u003ca href=\"../../vertx-bridge-common/dataobjects.html#PermittedOptions#setRequiredAuthority()\"\u003erequiredAuthority\u003c/a\u003e\u003c/code\u003e field.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Let through any messages sent to \u0026#x27;demo.orderService\u0026#x27; from the client\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e inboundPermitted = \u003cspan class=\"hljs-type\"\u003ePermittedOptions\u003c/span\u003e()\n  .setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;demo.orderService\u0026quot;\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-comment\"\u003e// But only if the user is logged in and has the authority \u0026quot;place_orders\u0026quot;\u003c/span\u003e\ninboundPermitted.setRequiredAuthority(\u003cspan class=\"hljs-string\"\u003e\u0026quot;place_orders\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = \u003cspan class=\"hljs-type\"\u003eBridgeOptions\u003c/span\u003e()\n  .setInboundPermitteds(\u003cspan class=\"hljs-type\"\u003eSet\u003c/span\u003e(inboundPermitted))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eFor the user to be authorised they must be first logged in and secondly have the required authority.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo handle the login and actually auth you can configure the normal Vert.x auth handlers. For example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-comment\"\u003e// Let through any messages sent to \u0026#x27;demo.orderService\u0026#x27; from the client\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e inboundPermitted = \u003cspan class=\"hljs-type\"\u003ePermittedOptions\u003c/span\u003e()\n  .setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;demo.orderService\u0026quot;\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-comment\"\u003e// But only if the user is logged in and has the authority \u0026quot;place_orders\u0026quot;\u003c/span\u003e\ninboundPermitted.setRequiredAuthority(\u003cspan class=\"hljs-string\"\u003e\u0026quot;place_orders\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e sockJSHandler = \u003cspan class=\"hljs-type\"\u003eSockJSHandler\u003c/span\u003e.create(vertx)\n\n\u003cspan class=\"hljs-comment\"\u003e// Now set up some basic auth handling:\u003c/span\u003e\n\nrouter.route().handler(\u003cspan class=\"hljs-type\"\u003eSessionHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-type\"\u003eLocalSessionStore\u003c/span\u003e.create(vertx)))\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e basicAuthHandler = \u003cspan class=\"hljs-type\"\u003eBasicAuthHandler\u003c/span\u003e.create(authProvider)\n\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/eventbus/*\u0026quot;\u003c/span\u003e).handler(basicAuthHandler)\n\n\u003cspan class=\"hljs-comment\"\u003e// mount the bridge on the router\u003c/span\u003e\nrouter.mountSubRouter(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/eventbus\u0026quot;\u003c/span\u003e, sockJSHandler.bridge(\u003cspan class=\"hljs-type\"\u003eBridgeOptions\u003c/span\u003e()\n  .setInboundPermitteds(\u003cspan class=\"hljs-type\"\u003eSet\u003c/span\u003e(inboundPermitted))\n))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_handling_event_bus_bridge_events\"\u003e\u003ca class=\"anchor\" href=\"#_handling_event_bus_bridge_events\"\u003e\u003c/a\u003eHandling event bus bridge events\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you want to be notified when an event occurs on the bridge you can provide a handler when calling\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/SockJSHandler.html#bridge(io.vertx.ext.web.handler.sockjs.BridgeOptions)\"\u003ebridge\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhenever an event occurs on the bridge it will be passed to the handler. The event is described by an instance of\n\u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/sockjs/BridgeEvent.html\"\u003eBridgeEvent\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe event can be one of the following types:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"dlist\"\u003e\n\u003cdl\u003e\n\u003cdt class=\"hdlist1\"\u003eSOCKET_CREATED\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis event will occur when a new SockJS socket is created.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003eSOCKET_IDLE\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis event will occur when SockJS socket is on idle for longer period of time than initially configured.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003eSOCKET_PING\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis event will occur when the last ping timestamp is updated for the SockJS socket.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003eSOCKET_CLOSED\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis event will occur when a SockJS socket is closed.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003eSEND\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis event will occur when a message is attempted to be sent from the client to the server.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003ePUBLISH\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis event will occur when a message is attempted to be published from the client to the server.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003eRECEIVE\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis event will occur when a message is attempted to be delivered from the server to the client.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003eREGISTER\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis event will occur when a client attempts to register a handler.\u003c/p\u003e\n\u003c/dd\u003e\n\u003cdt class=\"hdlist1\"\u003eUNREGISTER\u003c/dt\u003e\n\u003cdd\u003e\n\u003cp\u003eThis event will occur when a client attempts to unregister a handler.\u003c/p\u003e\n\u003c/dd\u003e\n\u003c/dl\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe event enables you to retrieve the type using \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/bridge/BaseBridgeEvent.html#type()\"\u003etype\u003c/a\u003e\u003c/code\u003e and\ninspect the raw message of the event using \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/bridge/BaseBridgeEvent.html#getRawMessage()\"\u003egetRawMessage\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe raw message is a JSON object with the following structure:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre\u003e{\n \"type\": \"send\"|\"publish\"|\"receive\"|\"register\"|\"unregister\",\n \"address\": the event bus address being sent/published/registered/unregistered\n \"body\": the body of the message\n}\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe event is also an instance of \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/core/Future.html\"\u003eFuture\u003c/a\u003e\u003c/code\u003e. When you are finished handling the event you can\ncomplete the future with \u003ccode\u003etrue\u003c/code\u003e to enable further processing.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIf you don\u0026#8217;t want the event to be processed you can complete the future with \u003ccode\u003efalse\u003c/code\u003e. This is a useful feature that\nenables you to do your own filtering on messages passing through the bridge, or perhaps apply some fine grained\nauthorisation or metrics.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example where we reject all messages flowing through the bridge if they contain the word \"Armadillos\".\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-comment\"\u003e// Let through any messages sent to \u0026#x27;demo.orderMgr\u0026#x27; from the client\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e inboundPermitted = \u003cspan class=\"hljs-type\"\u003ePermittedOptions\u003c/span\u003e()\n  .setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;demo.someService\u0026quot;\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e sockJSHandler = \u003cspan class=\"hljs-type\"\u003eSockJSHandler\u003c/span\u003e.create(vertx)\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = \u003cspan class=\"hljs-type\"\u003eBridgeOptions\u003c/span\u003e()\n  .setInboundPermitteds(\u003cspan class=\"hljs-type\"\u003eSet\u003c/span\u003e(inboundPermitted))\n\n\n\u003cspan class=\"hljs-comment\"\u003e// mount the bridge on the router\u003c/span\u003e\nrouter.mountSubRouter(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/eventbus\u0026quot;\u003c/span\u003e, sockJSHandler.bridge(options, (be: io.vertx.scala.ext.web.handler.sockjs.\u003cspan class=\"hljs-type\"\u003eBridgeEvent\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (be.\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e() == \u003cspan class=\"hljs-type\"\u003eBridgeEventType\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003ePUBLISH\u003c/span\u003e || be.\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e() == \u003cspan class=\"hljs-type\"\u003eBridgeEventType\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003eRECEIVE\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (be.getRawMessage().getValue(\u003cspan class=\"hljs-string\"\u003e\u0026quot;body\u0026quot;\u003c/span\u003e) == \u003cspan class=\"hljs-string\"\u003e\u0026quot;armadillos\u0026quot;\u003c/span\u003e) {\n      \u003cspan class=\"hljs-comment\"\u003e// Reject it\u003c/span\u003e\n      be.complete(\u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e)\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e\n    }\n  }\n  be.complete(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n}))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere\u0026#8217;s an example how to configure and handle SOCKET_IDLE bridge event type.\nNotice \u003ccode\u003esetPingTimeout(5000)\u003c/code\u003e which says that if ping message doesn\u0026#8217;t arrive from client within 5 seconds\nthen the SOCKET_IDLE bridge event would be triggered.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-comment\"\u003e// Initialize SockJS handler\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e sockJSHandler = \u003cspan class=\"hljs-type\"\u003eSockJSHandler\u003c/span\u003e.create(vertx)\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = \u003cspan class=\"hljs-type\"\u003eBridgeOptions\u003c/span\u003e()\n  .setInboundPermitteds(\u003cspan class=\"hljs-type\"\u003eSet\u003c/span\u003e(inboundPermitted))\n  .setPingTimeout(\u003cspan class=\"hljs-number\"\u003e5000\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-comment\"\u003e// mount the bridge on the router\u003c/span\u003e\nrouter.mountSubRouter(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/eventbus\u0026quot;\u003c/span\u003e, sockJSHandler.bridge(options, (be: io.vertx.scala.ext.web.handler.sockjs.\u003cspan class=\"hljs-type\"\u003eBridgeEvent\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (be.\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e() == \u003cspan class=\"hljs-type\"\u003eBridgeEventType\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003eSOCKET_IDLE\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// Do some custom handling...\u003c/span\u003e\n  }\n\n  be.complete(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n}))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn client side JavaScript you use the 'vertx-eventbus.js` library to create connections to the event bus and to send and receive messages:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026#x27;vertx-eventbus.js\u0026#x27;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"javascript\"\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e eb = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e EventBus(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;http://localhost:8080/eventbus\u0026#x27;\u003c/span\u003e, {\u003cspan class=\"hljs-string\"\u003e\u0026quot;vertxbus_ping_interval\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e300000\u003c/span\u003e}); \u003cspan class=\"hljs-comment\"\u003e// sends ping every 5 minutes.\u003c/span\u003e\n\neb.onopen = \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n\n\u003cspan class=\"hljs-comment\"\u003e// set a handler to receive a message\u003c/span\u003e\neb.registerHandler(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;some-address\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eerror, message\u003c/span\u003e) \u003c/span\u003e{\n  \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;received a message: \u0026#x27;\u003c/span\u003e + \u003cspan class=\"hljs-built_in\"\u003eJSON\u003c/span\u003e.stringify(message));\n});\n\n\u003cspan class=\"hljs-comment\"\u003e// send a message\u003c/span\u003e\neb.send(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;some-address\u0026#x27;\u003c/span\u003e, {\u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;tim\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eage\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e587\u003c/span\u003e});\n}\n\n\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe first thing the example does is to create a instance of the event bus\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-javascript\" data-lang=\"javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e eb = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e EventBus(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;http://localhost:8080/eventbus\u0026#x27;\u003c/span\u003e, {\u003cspan class=\"hljs-string\"\u003e\u0026quot;vertxbus_ping_interval\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e300000\u003c/span\u003e});\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe 2nd parameter to the constructor tells the sockjs library to send ping message every 5 minutes. since the server\nwas configured to expect ping every 5 seconds \u0026#8594; \u003ccode\u003eSOCKET_IDLE\u003c/code\u003e would be triggered on the server.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also amend the raw message, e.g. change the body. For messages that are flowing in from the client you can\nalso add headers to the message, here\u0026#8217;s an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e router = \u003cspan class=\"hljs-type\"\u003eRouter\u003c/span\u003e.router(vertx)\n\n\u003cspan class=\"hljs-comment\"\u003e// Let through any messages sent to \u0026#x27;demo.orderService\u0026#x27; from the client\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e inboundPermitted = \u003cspan class=\"hljs-type\"\u003ePermittedOptions\u003c/span\u003e()\n  .setAddress(\u003cspan class=\"hljs-string\"\u003e\u0026quot;demo.orderService\u0026quot;\u003c/span\u003e)\n\n\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e sockJSHandler = \u003cspan class=\"hljs-type\"\u003eSockJSHandler\u003c/span\u003e.create(vertx)\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e options = \u003cspan class=\"hljs-type\"\u003eBridgeOptions\u003c/span\u003e()\n  .setInboundPermitteds(\u003cspan class=\"hljs-type\"\u003eSet\u003c/span\u003e(inboundPermitted))\n\n\n\u003cspan class=\"hljs-comment\"\u003e// mount the bridge on the router\u003c/span\u003e\nrouter.mountSubRouter(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/eventbus\u0026quot;\u003c/span\u003e, sockJSHandler.bridge(options, (be: io.vertx.scala.ext.web.handler.sockjs.\u003cspan class=\"hljs-type\"\u003eBridgeEvent\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (be.\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e() == \u003cspan class=\"hljs-type\"\u003eBridgeEventType\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003ePUBLISH\u003c/span\u003e || be.\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e() == \u003cspan class=\"hljs-type\"\u003eBridgeEventType\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003eSEND\u003c/span\u003e) {\n    \u003cspan class=\"hljs-comment\"\u003e// Add some headers\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e headers = \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e io.vertx.core.json.\u003cspan class=\"hljs-type\"\u003eJsonObject\u003c/span\u003e().put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;header1\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;val\u0026quot;\u003c/span\u003e).put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;header2\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;val2\u0026quot;\u003c/span\u003e)\n    \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e rawMessage = be.getRawMessage()\n    rawMessage.put(\u003cspan class=\"hljs-string\"\u003e\u0026quot;headers\u0026quot;\u003c/span\u003e, headers)\n    be.setRawMessage(rawMessage)\n  }\n  be.complete(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e)\n}))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_csrf_cross_site_request_forgery\"\u003e\u003ca class=\"anchor\" href=\"#_csrf_cross_site_request_forgery\"\u003e\u003c/a\u003eCSRF Cross Site Request Forgery\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eCSRF or sometimes also known as XSRF is a technique by which an unauthorized site can gain your user\u0026#8217;s private data.\nVert.x-Web includes a handler \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/web/handler/CSRFHandler.html\"\u003eCSRFHandler\u003c/a\u003e\u003c/code\u003e that you can use to prevent cross site\nrequest forgery requests.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOn each get request under this handler a cookie is added to the response with a unique token. Clients are then\nexpected to return this token back in a header. Since cookies are sent it is required that the cookie handler is also\npresent on the router.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen developing non single page applications that rely on the User-Agent to perform the \u003ccode\u003ePOST\u003c/code\u003e action, Headers cannot\nbe specified on HTML Forms. In order to solve this problem the header value will also be checked if and only if no\nheader was present in the Form attributes under the same name as the header, e.g.:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e---\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eform\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eaction\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;/submit\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003emethod\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;POST\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003einput\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;hidden\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;X-XSRF-TOKEN\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;abracadabra\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eform\u003c/span\u003e\u0026gt;\u003c/span\u003e\n---\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIt is the responsibility of the user to fill in the right value for the form field. Users who prefer to use an HTML\nonly solution can fill this value by fetching the the token value from the routing context under the key \u003ccode\u003eX-XSRF-TOKEN\u003c/code\u003e\nor the header name they have chosen during the instantiation of the \u003ccode\u003eCSRFHandler\u003c/code\u003e object.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().handler(\u003cspan class=\"hljs-type\"\u003eCSRFHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;abracadabra\u0026quot;\u003c/span\u003e))\nrouter.route().handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_using_ajax\"\u003e\u003ca class=\"anchor\" href=\"#_using_ajax\"\u003e\u003c/a\u003eUsing AJAX\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen accessing protected routes via ajax both the csrf token will need to be passed in the request. Typically this is\ndone using a request header, as adding a request header can typically be done at a central location easily without\npayload modification.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe CSRF token is obtained from the server side context under the key \u003ccode\u003eX-XSRF-TOKEN\u003c/code\u003e (unless you specified a different\nname). This token needs to be exposed to the client-side, typically by including it in the initial page content. One\npossibility is to store it in an HTML \u0026lt;meta\u0026gt; tag, where value can then be retrieved at the time of the request by\nJavaScript.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe following can be included in your view (handlebar example below):\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-html\" data-lang=\"html\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;csrf-token\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;${X-XSRF-TOKEN}\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe following is an example of using the Fetch API to post to the /process route with the CSRF token from the \u0026lt;meta\u0026gt;\ntag on the page:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-js\" data-lang=\"js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Read the CSRF token from the \u0026lt;meta\u0026gt; tag\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e token = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.querySelector(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;meta[name=\u0026quot;csrf-token\u0026quot;]\u0026#x27;\u003c/span\u003e).getAttribute(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;content\u0026#x27;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// Make a request using the Fetch API\u003c/span\u003e\nfetch(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;/process\u0026#x27;\u003c/span\u003e, {\n \u003cspan class=\"hljs-attr\"\u003ecredentials\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;same-origin\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-comment\"\u003e// \u0026lt;-- includes cookies in the request\u003c/span\u003e\n \u003cspan class=\"hljs-attr\"\u003eheaders\u003c/span\u003e: {\n   \u003cspan class=\"hljs-string\"\u003e\u0026#x27;X-XSRF-TOKEN\u0026#x27;\u003c/span\u003e: token \u003cspan class=\"hljs-comment\"\u003e// \u0026lt;-- is the csrf token as a header\u003c/span\u003e\n },\n \u003cspan class=\"hljs-attr\"\u003emethod\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;POST\u0026#x27;\u003c/span\u003e,\n \u003cspan class=\"hljs-attr\"\u003ebody\u003c/span\u003e: {\n   \u003cspan class=\"hljs-attr\"\u003ekey\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;value\u0026#x27;\u003c/span\u003e\n }\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_virtualhost_handler\"\u003e\u003ca class=\"anchor\" href=\"#_virtualhost_handler\"\u003e\u003c/a\u003eVirtualHost Handler\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe Virtual Host Handler will verify the request hostname and if it matches it will send the request to the\nregistered handler, otherwise will continue inside the normal handlers chain.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eRequest are checked against the \u003ccode\u003eHost\u003c/code\u003e header to a match and patterns allow the usage of \u003ccode\u003e\u003cstrong\u003e\u003c/code\u003e wildcards, as for\nexample \u003ccode\u003e\u003c/strong\u003e.vertx.io\u003c/code\u003e or fully domain names as \u003ccode\u003ewww.vertx.io\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003erouter.route().handler(\u003cspan class=\"hljs-type\"\u003eVirtualHostHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;*.vertx.io\u0026quot;\u003c/span\u003e, (routingContext: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// do something if the request is for *.vertx.io\u003c/span\u003e\n}))\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_oauth2authhandler_handler\"\u003e\u003ca class=\"anchor\" href=\"#_oauth2authhandler_handler\"\u003e\u003c/a\u003eOAuth2AuthHandler Handler\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe \u003ccode\u003eOAuth2AuthHandler\u003c/code\u003e allows quick setup of secure routes using the OAuth2 protocol. This handler simplifies the\nauthCode flow. An example of using it to protect some resource and authenticate with GitHub can be implemented as:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// create an OAuth2 provider, clientID and clientSecret should be requested to github\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e authProvider = \u003cspan class=\"hljs-type\"\u003eGithubAuth\u003c/span\u003e.create(vertx, \u003cspan class=\"hljs-string\"\u003e\u0026quot;CLIENT_ID\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;CLIENT_SECRET\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// create a oauth2 handler on our running server\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// the second argument is the full url to the callback as you entered in your provider management console.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e oauth2 = \u003cspan class=\"hljs-type\"\u003eOAuth2AuthHandler\u003c/span\u003e.create(authProvider, \u003cspan class=\"hljs-string\"\u003e\u0026quot;https://myserver.com/callback\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// setup the callback handler for receiving the GitHub callback\u003c/span\u003e\noauth2.setupCallback(router.route())\n\n\u003cspan class=\"hljs-comment\"\u003e// protect everything under /protected\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/protected/*\u0026quot;\u003c/span\u003e).handler(oauth2)\n\u003cspan class=\"hljs-comment\"\u003e// mount some handler under the protected zone\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/protected/somepage\u0026quot;\u003c/span\u003e).handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  rc.response().end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Welcome to the protected resource!\u0026quot;\u003c/span\u003e)\n})\n\n\u003cspan class=\"hljs-comment\"\u003e// welcome page\u003c/span\u003e\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  ctx.response().putHeader(\u003cspan class=\"hljs-string\"\u003e\u0026quot;content-type\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;text/html\u0026quot;\u003c/span\u003e).end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello\u0026lt;br\u0026gt;\u0026lt;a href=\\\u0026quot;/protected/somepage\\\u0026quot;\u0026gt;Protected by Github\u0026lt;/a\u0026gt;\u0026quot;\u003c/span\u003e)\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe OAuth2AuthHandler will setup a proper callback OAuth2 handler so the user does not need to deal with validation\nof the authority server response. It is quite important to know that authority server responses are only valid once,\nthis means that if a client issues a reload of the callback URL it will be asserted as a invalid request since the\nvalidation will fail.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eA rule of thumb is once a valid callback is executed issue a client side redirect to a protected resource. This\nredirect should also create a session cookie (or other session mechanism) so the user is not required to authenticate\nfor every request.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eDue to the nature of OAuth2 spec there are slight changes required in order to use other OAuth2 providers but\nvertx-auth provides you with many out of the box implementations:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eAzure Active Directory \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/AzureADAuth.html\"\u003eAzureADAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBox.com \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/BoxAuth.html\"\u003eBoxAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDropbox \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/DropboxAuth.html\"\u003eDropboxAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFacebook \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/FacebookAuth.html\"\u003eFacebookAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFoursquare \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/FoursquareAuth.html\"\u003eFoursquareAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGithub \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/GithubAuth.html\"\u003eGithubAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eGoogle \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/GoogleAuth.html\"\u003eGoogleAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eInstagram \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/InstagramAuth.html\"\u003eInstagramAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eKeycloak \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/KeycloakAuth.html\"\u003eKeycloakAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLinkedIn \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/LinkedInAuth.html\"\u003eLinkedInAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eMailchimp \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/MailchimpAuth.html\"\u003eMailchimpAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSalesforce \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/SalesforceAuth.html\"\u003eSalesforceAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eShopify \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/ShopifyAuth.html\"\u003eShopifyAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eSoundcloud \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/SoundcloudAuth.html\"\u003eSoundcloudAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eStripe \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/StripeAuth.html\"\u003eStripeAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eTwitter \u003ccode\u003e\u003ca href=\"../../scaladocs/io/vertx/scala/ext/auth/oauth2/providers/TwitterAuth.html\"\u003eTwitterAuth\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHowever if you\u0026#8217;re using an unlisted provider you can still do it using the base API like this:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// create an OAuth2 provider, clientID and clientSecret should be requested to Google\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e authProvider = \u003cspan class=\"hljs-type\"\u003eOAuth2Auth\u003c/span\u003e.create(vertx, \u003cspan class=\"hljs-type\"\u003eOAuth2FlowType\u003c/span\u003e.\u003cspan class=\"hljs-type\"\u003eAUTH_CODE\u003c/span\u003e, \u003cspan class=\"hljs-type\"\u003eOAuth2ClientOptions\u003c/span\u003e()\n  .setClientID(\u003cspan class=\"hljs-string\"\u003e\u0026quot;CLIENT_ID\u0026quot;\u003c/span\u003e)\n  .setClientSecret(\u003cspan class=\"hljs-string\"\u003e\u0026quot;CLIENT_SECRET\u0026quot;\u003c/span\u003e)\n  .setSite(\u003cspan class=\"hljs-string\"\u003e\u0026quot;https://accounts.google.com\u0026quot;\u003c/span\u003e)\n  .setTokenPath(\u003cspan class=\"hljs-string\"\u003e\u0026quot;https://www.googleapis.com/oauth2/v3/token\u0026quot;\u003c/span\u003e)\n  .setAuthorizationPath(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/o/oauth2/auth\u0026quot;\u003c/span\u003e)\n)\n\n\u003cspan class=\"hljs-comment\"\u003e// create a oauth2 handler on our domain: \u0026quot;http://localhost:8080\u0026quot;\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e oauth2 = \u003cspan class=\"hljs-type\"\u003eOAuth2AuthHandler\u003c/span\u003e.create(authProvider, \u003cspan class=\"hljs-string\"\u003e\u0026quot;http://localhost:8080\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// these are the scopes\u003c/span\u003e\noauth2.addAuthority(\u003cspan class=\"hljs-string\"\u003e\u0026quot;profile\u0026quot;\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// setup the callback handler for receiving the Google callback\u003c/span\u003e\noauth2.setupCallback(router.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/callback\u0026quot;\u003c/span\u003e))\n\n\u003cspan class=\"hljs-comment\"\u003e// protect everything under /protected\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/protected/*\u0026quot;\u003c/span\u003e).handler(oauth2)\n\u003cspan class=\"hljs-comment\"\u003e// mount some handler under the protected zone\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/protected/somepage\u0026quot;\u003c/span\u003e).handler((rc: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  rc.response().end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Welcome to the protected resource!\u0026quot;\u003c/span\u003e)\n})\n\n\u003cspan class=\"hljs-comment\"\u003e// welcome page\u003c/span\u003e\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  ctx.response().putHeader(\u003cspan class=\"hljs-string\"\u003e\u0026quot;content-type\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;text/html\u0026quot;\u003c/span\u003e).end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello\u0026lt;br\u0026gt;\u0026lt;a href=\\\u0026quot;/protected/somepage\\\u0026quot;\u0026gt;Protected by Google\u0026lt;/a\u0026gt;\u0026quot;\u003c/span\u003e)\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou will need to provide all the details of your provider manually but the end result is the same.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe handler will pin your application the the configured callback url. The usage is simple as providing the handler\na route instance and all setup will be done for you. In a typical use case your provider will ask you what is the\ncallback url to your application, your then enter a url like: \u003ccode\u003e\u003ca href=\"https://myserver.com/callback\" class=\"bare\"\u003ehttps://myserver.com/callback\u003c/a\u003e\u003c/code\u003e. This is the second\nargument to the handler now you just need to set it up. To make it easier to the end user all you need to do is call\nthe setupCallback method.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis is how you pin your handler to the server \u003ccode\u003e\u003ca href=\"https://myserver.com:8447/callback\" class=\"bare\"\u003ehttps://myserver.com:8447/callback\u003c/a\u003e\u003c/code\u003e. Note that the port number is not\nmandatory for the default values, 80 for http, 443 for https.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// create a oauth2 handler pinned to myserver.com: \u0026quot;https://myserver.com:8447/callback\u0026quot;\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e oauth2 = \u003cspan class=\"hljs-type\"\u003eOAuth2AuthHandler\u003c/span\u003e.create(provider, \u003cspan class=\"hljs-string\"\u003e\u0026quot;https://myserver.com:8447/callback\u0026quot;\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e// now allow the handler to setup the callback url for you\u003c/span\u003e\noauth2.setupCallback(router.route())\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the example the route object is created inline by \u003ccode\u003eRouter.route()\u003c/code\u003e however if you want to have full control of the\norder the handler is called (for example you want it to be called as soon as possible in the chain) you can always\ncreate the route object before and pass it as a reference to this method.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_a_real_world_example\"\u003e\u003ca class=\"anchor\" href=\"#_a_real_world_example\"\u003e\u003c/a\u003eA real world example\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eUp to now you have learned how to use the Oauth2 Handler however you will notice that for each request you will need\nto authenticate. This is because the handler has no state and there was no state management applied in the examples.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eAlthough having no state is recommended for API facing endpoints, for example, using JWT (we will cover those later)\nfor user facing endpoinst we can keep the authentication result stored in the session. For this to work we would\nneed an application like the following snippet:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-scala\" data-lang=\"scala\"\u003e\u003cspan class=\"hljs-comment\"\u003e// To simplify the development of the web components\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// we use a Router to route all HTTP requests\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// to organize our code in a reusable way.\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// Simple auth service which uses a GitHub to\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// authenticate the user\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e authProvider = \u003cspan class=\"hljs-type\"\u003eGithubAuth\u003c/span\u003e.create(vertx, \u003cspan class=\"hljs-string\"\u003e\u0026quot;YOUR PROVIDER CLIENTID\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;YOUR PROVIDER CLIENT SECRET\u0026quot;\u003c/span\u003e)\n\u003cspan class=\"hljs-comment\"\u003e// We need a user session handler too to make sure\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// the user is stored in the session between requests\u003c/span\u003e\nrouter.route().handler(\u003cspan class=\"hljs-type\"\u003eSessionHandler\u003c/span\u003e.create(\u003cspan class=\"hljs-type\"\u003eLocalSessionStore\u003c/span\u003e.create(vertx)).setAuthProvider(authProvider))\n\u003cspan class=\"hljs-comment\"\u003e// we now protect the resource under the path \u0026quot;/protected\u0026quot;\u003c/span\u003e\nrouter.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/protected\u0026quot;\u003c/span\u003e).handler(\u003cspan class=\"hljs-type\"\u003eOAuth2AuthHandler\u003c/span\u003e.create(authProvider).setupCallback(router.route(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/callback\u0026quot;\u003c/span\u003e)).addAuthority(\u003cspan class=\"hljs-string\"\u003e\u0026quot;user:email\u0026quot;\u003c/span\u003e))\n\u003cspan class=\"hljs-comment\"\u003e// Entry point to the application, this will render\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// a custom template.\u003c/span\u003e\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  ctx.response().putHeader(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Content-Type\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;text/html\u0026quot;\u003c/span\u003e).end(\u003cspan class=\"hljs-string\"\u003e\u0026quot;\u0026lt;html\u0026gt;\\n  \u0026lt;body\u0026gt;\\n    \u0026lt;p\u0026gt;\\n      Well, hello there!\\n    \u0026lt;/p\u0026gt;\\n    \u0026lt;p\u0026gt;\\n      We\u0026#x27;re going to the protected resource, if there is no\\n      user in the session we will talk to the GitHub API. Ready?\\n      \u0026lt;a href=\\\u0026quot;/protected\\\u0026quot;\u0026gt;Click here\u0026lt;/a\u0026gt; to begin!\u0026lt;/a\u0026gt;\\n    \u0026lt;/p\u0026gt;\\n    \u0026lt;p\u0026gt;\\n      \u0026lt;b\u0026gt;If that link doesn\u0026#x27;t work\u0026lt;/b\u0026gt;, remember to provide\\n      your own \u0026lt;a href=\\\u0026quot;https://github.com/settings/applications/new\\\u0026quot;\u0026gt;\\n      Client ID\u0026lt;/a\u0026gt;!\\n    \u0026lt;/p\u0026gt;\\n  \u0026lt;/body\u0026gt;\\n\u0026lt;/html\u0026gt;\u0026quot;\u003c/span\u003e)\n})\n\u003cspan class=\"hljs-comment\"\u003e// The protected resource\u003c/span\u003e\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/protected\u0026quot;\u003c/span\u003e).handler((ctx: io.vertx.scala.ext.web.\u003cspan class=\"hljs-type\"\u003eRoutingContext\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// at this moment your user object should contain the info\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// from the Oauth2 response, since this is a protected resource\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// as specified above in the handler config the user object is never null\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003evar\u003c/span\u003e user = ctx.user()\n  \u003cspan class=\"hljs-comment\"\u003e// just dump it to the client for demo purposes\u003c/span\u003e\n  ctx.response().end(user.toString())\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect2\"\u003e\n\u003ch3 id=\"_mixing_oauth2_and_jwt\"\u003e\u003ca class=\"anchor\" href=\"#_mixing_oauth2_and_jwt\"\u003e\u003c/a\u003eMixing OAuth2 and JWT\u003c/h3\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSome providers use JWT tokens as access tokens, this is a feature of \u003ca href=\"https://tools.ietf.org/html/rfc6750\"\u003eRFC6750\u003c/a\u003e\nand can be quite useful when one wants to mix client based authentication and API authorization. For example say that\nyou have a application that provides some protected HTML documents but you also want it to be available for API\u0026#8217;s to\nconsume. In this case an API cannot easily perform the redirect handshake required by OAuth2 but can use a Token\nprovided before hand.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThis is handled automatically by the handler as long as the provider is configured to support JWTs.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn real life this means that your API\u0026#8217;s can access your protected resources using the header \u003ccode\u003eAuthorization\u003c/code\u003e with the\nvalue \u003ccode\u003eBearer BASE64_ACCESS_TOKEN\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e","version":"3.9.0"},"__N_SSG":true},"page":"/docs/[[...slug]]","query":{"slug":["3.9.0","vertx-web","scala"]},"buildId":"e44OdkvskwZZNaOOJbJ_B","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>